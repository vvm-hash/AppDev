
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5f168ad0-ee47-5c31-bf1e-b4de34899836")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2454893,e=>{e.v({cardLink:"marketplace-integration-card-module__GWffEq__cardLink",descriptionWrapper:"marketplace-integration-card-module__GWffEq__descriptionWrapper",icon:"marketplace-integration-card-module__GWffEq__icon",integrationCard:"marketplace-integration-card-module__GWffEq__integrationCard"})},1282571,e=>{"use strict";var t=e.i(6468255),r=e.i(9722978),i=e.i(9739627),s=e.i(4585051),a=e.i(9508212),n=e.i(5255926),l=e.i(2504781),o=e.i(57106),d=e.i(2704354),c=e.i(2454893),u=e.i(9100551),p=e.i(397094);function m(e){let{Actions:i,children:s,href:n,title:l,icon:d,className:m,"data-testid":g,disabled:h}=e,f=(0,u.useRouter)();return(0,t.jsxs)("div",{className:(0,r.clsx)(m,c.default.integrationCard),children:[(0,t.jsxs)(a.Stack,{className:c.default.descriptionWrapper,direction:"row",gap:4,justify:"space-between",children:[(0,t.jsxs)(a.Stack,{align:"center",className:c.default.descriptionWrapper,direction:"row",gap:3,children:[(0,t.jsx)(x,{icon:d,name:l}),s]}),i]}),h?null:(0,t.jsx)(o.Link,{"aria-label":`Open ${l}`,className:c.default.cardLink,"data-testid":g,href:n,onMouseDown:(0,p.buildOnMouseDown)({href:n,router:f})})]})}function g(e){let{children:i,Action:s,className:o}=e;return(0,t.jsx)("div",{className:(0,r.clsx)(o,c.default.integrationCard),children:(0,t.jsxs)(a.Stack,{direction:"row",justify:"space-between",children:[(0,t.jsxs)(a.Stack,{align:"center",className:"w-full",direction:"row",gap:3,children:[(0,t.jsx)(n.Skeleton,{height:36,rounded:!0,width:36}),i]}),s??(0,t.jsx)(l.Button,{size:"small",type:"secondary",children:(0,t.jsx)(n.Skeleton,{height:16,width:30})})]})})}function x(e){let{icon:r,name:a,size:n=36}=e;return(0,d.isContentfulIcon)(r)?(0,t.jsx)("div",{className:c.default.icon,children:(0,t.jsx)(i.Image,{alt:a,height:n,srcDark:`https:${r.fields.file.url}`,srcLight:`https:${r.fields.file.url}`,width:n})}):(0,t.jsx)(s.Avatar,{className:c.default.icon,hash:r,size:n})}e.s(["MarketplaceIntegrationCard",()=>m,"MarketplaceIntegrationCardIcon",()=>x,"MarketplaceIntegrationCardPlaceholder",()=>g])},4325157,e=>{"use strict";var t=e.i(3911483),r=e.i(4439612),i=(0,r.createServerReference)("7f0e6263a91a8fe4daee16fd2bc4fa4e04961f76b7",r.callServer,void 0,r.findSourceMapURL,"findManyPrivateMarketplaceIntegrationsByProduct"),s=e.i(2704354),a=e.i(9668517);e.s(["useMarketplaceIntegrations",0,e=>{let{protocolType:r}=e,n=(0,a.useTeamSlug)();return(0,t.default)(()=>(0,s.getMarketplaceIntegrationsApiUrl)({teamIdOrSlug:n??null,protocolType:r}),async e=>e&&n?i({protocolType:r,teamIdOrSlug:n}):[])}],4325157)},4110479,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646);let i=(0,r.createContext)(null);e.s(["DrainModalProvider",0,e=>{let{children:s,initialResource:a}=e,[n,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(a),p=(0,r.useCallback)((e,t)=>{d(e),u(t),l(!0)},[]),m=(0,r.useCallback)(()=>{d(null),u(a),l(!1)},[a]),g=(0,r.useMemo)(()=>({isOpen:n,setIsOpen:l,drain:o,resource:c,openDrain:p,closeModal:m}),[n,o,c,m,p]);return(0,t.jsx)(i.Provider,{value:g,children:s})},"useDrainModalContext",0,()=>{let e=(0,r.useContext)(i);if(null===e)throw Error("useDrainModal must be used within a DrainModalProvider");return e},"useOptionalDrainModalContext",0,()=>(0,r.useContext)(i)])},1971505,e=>{"use strict";var t=e.i(5486173),r=function(e,r,i){if(e&&"reportValidity"in e){var s=(0,t.get)(i,r);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},i=function(e,t){var i=function(i){var s=t.fields[i];s&&s.ref&&"reportValidity"in s.ref?r(s.ref,i,e):s.refs&&s.refs.forEach(function(t){return r(t,i,e)})};for(var s in t.fields)i(s)},s=function(e,r){r.shouldUseNativeValidation&&i(e,r);var s={};for(var a in e){var n=(0,t.get)(r.fields,a);(0,t.set)(s,a,Object.assign(e[a],{ref:n&&n.ref}))}return s},a=function(e,r){for(var i={};e.length;){var s=e[0],a=s.code,n=s.message,l=s.path.join(".");if(!i[l])if("unionErrors"in s){var o=s.unionErrors[0].errors[0];i[l]={message:o.message,type:o.code}}else i[l]={message:n,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),r){var d=i[l].types,c=d&&d[s.code];i[l]=(0,t.appendErrors)(l,r,i,a,c?[].concat(c,s.message):s.message)}e.shift()}return i},n=function(e,t,r){return void 0===r&&(r={}),function(n,l,o){try{return Promise.resolve(function(s,a){try{var l=Promise.resolve(e["sync"===r.mode?"parse":"parseAsync"](n,t)).then(function(e){return o.shouldUseNativeValidation&&i({},o),{errors:{},values:r.rawValues?n:e}})}catch(e){return a(e)}return l&&l.then?l.then(void 0,a):l}(0,function(e){return{values:{},errors:e.isEmpty?{}:s(a(e.errors,!o.shouldUseNativeValidation&&"all"===o.criteriaMode),o)}}))}catch(e){return Promise.reject(e)}}};e.s(["zodResolver",()=>n],1971505)},2199694,e=>{"use strict";function t(e){return"mode"in e&&"create"===e.mode}function r(e){return"mode"in e&&"update"===e.mode}e.s(["isCreateFlow",()=>t,"isUpdateFlow",()=>r])},5263903,(e,t,r)=>{"use strict";let i="[a-fA-F\\d:]",s=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${i})|(?<=${i})(?=\\s|$))`:"",a="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",l=`
(?:
(?:${n}:){7}(?:${n}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${n}:){6}(?:${a}|:${n}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${n}:){5}(?::${a}|(?::${n}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${n}:){4}(?:(?::${n}){0,1}:${a}|(?::${n}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${n}:){3}(?:(?::${n}){0,2}:${a}|(?::${n}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${n}:){2}(?:(?::${n}){0,3}:${a}|(?::${n}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${n}:){1}(?:(?::${n}){0,4}:${a}|(?::${n}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${n}){0,5}:${a}|(?::${n}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=RegExp(`(?:^${a}$)|(?:^${l}$)`),d=RegExp(`^${a}$`),c=RegExp(`^${l}$`),u=e=>e&&e.exact?o:RegExp(`(?:${s(e)}${a}${s(e)})|(?:${s(e)}${l}${s(e)})`,"g");u.v4=e=>e&&e.exact?d:RegExp(`${s(e)}${a}${s(e)}`,"g"),u.v6=e=>e&&e.exact?c:RegExp(`${s(e)}${l}${s(e)}`,"g"),t.exports=u},3775629,(e,t,r)=>{"use strict";let i=e.r(5263903),s=e.r(6881271);t.exports=e=>{e={strict:!0,...e};let t=`(?:(?:[a-z]+:)?//)${e.strict?"":"?"}`,r=i.v4().source,a=`(?:\\.${e.strict?"(?:[a-z\\u00a1-\\uffff]{2,})":`(?:${s.sort((e,t)=>t.length-e.length).join("|")})`})\\.?`,n=`(?:${t}|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${r}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*${a})(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;return e.exact?RegExp(`(?:^${n}$)`,"i"):RegExp(n,"ig")}},7662235,1094129,e=>{"use strict";var t=e.i(6468255),r=e.i(5486173),i=e.i(9957872),s=e.i(248550),a=e.i(4535059),n=e.i(4524395),l=e.i(2640326),o=e.i(6401841),d=e.i(6696646);e.i(553769);var c=e.i(3758860),u=e.i(4110479);let p=[{value:"logs",protocol:"logDrain",icon:s.Logs,title:"Logs",description:"Runtime, build and static logs"},{value:"traces",protocol:"traceDrain",icon:a.Traces,title:"Traces",description:"Distributed tracing data"},{value:"speed_insights",protocol:null,icon:n.StopwatchFast,title:"Speed Insights",description:"Performance metrics"},{value:"analytics",protocol:null,icon:l.Analytics,title:"Web Analytics",description:"Page views and custom events"}];e.s(["chooseDrainDataStep",0,{title:"Choose data to drain",component:function(){let{watch:e,setValue:s,resetField:a,register:n,clearErrors:l,formState:{errors:m}}=(0,r.useFormContext)(),g=(0,u.useOptionalDrainModalContext)(),x=g?.resource,h=e("drainType"),f=e("mode");return(0,d.useEffect)(()=>{n("drainType",{required:"required"})},[]),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ChoiceboxGroup,{className:"pt-4",direction:"column",label:"Choose data type",type:"radio",value:h??"",onChange:e=>{s("drainType",e),l("drainType"),"create"!==f||x?(a("delivery.type"),a("delivery.endpoint")):(s("delivery.type","traces"===e?"otlphttp":"http"),s("delivery.endpoint","traces"===e?{traces:""}:"")),a("delivery.encoding"),a("filter.source"),a("filter.environment")},children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:p.filter(e=>!x||e.protocol&&"integration"===x.type&&(0,c.isProtocolSupported)(x.product,e.protocol)).map(e=>{let r=e.icon;return(0,t.jsx)(i.ChoiceboxGroup.Item,{value:e.value,title:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r,{size:16}),e.title]}),description:e.description},e.value)})})}),m.drainType?.message&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)(o.Stop,{size:14,color:"red-700"}),(0,t.jsx)("p",{className:"text-copy-14 text-red-900",children:m.drainType.message})]})]})},getFieldsToValidate:()=>["drainType"],getIsNextEnabled:()=>!0,getSuffix:function(e,r){if(r)return null;let i=(()=>{switch(e){case"traces":return"Traces";case"logs":return"Logs";case"analytics":return"Web Analytics";case"speed_insights":return"Speed Insights"}})();return(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:i})}}],7662235),e.i(3512434);var m=e.i(9835407),g=e.i(3775629);let x=m.z.object({type:m.z.literal("head_sampling"),env:m.z.union([m.z.enum(["production","preview"]),m.z.literal("all")]).transform(e=>"all"===e?void 0:e).optional(),rate:m.z.number().min(0,"Sampling rate must be between 0 and 100%").max(1,"Sampling rate must be between 0 and 100%"),requestPath:m.z.string().optional().transform(e=>""===e?void 0:e)}),h=m.z.string().refine(e=>e.startsWith("https://"),{message:"URL must start with https://"}).refine(e=>(0,g.default)({exact:!0}).test(e),{message:"Must be a valid URL"}),f=m.z.object({type:m.z.literal("http"),endpoint:h,encoding:m.z.enum(["json","ndjson"]),headers:m.z.record(m.z.string()),secret:m.z.string().optional(),compression:m.z.enum(["gzip","none"]).optional()}),j=m.z.object({type:m.z.literal("otlphttp"),endpoint:m.z.object({traces:h}),encoding:m.z.enum(["proto","json"]),headers:m.z.record(m.z.string()),secret:m.z.string().optional()}),y=m.z.discriminatedUnion("type",[f,j]),v=m.z.enum(["lambda","edge","static","external","build","firewall","redirect"]),b=m.z.enum(["logs","traces","analytics","speed_insights"]),N=m.z.union([m.z.object({kind:m.z.literal("integration"),resourceId:m.z.string().optional(),integrationId:m.z.string().optional(),integrationConfigurationId:m.z.string().optional()}),m.z.object({kind:m.z.literal("self-served")})]),w=m.z.object({name:m.z.string().trim().min(1,"Drain name is required"),projects:m.z.enum(["all","some"]),drainType:b,delivery:y.optional(),sampling:m.z.array(x).max(5,"You can configure up to 5 sampling rules").optional(),projectIds:m.z.array(m.z.string()).optional(),filter:m.z.object({source:m.z.array(v),environment:m.z.array(m.z.string())}),source:N.optional(),mode:m.z.literal("create")}),S=m.z.object({name:m.z.string().trim().min(1,"Drain name is required").optional(),projects:m.z.enum(["all","some"]).optional(),drainType:b,delivery:y.optional(),sampling:m.z.array(x).optional(),projectIds:m.z.array(m.z.string()).optional(),status:m.z.enum(["enabled","disabled"]).optional(),filter:m.z.object({source:m.z.array(v),environment:m.z.array(m.z.string())}).optional(),source:N.optional(),mode:m.z.literal("update")}),C=m.z.discriminatedUnion("mode",[w,S]).refine(e=>"some"!==e.projects||e.projectIds&&e.projectIds.length>0,{message:"At least one project must be selected when choosing specific projects",path:["projectIds"]}).refine(e=>"logs"!==e.drainType||Number(e.filter?.environment.length)>0,{message:"At least one environment must be selected when draining logs",path:["filter.environment"]}).refine(e=>"logs"!==e.drainType||Number(e.filter?.source.length)>0,{message:"At least one source must be selected when draining logs",path:["filter.source"]});e.s(["DrainFormSchema",0,C,"httpUrl",0,h,"sourceLabelMap",0,{lambda:"Functions",edge:"Edge Functions",static:"Static Files",external:"Rewrites",build:"Builds",firewall:"Firewall",redirect:"Redirects"}],1094129)},1733572,e=>{"use strict";let t={logs:"Logs",traces:"Traces",analytics:"Web Analytics",speed_insights:"Speed Insights"};function r(e){return e.schemas?.trace?"traces":e.schemas?.analytics?"analytics":e.schemas?.speed_insights?"speed_insights":"logs"}function i(e){return t[e]}e.s(["getDrainType",()=>r,"getDrainTypeLabel",()=>i])},3614887,9572009,8249103,3456281,4789955,5664328,e=>{"use strict";let t;var r=e.i(6468255),i=e.i(3500331),s=e.i(3869281),a=e.i(7048904),n=e.i(6401841),l=e.i(2565125),o=e.i(2098824),d=e.i(1094129),c=e.i(1733572),u=e.i(5486173),p=e.i(6696646),m=e.i(6060673);let g=(0,p.createContext)(null),x=()=>(0,p.useContext)(g);e.s(["SheetContainerContext",0,g,"useSheetContainer",0,x],9572009);var h=e.i(5323212),f=e.i(3169345),j=e.i(8161149),y=e.i(2504781),v=e.i(5468328),b=e.i(923772),N=e.i(5169576);function w(){let{register:e,watch:t,setValue:s,formState:{errors:a}}=(0,u.useFormContext)(),l=Array.isArray(a.sampling)?a.sampling[0]?.rate?.message:void 0,{fields:o,append:d,remove:c}=(0,u.useFieldArray)({name:"sampling"});return(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Sampling"}),0===o.length?(0,r.jsx)("div",{className:"flex flex-col items-center justify-start gap-4 flex-initial mt-1.5",children:(0,r.jsx)(j.EmptyState.Root,{secondary:!0,title:"No sampling rules configured",description:"Configure how the data should be sampled for different environments",children:(0,r.jsx)(y.Button,{onClick:()=>d({type:"head_sampling",env:void 0,rate:1}),type:"secondary",typeName:"button",children:"Add Sampling Rule"})})}):(0,r.jsxs)(f.Table,{className:"border-separate border-spacing-0 mt-1.5",children:[(0,r.jsx)(f.Table.Header,{removeSpacing:!0,children:(0,r.jsxs)(f.Table.Row,{children:[(0,r.jsx)(f.Table.Head,{className:"border-t border-l rounded-tl border-solid border-gray-200 text-xs pl-4",children:"Environment"}),(0,r.jsx)(f.Table.Head,{className:"border-t border-solid border-gray-200 text-xs",children:"Rate"}),(0,r.jsx)(f.Table.Head,{className:"border-t border-solid border-gray-200 text-xs",children:(0,r.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:["Request Path Prefix",(0,r.jsx)(v.Tooltip,{text:"The prefix of the request path to sample or the entire request path",children:(0,r.jsx)(N.Information,{size:12,color:"gray-700"})})]})}),(0,r.jsx)(f.Table.Head,{className:"border-t border-r rounded-tr border-solid border-gray-200 text-xs"})]})}),(0,r.jsxs)(f.Table.Body,{className:"[&_td:first-child]:rounded-l-none [&_td:last-child]:rounded-r-none",children:[o.map((n,l)=>{let o=e(`sampling.${l}.env`);e(`sampling.${l}.rate`,{valueAsNumber:!0});let d=t(`sampling.${l}.rate`),u=Array.isArray(a.sampling)?a.sampling[l]?.rate?.message:void 0;return(0,r.jsxs)(f.Table.Row,{children:[(0,r.jsx)(f.Table.Cell,{className:"border-l border-b border-solid border-gray-200 rounded-none py-4 pl-4",children:(0,r.jsxs)(h.Select,{size:"small",ref:o.ref,name:o.name,value:t(`sampling.${l}.env`)??"all",onChange:e=>{s(`sampling.${l}.env`,e.target.value)},children:[(0,r.jsx)("option",{value:"all",children:"All Environments"}),(0,r.jsx)("option",{value:"production",children:"Production"}),(0,r.jsx)("option",{value:"preview",children:"Preview"})]})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-solid border-gray-200 rounded-none max-w-20 py-4",children:(0,r.jsx)(i.Input,{error:u,showErrorMessage:!1,className:"[&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",suffix:"%","aria-labelledby":`sampling-rate-${l}`,typeName:"number",min:"0",max:"100",step:"1",size:"small",defaultValue:"100",style:{width:"100px"},value:"number"==typeof d?`${100*d}`:d,onChange:e=>{let t=e.target.valueAsNumber;"number"!=typeof t||Number.isNaN(t)?s(`sampling.${l}.rate`,t,{shouldDirty:!0}):s(`sampling.${l}.rate`,t/100,{shouldDirty:!0})}})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-solid border-gray-200 rounded-none py-4",children:(0,r.jsx)(i.Input,{"aria-labelledby":`request-path-${l}`,placeholder:`/api/example-${l+1}`,...e(`sampling.${l}.requestPath`),size:"small"})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-r border-solid border-gray-200 rounded-none py-4",children:(0,r.jsx)(y.Button,{size:"small",type:"tertiary",onClick:()=>c(l),"aria-label":"Remove sampling config",children:(0,r.jsx)(b.Trash,{color:"gray-700",size:16})})})]},n.id)}),(0,r.jsx)(f.Table.Row,{children:(0,r.jsx)(f.Table.Cell,{colSpan:4,className:"border-b border-l border-r border-solid border-gray-200 !rounded-bl !rounded-br py-4 pl-4",children:(0,r.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:(0,r.jsx)(v.Tooltip,{text:"You can configure up to 5 sampling rules",disableTriggers:o.length<5,className:"",children:(0,r.jsx)(y.Button,{onClick:()=>d({type:"head_sampling",env:"all",rate:1}),size:"small",type:"tertiary",disabled:o.length>=5,typeName:"button",children:"Add Sampling Rule"})})})})})]})]}),l&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:l})]})]})}var S=e.i(4597921);let C=["lambda","edge","static","external","build","firewall","redirect"];function k(){let{watch:e,setValue:t,register:i,formState:{errors:a}}=(0,u.useFormContext)(),n=e("filter.source"),l=(0,p.useCallback)(e=>{n.includes(e)?t("filter.source",n.filter(t=>t!==e),{shouldDirty:!0}):t("filter.source",[...n,e],{shouldDirty:!0})},[n,t]);return(0,p.useEffect)(()=>{i("filter.source",{required:"required"})},[i]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(o.FormTitleDescription,{description:"Logs from the selected sources will be forwarded to your drain. At least one must be selected.",title:"Sources"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:C.map(e=>(0,r.jsx)(s.Checkbox,{className:"cursor-pointer rounded-md border border-gray-200 p-3 hover:border-gray-300",checked:n.includes(e),onChange:()=>l(e),children:d.sourceLabelMap[e]},e))}),(0,r.jsx)(z,{error:a.filter?.source?.message})]}),(0,r.jsx)(T,{})]})}function D(){return(0,r.jsx)(r.Fragment,{})}function I(){let{setValue:e,watch:t,register:i}=(0,u.useFormContext)(),s=t("sampling",[{type:"head_sampling",rate:1}]);return(0,p.useEffect)(()=>{i("sampling")},[]),(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,r.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Sampling"}),(0,r.jsxs)("span",{style:{minWidth:30,fontSize:"12px"},children:[Math.round((s?.[0]?.rate??1)*100),"%"]}),(0,r.jsx)("div",{style:{maxWidth:"200px",flex:1},children:(0,r.jsx)(a.Slider,{max:100,min:1,onValueChange:t=>{e("sampling",[{type:"head_sampling",rate:t[0]/100}],{shouldDirty:!0})},value:[Math.round((s?.[0]?.rate??1)*100)]})})]}),(0,r.jsx)("p",{className:"text-copy-14 text-gray-900",children:"A percentage of data matching the sampling rate will be sent to your drain from the selected environments."})]})}function T(){let{watch:e,setValue:t,formState:{errors:i}}=(0,u.useFormContext)(),a=e("filter.environment"),n=(e,r)=>{r?t("filter.environment",[...a,e],{shouldDirty:!0}):t("filter.environment",a.filter(t=>t!==e),{shouldDirty:!0})};return(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(o.FormTitleDescription,{description:"Select which environments to drain from.",title:"Environment"}),(0,r.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-6 flex-initial",children:[(0,r.jsx)(s.Checkbox,{checked:a.includes("production"),onChange:e=>{n("production",e.target.checked)},children:"Production"}),(0,r.jsx)(s.Checkbox,{checked:a.includes("preview"),onChange:e=>{n("preview",e.target.checked)},children:"Preview"})]}),(0,r.jsx)(z,{error:i.filter?.environment?.message})]})}function z(e){let{error:t}=e;return t?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:t})]}):null}e.s(["configureDrainStep",0,{title:"Configure the drain",component:function(){let{watch:e,setValue:t,register:s,clearErrors:a,formState:{errors:n}}=(0,u.useFormContext)(),o=e("drainType"),d="logs"===o||"traces"===o,g=(0,S.useServerFlag)("drains-advanced-sampling",!1)&&d,h=e("projects"),f=e("projectIds")||[],j=x();(0,p.useEffect)(()=>{s("projects",{required:"required"}),s("projectIds")},[]);let{data:y,isLoading:v}=(0,m.useProjects)(f.length>0?f:void 0),b=y||[],[N,C]=(0,p.useState)([]);return(0,r.jsx)("div",{className:"pt-4 max-w-2xl",children:(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,r.jsx)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial w-full",children:(0,r.jsx)(i.Input,{label:"Drain Name",id:"drain-name",placeholder:`My ${(0,c.getDrainTypeLabel)(o)} drain`,width:"100%",className:"flex-1",error:n.name?.message,...s("name")})}),(0,r.jsx)(l.ProjectSelector,{error:n.projects?.message||n.projectIds?.message,projects:b,projectType:"all"===h?l.ProjectTypes.ALL:l.ProjectTypes.SOME,onProjectsUpdated:e=>{t("projectIds",e.map(e=>e.id),{shouldDirty:!0}),a("projectIds"),C(e)},onProjectTypeUpdated:e=>{a("projectIds"),t("projects",e===l.ProjectTypes.ALL?"all":"some",{shouldDirty:!0}),e===l.ProjectTypes.ALL?(b.length>0&&C(b),t("projectIds",void 0,{shouldDirty:!0})):t("projectIds",(N.length>0?N:b).map(e=>e.id),{shouldDirty:!0})},title:"Projects",description:"Choose which projects should send data to the specified endpoint.",disabled:!1,isLoading:v&&0===b.length,loadingCount:f.length,comboboxListContainer:j}),"logs"===o&&(0,r.jsx)(k,{}),"traces"===o&&(0,r.jsx)(D,{}),g?(0,r.jsx)(w,{}):(0,r.jsx)(I,{})]})})},getFieldsToValidate:()=>["name","projects","projectIds","filter.source","filter.environment","sampling"],getIsNextEnabled:()=>!0}],3614887);var $=e.i(4201247),E=e.i(9844152),_=e.i(9334091),P=e.i(1906681),M=e.i(2455417),F=e.i(8735244),A=e.i(6607601),L=e.i(8225664),O=e.i(198667),R=e.i(6318858),B=e.i(4819890),U=e.i(1933683),q=e.i(3973638);let V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",H=(t=(e,t)=>{if(e<0||e>65536)throw RangeError('The value of "size" is out of range. It must be >= 0 && <= 65536. Received '+e);var r=new Uint8Array(e);return(globalThis.crypto.getRandomValues(r),t)?(setTimeout(()=>t(null,r),0),new Uint8Array):r},e=>new Promise(async(r,i)=>{Number.isInteger(e)?e<=0?i(Error("You must supply a length integer greater than zero")):t(e,(e,s)=>{let a;if(e)return i(e);let n=[];for(let e=0;e<s.length;e++){for(a=s[e];a>248;)try{a=t(1)[0]}catch(e){i(e)}n.push(V[a%V.length])}r(n.join(""))}):i(TypeError("You must supply a length integer to `uid-promise`."))}));async function W(e){return H(e)}e.s(["generateSecret",()=>W],8249103);var G=e.i(6461317),Y=e.i(7133058),K=e.i(277234),J=e.i(5338940);function X(e){return e.schemas?.log?"logs":e.schemas?.trace?"traces":e.schemas?.analytics?"analytics":e.schemas?.speed_insights?"speed_insights":"logs"}function Z(e){if(!e)throw Error("Drain type is required");switch(e){case"logs":return{log:{version:"v1"}};case"traces":return{trace:{version:"v1"}};case"analytics":return{analytics:{version:"v1"}};case"speed_insights":return{speed_insights:{version:"v1"}}}}e.s(["getDrainTypeFromDrain",()=>X,"getSchemaForDrainType",()=>Z],3456281);let[Q,ee]=(0,Y.default)(function(){let{team:e}=(0,J.useTeam)(),[t,r]=(0,p.useState)({status:"idle"});return{validationState:t,validateEndpoint:async t=>{r({status:"validating"});try{let{delivery:i,drainType:s}=t,a=Z(s),n={type:i?.type||"http",endpoint:i?.endpoint||"",encoding:i?.encoding||"json",headers:i?.headers||{},...i?.secret&&{secret:i.secret}},l=await (0,K.fetchAPI)(`/v1/drains/test${e?.id?`?teamId=${e.id}`:""}`,{method:"POST",body:{schemas:a,delivery:n},returnStatus:!0,throwOnHTTPError:!1});if(l.status&&l.status>=200&&l.status<300&&l.body){let{status:e,statusCode:t}=l.body;if(e){if("success"===e)return r({status:"success",message:"Success: Your endpoint sent a 2xx status"}),!0;if("failure"===e){if(t)return r({status:"error",message:`Error: Your endpoint sent a ${t} status instead of 2xx, fix it and try again`}),!1;return r({status:"error",message:"Error: Your endpoint did not reply, fix it and try again"}),!1}}}return r({status:"error",message:"Unknown error, please contact support"}),!1}catch(e){return r({status:"error",message:"Unknown error, please contact support"}),!1}},resetValidation:()=>{r({status:"idle"})}}});function et(e){let{icon:t,onClick:i,successDuration:s=1e3,...a}=e,[n,l]=(0,p.useState)(!1),[o,d]=(0,p.useState)(!0),c=(0,p.useRef)(null),u=async()=>{d(!1),c.current&&clearTimeout(c.current),await i(),l(!0),c.current=setTimeout(()=>{l(!1)},s)};return(0,r.jsx)(y.Button,{...a,onClick:u,children:(0,r.jsxs)("div",{style:{position:"relative",height:16,width:16},children:[(0,r.jsx)("div",{className:`absolute inset-0 transition-all duration-150 ease-out ${o?"opacity-0 scale-50":!o&&n?"opacity-100 scale-100":"opacity-0 scale-50"}`,children:(0,r.jsx)(R.Check,{size:16})}),(0,r.jsx)("div",{className:`absolute inset-0 transition-all duration-150 ease-out ${o||!o&&!n?"opacity-100 scale-100":"opacity-0 scale-50"}`,children:t})]})})}function er(){let e,t,s,{watch:a,setValue:l,register:o,setError:c,clearErrors:m,formState:{errors:g}}=(0,u.useFormContext)(),{validationState:x,validateEndpoint:f,resetValidation:j}=ee();(0,p.useEffect)(()=>()=>{m(),j()},[]);let b=a("delivery.headers"),N=a("delivery.type"),w=a("delivery.endpoint"),S=a("drainType"),[C,k]=(0,p.useState)(es.input(b||{})),[D,I]=(0,p.useState)(C.length>0),[T,z]=(0,p.useState)(!1),V=a("delivery.secret");return"string"==typeof w?(e="https://your-endpoint.com/ingest",t="delivery.endpoint"):(e="https://your-otlp-endpoint.com/v1/traces",t="delivery.endpoint.traces"),(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial pt-4 max-w-2xl",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-[3fr_1fr] md:gap-2 md:items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)(i.Input,{id:"drain-url",label:"URL",prefix:"POST",placeholder:e,width:"100%",...o(t,{onChange:()=>{j(),m(t)}})}),(0,r.jsx)(v.Tooltip,{desktopOnly:!0,text:"Send an example payload to your endpoint for testing",children:(0,r.jsx)(y.Button,{"aria-label":"Test endpoint",type:"secondary",typeName:"button",disabled:!(s="string"==typeof w?w:w?.traces)||!d.httpUrl.safeParse(s).success||x?.status==="validating",svgOnly:!0,onClick:()=>{f(a())},prefix:x?.status==="validating"?(0,r.jsx)(F.Spinner,{size:16}):(0,r.jsx)(B.PlayCircle,{size:16}),children:"Test"})})]}),(0,G.default)(g,`${t}.message`)&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:(0,G.default)(g,`${t}.message`)})]}),x&&"idle"!==x.status&&(0,r.jsx)("div",{className:"mt-2 flex items-center gap-2",children:"validating"===x.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.LoadingDots,{}),(0,r.jsx)("p",{className:"text-copy-13 text-gray-900",children:"Validating endpoint"})]}):(0,r.jsxs)(r.Fragment,{children:["success"===x.status?(0,r.jsx)(R.Check,{size:14,color:"green-700"}):(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:`text-copy-13 ${"success"===x.status?"text-green-900":"text-red-900"}`,children:x.message})]})})]}),(0,r.jsx)(h.Select,{label:"Encoding",placeholder:"Select encoding",...o("delivery.encoding"),children:ei[N].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),S&&(0,r.jsxs)("div",{className:"text-xs text-gray-900 text-right md:text-right sm:text-left",children:["Need help with the data format?"," ",(0,r.jsxs)("a",{href:{logs:"/docs/drains/reference/logs",traces:"/docs/drains/reference/traces",speed_insights:"/docs/drains/reference/speed-insights",analytics:"/docs/drains/reference/analytics"}[S],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:["View"," ","speed_insights"===S?"Speed Insights":"analytics"===S?"Analytics":S.charAt(0).toUpperCase()+S.slice(1)," ","schema â†’"]})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)(i.Input,{label:(0,r.jsxs)(r.Fragment,{children:["Signature verification secret"," ",(0,r.jsxs)("span",{className:"text-gray-900 normal-case",children:["(optional,"," ",(0,r.jsx)("a",{href:"/docs/drains/security",target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 hover:text-gray-700 underline",children:"How to use it"})]}),")"]}),id:"drain-secret",placeholder:"32-character secret",width:"100%",className:"font-mono tracking-wider",typeName:T?"text":"password",prefix:(0,r.jsx)(y.Button,{"aria-label":"Toggle password visibility",variant:"unstyled",svgOnly:!0,typeName:"button",onClick:()=>z(!T),className:"-ml-1",children:T?(0,r.jsx)(q.EyeOff,{size:16}):(0,r.jsx)(U.Eye,{size:16})}),prefixStyling:!1,suffix:(0,r.jsx)(L.CopyButton,{textToCopy:V||"",label:"Copy secret",title:"Copy secret to clipboard",disabled:!V,variant:"unstyled",className:"-mr-1"}),suffixStyling:!1,...o("delivery.secret")}),(0,r.jsx)(et,{"aria-label":"Generate new secret",shape:"square",svgOnly:!0,type:"secondary",typeName:"button",icon:(0,r.jsx)(O.RefreshClockwise,{size:16}),onClick:async()=>{l("delivery.secret",await W(32),{shouldDirty:!0})}})]})}),(0,r.jsx)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:(0,r.jsx)(P.Toggle,{checked:D,id:"custom-headers",onChange:I,size:"medium",direction:"switch-first",children:(0,r.jsx)("p",{className:"text-copy-14",children:"Custom Headers"})})}),(0,r.jsx)(E.AnimatePresence,{initial:!1,children:D&&(0,r.jsx)($.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut",opacity:{duration:.2}},children:(0,r.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(_.Textarea,{error:(0,G.default)(g,"delivery.headers.message"),"aria-labelledby":"Custom Headers (Optional)",className:"font-mono",onBlur:()=>{l("delivery.headers",es.output(C,c,m),{shouldDirty:!0})},onChange:e=>k(e.target.value),placeholder:"Authorization: Bearer token X-Custom-Header: value",rows:3,value:C}),(0,r.jsxs)("p",{className:"text-copy-13 text-gray-900",children:["Format: Header-Name: Header-Value (one per line). The"," ",(0,r.jsx)(A.InlineCode,{children:"content-type"})," header is automatically added."]})]})})})})]})}e.s(["EndpointValidationProvider",()=>Q,"useEndpointValidationContext",()=>ee],4789955);let ei={http:[{value:"json",label:"JSON"},{value:"ndjson",label:"NDJSON"}],otlphttp:[{value:"json",label:"JSON"},{value:"proto",label:"Protobuf"}]},es={input:e=>e?Object.entries(e).map(e=>{let[t,r]=e;return`${t}: ${r}`}).join("\n"):"",output(e,t,r){if(!e)return{};let i=e.split("\n").filter(e=>e.trim()),s=[],a=i.reduce((e,t,r)=>{let[i,...a]=t.split(":"),n=a.join(":"),l=ea(i?.trim()||""),o=ea(n?.trim()||"");return l&&o?e[l]=o:s.push(`Line ${r+1}: "${t}"`),e},{});return s.length>0?t("delivery.headers",{message:`Invalid header format: ${s.join(", ")}. Expected format: "Header-Name: Header-Value"`}):r("delivery.headers"),a}};function ea(e){return e?e.replace(/""+/g,'"').replace(/''+/g,"'").replace(/^["']+|["']+$/g,""):e}e.s(["CustomEndpointEditor",()=>er],5664328)},4576858,3226981,4758962,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(4237893),s=e.i(6064230),a=e.i(762896),n=e.i(4597921),l=e.i(5486173),o=e.i(5664328);e.i(6887680);var d=e.i(6810699);e.i(553769);var c=e.i(3758860),u=e.i(9957872),p=e.i(4245131),m=e.i(8161149),g=e.i(5255926),x=e.i(5468328);e.i(8703064);var h=e.i(648779),f=e.i(4325157),j=e.i(1017032),y=e.i(9668517),v=e.i(3584802),b=e.i(109803),N=e.i(57106);function w(e){let{drainType:i}=e,s=(0,y.useTeamSlug)(),a="logs"===i?"logDrain":"traceDrain",{data:n,isLoading:l}=(0,f.useMarketplaceIntegrations)({protocolType:a}),{data:o,isLoading:u}=(0,d.useResourceList)({protocolType:a}),{data:m,isLoading:x}=(0,j.useConfigurations)({type:"marketplace",skipBillingData:!0,skip:!1}),w=(0,r.useMemo)(()=>{if(!n||!o||!m)return[];let e=[];for(let t of n)for(let r of t.products)(0,c.isProtocolSupported)(r,a)&&e.push({product:r,integration:t});return e},[n,o,m,a]);return l||u||x?(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Available products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[1,2].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border border-gray-alpha-400 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsx)(g.Skeleton,{width:36,height:36,rounded:!0}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(g.Skeleton,{width:"80%",height:14,className:"mb-2"}),(0,t.jsx)(g.Skeleton,{width:"60%",height:12})]})]}),(0,t.jsx)(g.Skeleton,{width:60,height:32})]},e))})}):0!==w.length&&s?(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Available products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:w.map(e=>{let{product:r,integration:i}=e,a=(0,v.getIntegrationCheckoutUrl)({params:{integrationSlug:i.slug,teamSlug:s},searchParams:{productSlug:r.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}});return(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border border-gray-alpha-400 rounded-lg hover:border-gray-600 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(h.ProductIcon,{icon:r.iconUrl,size:"large"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium truncate",title:r.name,children:r.name}),(0,t.jsx)("div",{className:"text-sm text-gray-600 truncate",title:i.name,children:i.name})]})]}),(0,t.jsx)(N.ButtonLink,{size:"small",type:"secondary",href:a,target:"_blank",rel:"noopener noreferrer",suffix:(0,t.jsx)(b.External,{}),children:"Install"})]},r.id)})})}):null}function S(){let{watch:e,setValue:i}=(0,l.useFormContext)(),s=e("source"),a=e("drainType"),n=s&&"resourceId"in s?s.resourceId??"":"",{data:o,isLoading:f}=(0,d.useResourceList)({protocolType:"traceDrain"}),{data:j,isLoading:y}=(0,d.useResourceList)({protocolType:"logDrain"}),v=(0,r.useMemo)(()=>{let e=[];return"traces"===a&&o?.stores?e.push(...o.stores.filter(e=>(0,c.isProtocolSupported)(e.product,"traceDrain"))):"logs"===a&&j?.stores&&e.push(...j.stores.filter(e=>(0,c.isProtocolSupported)(e.product,"logDrain"))),e},[o,j,a]);if(f||y)return(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Installed products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 border border-gray-alpha-400 rounded-lg",children:[(0,t.jsx)(g.Skeleton,{width:40,height:40,rounded:!0}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(g.Skeleton,{width:"80%",height:14,className:"mb-2"}),(0,t.jsx)(g.Skeleton,{width:"60%",height:12})]})]},e))})});let b="logs"===a||"traces"===a;return 0===v.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.EmptyState.Root,{title:"No Integrations Installed",description:"Add an integration that supports drains to get started."}),b&&(0,t.jsx)("div",{className:"flex flex-col gap-6 mt-6",children:(0,t.jsx)(w,{drainType:a})})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Installed products"}),content:(0,t.jsx)(u.ChoiceboxGroup,{type:"radio",label:"Select resource",direction:"row",value:n,onChange:e=>{i("source",{kind:"integration",resourceId:e})},className:"[&>ul]:grid [&>ul]:grid-cols-2 [&>ul]:gap-3 [&_label>div>span:first-child]:overflow-hidden [&_label>div>span:first-child>span]:overflow-hidden",children:v.map(e=>(0,t.jsx)(u.ChoiceboxGroup.Item,{value:e.id,title:(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(h.ProductIcon,{icon:e.product.iconUrl,size:"large"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 overflow-hidden",children:[(0,t.jsx)(x.Tooltip,{text:e.name,className:"block truncate",children:(0,t.jsx)("span",{className:"truncate text-sm font-medium block",children:e.name})}),(0,t.jsxs)("div",{className:"truncate text-sm text-gray-600",title:`${e.product.name}${e.billingPlan?.name?` - ${e.billingPlan.name}`:""}`,children:[e.product.name,e.billingPlan?.name?` - ${e.billingPlan.name}`:""]})]})]})},e.id))})}),b&&(0,t.jsx)(w,{drainType:a})]})}var C=e.i(7609806),k=e.i(1282571);function D(e){let{protocolType:r,limit:i=3,size:s=20}=e,{data:a,isLoading:n,error:l}=(0,f.useMarketplaceIntegrations)({protocolType:r});if(n||l||!a||0===a.length)return null;let o=a.map(e=>({uid:e.id,component:(0,t.jsx)(k.MarketplaceIntegrationCardIcon,{icon:e.icon,name:e.name,size:s})}));return(0,t.jsx)(C.AvatarGroup,{members:o,size:s,limit:i})}function I(e,r){if(r)return null;let i="logs"===e?"logDrain":"traces"===e?"traceDrain":null;return i?(0,t.jsx)(D,{protocolType:i}):null}e.s(["configureDestinationStep",0,{title:"Configure the destination",component:function(){let e=(0,n.useServerFlag)("enable-marketplace-drains",!1),{watch:d,setValue:c}=(0,l.useFormContext)(),u=d("source"),p=d("mode"),m=d("drainType"),g=(0,r.useMemo)(()=>u?.kind==="integration"?"native-integrations":"custom",[u]),x=I(m,!1);return e&&("update"!==p||u?.kind==="integration")&&("logs"===m||"traces"===m)?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial pt-4 max-w-2xl",children:[(0,t.jsx)(i.Tabs,{selected:g,setSelected:e=>{"native-integrations"===e?c("source",{...u,kind:"integration"}):c("source",{...u,kind:"self-served"})},tabs:[{title:"Custom Endpoint",value:"custom",icon:(0,t.jsx)(s.Terminal,{size:16})},{title:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:["Native Integrations",x]}),value:"native-integrations",icon:(0,t.jsx)(a.LogoVercelFill,{size:16})}]}),"custom"===g?(0,t.jsx)(o.CustomEndpointEditor,{}):(0,t.jsx)(S,{})]}):(0,t.jsx)(o.CustomEndpointEditor,{})},getFieldsToValidate:e=>e.source?.kind==="integration"?["source","source.resourceId"]:["delivery.endpoint","delivery.encoding","delivery.headers","source"],getIsNextEnabled:e=>e.source?.kind!=="integration"||!!("resourceId"in e.source&&e.source.resourceId),getSuffix:I}],4576858);var T=e.i(9722978),z=e.i(2504781),$=e.i(4030453);function E(e){let{children:r,onNext:i,onBack:s,isFirstStep:a=!1,isLastStep:n=!1,nextLabel:l="Next",isLoading:o=!1,isNextDisabled:d=!1,error:c}=e;return(0,t.jsxs)(t.Fragment,{children:[r,(0,t.jsxs)("div",{className:`flex flex-row items-stretch justify-start gap-2 flex-initial ${(0,T.default)(!n&&"pb-6")}`,children:[!a&&(0,t.jsx)(z.Button,{onClick:s,type:"secondary",typeName:"button",children:"Back"}),i&&(0,t.jsx)(z.Button,{loading:o,disabled:d,onClick:i,typeName:"button",children:l})]}),c&&n&&(0,t.jsx)($.Error,{children:c})]})}e.s(["StepWrapper",()=>E],3226981);var _=e.i(6636464),P=e.i(9979783),M=e.i(5338940),F=e.i(1021293),A=e.i(6060673);function L(e,t){let{team:r}=(0,M.useTeam)(),{data:i}=(0,A.useProject)(t),s=(0,F.getDrainsKey)(e,t),{trigger:a,isMutating:n}=(0,_.default)(s,async(e,t)=>{let{arg:s}=t;if(!r?.id)throw Error("Team ID is required");let a={teamId:r.id,...i&&{projectId:i.id}};return(await (0,P.typedFetch)("/v1/drains","post",a,s,{throwOnHTTPError:!0})).body},{throwOnError:!0});return{createDrain:a,isCreating:n}}e.s(["useCreateDrain",()=>L],4758962)},8404074,e=>{"use strict";var t=e.i(6636464),r=e.i(9429645),i=e.i(9979783),s=e.i(5338940),a=e.i(1021293);function n(e,n){let{team:o}=(0,s.useTeam)(),d=(0,a.getDrainsKey)(e,n),{trigger:c,isMutating:u,error:p}=(0,t.default)(d,async(e,t)=>{let{arg:s}=t;if(!o?.id)throw Error("Team ID is required");let{id:a,...n}=s;(0,r.mutate)(d,e=>{if(e)return{...e,drains:e.drains.map(e=>e.id===a?{...e,...l(n)}:e)}},!1);try{let e=await (0,i.typedFetch)("/v1/drains/{id}","patch",{id:a,teamId:o.id},n,{throwOnHTTPError:!0});if((0,r.mutate)(d),200!==e.status)throw console.error("Failed to update drain:",e.body),Error("Failed to update drain");return e.body}catch(e){throw console.error("Failed to update drain:",e),(0,r.mutate)(d),e}},{throwOnError:!0});return{updateDrain:c,isUpdating:u,error:p}}let l=e=>{let t={};for(let[r,i]of Object.entries(e))t[r]=null===i?void 0:i;return t};e.s(["useUpdateDrain",()=>n])},223073,5905545,e=>{"use strict";var t=e.i(6696646),r=e.i(2199694),i=e.i(4758962),s=e.i(8404074),a=e.i(3456281),n=e.i(5744676),l=e.i(6092370);function o(e){let{drainType:t,filter:r}=e,i={};return r&&("logs"===t&&r.source&&r.source.length>0&&(i["log/source"]=r.source),r.environment&&r.environment.length>0&&(i["deployment/environment"]=r.environment)),(0,l.serializeObjectFilter)(i)}var d=e.i(8631221),c=e.i(3196486),u=e.i(7917902),p=e.i(9429645),m=e.i(1021293),g=e.i(3573347);function x(e){let{teamSlug:l,projectIdOrSlug:x,drainId:h,isLegacyDrain:f,onSuccess:j,onError:y,onDrainCreated:v}=e,{team:b,user:N}=(0,u.useAccount)(),{createDrain:w,isCreating:S}=(0,i.useCreateDrain)(l,x),{updateDrain:C,isUpdating:k}=(0,s.useUpdateDrain)(l,x),{updateLogDrain:D}=(0,g.useLogDrainsOperations)({teamSlug:l});return{handleSubmit:(0,t.useCallback)(async e=>{try{if((0,r.isCreateFlow)(e)){let t={name:e.name.trim(),projects:e.projects,projectIds:e.projectIds,...e.delivery&&{delivery:e.delivery},sampling:e.sampling,schemas:(0,a.getSchemaForDrainType)(e.drainType),filter:o({drainType:e.drainType,filter:e.filter}),...e.source&&{source:e.source}},r=await w(t);v?.(e,r)}else if((0,r.isUpdateFlow)(e)){if(!h)throw Error("Drain ID is required for update mode");if(f){let t,r,i=(t=e.filter?.source||[],r=e.filter?.environment||["production","preview"],{id:h,name:e.name?.trim()||"",sources:t,deliveryFormat:e.delivery?.encoding==="ndjson"?n.DeliveryFormats.NDJSON:n.DeliveryFormats.JSON,url:"string"==typeof e.delivery?.endpoint?e.delivery?.endpoint:"",headers:e.delivery?.headers||{},environments:r,projectIds:e.projectIds,samplingRate:e.sampling?.[0]?.rate});await D(i);let s=(0,m.getLegacyLogDrainsKey)(l,x);(0,p.mutate)(s)}else{let t={id:h,...void 0!==e.name&&{name:e.name.trim()},...void 0!==e.status&&{status:e.status},...void 0!==e.delivery&&{delivery:e.delivery},...void 0!==e.sampling&&{sampling:e.sampling},...void 0!==e.filter&&{filter:o({drainType:e.drainType,filter:e.filter})},...(void 0!==e.projectIds||void 0!==e.projects)&&{projectIds:e.projectIds,projects:e.projects}};await C(t)}e.status&&(0,c.sendToSnowflake)(d.Topic.VercelAppV0LogDrainToggle,{event_time:Date.now(),user_id:null!==N?N.uid:"",team_id:null!==b?b.id:"",log_drain_id:h,enabled:"enabled"===e.status},"vercel-app")}j?.()}catch(e){y?.(e)}},[w,C,D,h,f,l,x,j,y,b,N,v]),isLoading:S||k}}e.s(["useDrainSubmit",()=>x],223073);let h={"log/source":[],"deployment/environment":[]};function f(e,t){if(!e)return t.reduce((e,t)=>(e[t]=h[t],e),{});try{let r=(0,l.parseNormalFilter)(e);return t.reduce((e,t)=>(e[t]=function e(t,r){if(!t)return[];if("and"in t)return t.and.flatMap(t=>e(t,r));if("or"in t)return t.or.flatMap(t=>e(t,r));if(t.subject===r){if("in"===t.operator&&Array.isArray(t.values))return t.values.map(String);if("eq"===t.operator&&void 0!==t.value)return[String(t.value)]}return[]}(r,t)||h[t],e),{})}catch(e){console.error("Failed to parse filter:",e)}return t.reduce((e,t)=>(e[t]=h[t],e),{})}e.s(["parseDrainFilter",()=>f],5905545)},7983333,e=>{"use strict";function t(e){return e.id.startsWith("ld_")}e.s(["isLegacyLogDrain",()=>t])},3199886,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(2504781),s=e.i(455575),a=e.i(5806401),n=e.i(6942035),l=e.i(6318858),o=e.i(109803),d=e.i(5486173),c=e.i(1971505),u=e.i(6143247),p=e.i(4597921),m=e.i(2199694),g=e.i(7662235),x=e.i(3614887),h=e.i(4576858),f=e.i(3226981),j=e.i(223073),y=e.i(4789955),v=e.i(8249103),b=e.i(1094129),N=e.i(3456281),w=e.i(5905545),S=e.i(7983333),C=e.i(9572009),k=e.i(4110479);e.i(8703064);var D=e.i(648779);function I(e){let{drain:i,active:s,onClose:n,teamSlug:l,projectIdOrSlug:o,onDrainCreated:d,onDrainUpdated:c,onOpenExternalModal:p,drainType:m,defaultProjectId:g}=e,x=(0,r.useRef)(null);return(0,t.jsx)(a.Sheet,{open:s,onOpenChange:e=>!e&&n(),children:(0,t.jsx)(a.SheetContent,{ref:x,className:(0,u.cn)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-y-auto rounded-[1rem] bg-white p-0 pb-6 lg:w-3/4 sm:max-w-[800px]"),side:"right",children:(0,t.jsx)(C.SheetContainerContext.Provider,{value:x.current,children:(0,t.jsx)(y.EndpointValidationProvider,{children:(0,t.jsx)(T,{drain:i,onClose:n,teamSlug:l,projectIdOrSlug:o,onDrainCreated:d,onDrainUpdated:c,onOpenExternalModal:p,drainType:m,defaultProjectId:g})})})})})}function T(e){let{drain:l,onClose:C,teamSlug:I,projectIdOrSlug:T,onDrainCreated:$,onDrainUpdated:E,onOpenExternalModal:_,drainType:P,defaultProjectId:M}=e,F=l?"update":"create",A=(0,s.useToasts)(),L=P?2:1,[O,R]=(0,r.useState)(L),{validateEndpoint:B}=(0,y.useEndpointValidationContext)(),U=(0,p.useServerFlag)("enable-marketplace-drains",!1),q=(0,k.useOptionalDrainModalContext)(),V=q?.resource,H=(0,d.useForm)({resolver:(0,c.zodResolver)(b.DrainFormSchema),defaultValues:async()=>"update"===F&&l?((e,t)=>{if((0,S.isLegacyLogDrain)(e)){let r,i,s,a,n,l;return r={static:"static",lambda:"lambda",build:"build",edge:"edge",external:"external",firewall:"firewall"},i=(e.sources||[]).map(e=>r[e]||e),s=e.samplingRate?[{type:"head_sampling",rate:e.samplingRate}]:[],a=e.projectIds&&e.projectIds.length>0||!!e.projectId,n=e.projectIds?.length?e.projectIds:e.projectId&&null!==e.projectId?[e.projectId]:[],l={type:"http",endpoint:e.url,encoding:({json:"json",ndjson:"ndjson"})[e.deliveryFormat]||"json",headers:e.headers||{},...e.secret&&{secret:e.secret}},{mode:"update",name:e.name??"",projects:a?"some":"all",projectIds:n,drainType:"logs",filter:{source:i,environment:e.environments||["production","preview"]},delivery:l,sampling:s,source:t?{kind:"integration",resourceId:t}:{kind:"self-served"}}}let{"log/source":r,"deployment/environment":i}=(0,w.parseDrainFilter)(e.filter,["log/source","deployment/environment"]),s=(0,N.getDrainTypeFromDrain)(e);return{mode:"update",name:e.name??"",projects:e.projectIds?"some":"all",projectIds:e.projectIds,drainType:s,filter:{source:r,environment:i},delivery:e.delivery,sampling:e.sampling,...e.source&&{source:e.source}}})(l,V?.id):(e=>{let{secret:t,resourceId:r,drainType:i,projectId:s}=e;return{mode:"create",name:"",...s?{projectIds:[s],projects:"some"}:{projects:"all",projectIds:[]},drainType:i,filter:{source:[],environment:[]},delivery:r?void 0:{type:"http",endpoint:"",encoding:"json",secret:t,headers:{},compression:void 0},sampling:[],source:r?{kind:"integration",resourceId:r}:{kind:"self-served"}}})({secret:await (0,v.generateSecret)(32),resourceId:V?.id,drainType:P,projectId:M})}),W=(0,r.useCallback)(()=>{C(),H.reset(),R(L)},[C,H,L]),{handleSubmit:G,isLoading:Y}=(0,j.useDrainSubmit)({teamSlug:I,projectIdOrSlug:T,drainId:l?.id,isLegacyDrain:!!l&&(0,S.isLegacyLogDrain)(l),onSuccess:async()=>{"update"===F&&await E?.(),W(),A.success({text:`Drain ${"create"===F?"created":"updated"} successfully.`,key:`${"create"===F?"add":"edit"}-drain`})},onError:e=>{console.error(e),H.setError("root.serverError",{message:e.message}),A.error({text:`Failed to ${F} drain`})},onDrainCreated:e=>{$?.({drainType:e.drainType,kind:e.source?.kind==="integration"?`integration${"externalResourceId"in e.source?"-external":""}`:e.source?.kind})}}),K=(0,r.useCallback)(async e=>{if(H.clearErrors(),(0,m.isCreateFlow)(e))await G(e);else if(H.formState.isDirty&&Object.keys(H.formState.dirtyFields).length>0)if(l&&(0,S.isLegacyLogDrain)(l))await G({...e,mode:"update"});else{var t;let r,i=(t=H.formState.dirtyFields,r=Object.keys(t).reduce((r,i)=>t[i]?{...r,[i]:e[i]}:r,{}),("projectIds"in e||"projects"in e)&&(r.projectIds=e.projectIds,r.projects=e.projects),r);await G({...i,mode:"update",drainType:e.drainType})}else W(),A.success({text:"No changes to save.",key:"edit-drain"})},[G,H.formState.isDirty,H.formState.dirtyFields,A,W,H.clearErrors,$,l]),J=(0,r.useMemo)(()=>{let e=[g.chooseDrainDataStep,x.configureDrainStep,h.configureDestinationStep],t=[x.configureDrainStep,h.configureDestinationStep];return V&&(e=[g.chooseDrainDataStep,x.configureDrainStep],t=[x.configureDrainStep]),("update"===F?t:e).map((e,t)=>({...e,id:t+1,number:t+1,isComplete:t+1<O,isActive:O===t+1,disabled:t+1>O}))},[F,O,V]),X=J.length,Z=J.find(e=>e.id===O),Q=async()=>{let e=H.getValues(),t=Z?.getFieldsToValidate(e);if(!t)return;let r=await H.trigger(t),i=e.source?.kind==="self-served";if(r&&Z?.component===h.configureDestinationStep.component)if(i){if(H.setValue("source",{kind:"self-served"}),!await B(e)){let t="string"==typeof e.delivery?.endpoint?"delivery.endpoint":"delivery.endpoint.traces";H.setError(t,{message:""});return}}else H.setValue("delivery",void 0);r&&(O===X?H.handleSubmit(K,e=>{console.error("[DrainModal] RHF validation failed with errors:",e)})():O<X&&R(O+1))},ee=()=>{O>1&&(H.clearErrors(),R(O-1))};return(0,t.jsxs)("main",{className:"flex h-full shrink-0 grow-0 flex-col",children:[(0,t.jsx)("header",{className:"sticky top-0 z-50 bg-background-100 pt-7",children:(0,t.jsxs)("section",{className:"flex items-center justify-start gap-4 px-8",children:[(0,t.jsxs)(a.SheetTitle,{className:"text-heading-24 flex items-center gap-4",children:[(0,t.jsxs)("span",{children:["create"===F?"Add":"Edit"," Drain"]}),V&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,t.jsx)(D.ProductIcon,{icon:V.product.iconUrl,size:"medium"}),(0,t.jsx)("span",{children:V.name})]})]}),(0,t.jsx)(a.SheetDescription,{className:"sr-only",children:"Configure a drain to send your data to external services"}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:["create"===F&&!V&&U&&_&&(0,t.jsx)(i.Button,{type:"tertiary",size:"small",onClick:_,suffix:(0,t.jsx)(o.External,{}),className:"!text-gray-600 hover:!text-gray-900",children:"External Integrations"}),(0,t.jsx)(i.Button,{svgOnly:!0,"aria-label":"close modal",shape:"circle",size:"tiny",onClick:W,className:"!border-0 !bg-transparent",children:(0,t.jsx)(n.Cross,{color:"gray-1000"})})]})]})}),(0,t.jsx)("div",{className:"px-8 pb-4 pt-6",children:(0,t.jsx)("div",{className:"space-y-1",children:(0,t.jsx)(d.FormProvider,{...H,children:(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault(),Q()},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Q())},children:J.map(e=>{let r=e.getSuffix?.(H.watch("drainType"),e.isActive);return(0,t.jsxs)("div",{children:[(0,t.jsx)(z,{step:e,onClick:()=>{var t;(t=e.number)>O||(H.clearErrors(),R(t))},suffix:r}),e.isActive&&(0,t.jsx)("div",{className:`flex flex-col items-stretch justify-start gap-6 flex-initial ${(0,u.cn)("pl-6 ml-[1.6rem] -mt-1 -mb-1",e.number!==X&&"border-gray-400 border-dashed border-l")}`,children:(()=>{var e,r,i;if(!Z)return null;let s=Z.component,a=Z.getIsNextEnabled(H.getValues());return(0,t.jsx)(f.StepWrapper,{error:H.formState.errors.root?.serverError?.message,isLoading:Y,onNext:Q,onBack:ee,isFirstStep:1===O,isLastStep:O===X,nextLabel:(e=O,r=X,i=F,e===r?"create"===i?"Create Drain":"Update Drain":"Next"),isNextDisabled:!a,children:(0,t.jsx)(s,{})})})()})]},e.number)})})})})})]})}function z(e){let{step:r,onClick:i,suffix:s}=e;return(0,t.jsxs)("div",{className:(0,u.cn)("flex items-center gap-3 px-3 py-3 cursor-pointer transition-colors",{"hover:bg-gray-50":!r.disabled&&!r.isActive,"opacity-80 cursor-not-allowed":r.disabled&&r.isNext,"opacity-50 cursor-not-allowed":r.disabled&&!r.isNext,"hover:bg-success-100":r.isComplete&&!r.isActive}),onClick:i,title:r.isComplete&&!r.isActive?"Click to return to this step":void 0,children:[(0,t.jsx)("div",{className:(0,u.cn)("flex size-7 items-center justify-center rounded-full text-sm font-medium border",{"bg-success text-black border-success":r.isComplete,"bg-black text-white border-black":!r.isComplete&&r.isActive,"bg-white text-gray-900 border-gray-500":!r.isComplete&&!r.isActive}),children:r.isComplete?(0,t.jsx)(l.Check,{size:14}):r.number}),(0,t.jsx)("p",{className:(0,u.cn)("text-[16px] leading-[24px]",r.isActive&&"font-medium"),children:r.title}),s]})}e.s(["DrainModal",()=>I],3199886)},5765731,e=>{"use strict";var t=e.i(2704354),r=e.i(9668517),i=e.i(3911483);function s(){let e=(0,r.useTeamSlug)();return(0,i.default)(e?(0,t.getMarketplaceIntegrationsApiUrl)({integrationType:"external",teamIdOrSlug:e}):null,e=>fetch(e).then(e=>e.json()))}e.s(["useConnectableIntegrations",()=>s])},6269556,e=>{"use strict";var t=e.i(9100551),r=e.i(6696646),i=e.i(4011256);function s(){let e=(0,t.useSearchParams)(),s=(0,t.useParams)(),a=e?.get("category")??null,n=e?.get("search")??null,l=!!e?.get("expanded"),o=!!e?.get("isPreview"),d=(0,r.useMemo)(()=>s?.teamSlug?{teamSlug:s.teamSlug.toString(),isPublic:!1}:{isPublic:!0,teamSlug:void 0},[s?.teamSlug]);return{categorySlug:a,isRootCategory:!a||!!l,searchQuery:n,expanded:l,teamSlugOrPublic:d,isPreview:!!o,getBrowseMarketplaceLink:e=>(0,i.getBrowseMarketplaceLink)({teamSlugOrPublic:d,...e})}}e.s(["useMarketplaceNavigation",()=>s])},6315360,e=>{e.v({bradcrumbsWrapper:"details-layout-module__xg7Djq__bradcrumbsWrapper",breadcrumbsText:"details-layout-module__xg7Djq__breadcrumbsText",cta:"details-layout-module__xg7Djq__cta",header:"details-layout-module__xg7Djq__header",marketplaceDetailsProductsGrid:"details-layout-module__xg7Djq__marketplaceDetailsProductsGrid",marketplaceProduct:"details-layout-module__xg7Djq__marketplaceProduct",message:"details-layout-module__xg7Djq__message",mobileHeaderButtons:"details-layout-module__xg7Djq__mobileHeaderButtons",wrapper:"details-layout-module__xg7Djq__wrapper"})},1033832,e=>{"use strict";var t=e.i(6468255),r=e.i(9508212),i=e.i(5468328),s=e.i(4991687),a=e.i(6694387),n=e.i(8459493),l=e.i(8674454),o=e.i(8876434),d=e.i(57106),c=e.i(6696646),u=e.i(5338940),p=e.i(1857939),m=e.i(2504781),g=e.i(3225905),x=e.i(7668531),h=e.i(2704354),f=e.i(4011256),j=e.i(1017032),y=e.i(8794163),v=e.i(4065455),b=e.i(6269556),N=e.i(7594446),w=e.i(6315360);let S={normal:{foreground:"#000",background:"#fff",border:"#fff"},hover:{foreground:"#fff",background:"#000",border:"#fff"},active:{foreground:"#fff",background:"#000",border:"#fff"}};function C(e){let{isCta:r,...i}=e;return r?(0,t.jsx)(x.CustomButtonLink,{...S,...i}):(0,t.jsx)(d.ButtonLink,{...i})}function k(e){let{isCta:r,...i}=e;return r?(0,t.jsx)(g.CustomButton,{...S,...i}):(0,t.jsx)(m.Button,{...i})}function D(e){let{integration:r,isCta:s,type:a,size:n,className:l,loginRedirect:o}=e,{isLoggedOut:d}=(0,p.useIsLoggedIn)(),{teamSlugOrPublic:m}=(0,b.useMarketplaceNavigation)(),{canCreateIntegrationConfiguration:g}=(0,N.useIntegrationPermissions)(),x=a??((0,h.isMarketplaceIntegration)(r)?"secondary":"default"),{isReady:w,team:S}=(0,u.useTeam)(),{hasConfigurations:D,data:I}=(0,j.useConfigurations)({integrationId:r.id,type:"external",skip:m.isPublic,skipBillingData:!0}),T=I?.[0],[z,$]=(0,c.useState)(!1),E=!!(S?.billing?.plan==="hobby"||S?.billing?.trial)&&r.proOnly,_=!g,P=E||_,M=!!(0,y.useV0Marketplace)()?.token;return(0,h.isMarketplaceOnlyIntegration)(r)?null:d?(0,t.jsx)(C,{className:l,disabled:(0,h.isLegacyIntegration)(r),href:o??`/login?next=${(0,f.getIntegrationDetailsLink)({integrationSlug:r.slug,teamSlugOrPublic:m,isFromV0:M})}`,isCta:s,type:x,size:n,rel:"nofollow",children:"Connect Account"}):T&&m.teamSlug?(0,t.jsx)(i.Tooltip,{disableTriggers:g,text:g?void 0:"You don't have permission to manage this integration.",children:(0,t.jsx)(C,{className:l,href:(0,f.getInstallationDetailsLink)({teamSlug:m.teamSlug,configurationId:T.id,integrationSlug:r.slug,isMarketplace:!1}),isCta:s,type:x,size:n,disabled:!g,children:"Manage"})}):(0,t.jsxs)(t.Fragment,{children:[D?null:(0,t.jsx)(i.Tooltip,{disableTriggers:!P,text:_?"You need additional permissions to install integrations.":"You need a paid account to install this integration",children:(0,t.jsx)(k,{className:l,disabled:P,isCta:s,onClick:()=>$(!0),type:x,size:n,children:"Connect Account"})}),z&&w?(0,t.jsx)(v.InstallExternalIntegrationModal,{account:S,integration:r,onAnimationDone:()=>$(!1),teamSlugOrPublic:m}):null]})}function I(){let{size:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsxs)(s.MenuContainer,{children:[(0,t.jsx)(a.MenuButton,{"aria-label":"More",shape:"square",svgOnly:!0,type:"secondary",size:e,children:(0,t.jsx)(o.MoreHorizontal,{})}),(0,t.jsx)(l.Menu,{children:(0,t.jsx)(n.MenuItem,{children:(0,t.jsx)(d.Link,{href:"#template",prefetch:!1,children:"Deploy Template"})})})]})}function T(e){let{integration:i}=e,{teamSlugOrPublic:s}=(0,b.useMarketplaceNavigation)(),{hasConfigurations:a}=(0,j.useConfigurations)({integrationId:i.id,type:"external",skip:s.isPublic,skipBillingData:!0});return a?null:(0,t.jsx)("div",{className:w.default.wrapper,children:(0,t.jsxs)(r.Stack,{className:w.default.cta,gap:3,children:[(0,t.jsxs)("div",{className:w.default.message,children:["Get started with Vercel and ",i.name,"."]}),(0,t.jsx)(D,{integration:i,isCta:!0})]})})}e.s(["ConnectAndTemplateMenu",()=>I,"ConnectExternalIntegrationButton",()=>D,"ConnectExternalIntegrationCTA",()=>T])},7589392,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(3199886),s=e.i(6891161),a=e.i(57106),n=e.i(109803),l=e.i(1017032),o=e.i(5765731),d=e.i(2521731),c=e.i(2704354),u=e.i(1282571),p=e.i(1033832),m=e.i(7743427);function g(e){let{config:r,teamSlug:i}=e,{data:s,isLoading:l}=(0,m.useIntegration)(r.integrationId,{teamId:i});return l||!s?null:(0,t.jsx)(u.MarketplaceIntegrationCard,{Actions:(0,t.jsx)(a.ButtonLink,{size:"small",type:"secondary",prefix:(0,t.jsx)(n.External,{size:14}),href:(0,c.getConfigureUrl)(s,r.id),target:"_blank",children:"Configure"}),className:"p-3 px-4",disabled:!0,href:"#",icon:s.icon,title:s.name,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-1000",children:s.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-900",children:["Connected ",new Date(r.createdAt).toLocaleDateString()]})]})})}function x(e){let{teamSlug:r,onClose:i}=e,{data:a}=(0,l.useConfigurations)({skipBillingData:!0}),{data:n}=(0,o.useConnectableIntegrations)(),c=a?.filter(e=>"external"===e.installationType&&e.scopes.includes("read-write:log-drain"))||[],m=Array.isArray(n)?n.filter(e=>!!(0,d.integrationSupportsLogDrains)(e)&&!a?.some(t=>"external"===t.installationType&&t.integrationId===e.id)):[];return(0,t.jsxs)(s.Modal.Modal,{active:!0,onClickOutside:i,children:[(0,t.jsxs)(s.Modal.Body,{children:[(0,t.jsx)(s.Modal.Header,{children:(0,t.jsx)(s.Modal.Title,{center:!0,children:"External Integration Log Drains"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-6 mt-4",children:[c.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-1000 mb-3",children:"Installed Integrations"}),(0,t.jsx)("div",{className:"rounded-md border border-accents-2 shadow-[0px_1px_2px_0px_rgba(0,0,0,0.04)]",children:c.map(e=>(0,t.jsx)(g,{config:e,teamSlug:r},e.id))})]}),m.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-1000 mb-3",children:"Available Integrations"}),(0,t.jsx)("div",{className:"rounded-md border border-accents-2 shadow-[0px_1px_2px_0px_rgba(0,0,0,0.04)]",children:m.map(e=>(0,t.jsx)(u.MarketplaceIntegrationCard,{Actions:(0,t.jsx)(p.ConnectExternalIntegrationButton,{integration:e,size:"small"}),className:"p-3 px-4",disabled:!0,href:"#",icon:e.icon,title:e.name,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-1000",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-900",children:e.shortDescription})]})},e.id))})]}),0===c.length&&0===m.length&&(0,t.jsx)("p",{className:"text-center py-8 text-gray-700",children:"No external integrations available for log drains."})]})]}),(0,t.jsxs)(s.Modal.Actions,{children:[(0,t.jsx)("div",{}),(0,t.jsx)(s.Modal.Action,{type:"secondary",onClick:i,children:"Close"})]})]})}var h=e.i(8633387);function f(e){let{isOpen:s,closeModal:a,teamSlug:n,projectIdOrSlug:l,onDrainCreated:o,drain:d,drainType:c,enableMarketplaceDrains:u}=e,[p,m]=(0,r.useState)(!1),{data:g}=(0,h.useDashboardProject)({projectSlug:l,teamSlug:n});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.DrainModal,{drain:d,active:s,onClose:()=>{a()},teamSlug:n,projectIdOrSlug:l,onDrainCreated:o,onOpenExternalModal:()=>{a(),m(!0)},drainType:c,defaultProjectId:g?.id},d?.id),u&&p&&(0,t.jsx)(x,{teamSlug:n,onClose:()=>m(!1)})]})}e.s(["DrainModals",()=>f],7589392)}]);

//# sourceMappingURL=9b9ce3d240d93778.js.map
//# debugId=5f168ad0-ee47-5c31-bf1e-b4de34899836
