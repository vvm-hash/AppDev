
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="bfca6dbb-65a9-5a5a-94db-c956b7e94d68")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4962639,e=>{"use strict";var t=e.i(6696646),r="undefined"==typeof window?t.default.useEffect:t.default.useLayoutEffect,l=0,n=()=>++l,a=!1;function i(){let[e,i]=t.default.useState(a?n:void 0);return r(()=>{void 0===e&&i(++l),a=!0},[]),void 0===e?e:`rwb-${e.toString(32)}`}var s="__wrap_b",o="__wrap_n",c="__wrap_o",d=(e,t,r)=>{let l=(r=r||document.querySelector(`[data-br="${e}"]`)).parentElement,n=e=>r.style.maxWidth=e+"px";r.style.maxWidth="";let a=l.clientWidth,i=l.clientHeight,s=a/2-.25,o=a+.5,c;if(a){for(n(s),s=Math.max(r.scrollWidth,s);s+1<o;)n(c=Math.round((s+o)/2)),l.clientHeight===i?o=c:s=c;n(o*t+a*(1-t))}r.__wrap_o||"undefined"!=typeof ResizeObserver&&(r.__wrap_o=new ResizeObserver(()=>{self.__wrap_b(0,+r.dataset.brr,r)})).observe(l)},u=d.toString(),m=function(e,r){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return l&&(l=`self.${o}!=1&&${l}`),t.default.createElement("script",{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:(e?"":`self.${o}=self.${o}||(self.CSS&&CSS.supports("text-wrap","balance")?1:2);self.${s}=${u};`)+l},nonce:r})},p=t.default.createContext(!1),h=e=>{let{nonce:r,children:l}=e;return t.default.createElement(p.Provider,{value:!0},m(!1,r),l)},x=e=>{let{ratio:l=1,nonce:n,children:a,...u}=e,h=t.default.useMemo(()=>"useId"in t.default?t.default.useId:i,[])(),x=t.default.useRef(),g=t.default.useContext(p),y=u.as||"span";return r(()=>{1!==self[o]&&x.current&&(self[s]=d)(0,l,x.current)},[a,l]),r(()=>{if(1!==self[o])return()=>{if(!x.current)return;let e=x.current[c];e&&(e.disconnect(),delete x.current[c])}},[]),t.default.createElement(t.default.Fragment,null,t.default.createElement(y,{...u,"data-br":h,"data-brr":l,ref:x,style:{display:"inline-block",verticalAlign:"top",textDecoration:"inherit",textWrap:"balance"},suppressHydrationWarning:!0},a),m(g,n,`self.${s}("${h}",${l})`))};e.s(["Balancer",()=>x,"Provider",()=>h,"default",()=>x])},935882,e=>{"use strict";let t=e.i(6696646).useLayoutEffect;e.s(["default",0,t])},7401972,e=>{"use strict";var t=e.i(6696646),r=e.i(8815282),l=e.i(8042625),n=e.i(277234),a=e.i(4244280),i=e.i(5338940),s=e.i(935882);function o(e){let{project:o,includeProductionBranch:d,query:u,limit:m,active:p,includeDeploymentInfo:h,readyStateFilter:x}=e,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:y,team:f}=(0,i.useTeam)(),[j,b]=(0,t.useState)(""),v={search:u&&c(u)?`"${u}"`:u,active:p?"1":null,teamId:f?.id,includeDeployments:h?"1":null,limit:m,state:x},k=(0,r.default)((e,t)=>{if(!o)return null;if(!e)return y?`${(0,a.API_PROJECTS_VERSION)("v5")}/${o.id}/branches/${(0,l.encode)(v)}`:null;let r=t&&m&&t.branches.length>=m?t.until:null;return r&&y?`${(0,a.API_PROJECTS_VERSION)("v5")}/${o.id}/branches/${(0,l.encode)({...v,until:r})}`:null},e=>(0,n.fetchAPI)(e,{throwOnHTTPError:!0}).then(e=>({...e,query:u})),g),R=o?.link?.productionBranch,S=(0,t.useMemo)(()=>{let e;if(!k.data)return;if(h){let t,r=[];for(let l of k.data)for(let n of(e=l.query,l.branches))R&&n.branch===R?t=n:r.push(n);return{query:e,result:(d&&t?[t,...r]:r).filter(e=>!!e.deployment).sort((e,t)=>t.deployment.createdAt-e.deployment.createdAt)}}let t=new Set;for(let r of k.data)for(let l of(e=r.query,r.branches))t.add(l.branch);return{query:e,result:(R&&t.has(R)&&t.delete(R),d&&R?[R,...t]:[...t])}},[k.data,d,R,h]);(0,s.default)(()=>{S?.query&&b(S.query)},[S?.query,b]);let w=!!k.data,E=w&&S?.result.length===0,C=w&&k.data&&k.size>k.data.length,D=!m||w&&k.data&&k.data[k.data.length-1]?.branches.length<m;return[k,{branches:S?.result,fetchedQuery:j,initialDataLoaded:w,isValidating:k.isValidating,isEmpty:E,loadMore:()=>k.setSize(e=>e+1),isLoadingMore:C,isReachingEnd:D,mutate:k.mutate}]}let c=e=>+e==+e;e.s(["useProjectDeployedBranches",()=>o])},7442760,e=>{"use strict";var t=e.i(1991452);function r(){let e=(0,t.useRouter)(),r=e.isReady&&"/[teamSlug]/~/[...catchAll]"===e.pathname&&e.query.catchAll?.length===1&&"deployments"===e.query.catchAll[0];return{isReady:e.isReady,scope:r?"TEAM_DEPLOYMENTS":"PROJECT_DEPLOYMENTS"}}e.s(["useDeploymentListScope",()=>r])},4029500,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),l=e.i(8459493),n=e.i(5255926),a=e.i(9318197),i=e.i(9508212),s=e.i(1344973),o=e.i(455575),c=e.i(57106),d=e.i(1201436),u=e.i(4345845),m=e.i(6107899),p=e.i(6942035),h=e.i(7674801),x=e.i(119294),g=e.i(2132151),y=e.i(5819220),f=e.i(979715),j=e.i(4712634),b=e.i(4450569),v=e.i(8529990),k=e.i(6625227),R=e.i(545405),S=e.i(4962639),w=e.i(8735244),E=e.i(5468328),C=e.i(6401841),D=e.i(2988836);function I(e){let{children:r,header:l,text:n}=e;return(0,t.jsx)(E.Tooltip,{maxWidth:278,text:(0,t.jsxs)(i.Stack,{as:"span",gap:0,children:[(0,t.jsx)(i.Stack,{align:"center",direction:"row",gap:1,justify:"center",children:l}),(0,t.jsx)(S.Balancer,{children:(0,t.jsx)(s.Text,{as:"span",children:n})})]}),children:r})}let T={building:{text:"Link can be shared now—it will open a page with a loading indicator until build completes",content:(0,t.jsx)(w.Spinner,{style:{overflow:"revert"},size:16})},ready:{text:"View of latest deployment on branch—updates automatically",content:(0,t.jsx)(D.InformationFillSmall,{})},failed:{text:"Domain was not updated because checks failed",content:(0,t.jsx)(C.Stop,{})}};function N(e){let{state:r}=e;return(0,t.jsx)(I,{header:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.GitBranch,{}),(0,t.jsx)(s.Text,{as:"span",weight:600,children:"Branch Link"})]}),text:T[r].text,children:T[r].content})}var P=e.i(2695633),A=e.i(4396019);let L=(0,r.memo)(e=>{var S;let w,{project:E,branch:C,deployments:D,isLoading:I,onClearBranch:T}=e,L=function(e){let t=e?.find(e=>"READY"===e.readyState);if(t)return t;let r=e?.find(e=>"BUILDING"===e.readyState);return r||null}(D),B=(0,o.useToasts)(),{deployment:O}=(0,A.useProjectProductionDeployment)(E?.id),{data:M,isValidating:_}=(0,k.default)(L?.uid,{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:!0}),U=(0,v.getGitInfoFromDeployment)(L),F=E?.link?.type||"github",$=U?.prUrl??U?.refUrl??U?.commitUrl??"",z=(0,P.getGitMeta)(O?.meta),q=I||_,G=M?.alias[0]??M?.url,V=(S=()=>(0,t.jsxs)(y.Entity,{className:"shadow-small border border-[var(--ds-gray-alpha-400)] !bg-[var(--ds-background-100)] bg-clip-padding",filled:!0,placeholder:q,thumbnail:(0,t.jsx)(j.EntityThumbnail,{circular:!0,size:30,children:(0,t.jsx)(u.GitBranch,{style:{transform:"translateX(0.5px)"}})}),...!!$&&!q&&{menuItems:(0,t.jsxs)(t.Fragment,{children:[G?(0,t.jsx)(l.MenuItem,{href:`https://${G}`,isLink:!0,prefix:(0,t.jsx)(m.PreviewEye,{}),target:"_blank",children:"Visit Preview"}):null,(0,t.jsxs)(l.MenuItem,{onClick:()=>{(0,R.copyToClipboard)($),B&&B.current&&B.current.message("Copied URL to clipboard!")},prefix:(0,t.jsx)(d.Copy,{}),children:["Copy ",U?.prUrl?"PR":"Branch"," URL ",(0,t.jsx)(a.Spacer,{})," "]}),(0,t.jsx)(l.MenuItem,{onClick:T,prefix:(0,t.jsx)(p.Cross,{}),type:"error",children:"Remove Filter"})]})},children:[(0,t.jsx)(f.EntityField,{description:$?(0,t.jsxs)("div",{children:["Branch link for"," ",(0,t.jsx)(c.Link,{href:$,children:(0,t.jsx)(s.Text,{as:"span",color:"inherit",monospace:!0,children:C})})]}):(0,t.jsx)("span",{children:C}),title:G?(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(c.Link,{className:"inline font-medium",href:`https://${G}`,onClick:()=>{x.analytics.track(g.CoreAnalyticsEvents.CLICK_EVENT,{click_name:"click_button",click_value:"deployments_page_primary_preview_deployments"})},variant:"highlight",children:G}),(0,t.jsx)(N,{state:L?.readyState==="BUILDING"?"building":"ready"})]}):(0,t.jsx)("div",{className:"mb-[2px]",children:"No successful deploy, yet."})}),(0,t.jsx)(f.EntityField,{className:"sm:max-w-fit",right:!0,children:(0,t.jsx)(b.default,{center:!0,row:!0,children:q?(0,t.jsxs)(b.default,{center:!0,className:"flex flex-row gap-4",row:!0,children:[(0,t.jsx)(n.Skeleton,{height:32,width:130}),(0,t.jsx)(n.Skeleton,{style:{width:32,height:32}})]}):(0,t.jsxs)(t.Fragment,{children:[!!U?.prUrl&&(0,t.jsx)(c.ButtonLink,{href:U.prUrl,prefix:"github"===F?(0,t.jsx)(h.LogoGithub,{}):z?(0,t.jsx)("span",{className:"size-4 [&>svg]:size-4",children:z.logo}):null,size:"small",tab:!0,type:"secondary",children:"github"===F?"View PR":"View Changes"}),!U?.prUrl&&!!U?.refUrl&&(0,t.jsx)(c.ButtonLink,{href:U?.refUrl,prefix:(0,t.jsx)(u.GitBranch,{style:{transform:"translateX(4px)"}}),size:"small",tab:!0,type:"secondary",children:"View Branch"})]})})})]}),w=(0,r.useRef)(0),q||(w.current=Math.random()),(0,r.useMemo)(()=>S(),[w.current]));return q||C?V:null});e.s(["FilteredBranchEntityBar",0,L],4029500)},1122901,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),l=e.i(9722978),n=e.i(9100551),a=e.i(1991452),i=e.i(5255926),s=e.i(3306538),o=e.i(3869281),c=e.i(2504781),d=e.i(9992248),u=e.i(6143247),m=e.i(119294),p=e.i(6352514),h=e.i(2560270);let x={READY:{label:"Ready",className:"bg-[var(--geist-cyan)]",key:"ready"},ERROR:{label:"Error",className:"bg-[var(--geist-error)]",key:"error"},BUILDING:{label:"Building",className:"bg-[var(--geist-warning)]",key:"building"},QUEUED:{label:"Queued",className:"bg-[var(--accents-2)]",key:"queued"},INITIALIZING:{label:"Provisioning",className:"bg-[var(--accents-2)]",key:"initializing"},CANCELED:{label:"Canceled",className:"bg-[var(--accents-2)]",key:"canceled"}},g=["ready","error","building","queued","initializing"],y="empty";function f(e){let{status:r,...n}=e;return(0,t.jsx)("span",{className:(0,l.clsx)("inline-block w-[10px] h-[10px] rounded-[5px] ring ring-1 ring-[var(--geist-background)] transition-colors duration-200 ease",r),...n})}function j(e){let t=Object.keys(e).filter(t=>e[t]).map(e=>e.toUpperCase());return 0===t.length?y:t.join(",")}let b={[x.INITIALIZING.key]:!0,[x.READY.key]:!0,[x.ERROR.key]:!0,[x.BUILDING.key]:!0,[x.QUEUED.key]:!0,[x.CANCELED.key]:!1};function v(){let e=(0,a.useRouter)(),t=(0,n.usePathname)(),l=(0,n.useSearchParams)(),[i,s]=(0,r.useState)(!0),[o,c]=(0,r.useState)(b);return(0,r.useEffect)(()=>{if(i&&e.isReady){var t;c((t=e.query.status)?t===y?{[x.INITIALIZING.key]:!1,[x.READY.key]:!1,[x.ERROR.key]:!1,[x.BUILDING.key]:!1,[x.QUEUED.key]:!1,[x.CANCELED.key]:!1}:{[x.INITIALIZING.key]:t.includes(x.INITIALIZING.key),[x.READY.key]:t.includes(x.READY.key),[x.ERROR.key]:t.includes(x.ERROR.key),[x.BUILDING.key]:t.includes(x.BUILDING.key),[x.QUEUED.key]:t.includes(x.QUEUED.key),[x.CANCELED.key]:t.includes(x.CANCELED.key)}:{[x.INITIALIZING.key]:!0,[x.READY.key]:!0,[x.ERROR.key]:!0,[x.BUILDING.key]:!0,[x.QUEUED.key]:!0,[x.CANCELED.key]:!1}),s(!1)}},[e.query.status,e.isReady,i]),(0,r.useEffect)(()=>{let r;if(i)return;let n=new URLSearchParams(l??{}),a=(r=Object.keys(o).filter(e=>o[e]).sort().join(","),g.sort().join(",")===r?null:""===r?y:r);a?n.set("status",a):n.delete("status"),l&&l.get("status")!==n.get("status")&&e.isReady&&e.replace({pathname:t,query:n.toString()},void 0,{scroll:!1})},[i,o,e,e.query.status,l,t]),{isInitialStatusItems:Object.entries(o).every(e=>{let[t,r]=e;return b[t]===r}),selectedStatusItems:o,resetStatusToDefault(){c(b)},handleSelectStatusItem:e=>{c(t=>{let r={...t,[e]:!t[e]};return m.analytics.track(p.AnalyticsEvent.DEPLOYMENT_OVERVIEW_FILTERS_STATUS,{status:JSON.stringify(r)}),r})},selectStatusFilterValues:Object.keys(o).filter(e=>o[e]).map(e=>e.toUpperCase())}}let k="Check",R="Uncheck",S="Only",w="Check All";function E(e){let{className:n,menuButtonClassName:a,selectedStatusItems:m,handleSelectStatusItem:p,skeleton:g=!1,position:y="right"}=e,[j,b]=(0,r.useState)(!1),[v,E]=(0,r.useState)(!1),[C,D]=(0,r.useState)(null),[I,T]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g||b(!0)},[g]);let N=Object.values(m).filter(Boolean).length,P=Object.values(x).length,A=N>0&&N<P,L=N===P,B=(e,t)=>{switch(e){case"selectOnly":Object.values(x).forEach(e=>{let{key:r}=e;r!==t&&m[r]&&p(r)}),m[t]||p(t);break;case"selectAll":Object.values(x).forEach(e=>{let{key:t}=e;m[t]||p(t)});break;case"toggle":p(t)}};return(0,t.jsx)("div",{className:(0,l.clsx)("left"===y&&"mr-[var(--geist-space-2x)] max-[600px]:mb-[var(--geist-space-2x)] max-[600px]:mr-0","right"===y&&"ml-0 mr-[var(--geist-space-2x)] max-[997px]:mb-[var(--geist-space-2x)] max-[997px]:ml-0 max-[997px]:mr-[var(--geist-space-2x)] max-[600px]:mx-0",n),children:(0,t.jsx)(i.Skeleton,{show:!!(g&&!j),children:(0,t.jsxs)(d.Root,{open:v,onOpenChange:E,children:[(0,t.jsx)(d.Trigger,{asChild:!0,children:(0,t.jsxs)(c.Button,{className:(0,u.cn)(a,"*:whitespace-nowrap *:flex *:px-1.5 group/trigger"),type:"secondary","aria-label":`Filter by deployment status. ${N} of ${P} statuses selected`,"aria-expanded":v,suffix:(0,t.jsx)("div",{className:"text-[var(--accents-3)] group-hover/trigger:text-gray-1000 transition-colors",children:(0,t.jsx)(h.ChevronDown,{})}),children:[(0,t.jsx)("div",{className:"[&>span]:ease w-[45px] text-left [&>span]:relative [&>span]:ring-0 [&>span]:border [&>span]:border-solid [&>span]:border-[var(--themed-bg,var(--ds-background-100))] [&>span]:transition-colors [&>span]:duration-200",children:Object.values(x).map((e,r)=>{let{key:l,className:n}=e;return(0,t.jsx)(f,{status:m[l]?n:"bg-[var(--geist-background)] shadow-[inset_0_0_0_1px_var(--accents-2)]",style:{left:`${-4*r}px`}},l)})}),(0,t.jsx)("span",{className:"flex-1 text-left font-normal text-[var(--geist-foreground)] max-[600px]:text-sm",children:"Status"}),(0,t.jsxs)(s.Badge,{className:"ml-1 h-5 min-w-8 bg-gray-300 px-1.5 text-xs font-medium tabular-nums",variant:"gray-subtle","aria-label":`${N} of ${P} statuses selected`,children:[N,"/",P]})]})}),(0,t.jsx)(d.Portal,{children:(0,t.jsx)(d.Content,{align:"start",className:"z-50 w-[220px] rounded-md bg-background-100 p-2 shadow-menu",sideOffset:5,children:(0,t.jsx)("div",{className:"flex flex-col",children:Object.values(x).map(e=>{let{key:r,className:n,label:a}=e,i=m[r]??!1,s=C===r,c=function(e){let{isHoveringCheckbox:t,isHoveredRow:r,isChecked:l,isMixedSelection:n,allSelected:a,selectedCount:i}=e;return t&&r?l?R:k:n?l?w:S:a?S:0===i?k:""}({isHoveringCheckbox:I,isHoveredRow:s,isChecked:i,isMixedSelection:A,allSelected:L,selectedCount:N});return(0,t.jsxs)("div",{className:"group relative flex items-center *:rounded *:px-1.5 *:py-1.5",onMouseEnter:()=>D(r),onMouseLeave:()=>{D(null),T(!1)},children:[(0,t.jsx)("div",{className:"peer flex items-center !px-0 !py-0 h-8 w-6",onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),children:(0,t.jsx)(o.Checkbox,{className:"size-full items-center justify-center flex rounded hover:bg-gray-100",checked:i,onChange:()=>p(r),"aria-labelledby":`status-label-${r}`})}),(0,t.jsxs)("button",{id:`status-label-${r}`,className:"group/label flex-1 w-full flex justify-between text-left text-sm text-gray-1000 bg-transparent !pl-2 pr-0 cursor-pointer hover:bg-gray-100 focus-visible:shadow-focus-ring outline-none",onClick:()=>{B(function(e){let{isChecked:t,allSelected:r,isMixedSelection:l,selectedCount:n}=e;return r?"selectOnly":t?"selectAll":l?"selectOnly":0===n?"toggle":"none"}({isChecked:i,allSelected:L,isMixedSelection:A,selectedCount:N}),r)},type:"button","aria-label":`${a}${c?`. ${c}`:""}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(f,{status:n}),a]}),c&&(0,t.jsx)("span",{className:(0,l.clsx)("text-gray-900 ml-auto px-1 py-0.5 rounded-sm text-xs font-medium opacity-0 peer-hover:opacity-100 group-hover/label:opacity-100 group-focus-visible/label:opacity-100",I&&s&&"opacity-100"),onClick:e=>{e.stopPropagation(),B(function(e){switch(e){case S:return"selectOnly";case w:return"selectAll";case k:case R:return"toggle";default:return"none"}}(c),r)},"aria-hidden":"true",children:c})]})]},r)})})})})]})})})}e.s(["default",()=>E,"getReadyStateFilter",()=>j,"useFilterStatus",()=>v])},3981247,e=>{"use strict";var t=e.i(3911483),r=e.i(2547843);function l(e){let{teamIdOrSlug:t,projectSlug:r}=e;return n({teamIdOrSlug:t,projectSlug:r},{suspense:!0,revalidateOnMount:!1})}function n(e,l){let{teamIdOrSlug:n,projectSlug:a}=e,i=!n||!a,s=(0,t.default)(()=>i?null:(0,r.getRollingReleaseEndpoint)(n,a),r.rollingReleaseFetcher,l);return{...s,skipped:i,isLoading:!i&&s.isLoading}}e.s(["useRollingRelease",()=>n,"useSuspenseRollingRelease",()=>l])},4443312,e=>{"use strict";var t=e.i(4603164),r=e.i(5338940);function l(e){let{deploymentId:l,swrOptions:n,enableCiChecksAndPolicies:a}=e,{team:i}=(0,r.useTeam)();return(0,t.useTypedSWR)("/v2/deployments/{deploymentId}/check-runs",a&&l&&i?.id?{deploymentId:l,teamId:i.id}:null,{refreshInterval:3e3,...n})}e.s(["CHECK_RUNS_REFRESH_INTERVAL",0,3e3,"useProjectCheckRuns",()=>l])},930810,9745887,e=>{"use strict";var t=e.i(6468255),r=e.i(1344973),l=e.i(2504781),n=e.i(9334091),a=e.i(3306538),i=e.i(9508212),s=e.i(57106),o=e.i(3753138),c=e.i(6226725),d=e.i(4345845),u=e.i(8893913),m=e.i(7218483),p=e.i(9722978),h=e.i(9375869),x=e.i(8529990),g=e.i(3907048);function y(e){let{isForm:r,children:l,className:n}=e;return r?(0,t.jsx)("label",{className:n,children:l}):(0,t.jsx)("div",{className:n,children:l})}function f(e){let{deployment:l,isForm:n,isPromote:f,isPreviousDeployment:j,isProductionDeployment:b,isRolledBackDeployment:v,selectedDeployment:k,setSelectedDeployment:R,ariaLabel:S="Rollback Deployment"}=e,w=(0,m.useAgo)(l.createdAt||0),E="number"==typeof l.aliasAssigned?l.aliasAssigned:0,C=E>0,D=(0,m.useAgo)(E),I=(0,h.useDeploymentLink)(l),T=(0,x.getGitInfoFromDeployment)(l),N=b||j||v;j&&v&&(j=!1);let P="Preview";if("target"in l)switch(l.target){case"staging":P="Staging";break;case"production":P="Production";break;default:P="Preview"}else P="Production";let A="uid"in l?l.uid:l.id,L=null;f?T?.commitRef&&(L=(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(d.GitBranch,{color:"gray-900"}),(0,t.jsx)(r.Text,{as:"span",color:"gray-900",monospace:!0,style:{marginRight:"4px",maxWidth:120,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0},title:T.commitRef,truncate:!0,wrap:!1,children:T.commitRef}),(0,t.jsxs)(r.Text,{as:"span",className:"flex items-center gap-1",color:"gray-900",style:{flexBasis:"50%",flexShrink:0,flexGrow:1,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0,maxWidth:260},truncate:!0,wrap:!1,children:["Staged"," ",w," by"," ",(0,t.jsx)("span",{children:(0,t.jsx)(g.CreatorAvatar,{deployment:l,showProviderIcon:!0,size:24})}),(0,t.jsx)("span",{children:!l.meta?.originalDeploymentId&&l.creator?.username?l.creator.username:T.commitAuthorLogin})]})]})):L=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"inline-flex flex-row items-center",children:[(0,t.jsx)(r.Text,{as:"span",color:"gray-900",size:14,style:{marginRight:"4px"},children:P}),T?.commitRef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.GitBranch,{color:"gray-900",size:14}),(0,t.jsx)(r.Text,{as:"span",className:"max-w-[100px] truncate whitespace-nowrap px-1 text-center text-sm leading-5 text-gray-900",monospace:!0,title:T.commitRef,children:T.commitRef}),(0,t.jsx)(r.Text,{as:"span",color:"gray-900",children:"by"}),(0,t.jsxs)("div",{className:"ml-1 inline-flex flex-row items-center gap-1",children:[(0,t.jsx)(g.CreatorAvatar,{deployment:l,size:20}),(0,t.jsx)(r.Text,{as:"span",className:"max-w-[140px] truncate",color:"gray-900",truncate:!0,children:!l.meta?.originalDeploymentId&&l.creator?.username?`${l.creator.username}`:T.commitAuthorLogin})]})]}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(r.Text,{as:"span",color:"gray-900",size:14,children:["Deployed"," "]}),(0,t.jsx)(r.Text,{as:"span",color:"gray-900",size:14,children:w}),(0,t.jsxs)(r.Text,{as:"span",color:"gray-900",size:14,children:[","," "]}),C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.Text,{as:"span",color:"gray-900",size:14,children:["promoted"," "]}),(0,t.jsx)(r.Text,{as:"span",color:"gray-900",size:14,children:D})]}):(0,t.jsx)(r.Text,{as:"span",color:"gray-900",size:14,children:"never promoted"})]})]});let B=null;return n||(B=f?(0,t.jsx)(o.ArrowCircleUp,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):b?(0,t.jsx)(c.CrossCircle,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):(0,t.jsx)(u.RotateCounterClockwise,{className:"mr-4 hidden self-center sm:block",color:"gray-1000",style:{flexShrink:0}})),(0,t.jsxs)(y,{className:(0,p.clsx)("flex w-full items-end justify-start px-4 py-3","rounded border border-solid border-[var(--accents-2)]","rounded-b-none","last:rounded-b","[&+&]:rounded-t-none [&+&]:border-t-0",{"bg-[var(--accents-1)] shadow-none":b,"bg-[var(--geist-background)]":!b}),isForm:n,children:[n?(0,t.jsx)("input",{"aria-label":S,checked:k?.uid===A,className:`
            relative m-0 mr-4 size-4 shrink-0 appearance-none
            self-center rounded-[1000px] border
            border-solid border-[var(--geist-foreground)] after:absolute after:inset-[3px]
            after:rounded-[1000px] after:bg-[var(--geist-foreground)]
            after:content-none checked:after:content-['']
          `,name:"rollbackDeployment",onChange:()=>{"uid"in l&&"type"in l&&R&&R(l)},type:"radio",value:A}):B,(0,t.jsxs)("div",{style:{width:N?"initial":"100%",minWidth:0},children:[(0,t.jsx)(s.Link,{className:"flex w-[calc(100%-1ch)] items-center gap-0.5 break-all text-sm font-bold leading-5",href:I,target:"_blank",children:(0,t.jsx)(r.Text,{as:"span",title:l.url,truncate:1,weight:500,children:l.url})}),T?.commitMessage?(0,t.jsxs)(r.Text,{as:"p",className:"break-words",color:"gray-900",size:14,title:T.commitMessage,truncate:1,children:[T.commitSha.substring(0,7)," ",T.commitMessage]}):null,L]}),b?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"inverted",children:"Current"}):null,j?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"gray-subtle",children:"Previous"}):null,v?(0,t.jsx)(a.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"red-subtle",children:"Rolled back"}):null]})}e.s(["DeploymentCardSmall",()=>f],9745887);var j=e.i(8227242),b=e.i(8651268);function v(e){return"id"in e?e.id:"uid"in e?e.uid:void 0}function k(e){return void 0!==e.deleted}function R(e){let{rollbackDescription:l,project:n,preview:a}=e,i=(0,m.useAgo)(l.createdAt);return(0,t.jsxs)("div",{className:"px-4 py-3 rounded bg-background-200 shadow-border",children:[(0,t.jsx)(r.Text,{className:"break-words",color:"gray-900",children:l.description.length>0?(0,t.jsxs)(t.Fragment,{children:["“",(0,t.jsx)(j.LinkParser,{text:l.description}),"”"]}):(0,t.jsx)(r.Text,{children:"No reason provided."})}),(0,t.jsxs)("div",{className:"flex gap-1 pt-1",children:[a?null:(0,t.jsx)(r.Text,{children:"Rolled back by"}),l.username?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.PrincipalAvatar,{size:20,principalId:l.userId,principal:{type:"user",uid:l.userId,username:l.username}}),(0,t.jsx)(r.Text,{children:l.username}),n?.lastAliasRequest!==void 0&&!a&&(0,t.jsx)(r.Text,{children:i})]}):null]})]})}function S(e){let{deployments:r,previousDeployment:n,rolledBackDeploymentId:a,productionDeployment:i,selectedDeployment:s,setSelectedDeployment:o,swr:c,ariaLabel:d}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:r.map(e=>i.id!==e.uid&&(0,t.jsx)(f,{deployment:e,isForm:!0,isPreviousDeployment:n?.uid===e.uid,isRolledBackDeployment:a===e.uid,selectedDeployment:s,setSelectedDeployment:o,ariaLabel:d},e.uid))}),!c.isReachingEnd&&(0,t.jsx)(l.Button,{loading:c.isLoadingMore,onClick:()=>{c.loadMore()},style:{marginTop:24},type:"secondary",width:"100%",children:"Show More"})]})}function w(e){if(0===e.length)return;let t=e.reduce((e,t)=>e.aliasAssigned&&t.aliasAssigned?e.aliasAssigned>t.aliasAssigned?e:t:t.aliasAssigned?t:e);if(t.aliasAssigned)return t}function E(e){let{value:r,onChange:l,id:a}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Textarea,{autoFocus:!0,className:"text-base min-h-24",error:r.length>=250?"Reason cannot be longer than 250 characters.":void 0,id:a,onChange:e=>l(e.target.value),placeholder:"Production is not behaving as expected…",required:!0,value:r,style:{fontSize:14}})})}e.s(["ChooseDeploymentList",()=>S,"REASON_MAX_CHARACTER_LENGTH",0,250,"RollbackDescriptionCard",()=>R,"RollbackDescriptionTextarea",()=>E,"getDeploymentId",()=>v,"getMostRecentlyPromotedDeployment",()=>w,"isDeleted",()=>k],930810)},6619197,5645345,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),l=e.i(8248823),n=e.i(9100551),a=e.i(57106),i=e.i(3869281),s=e.i(4030453),o=e.i(2455417),c=e.i(6891161),d=e.i(8522580),u=e.i(5255926),m=e.i(9318197),p=e.i(9508212),h=e.i(1344973),x=e.i(455575),g=e.i(8761240),y=e.i(472117),f=e.i(4004502),j=e.i(8042625),b=e.i(277234),v=e.i(4244280),k=e.i(4443312),R=e.i(5140444),S=e.i(5338940),w=e.i(4614946),E=e.i(4450569),C=e.i(4396019),D=e.i(9375869),I=e.i(8518548);function T(e){if(!e)return;if("id"in e==!1)return e;let{aliasAssigned:t,aliasError:r=null,aliasAssignedAt:l,buildingAt:n,created:a=e.createdAt,createdAt:i,creator:s,name:o,ready:c,readyState:d,readySubstate:u,target:m=null,uid:p=e.id,url:h,isRollbackCandidate:x="production"===e.target}=e;return{aliasAssigned:t,aliasError:r,aliasAssignedAt:l,buildingAt:n,created:a,createdAt:i,creator:{email:"",githubLogin:"",...s},name:o,ready:c,readyState:d,readySubstate:u,target:m,type:"LAMBDAS",uid:p,url:h,isRollbackCandidate:x}}e.s(["asListDeployment",()=>T],5645345);var N=e.i(1840726),P=e.i(930810),A=e.i(7952834),L=e.i(1173672),B=e.i(9745887),O=e.i(3008300),M=e.i(3981247),_=e.i(6060673);function U(e){let t=e?.name,{deployment:l,isLoading:n}=(0,C.useProjectProductionDeployment)(t);return(0,r.useMemo)(()=>{let t=T(e);return t?n?"Loading…":t.uid===l?.id?"This Deployment is already in Production.":"readyState"in t&&"READY"!==t.readyState?"Only Deployments that are Ready can be promoted.":"":""},[e,n,l?.id])}function F(e){let{title:r}=e;return(0,t.jsx)(c.Modal.Header,{children:(0,t.jsx)(c.Modal.Title,{center:!0,children:r})})}function $(e){let{deploymentId:r}=e,l=(0,y.useChecksPrivateBetaFlag)(),n=(0,y.useCiChecksAndPoliciesFlagV2)(),i=l||n,{data:s,isLoading:o}=(0,k.useProjectCheckRuns)({deploymentId:r,enableCiChecksAndPolicies:i});if(!i)return null;if(o)return(0,t.jsx)(u.Skeleton,{});if(s?.runs.every(e=>"succeeded"===e.conclusion))return null;let c=s?.runs.filter(e=>"succeeded"!==e.conclusion)||[];return(0,t.jsxs)(d.Note,{type:"error",fill:!0,className:"mt-6",children:["By clicking Promote, you acknowledge that you are bypassing promotion requirements:",c.length>0&&(0,t.jsx)("ul",{className:"flex flex-col gap-1 ml-4 list-disc",children:c.slice(0,5).map(e=>(0,t.jsx)("li",{children:e.externalUrl?(0,t.jsx)(a.Link,{href:e.externalUrl,external:!0,children:e.name}):(0,t.jsx)("span",{children:e.name})},e.id||e.name||`${e.conclusion}-${e.status}`))})]})}function z(e,l){let{onDeploymentPromoted:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[u,x]=(0,r.useState)(!1),[y,j]=(0,r.useState)(null),{team:b}=(0,S.useTeam)(),v=e??y?.name,{data:k}=(0,_.useProject)(v),w=l??k,D=(0,N.useShowIgnoreBuildStep)({project:w,deployment:y}),[T,A]=(0,r.useState)(O.DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE),L=(0,r.useCallback)(()=>{x(!1)},[]),{error:U,loading:z,promote:G,setError:V,setLoading:W}=q({deployment:y,useIgnoreBuildStep:T,project:w,onCurrentDeploymentPromoted:(0,r.useCallback)(()=>{L(),n?.()},[L,n])}),{user:H}=(0,R.useUser)(),{data:Y}=(0,M.useRollingRelease)({teamIdOrSlug:b?.slug,projectSlug:v}),Q=w?.rollingRelease?.stages!==void 0&&w.rollingRelease.stages.length>0,J=Y?.rollingRelease?.state==="ACTIVE",Z=Y?.rollingRelease?.canaryDeployment?.id,K=J&&Z===y?.uid,X=Q&&!J&&y?.target==="production",ee=Q&&J&&y?.target==="production",et=X&&w.rollingRelease?.stages!==void 0?w.rollingRelease.stages[0]?.targetPercentage:null,{data:er}=(0,I.useProjectDomains)(v,{limit:11,production:"true",redirects:"false",verified:"true",order:"ASC"}),el=(0,r.useCallback)(e=>{j(e),x(!0)},[]),en=(0,r.useCallback)(()=>{W(!1),j(null),V(void 0)},[V,W]),{rollbackDescription:ea,deploymentIsStale:ei}=(0,C.useProjectProductionDeployment)(w?.name),{andMoreDomains:es,remainingDomains:eo}=(0,r.useMemo)(()=>{if(!er)return{andMoreDomains:!1,remainingDomains:[]};let e=er.length>2,t=e?er.slice(2).map(e=>e.name):[];return{andMoreDomains:e,remainingDomains:t}},[er]),ec=(0,r.useMemo)(()=>{if(!w||!y)return(0,t.jsx)(E.default,{center:!0,style:{marginTop:10},children:(0,t.jsx)(o.LoadingDots,{size:4})});let e=!!(er&&er.length>0);return(0,t.jsxs)(t.Fragment,{children:["production"===y.target?(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote:"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:"16px"},children:"A new deployment will be built using your production environment."}),(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote to production:"})]}),(0,t.jsx)("div",{children:(0,t.jsx)(B.DeploymentCardSmall,{deployment:y,isPromote:!0,selectedDeployment:null})}),X?(0,t.jsxs)(h.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:["This will start a new rolling release with initial traffic of"," ",et,"%."]}):null,ee?(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"This will queue the deployment for promotion after the current rolling release completes."}):null,X||ee||!e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:16,marginTop:24},weight:400,children:"It will be aliased to the following domains:"}),(0,t.jsx)(p.Stack,{gap:2,style:{paddingLeft:12},children:er?.slice(0,2).map(e=>{let{name:r}=e;return(0,t.jsx)(h.Text,{as:"p",children:(0,t.jsxs)(p.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsx)(g.CheckCircleFill,{color:"blue-700",size:20}),(0,t.jsx)("span",{children:r.startsWith("*")?r:(0,t.jsx)(a.Link,{"data-testid":(0,f.tid)("deployments","promote-to-production-overlay","preview-link"),external:!0,href:`https://${r}`,variant:"highlight",children:r})})]})},r)})}),es?(0,t.jsxs)(h.Text,{as:"p",className:"mt-6 mb-4",children:["...and ",eo.length," more"]}):null]}),!X&&!e&&(0,t.jsxs)(h.Text,{as:"p",style:{marginBottom:"24px",marginTop:"24px"},children:["Warning: Your Project does not have a Production Domain. We recommend you"," ",(0,t.jsx)(a.Link,{href:`/${b?b.slug:H?.username}/${encodeURIComponent(w.name)}/settings/domains`,variant:"highlight",children:"add"})," ","one."]}),w.link&&y.gitSource?(0,t.jsx)($,{deploymentId:y.id}):null,D?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)(i.Checkbox,{checked:T,fullWidth:!0,onChange:()=>{A(!T)},children:"Use project's Ignore Build Step"})]}):null,K?(0,t.jsx)(d.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(p.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(p.Stack,{align:"start",children:(0,t.jsx)(h.Text,{as:"p",color:"inherit",children:"This will complete the rolling release for this deployment."})})})}):null,ei?(0,t.jsx)(d.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(p.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(p.Stack,{align:"start",children:(0,t.jsx)(h.Text,{as:"p",color:"inherit",children:X?"Completing the Rolling Release will undo the current Instant Rollback":"This action will undo the current Instant Rollback"})})})}):null,ea?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"Rollback Details:"}),(0,t.jsx)(P.RollbackDescriptionCard,{rollbackDescription:ea,project:w})]}):null]})},[es,eo,er,w,b,H,y,T,D,ei,ea,et,X,ee,K]),ed=(0,r.useMemo)(()=>(0,t.jsx)(c.Modal.Action,{"data-testid":(0,f.tid)("deployments","promote-to-production-overlay","confirm-button"),loading:z,onClick:G,children:y&&"target"in y&&"production"===y.target?"Promote":"Promote to Production"}),[G,z,y]);return{modal:(0,r.useMemo)(()=>(0,t.jsxs)(c.Modal.Modal,{active:u,"data-testid":(0,f.tid)("deployments","promote-to-production-overlay"),onAnimationDone:en,onClickOutside:L,sticky:!0,width:"500px",children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(F,{title:ee?"Queue for Promotion":y&&"target"in y&&"production"!==y.target?"Promote to Production":"Promote"}),ec,U?(0,t.jsx)(s.Error,{error:U}):null]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{"data-testid":(0,f.tid)("deployments","promote-to-production-overlay","cancel-button"),loading:!1,onClick:L,type:"secondary",children:"Cancel"}),ed]})]}),[u,en,L,ec,U,ed,ee,y]),close:L,open:el}}let q=e=>{let{deployment:t,project:a,useIgnoreBuildStep:i,onCurrentDeploymentPromoted:s}=e,o=(0,x.useToasts)(),c=(0,n.useRouter)(),{team:d}=(0,S.useTeam)(),{user:u}=(0,R.useUser)(),{mutate:m}=(0,w.useSWRConfig)(),[p,h]=(0,r.useState)(!1),[g,y]=(0,r.useState)(void 0),f=(0,N.useShowIgnoreBuildStep)({project:a,deployment:t});return{promote:(0,r.useCallback)(async()=>{if(t&&a){h(!0),y(void 0);try{let e,r=d?.id,l="Promoted Deployment successfully.";if("production"===t.target)await (0,b.fetchAPI)(`${(0,v.API_DEPLOYMENT_PROMOTE)(a.id,t.uid||t.id)}${(0,j.encode)({teamId:r})}`,{method:"POST",body:{},throwOnHTTPError:!0}),e=(0,D.pathFromDeployment)(t,{user:u,team:d});else{let n=await (0,b.fetchAPI)(`${(0,v.API_DEPLOYMENTS)("v13")}${(0,j.encode)({teamId:r,skipIgnoreBuildStep:f&&!i?"1":null})}`,{method:"POST",body:JSON.stringify({deploymentId:t.uid||t.id,meta:{action:"promote"},name:a.name,target:"production"}),throwOnHTTPError:!0});e=(0,D.pathFromDeployment)(n,{user:u,team:d});let s=t.uid||t.id;l="production"===t.target?s===n.id?"Deployment is already the current Production Deployment.":"Promoted Deployment to Production successfully.":"Created Production Deployment successfully."}d&&((0,A.revalidateProject)(m,a),await m((0,L.getProjectProductionDeploymentKey)({projectIdOrName:a.id,teamId:d.slug}))),o.success({text:l,key:"production-deployment"}),e&&(e===location.pathname?s?.():c.push(e))}catch(e){y((0,l.normalizeError)(e))}finally{h(!1)}}},[t,a,c,f,d,o,i,u,m,s]),loading:p,setLoading:h,error:g,setError:y}};e.s(["default",()=>z,"usePromoteDeployment",0,q,"usePromoteTooltip",()=>U],6619197)},1553329,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),l=e.i(6891161),n=e.i(9508212),a=e.i(1344973),i=e.i(9100551),s=e.i(1717203),o=e.i(7557283),c=e.i(930810),d=e.i(6060673),u=e.i(4396019),m=e.i(5771992),p=e.i(6619197);function h(e){let{open:h,setOpen:x}=e,g=(0,r.useRef)(!1),y=(0,i.useParams)(),{data:f}=(0,d.useProject)(y?.project),{can:j}=(0,s.default)({projectIdOrName:y?.project}),b=j(o.Action.Delete,o.Resource.DeploymentRollback),{deployment:v,rollbackDescription:k}=(0,u.useProjectProductionDeployment)(y?.project),[,R]=(0,m.useDeploymentsInfinite)({projectId:f?f.id:"",requireProject:!0,limit:10,rollbackCandidate:!0},{}),{deployments:S}=R,[w,E]=(0,r.useState)(null);null===w&&S.length>0&&E(S[0]);let{loading:C,promote:D}=(0,p.usePromoteDeployment)({deployment:w,project:f,useIgnoreBuildStep:!1});return((0,r.useEffect)(()=>{h&&!g.current?(R.loadMore(),g.current=!0):h||(g.current=!1)},[h,R]),void 0===v)?null:(0,t.jsxs)(l.Modal.Modal,{active:h,onClickOutside:()=>x(!1),sticky:!0,children:[(0,t.jsxs)(l.Modal.Body,{children:[(0,t.jsx)(l.Modal.Header,{children:(0,t.jsx)(l.Modal.Title,{center:!0,children:"Undo Rollback"})}),(0,t.jsxs)(n.Stack,{gap:6,children:[k?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Text,{size:16,children:"Rollback details:"}),(0,t.jsx)(c.RollbackDescriptionCard,{project:f,rollbackDescription:k})]}):null,(0,t.jsx)(a.Text,{size:16,children:"Undo this rollback by promoting a different deployment:"}),(0,t.jsx)(n.Stack,{children:(0,t.jsx)(c.ChooseDeploymentList,{deployments:S,productionDeployment:v,rolledBackDeploymentId:f?.lastAliasRequest?.type==="rollback"?f.lastAliasRequest.fromDeploymentId:void 0,selectedDeployment:w,setSelectedDeployment:E,swr:R,ariaLabel:"Promote Deployment"})})]})]}),(0,t.jsxs)(l.Modal.Actions,{children:[(0,t.jsx)(l.Modal.Action,{onClick:()=>x(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(l.Modal.Action,{disabled:!b,loading:C,onClick:()=>{D()},children:"Confirm"})]})]})}e.s(["UndoRollbackModal",()=>h])},5598924,5442212,e=>{"use strict";var t=e.i(6468255),r=e.i(9338892),l=e.i(6696646),n=e.i(5255926),a=e.i(6881349),i=e.i(119294),s=e.i(6352514),o=e.i(1991452),c=e.i(9100551),d=e.i(9031150),u=e.i(935882);let m=()=>{let e=(0,c.useSearchParams)();return{isReady:(0,o.useRouter)().isReady,filterBranch:e?.get("filterBranch")||void 0}};function p(){let{project:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=m(),[r,n]=(0,l.useState)(t.filterBranch||null);(0,l.useEffect)(()=>{n(t.filterBranch||null)},[t.isReady,t.filterBranch]);let a=(0,o.useRouter)(),i=(0,l.useCallback)(e=>{(0,d.awaitPaint)().then(()=>{n(e),function(e,t){let{teamSlug:r,project:l,slug:n,...a}=e.query;t?a.filterBranch=t:delete a.filterBranch,e.replace({pathname:window.location.pathname,query:a},void 0,{shallow:!0,scroll:!1})}(a,e)})},[a]),s=r?{ref:r}:void 0,c=(0,l.useCallback)(()=>{r&&(n(null),i(null))},[r,i]),p=!e||!t.isReady,h=null!==r,[x,g]=(0,l.useState)(h);return(0,u.default)(()=>{g(h)},[g,p,h]),{showBranchFilterBar:x,filteredBranch:r,setFilteredBranch:i,clearBranch:c,gitSource:s}}e.s(["useProjectFilteredBranch",()=>p,"useRouterFilteredBranch",0,m],5442212);var h=e.i(1947138),x=e.i(7401972);function g(e){let{skeletonStyle:r}=e;return(0,t.jsx)(l.Suspense,{fallback:(0,t.jsx)(f,{skeletonStyle:r}),children:(0,t.jsx)(y,{...e})})}let y=(0,l.memo)(e=>{let{loading:n,skeleton:o,onSelect:c,project:d,value:p,includeProductionBranch:g,placeholder:y,skeletonStyle:j,comboboxSize:b,clearable:v}=e,[k,R]=(0,l.useState)(!1),[S,w]=(0,l.useState)(!1),[E,C,{currentValue:D,setValueImmediate:I}]=(0,h.useDebounceState)(p||"",300);(0,l.useEffect)(()=>{p&&I(p)},[I,p]);let[,{branches:T,isValidating:N,fetchedQuery:P}]=(0,x.useProjectDeployedBranches)({project:d,includeProductionBranch:g,query:E},{revalidateOnFocus:!1,revalidateIfStale:!1,revalidateOnReconnect:!1}),A=(P||"")!==E,L=!!S&&!!k&&!!D&&A,{filterBranch:B}=m();(0,l.useEffect)(()=>{B&&I(B)},[I,B]),(0,l.useEffect)(()=>{I(p||"")},[I,p]),(0,l.useEffect)(()=>{k||T&&!N&&R(!0)},[k,T,N]);let[O,M]=(0,l.useState)([]);(0,l.useEffect)(()=>{N||void 0===T||(0!==_.current.query.indexOf(D)&&(_.current={values:[],query:D}),M(T||[]))},[JSON.stringify(T),P]);let _=(0,l.useRef)({values:[],query:""}),U=N||D.length>=E.length&&D.length>=1?_.current.values:[],F=[...new Set([...U,...L?O:T||[]])],$=(0,l.useRef)(null);return((0,u.default)(()=>{D&&$.current?.setValue(D)},[D]),(0,u.default)(()=>{p||$.current?.clear()},[p]),o&&!k)?(0,t.jsx)(f,{skeletonStyle:j}):(0,t.jsxs)(a.Combobox,{clearable:v,filter:function(e,t){let l=""===t?e:(0,r.matchSorter)(e,t,{keys:["value","label"]}),n=[];for(let e of U)l.find(t=>t.value===e)&&n.push(e);let a=[...new Set([...n,...l.map(e=>e.value)])],i=a.map(e=>{let t=l.find(t=>t.value===e);if(!t)throw Error("impossible state");return t});return _.current={values:a,query:D},i},loading:L||n,onChange:e=>{e===B?setTimeout(()=>{c?.(null),$.current?.clear(),I("")}):(i.analytics.track(s.AnalyticsEvent.DEPLOYMENT_OVERVIEW_FILTERS_BRANCH,{value:e}),I(e||""),c?.(e))},onChangeOpen:e=>{w(e)},placeholder:y||"All Branches…",ref:$,size:b,children:[(0,t.jsx)(a.Combobox.Input,{loading:L||n,onChange:e=>{""===e.target.value?I(""):C(e.target.value)}}),(0,t.jsx)(a.Combobox.List,{children:F.map((e,r)=>(0,t.jsx)(a.Combobox.Option,{value:e,children:e},D?e:`${e}${r}`))})]})});function f(e){let{skeletonStyle:r}=e;return(0,t.jsx)(n.Skeleton,{style:r||{height:40},width:"100%"})}e.s(["BranchSearchCombobox",()=>g],5598924)}]);

//# sourceMappingURL=8ae54ddea3f82709.js.map
//# debugId=bfca6dbb-65a9-5a5a-94db-c956b7e94d68
