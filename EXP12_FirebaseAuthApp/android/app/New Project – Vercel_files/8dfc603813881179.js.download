
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="fdd50fe6-9829-5755-839e-c11becd5d388")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6881271,e=>{e.v(JSON.parse('["aaa","aarp","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","link","live","living","lk","llc","llp","loan","loans","locker","locus","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mv","mw","mx","my","mz","na","nab","nagoya","name","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shell","shia","shiksha","shoes","shop","shopping","shouji","show","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermögensberater","vermögensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volvo","vote","voting","voto","voyage","vu","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","ελ","ευ","бг","бел","дети","ею","католик","ком","мкд","мон","москва","онлайн","орг","рус","рф","сайт","срб","укр","қаз","հայ","ישראל","קום","ابوظبي","ارامكو","الاردن","البحرين","الجزائر","السعودية","العليان","المغرب","امارات","ایران","بارت","بازار","بيتك","بھارت","تونس","سودان","سورية","شبكة","عراق","عرب","عمان","فلسطين","قطر","كاثوليك","كوم","مصر","مليسيا","موريتانيا","موقع","همراه","پاکستان","ڀارت","कॉम","नेट","भारत","भारतम्","भारोत","संगठन","বাংলা","ভারত","ভাৰত","ਭਾਰਤ","ભારત","ଭାରତ","இந்தியா","இலங்கை","சிங்கப்பூர்","భారత్","ಭಾರತ","ഭാരതം","ලංකා","คอม","ไทย","ລາວ","გე","みんな","アマゾン","クラウド","グーグル","コム","ストア","セール","ファッション","ポイント","世界","中信","中国","中國","中文网","亚马逊","企业","佛山","信息","健康","八卦","公司","公益","台湾","台灣","商城","商店","商标","嘉里","嘉里大酒店","在线","大拿","天主教","娱乐","家電","广东","微博","慈善","我爱你","手机","招聘","政务","政府","新加坡","新闻","时尚","書籍","机构","淡马锡","游戏","澳門","点看","移动","组织机构","网址","网店","网站","网络","联通","谷歌","购物","通販","集团","電訊盈科","飞利浦","食品","餐厅","香格里拉","香港","닷넷","닷컴","삼성","한국"]'))},9859596,e=>{e.v({$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0})},4350397,e=>{e.v({$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1})},3677672,e=>{"use strict";var t=e.i(3911483),a=e.i(5338940),n=e.i(277234),r=e.i(4244280),i=e.i(1717203),o=e.i(7557283),s=e.i(5328446);function l(e){let{team:l}=(0,a.useTeam)(),{can:c,isLoading:d}=(0,i.default)(),{data:u,isLoading:g}=(0,t.default)(l&&e?`${r.API_INTEGRATION_CONTROLLER}/installations/${e}/membership?teamId=${l.id}`:null,e=>(0,n.fetchAPI)(e,{throwOnHTTPError:!0})),{data:p,isLoading:m}=(0,s.default)(e),h=!!p?.deleteRequestedAt,b=u?.role==="ADMIN";return{isLoading:d||g||m,canCreateResource:c(o.Action.Create,o.Resource.IntegrationResource)&&b,canDeleteResource:c(o.Action.Delete,o.Resource.IntegrationResource)&&b,isDeleteRequested:h}}e.s(["useInstallationPermissions",()=>l])},1595844,e=>{"use strict";var t=e.i(6696646);e.i(6887680);var a=e.i(6810699),n=e.i(5074599),r=e.i(3758860);let i=["gray","red","rose","yellow","amber","green","lime","emerald","blue","lightBlue","cyan","purple","violet","fuchsia","orange","pink","indigo","teal","sky"],o=["apple","ball","car","dog","elephant","flower","garden","house","island","jacket","kite","lamp","mountain","notebook","ocean","park","queen","river","school","tree","umbrella","village","window","xylophone","yacht","zebra","book","chair","door","grass"];function s(){return`${l(i)}-${l(o)}`}function l(e){return e[Math.round((e.length-1)*Math.random())]}e.s(["MAX_RESOURCE_NAME_LENGTH",0,128,"MIN_RESOURCE_NAME_LENGTH",0,1,"generateRandomName",()=>s,"useResourceName",0,e=>{let{defaultName:i,projectName:o,product:s,resourceId:l}=e,[c,d]=(0,t.useState)(),[u,g]=(0,t.useState)(i??""),p=(0,r.getPrimaryProtocolByProduct)(s),{isNameTaken:m}=(0,a.useResourceList)({protocolType:p}),h=(0,n.getResourceTitleByProduct)(s);return(0,t.useEffect)(()=>{o&&o.length>0&&g(e=>""===e?[o.replaceAll("_","-").slice(0,128-h.length),h].join(""):e)},[o,h]),{resourceNameError:c,name:u,setName:(0,t.useCallback)(e=>{let t=e.trim();d(void 0),g(t),t.length<1?d("The name must be at least 1 characters."):t.length>128?d("The name must be at most 128 characters."):/^[a-zA-Z0-9_-\s]*$/.test(t)?m({name:t,storeType:"integration",productId:s.id,storeId:l})&&d(`This name is already in use by another ${h}`):d("The name can only contain letters, numbers, and the following characters: _ - ")},[m,s.id,l,h]),touched:u!==i,characterCount:u.length,isAtLimit:u.length>128}}])},2112997,e=>{e.v({checked:"switch-control-module__WvDOda__checked",container:"switch-control-module__WvDOda__container",control:"switch-control-module__WvDOda__control",disabled:"switch-control-module__WvDOda__disabled",icon:"switch-control-module__WvDOda__icon",large:"switch-control-module__WvDOda__large",small:"switch-control-module__WvDOda__small",text:"switch-control-module__WvDOda__text"})},1328457,e=>{e.v({hideBorder:"switch-module__idkRsq__hideBorder",large:"switch-module__idkRsq__large",small:"switch-module__idkRsq__small",switch:"switch-module__idkRsq__switch"})},8923565,e=>{"use strict";var t=e.i(6468255),a=e.i(6696646),n=e.i(9722978),r=e.i(9508212),i=e.i(5402816),o=e.i(1344973),s=e.i(2112997),l=e.i(1328457);let c=Object.assign((0,a.forwardRef)(function(e,i){let{className:o,size:s,name:c,children:d,hideBorder:u,checkedColor:g,...p}=e;return(0,t.jsx)(r.Stack,{className:(0,n.clsx)(o,l.default.switch,{[String(l.default.large)]:"large"===s,[String(l.default.small)]:"small"===s,[String(l.default.hideBorder)]:u}),direction:"row",...p,ref:i,children:a.Children.map(d,e=>(0,a.cloneElement)(e,{name:c,size:s,checkedColor:g}))})}),{Control:function(e){let{className:r,icon:l,label:c,size:d,checked:u,disabled:g,checkedColor:p="var(--ds-gray-100)",innerDivClassName:m,...h}=e,b=void 0!==l,f=(0,n.clsx)(s.default.control,{[String(s.default.disabled)]:g,[String(s.default.checked)]:u,[String(s.default.large)]:"large"===d,[String(s.default.small)]:"small"===d,[String(s.default.text)]:!b,[String(s.default.icon)]:b}),x=l?(0,t.jsxs)(t.Fragment,{children:[(0,a.cloneElement)(l,{size:"large"===d?20:16}),(0,t.jsx)("span",{className:"geist-sr-only",children:c})]}):c;return"href"in h&&void 0!==h.href?g?(0,t.jsx)(o.Text,{as:"span",className:f,style:{"--switch-checked-color":p},children:x}):(0,t.jsx)(i.default,{className:f,href:h.href,onClick:h.onClick,prefetch:h.prefetch,scroll:!1,style:{"--switch-checked-color":p},children:x}):(0,t.jsxs)("label",{className:(0,n.clsx)(s.default.container,r),"data-disabled":g?"true":"false",children:[(0,t.jsx)("input",{...h,checked:u,className:"geist-sr-only",disabled:g,type:"radio"}),(0,t.jsx)("div",{className:(0,n.clsx)(f,m),style:{"--switch-checked-color":p},children:x})]})}});e.s(["Switch",0,c],8923565)},2782729,e=>{"use strict";var t=e.i(2704354),a=e.i(3798983);function n(e){let{start:t,end:a}=e;return t&&a&&a-t>31536e6?{start:t,end:t+31536e6}:{start:t,end:a}}function r(e,t){let n="";return"integration"===e?t?.type==="integration"&&(n=t.product.name):n=a.storeTitleFull[e],n}function i(e){return"integration"===e.type?e.product.iconUrl:void 0}function o(e){return void 0!==e&&e.length>0}function s(e){return"oac_3sK3gnG06emjIEVL09jjntDD"===e.id&&(0,t.isMarketplaceIntegration)(e)}function l(e){let{integration:t,storesData:a}=e;return!1}function c(e){let{teamSlug:t,projectSlug:a}=e;return a?`/${t}/${a}/stores`:`/${t}/~/stores`}e.s(["getStoreIcon",()=>i,"getStoreOverviewPath",()=>c,"getStoreTitle",()=>r,"hasProjectSlug",()=>o,"isIntegrationStoreDisabled",()=>l,"isNeonIntegration",()=>s,"maximumOneYearRange",()=>n])},3288889,e=>{"use strict";function t(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];let r=[];for(let t=0;t<e.length;t++){let n=e[t];if(n&&r.push(n),e.length===a.length||t<e.length-1){let e=a[t];if(!e){r=[];break}r.push(e)}}return r.length?r.join(""):""}e.s(["emptyStringFallback",()=>t])},9906957,e=>{"use strict";var t=e.i(6696646),a=e.i(1991452);e.i(3182268);var n=e.i(7849855),r=e.i(3288889),i=e.i(2782729);function o(e){let{projectSlug:t,teamSlug:a}=(0,n.useProjectAndTeamSlug)(),r=e?e.overrideTeamSlug:a,o=e?e.overrideProjectSlug:t;return(0,i.getStoreOverviewPath)({teamSlug:r??"",projectSlug:o})}function s(e,t){let{baseDetailPath:a,path:n}=t;return"integration"===e.type?r.emptyStringFallback`${a.replace("/stores","/integrations")}/${e.product.integration.slug}/${e.product.integrationConfigurationId}/resources/storage/${e.id}/${n}`:r.emptyStringFallback`${a}/${e.type}/${e.id}/${n}`}function l(e){let{id:t,path:a,baseDetailPath:n,type:i,integrationSlug:o}=e;return"integration"===i?r.emptyStringFallback`${n}/${i}/${o}/${t}/${a}`:r.emptyStringFallback`${n}/${i}/${t}/${a}`}function c(){let e=(0,a.useRouter)(),n=o(),r=(0,t.useCallback)(t=>e.push(l({baseDetailPath:n,...t})),[e,n]),i=(0,t.useCallback)(e=>{switch(e.type){case"blob":r({id:e.id,path:"guides",type:e.type});break;case"integration":r({id:e.id,path:"guides",type:e.type,integrationSlug:e.product.integration.slug});break;case"edge-config":r({id:e.id,path:"items",type:"edge-config"})}},[r]);return{storeOverviewPath:n,pushToDetailPath:r,handleResourceModalSucceeded:i}}e.s(["getPathByType",0,e=>{switch(e){case"edge-config":default:return"items";case"blob":return"browser";case"integration":return"guides"}},"getStoreDetailPath",()=>l,"getStoreDetailPathResource",()=>s,"usePushToStorePath",()=>c,"useStoreOverviewPath",()=>o])},6356390,e=>{"use strict";var t=e.i(6468255),a=e.i(6696646),n=e.i(6891161),r=e.i(8522580),i=e.i(8735244),o=e.i(5338940),s=e.i(9544652),l=e.i(8711152),c=e.i(3677672),d=e.i(3798983),u=e.i(9906957),g=e.i(5074599);e.i(2331088);var p=e.i(545169),m=e.i(6817234),h=e.i(9623675),b=e.i(9508212),f=e.i(1344973),x=e.i(57106),y=e.i(119294),k=e.i(6352514),j=e.i(1717203),v=e.i(7557283),w=e.i(277234),S=e.i(4244280);async function C(e){let{integrationId:t,teamId:a,source:n,acceptedPolicies:r,metadata:i,billingPlanId:o,authorizationId:s}=e,l=new URLSearchParams;a&&l.append("teamId",a);let c=l.toString();return await (0,w.fetchAPI)(`${S.API_INTEGRATION_CONTROLLER_V2}/integration/${t}/marketplace/install${c?`?${c}`:""}`,{method:"POST",body:{acceptedPolicies:r,source:n??"marketplace",metadata:i,billingPlanId:o,authorizationId:s},throwOnHTTPError:!0})}var I=e.i(9186321),P=e.i(2512825),M=e.i(3788585),N=e.i(4030453),T=e.i(4004502);e.i(553769);var A=e.i(3758860),R=e.i(2557188),L=e.i(1914640),E=e.i(373291);function B(e){let{integration:r,product:i,cancelLabel:o,onBack:s,onNext:l,isLoading:c=!1,isTransitioning:d}=e,{hasMetadataErrors:u,isLoading:g,metadataState:f,areMetadataChanged:x}=(0,E.useStoreIntegrationFormContext)(),{plan:y,isBillingPlanSelectionValid:k}=(0,m.useMarketplaceBillingPlansContext)(),j=(0,a.useMemo)(()=>Object.keys(r.metadataSchema?.properties??{}).length>0,[r]);return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,T.tid)("create-integration-button","store-modal-continue"),disabled:u||!y||!k||c,loading:g||d,onClick:()=>{y&&l(f,y)},children:"Continue"}),cancelLabel:o,checkoutContentVariant:"default",from:"installation",integration:r,onBack:s,product:i,children:(0,t.jsxs)(b.Stack,{gap:5,children:[j?(0,t.jsx)(b.Stack,{className:"border-0 border-b border-solid border-gray-alpha-400 bg-background-200 p-6 px-0",children:(0,t.jsx)(p.ResourceMetadataFieldsWithErrorBoundary,{integrationId:r.id,isLoading:c,productId:"iap_none"})}):null,(0,t.jsx)(b.Stack,{paddingY:6,children:u?(0,t.jsx)(R.BillingPlanMetadataErrors,{integrationSlug:r.slug,isInstallationLevel:!0}):(0,t.jsx)(R.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:x,arePermissionsLoading:!1,hasLogDrainsSupport:r.products.some(e=>(0,A.isProtocolSupported)(e,"logDrain")),integrationId:r.id,integrationName:r.name,integrationSlug:r.slug,isInstallationLevel:!0,metadata:f,type:"new-installation"})})]})})}function _(e){let{integration:a,product:r,onBack:i,onNext:o,isTransitioning:s}=e,{isLoading:l,metadataState:c,formError:d}=(0,E.useStoreIntegrationFormContext)(),{plan:u}=(0,m.useMarketplaceBillingPlansContext)();return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsxs)(n.Modal.Action,{"data-testid":(0,T.tid)("create-integration-button","store-modal-create"),loading:l||s,onClick:o,children:["Create ",(0,g.getAccountTitleBySlug)({slug:r.slug})]}),cancelLabel:"Back",checkoutContentVariant:"no-padding",from:"installation",integration:a,onBack:i,product:r,children:(0,t.jsxs)(b.Stack,{gap:4,padding:6,children:[(0,t.jsx)(f.Text,{size:16,weight:500,children:"Your Selection"}),d.form?(0,t.jsx)(N.Error,{children:d.form}):null,(0,t.jsx)(L.ReadOnlyMetadataWithErrorBoundary,{integrationId:a.id,metadata:c,metadataErrors:d.metadata,productId:r.id,target:"create"}),(0,t.jsx)(L.ReadOnlyBillingPlan,{billingPlan:u})]})})}var $=e.i(9588822),O=e.i(8843717),D=e.i(1008179),z=e.i(6111613);function F(e){let{team:a,requireNew:n,paymentMethodState:r,onBack:i,onNext:o}=e;return(0,t.jsx)(z.PaymentMethodAction,{onBack:i,onNext:o,paymentMethodState:r,requireNew:n,team:a})}var U=e.i(2504781),q=e.i(762945),W=e.i(5761705),V=e.i(4987761);function K(e){let{teamId:a,integration:r,authorizationId:i,onChangePaymentMethod:o,onBack:s,onNext:l,product:c,success:d,error:u,isTransitioning:g}=e,{authorization:p,error:m,handleUserActions:f}=(0,V.usePollAuthorization)(a,i),x=!!(m||u||p?.status==="failed"),y=p?.status==="requires_action";return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{disabled:!d,loading:!x&&!d||g,onClick:()=>l(),children:d?"Done":"Processing"}),cancelLabel:"Back",checkoutContentVariant:"no-padding-no-bottom",hideCancel:!(x||y)||d,from:"resource",integration:r,onBack:s,product:c,children:(0,t.jsx)(b.Stack,{gap:4,padding:6,paddingBottom:0,children:(0,t.jsx)(G,{authorization:p,error:u||(m?"Unknown error":void 0),handleUserActions:f,integration:r,onChangePaymentMethod:o,success:d})})})}function G(e){let{authorization:a,error:n,success:r,integration:o,handleUserActions:s,onChangePaymentMethod:l}=e;return r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(W.CheckCircle,{color:"green-900",size:16}),(0,t.jsxs)(f.Text,{color:"green-900","data-testid":(0,T.tid)("create-resource-modal","successfully-created"),weight:500,children:[o.name," Account Created Successfully"]})]}),(0,t.jsxs)(f.Text,{className:"text-gray-900",children:["Your"," ",(0,t.jsx)(f.Text,{as:"span",className:"text-gray-1000",children:o.name})," ","account has been created successfully."]})]}):a?.status==="requires_action"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(q.Warning,{color:"amber-900",size:16}),(0,t.jsx)(f.Text,{color:"amber-900",weight:500,children:"Authentication Needed"})]}),(0,t.jsx)(f.Text,{className:"text-gray-900",children:"Further action is needed. Please authenticate your payment method to continue."}),(0,t.jsx)(U.Button,{onClick:()=>{s()},children:"Authenticate"})]}):a?.status==="failed"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Error,{children:"Preauthorization Failed"}),(0,t.jsx)(f.Text,{className:"text-gray-900",children:"There was an error using your payment method. Please try again with a different payment method."}),(0,t.jsx)(U.Button,{onClick:()=>l(),children:"Change Payment Method"})]}):n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Error,{children:n}),(0,t.jsxs)(f.Text,{className:"text-gray-900",children:["There was an error creating your"," ",(0,t.jsx)(f.Text,{as:"span",className:"text-gray-1000",children:o.name})," ","account. Please try again later."]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Spinner,{size:16}),(0,t.jsx)(f.Text,{size:16,weight:500,children:"Processing"})]}),(0,t.jsxs)(f.Text,{className:"text-gray-900",children:["Almost ready, we're setting up your"," ",(0,t.jsx)(f.Text,{as:"span",className:"text-gray-1000",children:o.name}),"."]})]})}var H=e.i(8794163);function Y(e){let{product:a,cancelLabel:n,integration:i,isLoading:o,onSuccess:s,onBack:l,team:c,checkoutContentVariant:d}=e,u=c.enabledInvoiceItems?.vercelMarketplace?.enabled===!0,{can:g,isLoading:p}=(0,j.default)({teamId:c.id}),m=g(v.Action.Create,v.Resource.IntegrationConfiguration);return u?m||p?(0,t.jsx)(Z,{isLoading:o,cancelLabel:n,integration:i,product:a,team:c,onBack:l,onSuccess:s}):(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(P.InstallButton,{account:c,canInstall:!1,hasPermission:!1,onClick:()=>{},children:"Continue"}),cancelLabel:n,checkoutContentVariant:d,from:"installation",integration:i,onBack:l,product:a,children:(0,t.jsx)(b.Stack,{gap:4,children:(0,t.jsxs)(r.Note,{type:"warning",children:["You need additional permissions to install integrations to"," ",c.name||"this"," account. Please contact your account administrator to request the necessary permissions."," ",(0,t.jsx)(x.Link,{external:!0,href:"https://vercel.com/docs/accounts/team-members-and-roles",target:"_blank",children:(0,t.jsx)(f.Text,{children:"Learn more"})})]})})}):(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(x.ButtonLink,{href:"/contact/sales",children:"Contact Sales"}),cancelLabel:n,checkoutContentVariant:d,from:"installation",integration:i,onBack:l,product:a,children:(0,t.jsx)(b.Stack,{gap:4,style:{minHeight:0},children:(0,t.jsx)(r.Note,{type:"warning",children:"Your Enterprise account is not yet available to use the Vercel Marketplace. To gain access, contact our team to discuss an account upgrade."})})})}function X(e){let{team:n,integration:r,product:i,isLoading:o,cancelLabel:s,onBack:l,onSuccess:c}=e,[d,u]=(0,a.useState)("policies"),{onSubmit:g,metadataState:p,formError:b,isLoading:f}=(0,E.useStoreIntegrationFormContext)(),x=r.flags?.includes(I.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{plan:j}=(0,m.useMarketplaceBillingPlansContext)(),[v,w]=(0,a.useState)(!1),{data:S}=(0,O.useIntegrationPaymentMethodState)(),N=(0,D.useAwaitData)(S),[T,A]=(0,a.useState)(),{createAuthorization:R}=(0,V.useMarketplaceBillingAuthorizationApi)(),L=(0,V.useAwaitAuthorization)(),[$,U]=(0,a.useState)(null),[q,W]=(0,a.useTransition)(),[G,Y]=(0,a.useState)(),{connectProjectAndReturnToV0:X}=(0,H.useV0Marketplace)()||{},J=e=>{if(G)return void c(G,j??void 0);let t=X?"v0":"marketplace";y.analytics.track(k.AnalyticsEvent.MARKETPLACE_INSTALLATION_CREATE_CLICKED,{integration:{id:r.id,slug:r.slug},source:t});let a=e.paymentMethodId??T;j&&u("provisioning"),g(async()=>{let e,i={},o=new Date().toISOString();if(r.eulaDocUri&&(i.eula=o),r.privacyDocUri&&(i.privacy=o),j){let t=await R(n.id,{integrationIdOrSlug:r.id,billingPlanId:j.id,metadata:p,integrationConfigurationId:void 0,paymentMethodId:a});if(U(t?.id??null),e=t?.id,t&&"succeeded"!==(await L(n.id,t.id)).status)return}let s=await C({integrationId:r.id,teamId:n.id,acceptedPolicies:i,metadata:p,billingPlanId:j?.id,authorizationId:e,source:t});Y(s),a&&await (0,O.updateInstallationPaymentMethod)(n.id,s.id,a),c(s,j??void 0)})},Z=`Accept and ${x?"Continue":"Create"}`;switch(d){case"policies":return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(P.InstallButton,{account:n,canInstall:!0,hasPermission:!0,loading:o||q||f,onClick:()=>{x?u("select-plan"):J({paymentMethodId:void 0})},children:Z}),cancelLabel:s,checkoutContentVariant:"default",from:"installation",integration:r,onBack:l,product:i,children:(0,t.jsx)(M.TermsAndConditions,{buttonCaption:Z,integrations:[r]})});case"select-plan":return(0,t.jsx)(B,{cancelLabel:"Back",integration:r,isLoading:o,isTransitioning:q,onBack:()=>u("policies"),onNext:function(){W(async()=>{if(j?.paymentMethodRequired){let e=await N;if((0,z.getIsPaymentMethodStepNeeded)(n,e,j))return void u("payment-method")}u("confirm-plan")})},product:i});case"confirm-plan":return(0,t.jsx)(_,{integration:r,isTransitioning:q,onBack:()=>u("select-plan"),onNext:function(){y.analytics.track(k.AnalyticsEvent.MARKETPLACE_INSTALLATION_PLAN_SELECTED,{integration:{id:r.id,slug:r.slug}}),J({paymentMethodId:T})},product:i});case"payment-method":return S?(0,t.jsx)(F,{onBack:()=>u("confirm-plan"),onNext:e=>{A(e),w(!1),u("confirm-plan")},paymentMethodState:S,requireNew:v,team:n}):null;case"provisioning":return(0,t.jsx)(K,{authorizationId:$,error:b.form??void 0,integration:r,isTransitioning:q,onBack:()=>u("confirm-plan"),onChangePaymentMethod:()=>{w(!0),u("payment-method")},onNext:()=>{G&&j&&c(G,j)},product:i,success:!!G,teamId:n.id})}}let J={type:"object",properties:{},additionalProperties:!1,required:[]},Z=(0,$.withStripe)(function(e){return(0,t.jsx)(m.MarketplaceInstallationBillingPlansProvider,{target:"create",children:(0,t.jsx)(p.ResourceFormProvider,{metadataSchema:e.integration.metadataSchema??J,resourceTitle:"Account",target:"create",children:(0,t.jsx)(X,{...e})})})});var Q=e.i(455575),ee=e.i(9100551),et=e.i(5033426),ea=e.i(9219571),en=e.i(9349058),er=e.i(9722978),ei=e.i(5328446),eo=e.i(1906681),es=e.i(5684165);function el(e){let[n,r]=(0,a.useState)(void 0);return{protocolSettingsForm:(0,a.useMemo)(()=>{if("protocols"in e&&e.protocols.experimentation?.edgeConfigSyncingSupport){let e=n?.experimentation?.edgeConfigSyncingEnabled??!1;return(0,t.jsx)(b.Stack,{gap:2,children:(0,t.jsx)(es.IntegrationResourceFormControlWithDescription,{controlKey:"",description:(0,t.jsxs)(t.Fragment,{children:["Synchronizes integration data with Edge Config for ultra-low latency resolution. Additional costs may apply for Edge Config usage."," ",(0,t.jsx)(x.Link,{external:!0,href:"https://vercel.com/docs/integrations/marketplace-flows#experimentation-edge-config-syncing",variant:"highlight",children:"Learn more"})]}),children:(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsx)(eo.Toggle,{checked:e,onChange:e=>{r(t=>({...t,experimentation:{...t?.experimentation,edgeConfigSyncingEnabled:e}}))},size:"large"}),(0,t.jsx)(f.Text,{color:"gray-900",weight:500,children:"Enable Edge Config Syncing"})]})})})}return null},[e,n,r]),protocolSettings:n}}var ec=e.i(6835270),ed=e.i(6143247);function eu(e){let{product:a,integration:n,installationId:r,cancelLabel:i,onBack:o,onNext:s,isLoading:l,isTransitioning:c,...d}=e;return(0,t.jsx)(eg,{cancelLabel:i,installationId:r,integration:n,isLoading:l,isTransitioning:c,onBack:o,onNext:s,product:a,...d})}function eg(e){let{product:r,integration:i,installationId:o,cancelLabel:s,onBack:l,onNext:c,isLoading:d,isTransitioning:u,...g}=e,f=i.flags?.includes(I.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{hasMetadataErrors:x,isLoading:y,metadataState:k,areMetadataChanged:j,target:v}=(0,E.useStoreIntegrationFormContext)(),{plan:w,isSelectedPlanValid:S,isBillingPlanPreselected:C}=(0,m.useMarketplaceBillingPlansContext)(),P=(0,a.useMemo)(()=>Object.keys(r.metadataSchema.properties).length>0,[r]),M=i.supportsInstallationBillingPlans??!1,{protocolSettings:N,protocolSettingsForm:L}=el(r),{data:B}=(0,ei.default)(o),_=f||w&&S,$=(0,ec.useInstallMarketplaceProductDisplayMode)();return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,T.tid)("create-integration-button","store-modal-create"),disabled:x||!_||d,loading:y||u,onClick:()=>{let e=w??(M?B?.billingPlan:void 0);e&&c(k,e,N)},children:"create"===v?"Continue":"Save"}),cancelLabel:s,checkoutContentVariant:"no-padding",from:"resource",integration:i,onBack:l,product:r,children:(0,t.jsxs)(b.Stack,{gap:5,children:[P?(0,t.jsx)(b.Stack,{className:(0,ed.cn)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200",{"p-6":"modal"===$,"pb-6":"inline"===$}),children:(0,t.jsx)(p.ResourceMetadataFieldsWithErrorBoundary,{integrationId:i.id,isLoading:d,productId:r.id})}):null,L?(0,t.jsx)(b.Stack,{className:(0,er.clsx)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200 px-6",{"pb-6 pt-0":P,"py-6":!P},"inline"===$?" !px-0 pt-0":""),children:L}):null,C||f?null:(0,t.jsx)(b.Stack,{padding:6*("modal"===$),children:x?(0,t.jsx)(R.BillingPlanMetadataErrors,{integrationSlug:i.slug,isInstallationLevel:M}):(0,t.jsx)(R.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:j,arePermissionsLoading:d,hasLogDrainsSupport:(0,A.isProtocolSupported)(r,"logDrain"),installationId:o,integrationId:i.id,integrationName:i.name,integrationSlug:i.slug,isInstallationLevel:M,metadata:k,productId:r.id,...g})})]})})}var ep=e.i(3500331),em=e.i(4585051),eh=e.i(5468328),eb=e.i(3322724),ef=e.i(1595844),ex=e.i(1571992),ey=e.i(6060673);function ek(e){let{team:i,integration:o,installationBalance:s,product:l,onBack:c,onNext:d,source:u,projectId:p}=e,w=o.flags?.includes(I.LaunchDarklyIntegrationFlags.MarketplaceInstallationOnlyPlan),{isLoading:S,formError:C,metadataState:P}=(0,E.useStoreIntegrationFormContext)(),{plan:M,defaultPlan:R,topUpForm:B,shouldAddTopUpFormStep:_}=(0,m.useMarketplaceBillingPlansContext)(),$=(0,a.useMemo)(()=>{let e=l.slug.toLowerCase(),t=Object.entries(l.metadataSchema?.properties||{}).find(e=>{let[t,a]=e;return"git-namespace"===a["ui:control"]});if(t&&P[t[0]]){let a=P[t[0]];if(a&&"string"==typeof a){let t=(0,ex.stringToGitNamespace)(a);t&&(e+=`-${t.slug}`)}}return`${e}-${(0,ef.generateRandomName)()}`},[l,P]),O=(0,g.getResourceNameLabelByProduct)(l),{name:D,setName:z,resourceNameError:F,characterCount:U,isAtLimit:q}=(0,ef.useResourceName)({product:l,defaultName:$}),W=(0,a.useRef)(null),[V,K]=(0,a.useState)(!1),G=(0,eb.useIsMobile)();(0,a.useEffect)(()=>{G||setTimeout(()=>{W.current?.focus(),W.current?.select()},0)},[G]);let H=!!(R&&M?.id!==R.id),Y=(0,ec.useInstallMarketplaceProductDisplayMode)(),{data:X}=(0,ey.useProject)(p),{can:J}=(0,j.default)(),Z=J(v.Action.Create,v.Resource.Drain),Q=(0,A.isProtocolSupported)(l,"traceDrain"),ee=(0,A.hasFreeBillingPlan)(i),et=Q&&Z&&!ee&&!!p,[ea,en]=(0,a.useState)(et);return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,T.tid)("create-resource-modal","confirm-create"),disabled:!D,loading:S,onClick:()=>{if(K(!0),F)return;let e={integration:{id:o.id,slug:o.slug},productSlug:l.slug},t=u?{...e,source:u}:e;y.analytics.track(k.AnalyticsEvent.MARKETPLACE_RESOURCE_PROVISION_CLICKED,t);let a=et&&ea&&p?{name:`${D}-${Math.random().toString(36).substring(2,8).toLowerCase()}`,projects:"some",projectIds:[p],sampling:[],schemas:{trace:{version:"v1"}}}:void 0;d({resourceName:D,createDrainPayload:a})},children:(0,g.createResourceConfirmationStepLabel)(l)}),cancelLabel:"Back",checkoutContentVariant:"no-padding",from:"resource",integration:o,onBack:c,product:l,children:(0,t.jsxs)(b.Stack,{gap:5,children:[(0,t.jsxs)(b.Stack,{className:"inline"===Y?"bg-background-200":"border-0 border-b border-solid border-gray-alpha-400 bg-background-200 p-6",gap:2.5,children:[(0,t.jsxs)(b.Stack,{gap:1,children:[(0,t.jsx)(ep.Input,{"aria-label":`${O} Name`,disabled:S,error:V?F:void 0,label:`${O} Name (*)`,maxLength:ef.MAX_RESOURCE_NAME_LENGTH+1,minLength:ef.MIN_RESOURCE_NAME_LENGTH,onChange:e=>{z(e.currentTarget.value)},placeholder:`${O.toLowerCase().replaceAll(" ","-")}-name`,ref:W,value:D,width:"100%"}),(0,t.jsxs)(f.Text,{color:q?"red-900":"gray-900",size:12,style:{textAlign:"right"},children:[U,"/",ef.MAX_RESOURCE_NAME_LENGTH]})]}),(0,t.jsxs)(f.Text,{color:"gray-900",size:13,children:["This is how we call your ",O," in the Vercel dashboard and in ",o.name,"."]}),l.disableResourceRenaming&&(0,t.jsx)(r.Note,{fill:!0,type:"warning",children:"The name cannot be changed after the resource is created."})]}),(0,t.jsxs)(b.Stack,{gap:4,paddingX:6*("inline"!==Y),paddingY:6,children:[(0,t.jsx)(f.Text,{size:16,weight:500,children:"Your Selection"}),H?(0,t.jsx)(r.Note,{fill:!0,type:"secondary",children:"You have selected to upgrade your plan. This upgrade will apply at the installation level."}):null,C.form?(0,t.jsx)(N.Error,{children:C.form}):null,(0,t.jsx)(L.ReadOnlyMetadataWithErrorBoundary,{integrationId:o.id,metadata:P,metadataErrors:C.metadata,productId:l.id,target:"create"}),_&&void 0!==B.getAmountToAdd()?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(L.ReadOnlyPanel,{title:"Manage Funds",children:[(0,t.jsx)(L.ReadOnlyPanelRecord,{title:"Initial credit balance",children:(0,t.jsx)(f.Text,{children:B.formatCurrency(B.addFundsForm.getValues().amountToAdd)})}),B.rechargeSettingsForm.getValues().autoRecharge?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(L.ReadOnlyPanelRecord,{align:"center",title:"Auto recharge",titleWrap:!1,children:(0,t.jsxs)(f.Text,{color:"gray-900",align:"right",className:"text-balance",children:["add"," ",(0,t.jsx)(f.Text,{as:"span",children:B.formatCurrency(B.rechargeSettingsForm.getValues().topUpAmount)})," ","when balance falls below"," ",(0,t.jsx)(f.Text,{as:"span",children:B.formatCurrency(B.rechargeSettingsForm.getValues().topUpThreshold)}),", up to"," ",(0,t.jsx)(f.Text,{as:"span",children:B.formatCurrency(B.rechargeSettingsForm.getValues().periodSpendMaximum)})," ","per month"]})})}):null]})}):(0,t.jsx)(t.Fragment,{children:s?.currencyValueInCents!==void 0?(0,t.jsx)(L.ReadOnlyPanel,{title:(0,t.jsx)(f.Text,{weight:500,children:"Current balance"}),children:(0,t.jsx)(L.ReadOnlyPanelRecord,{title:"Current installation balance",children:(0,t.jsx)(f.Text,{children:B.formatCurrency((s.currencyValueInCents/100).toFixed(2))})})}):null}),w?null:(0,t.jsx)(L.ReadOnlyBillingPlan,{billingPlan:M}),et&&X?(0,t.jsxs)("div",{className:"flex w-full flex-col items-start gap-1",children:[(0,t.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,t.jsx)(eo.Toggle,{checked:ea,onChange:e=>en(e)}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-1 text-sm",children:[(0,t.jsx)("span",{className:"shrink-0 whitespace-nowrap",children:"Drain traces from"}),(0,t.jsx)(em.Avatar,{hash:X.id,size:16,className:"shrink-0"}),(0,t.jsx)(eh.Tooltip,{text:X.name,className:"min-w-0 max-w-full flex-shrink inline-flex items-center overflow-hidden",children:(0,t.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:X.name})}),(0,t.jsx)("span",{className:"shrink-0 whitespace-nowrap",children:"to this product"})]})]}),(0,t.jsx)("div",{className:"text-gray-900",children:(0,t.jsx)(x.Link,{href:"/docs/drains#usage-and-pricing",target:"_blank",underline:!0,children:"Learn about Drains pricing"})})]}):null]})]})})}function ej(e){let{integration:i,product:o,onBack:s,onNext:l,cancelLabel:c,installationId:d}=e,{hasMetadataErrors:u,isLoading:x,metadataState:j,areMetadataChanged:v,formError:w}=(0,E.useStoreIntegrationFormContext)(),{plan:S,isSelectedPlanValid:C,isBillingPlanPreselected:I}=(0,m.useMarketplaceBillingPlansContext)();(0,ei.default)(d);let P=(0,a.useMemo)(()=>Object.keys(o.metadataSchema.properties).length>0,[o]),M=i.supportsInstallationBillingPlans??!1,{protocolSettings:L,protocolSettingsForm:B}=el(o),_=(0,a.useMemo)(()=>{let e=o.slug.toLowerCase(),t=Object.entries(o.metadataSchema?.properties||{}).find(e=>{let[t,a]=e;return"git-namespace"===a["ui:control"]});if(t&&j[t[0]]){let a=j[t[0]];if(a&&"string"==typeof a){let t=(0,ex.stringToGitNamespace)(a);t&&(e+=`-${t.slug}`)}}return`${e}-${(0,ef.generateRandomName)()}`},[o,j]),$=(0,g.getResourceNameLabelByProduct)(o),O=(0,a.useMemo)(()=>"ab-12-aws"===i.slug?`${o.slug.toLowerCase()}-`:"",[i.slug,o.slug]),{name:D,setName:z,resourceNameError:F,characterCount:U,isAtLimit:q}=(0,ef.useResourceName)({product:o,defaultName:_}),[W,V]=(0,a.useState)(()=>"ab-12-aws"===i.slug&&D.startsWith(O)?D.slice(O.length):D);(0,a.useEffect)(()=>{"ab-12-aws"===i.slug&&z(`${O}${W}`)},[i.slug,O,W,z]);let K=(0,a.useRef)(null),[G,H]=(0,a.useState)(!1),Y=(0,eb.useIsMobile)();(0,a.useEffect)(()=>{Y||setTimeout(()=>{K.current?.focus(),K.current?.select()},0)},[Y]);let X=(0,ec.useInstallMarketplaceProductDisplayMode)(),J=S&&C;return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{"data-testid":(0,T.tid)("create-resource-modal","combined-create"),disabled:u||!J||!D,loading:x,onClick:()=>{H(!0),!F&&S&&(y.analytics.track(k.AnalyticsEvent.MARKETPLACE_RESOURCE_PROVISION_CLICKED,{integration:{id:i.id,slug:i.slug},productSlug:o.slug}),l(D,j,S,L))},children:(0,g.createResourceConfirmationStepLabel)(o)}),cancelLabel:c,checkoutContentVariant:"no-padding",from:"resource",integration:i,onBack:s,product:o,children:(0,t.jsxs)(b.Stack,{gap:5,children:[P?(0,t.jsx)(b.Stack,{className:(0,ed.cn)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200",{"p-6":"modal"===X,"pb-6":"inline"===X}),children:(0,t.jsx)(p.ResourceMetadataFieldsWithErrorBoundary,{integrationId:i.id,isLoading:!1,productId:o.id})}):null,B?(0,t.jsx)(b.Stack,{className:(0,ed.cn)("border-0 border-b border-solid border-gray-alpha-400 bg-background-200 px-6",{"pb-6 pt-0":P,"py-6":!P},"inline"===X?" !px-0 pt-0":""),children:B}):null,(0,t.jsxs)(b.Stack,{className:"inline"===X?"bg-background-200":"border-0 border-b border-solid border-gray-alpha-400 bg-background-200 p-6",gap:2.5,children:[(0,t.jsxs)(b.Stack,{gap:1,children:["ab-12-aws"===i.slug?(0,t.jsxs)(b.Stack,{gap:1,children:[(0,t.jsxs)(f.Text,{as:"label",color:"gray-900",size:12,style:{textTransform:"none"},weight:500,children:[$," Name (*)"]}),(0,t.jsxs)(b.Stack,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:"flex items-center rounded-l border border-solid border-gray-400 bg-gray-100 px-3",style:{borderRight:"none",flexShrink:0,whiteSpace:"nowrap"},children:(0,t.jsx)(f.Text,{color:"gray-900",children:O})}),(0,t.jsx)(ep.Input,{"aria-label":`${$} Name Suffix`,disabled:x,error:G?F:void 0,maxLength:ef.MAX_RESOURCE_NAME_LENGTH-O.length+1,minLength:ef.MIN_RESOURCE_NAME_LENGTH,onChange:e=>{V(e.currentTarget.value)},placeholder:"name",ref:K,style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,flex:1},value:W,width:"100%"})]})]}):(0,t.jsx)(ep.Input,{"aria-label":`${$} Name`,disabled:x,error:G?F:void 0,label:`${$} Name (*)`,maxLength:ef.MAX_RESOURCE_NAME_LENGTH+1,minLength:ef.MIN_RESOURCE_NAME_LENGTH,onChange:e=>{z(e.currentTarget.value)},placeholder:`${$.toLowerCase().replaceAll(" ","-")}-name`,ref:K,value:D,width:"100%"}),(0,t.jsxs)(f.Text,{color:q?"red-900":"gray-900",size:12,style:{textAlign:"right"},children:[U,"/",ef.MAX_RESOURCE_NAME_LENGTH]})]}),(0,t.jsxs)(f.Text,{color:"gray-900",size:13,children:["This is how we call your ",$," in the Vercel dashboard and in ",i.name,"."]}),o.disableResourceRenaming&&(0,t.jsx)(r.Note,{fill:!0,type:"warning",children:"The name cannot be changed after the resource is created."})]}),I?null:(0,t.jsx)(b.Stack,{className:(0,ed.cn)("border-0 border-b border-solid border-gray-alpha-400",{"px-6 pb-6":"modal"===X,"pb-6":"inline"===X}),children:u?(0,t.jsx)(R.BillingPlanMetadataErrors,{integrationSlug:i.slug,isInstallationLevel:M}):(0,t.jsx)(R.MarketplaceBillingPlanSelectorWithErrorBoundary,{areMetadataChanged:v,arePermissionsLoading:!1,hasLogDrainsSupport:(0,A.isProtocolSupported)(o,"logDrain"),installationId:d,integrationId:i.id,integrationName:i.name,integrationSlug:i.slug,isInstallationLevel:M,metadata:j,productId:o.id,type:"product"})}),w.form?(0,t.jsx)(b.Stack,{paddingX:6*("inline"!==X),children:(0,t.jsx)(N.Error,{children:w.form})}):null]})})}function ev(e){let{team:a,configuration:n,requireNew:r,paymentMethodState:i,onBack:o,onNext:s}=e;return(0,t.jsx)(z.PaymentMethodInstallationAction,{installationId:n.id,onBack:o,onNext:s,paymentMethodState:i,requireNew:r,team:a})}var ew=e.i(2083276);e.i(6887680);var eS=e.i(5779481),eC=e.i(4011256),eI=e.i(397510),eP=e.i(7114720);e.i(6483798);var eM=e.i(8287059);function eN(e){let{success:t,onboardingRequired:a,modalDisplayMode:n,drainAddedAfterCreation:r,createdResource:i}=e;return t&&!a&&"inline"===n&&!r&&null!=i&&"integration"===i.type&&(0,A.supportsAnyDrainProtocol)(i.product)}function eT(e){let{success:t,onboardingRequired:a,modalDisplayMode:n,drainAddedAfterCreation:r,createdResource:i,isFreePlan:o}=e;return o&&eN({success:t,onboardingRequired:a,modalDisplayMode:n,drainAddedAfterCreation:r,createdResource:i})}function eA(e){let{team:r,authorizationId:i,onChangePaymentMethod:s,onBack:l,onNext:c,onSkipOnboarding:d,integration:u,product:p,resourceName:m,success:b,isTransitioning:f,createdResource:x,createdDrain:y}=e,k=(0,ee.useRouter)(),[j,v]=(0,a.useState)(!1),{authorization:w,error:S,handleUserActions:C}=(0,V.usePollAuthorization)(r.id,i),{formError:I}=(0,E.useStoreIntegrationFormContext)(),P=!!(S||I.form||w?.status==="failed"),M=w?.status==="requires_action",N=(0,g.getResourceTitleByProduct)(p),T=(0,ec.useInstallMarketplaceProductDisplayMode)(),R=y?.projectIds&&y.projectIds.length>0?y.projectIds[0]:void 0,{data:L}=(0,ey.useProject)(R),{data:B}=(0,eS.useResourceItem)({resourceId:x?.id||null}),_=B?.store,$="onboarding"===(_?_.status:x?.status),O=()=>{x&&k.push((0,eC.getResourceDashboardLink)(x,{teamSlug:r.slug}))},{mutate:D}=(0,o.useTeam)(),z=(0,eM.useOpenUpgradeModal)(),F=(0,A.hasFreeBillingPlan)(r),q=eT({success:b,onboardingRequired:$,modalDisplayMode:T,drainAddedAfterCreation:j,createdResource:x,isFreePlan:F}),W=function(e){let{success:t,onboardingRequired:a,modalDisplayMode:n,drainAddedAfterCreation:r,createdResource:i,isFreePlan:o}=e;return eN({success:t,onboardingRequired:a,modalDisplayMode:n,drainAddedAfterCreation:r,createdResource:i})&&!o}({success:b,onboardingRequired:$,modalDisplayMode:T,drainAddedAfterCreation:j,createdResource:x,isFreePlan:F});return(0,t.jsx)(h.ResourceModalWrapper,{SecondaryButton:function(e){let{showUpgradeUpsell:a,showAddDrainButton:r,createdResource:i,teamSlug:o,onNext:s,onDrainCreated:l}=e;return a?(0,t.jsx)(n.Modal.Action,{onClick:()=>s(),type:"secondary",children:"Done"}):r&&i?(0,t.jsx)(eP.MarketplaceAddDrainButton,{resource:i,teamSlug:o,type:"secondary",onDrainCreated:l}):void 0}({showUpgradeUpsell:q,showAddDrainButton:W,createdResource:x,teamSlug:r.slug,onNext:c,onDrainCreated:async()=>{v(!0)}}),SuccessAction:function(e){let{onboardingRequired:a,createdResource:r,showUpgradeUpsell:i,openUpgradeModal:o,mutateTeam:s,success:l,hasErrors:c,isTransitioning:d,onNext:u,goToResource:g}=e;return a&&r?(0,t.jsx)(eI.OpenInPartnerDashboardButton,{buttonVariant:"default",componentType:"button",integrationConfigurationId:r.product.integrationConfigurationId,label:"Complete Onboarding",onClick:()=>{g()},productId:r.product.id,externalResourceId:r.externalResourceId,teamIdOrSlug:r.ownerId,path:"onboarding"}):i?(0,t.jsx)(U.Button,{onClick:()=>{o({source:"marketplace-install-flow-upgrade",forceImmediateUpgrade:!0,onConversionSuccess:()=>{s()}})},children:"Upgrade"}):(0,t.jsx)(n.Modal.Action,{disabled:!l,loading:!c&&!l||d,onClick:()=>u(),children:l?"Done":"Processing"})}({onboardingRequired:$,createdResource:x,showUpgradeUpsell:q,openUpgradeModal:z,mutateTeam:D,success:b,hasErrors:P,isTransitioning:f,onNext:c,goToResource:O}),cancelLabel:$?"Later":"Back",checkoutContentVariant:"no-padding-no-bottom",hideCancel:(!(P||M)||b)&&!$,from:"resource",integration:u,onBack:()=>{$?d?d(x):O():l()},product:p,children:(0,t.jsx)("div",{className:(0,ed.cn)("flex flex-col gap-4","inline"===T?"p-0":"p-6"),children:(0,t.jsx)(eR,{authorization:w,createdDrain:y,createdResource:x,drainAddedAfterCreation:j,error:I.form||(S?S instanceof Error?S.message:`There was an error creating your ${m||N}`:void 0),handleUserActions:C,integration:u,isFreePlan:F,modalDisplayMode:T,onChangePaymentMethod:s,onboardingRequired:$,product:p,project:L,resourceName:m,success:b})})})}function eR(e){let{product:a,resourceName:n,authorization:o,error:s,success:l,onboardingRequired:c,integration:d,handleUserActions:u,onChangePaymentMethod:p,project:m,createdDrain:h,createdResource:x,isFreePlan:y,modalDisplayMode:k,drainAddedAfterCreation:j}=e,v=(0,g.getResourceTitleByProduct)(a);if(l){let e=eT({success:l,onboardingRequired:c,modalDisplayMode:k,drainAddedAfterCreation:j,createdResource:x,isFreePlan:y});return(0,t.jsxs)(b.Stack,{gap:3,children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,className:"mb-3",children:[(0,t.jsx)(W.CheckCircle,{color:"green-900",size:16}),(0,t.jsx)(f.Text,{color:"green-900","data-testid":(0,T.tid)("create-resource-modal","successfully-created"),weight:500,children:h?`${v} and Trace Drain Created Successfully`:`${v} Created Successfully`})]}),e?(0,t.jsxs)(r.Note,{fill:!0,type:"secondary",children:["The"," ",(0,t.jsx)(f.Text,{as:"span",className:"text-gray-1000",children:n||`${d.name} ${v}`})," ","has been created, but you will need to upgrade in order to start using Drains."]}):(0,t.jsx)("div",{className:"rounded-md bg-gray-200 p-4",children:(0,t.jsxs)("p",{className:"leading-relaxed",children:["The"," ",(0,t.jsx)("span",{className:"font-semibold",children:n||`${d.name} ${v}`})," ","has been created successfully",c?(0,t.jsx)(t.Fragment,{children:", but you will need to proceed to the partner dashboard to continue onboarding and complete the setup."}):"."]})}),h&&m?(0,t.jsx)("div",{className:"rounded-md bg-gray-200 p-4",children:(0,t.jsxs)("p",{className:"leading-relaxed text-gray-900",children:["The trace drain"," ",(0,t.jsx)("span",{className:"text-gray-1000",children:h.name})," has been created and connected to"," ",(0,t.jsx)(em.Avatar,{className:"top-[2px]",hash:m.id,size:16})," ",(0,t.jsx)("span",{className:"text-gray-1000",children:m.name}),"."]})}):null]})}return o?.status==="requires_action"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(q.Warning,{color:"amber-900",size:16}),(0,t.jsx)(f.Text,{color:"amber-900",weight:500,children:"Authentication Needed"})]}),(0,t.jsx)(f.Text,{className:"text-gray-900",children:"Further action is needed. Please authenticate your payment method to continue."}),(0,t.jsx)(U.Button,{onClick:()=>{u()},children:"Authenticate"})]}):o?.status==="failed"?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Error,{children:"Preauthorization Failed"}),(0,t.jsx)(f.Text,{className:"text-gray-900",children:"There was an error using your payment method. Please try again with a different payment method."}),(0,t.jsx)(U.Button,{onClick:()=>p(),children:"Change Payment Method"})]}):s?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(r.Note,{fill:!0,type:"error",children:[(0,ew.default)(s),". Please go back and check your settings before trying again."]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(b.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Spinner,{size:16}),(0,t.jsx)(f.Text,{size:16,weight:500,children:"Processing"})]}),(0,t.jsxs)(f.Text,{className:"text-gray-900",children:["Almost ready, we're setting up your"," ",(0,t.jsx)(f.Text,{as:"span",className:"text-gray-1000",children:n||v}),"."]})]})}var eL=e.i(7063289);function eE(e){let a=(0,m.useMarketplaceBillingPlansContext)();return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{disabled:!1,loading:e.isTransitioning,onClick:async()=>{let t=await a.topUpForm.addFundsForm.trigger(),n=await a.topUpForm.rechargeSettingsForm.trigger();t&&n&&e.onNext()},children:"Continue"}),cancelLabel:"Back",checkoutContentVariant:"default",from:"top-up",integration:e.integration,onBack:()=>{e.onBack()},product:e.product,children:(0,t.jsx)(b.Stack,{className:"pb-6",gap:5,children:(0,t.jsx)("form",{children:(0,t.jsx)(eL.TopUpFormFields,{topUpForm:a.topUpForm,variant:"create"})})})})})}var eB=e.i(9871375),e_=e.i(4758962);let e$=(0,$.withStripe)(function(e){let n,{arePermissionsLoading:r,isTransitioning:i,startTransition:o,team:s,integration:l,product:c,configuration:d,onBack:u,onIntegrationResourceCreate:g,cancelLabel:p,onStepChange:h,onSkipOnboarding:b}=e,f=(0,ee.useSearchParams)(),x=f?.get("external-id")||void 0,{connectProjectAndReturnToV0:j}=(0,H.useV0Marketplace)()||{},v=(0,eB.useProjectCloneContext)();n=v.projectId?"deploy-button":j?"v0":"marketplace";let{projectId:w}=v,{createDrain:S}=(0,e_.useCreateDrain)(s.slug,w??void 0),[C,I]=(0,a.useState)(null),[P,M]=(0,a.useState)(!1),{onSubmit:N}=(0,E.useStoreIntegrationFormContext)(),T="ab-12-aws"===l.slug,[A,R]=(0,a.useState)(T?"combined":"select-plan"),{createResource:L}=(0,en.useMutateResource)(),{data:B}=(0,ea.useMarketplaceBillingBalance)(d.id),[_,$]=(0,a.useState)(),[F,U]=(0,a.useState)(null),[q,W]=(0,a.useState)(!1),{data:K}=(0,O.useInstallationPaymentMethodState)({integrationConfigurationId:d.id}),G=(0,D.useAwaitData)(K),{createAuthorization:Y}=(0,V.useMarketplaceBillingAuthorizationApi)(),X=(0,V.useAwaitAuthorization)(),[J,Z]=(0,a.useState)(null),[er,ei]=(0,a.useState)(null),[eo,es]=(0,a.useState)(),el=(0,m.useMarketplaceBillingPlansContext)(),ec=(0,a.useCallback)((e,t)=>{e.paymentMethodRequired||t?o(async()=>{let t=await G;(0,z.getIsPaymentMethodStepNeeded)(s,t,e)?R("payment-method"):R("confirm")}):R("confirm")},[G,o,s]),ed=(0,a.useCallback)(()=>{_&&ec(_,!0)},[_,ec]),eg=(0,a.useCallback)(()=>{R("confirm"),W(!1)},[]),ep=(0,a.useCallback)(()=>{W(!0),R("payment-method")},[]);function em(e){let{resourceName:t,createDrainPayload:a,billingPlanOverride:r}=e;U(t),M(!!a),N(async e=>{let{metadata:i}=e;R("provisioning");let o=r??_;if(!o)throw Error("Billing plan is missing");let u="prepayment"===o.type?el.topUpForm.getAmountToAdd():void 0,g=await Y(s.id,{integrationIdOrSlug:l.id,productId:c.id,integrationConfigurationId:d.id,billingPlanId:o.id,metadata:i,prepaymentAmountCents:u});if(Z(g?.id??null),g&&"succeeded"!==(await X(s.id,g.id)).status)return;let p=await L({metadata:i,externalId:x,billingPlanId:o.id,name:t,integrationConfigurationId:d.id,integrationProductIdOrSlug:c.id,authorizationId:g?.id??void 0,protocolSettings:eo,source:n});y.analytics.track(k.AnalyticsEvent.MARKETPLACE_RESOURCE_INSTALL_CLICKED,{integration:{id:l.id,slug:l.slug},productSlug:c.slug,source:n}),"prepayment"===o.type&&await el.topUpForm.requests.updateRechargeSettingsForResource({billingPlanId:o.id,resourceId:p.id,teamId:s.id,configurationId:d.id,metadata:i}),ei(p),a&&I(await S({...a,source:{kind:"integration",resourceId:p.id}}))},{noTransition:!0,resourceName:t})}let eh=(0,a.useCallback)(()=>{if(!er)throw Error("Not created");o(async()=>{if(j){Q.toasts.success(`Created ${er.name} successfully. Redirecting back to v0.`);try{(0,et.track)("v0/marketplace/integration-connected",{integrationId:l.id,productId:c.id}),await j({integrationId:l.id,productId:c.id,resourceId:er.id,productSlug:c.slug})}catch(t){let e="[object Error]"===Object.prototype.toString.call(t)?t.message:String(t);(0,et.track)("v0/marketplace/integration-connect-failed",{integrationId:l.id,productId:c.id,error:e}),Q.toasts.error("Failed to connect integration to v0.")}}else await g(er)})},[er,o,j,l.id,c.id,c.slug,g]);switch(A){case"combined":return(0,t.jsx)(ej,{cancelLabel:p,installationId:d.id,integration:l,onBack:()=>{h?.(),u()},onNext:(e,t,a,n)=>{h?.(),$(a),es(n),em({resourceName:e,billingPlanOverride:a})},product:c});case"select-plan":return(0,t.jsx)(eu,{cancelLabel:p,installationId:d.id,integration:l,isLoading:r,isTransitioning:i,onBack:()=>{h?.(),u()},onNext:(e,t,a)=>{h?.(),function(e,t,a){if(y.analytics.track(k.AnalyticsEvent.MARKETPLACE_PRODUCT_PLAN_SELECTED,{integration:{id:l.id,slug:l.slug},productSlug:c.slug,source:n}),$(t),es(a),el.shouldAddTopUpFormStep&&("installation"!==t.scope||(B?.balance?.currencyValueInCents??0)===0)){let e=B?.balance?.currencyValueInCents;el.topUpForm.setup({type:"create",billingPlan:t,currentBalance:e?(e/100).toString():void 0}),R("top-up");return}ec(t,!1)}(0,t,a)},product:c,type:"product"});case"payment-method":return K?(0,t.jsx)(ev,{configuration:d,onBack:()=>{h?.(),R("select-plan")},onNext:()=>{h?.(),eg()},paymentMethodState:K,requireNew:q,team:s}):null;case"confirm":return(0,t.jsx)(ek,{cancelLabel:p,installationBalance:B?.balance,integration:l,onBack:()=>{h?.(),R("select-plan")},onNext:e=>{h?.(),em({resourceName:e.resourceName,createDrainPayload:e.createDrainPayload})},product:c,projectId:w??void 0,source:n,team:s});case"provisioning":return(0,t.jsx)(eA,{authorizationId:J,cancelLabel:p,configurationId:d.id,createdDrain:C,createdResource:er,integration:l,isTransitioning:i||P&&!C,onBack:()=>{h?.(),R("confirm")},onChangePaymentMethod:ep,onNext:()=>{h?.(),eh()},onSkipOnboarding:b,product:c,resourceName:F,success:!!er&&(!P||!!C),team:s});case"top-up":return(0,t.jsx)(eE,{integration:l,isTransitioning:i,onBack:()=>{h?.(),R("select-plan")},onNext:()=>{h?.(),ed()},product:c})}});function eO(e){let{onBack:n,onIntegrationResourceCreate:r,onSkipOnboarding:i,cancelLabel:s,product:c,integration:d,teamSlug:g,team:p,initialConfigurationStatus:m,neonIntegrationStatus:h,onStepChange:b}=e,{team:f}=(0,o.useTeam)(g),x=p??f,{pushToDetailPath:y}=(0,u.usePushToStorePath)(),{configurationStatus:k,onConfigurationInstalled:j}=(0,l.useConfigurationStatus)({initialConfigurationStatus:m}),{data:v}=(0,ei.default)(!k.isLoading&&k.isInstalled?k.configuration.id:void 0),[w,S]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{h.isLoading||S(!0)},[h.isLoading]),k.isLoading||!x||h.isLoading&&!w)return(0,t.jsx)(ez,{cancelLabel:s,integration:d,onBack:n,product:c});if(!k.isInstalled)return(0,t.jsx)(Y,{cancelLabel:s,checkoutContentVariant:"default",integration:d,isLoading:!d,onBack:n,onSuccess:j,product:c,team:x});if(!v)return(0,t.jsx)(ez,{cancelLabel:s,integration:d,onBack:n,product:c});let C=d.supportsInstallationBillingPlans?v.billingPlan??k.configuration.billingPlan:void 0;return(0,t.jsx)(eD,{onStepChange:b,cancelLabel:s,configuration:v,installationBillingPlan:k.billingPlan??C,integration:d,onBack:n,onIntegrationResourceCreate:r,onSkipOnboarding:i,preselectedBillingPlan:k.billingPlan,product:c,team:x})}function eD(e){let{team:n,installationBillingPlan:i,preselectedBillingPlan:o,integration:l,product:u,configuration:b,onStepChange:f,onBack:x,onIntegrationResourceCreate:y,onSkipOnboarding:k,cancelLabel:j}=e,{canCreateResource:v,isLoading:w,isDeleteRequested:S}=(0,c.useInstallationPermissions)(b.id),[C,I]=(0,a.useTransition)();return S?(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:null,cancelLabel:j,checkoutContentVariant:"default",from:"resource",integration:l,onBack:x,product:u,children:(0,t.jsx)(r.Note,{type:"warning",children:`${(0,g.pendingDeletionLabel)("create",u,n.name)}`})}):w||v?(0,t.jsx)(p.ResourceFormProvider,{metadataSchema:u.metadataSchema,resourceTitle:d.storeTitle.integration,target:"create",children:(0,t.jsx)(m.MarketplaceInstallationBillingPlansProvider,{defaultPlan:o??i,isBillingPlanPreselected:!!o,target:"create",children:(0,t.jsx)(s.DisabledContext.Provider,{value:w||C,children:(0,t.jsx)(e$,{arePermissionsLoading:w,cancelLabel:j,configuration:b,integration:l,isTransitioning:C,onBack:x,onIntegrationResourceCreate:y,product:u,startTransition:I,team:n,onStepChange:f,onSkipOnboarding:k})})})}):(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:null,cancelLabel:j,checkoutContentVariant:"default",from:"resource",integration:l,onBack:x,product:u,children:(0,t.jsx)(r.Note,{type:"warning",children:`${(0,g.missingPermissionLabel)("create",u,n.name)}`})})}function ez(e){return(0,t.jsx)(h.ResourceModalWrapper,{SuccessAction:(0,t.jsx)(n.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"Continue"}),from:"installation",checkoutContentVariant:"default",...e,children:(0,t.jsx)("div",{className:"flex size-full items-center justify-center py-16",children:(0,t.jsx)(i.Spinner,{})})})}e.s(["CreateResourceModal",()=>eO],6356390)},5628754,e=>{"use strict";e.i(5313122),e.i(9203481),e.i(680627),e.i(8026771),e.i(9691190),e.s([])},15312,e=>{"use strict";var t=e.i(6468255),a=e.i(7512194),n=e.i(9508212),r=e.i(6891161),i=e.i(8923565),o=e.i(6696646),s=e.i(119294),l=e.i(6352514),c=e.i(9668517),d=e.i(4597921);e.i(6887680);var u=e.i(6810699),g=e.i(8711152);e.i(5628754);var p=e.i(680627),m=e.i(1017032),h=e.i(5074599),b=e.i(4981413),f=e.i(3758860),x=e.i(7849855),y=e.i(7137779),k=e.i(2483721),j=e.i(3183079),v=e.i(39509),w=e.i(6356390),S=e.i(9100551),C=e.i(3584802);function I(){let e=(0,c.useTeamSlug)(),{data:a}=(0,m.useConfigurations)({type:"marketplace",skipBillingData:!0}),{hasProject:I,projectSlug:P}=(0,x.useProjectSlug)(),{state:M,onClose:N,onBack:T,onAnimationDone:A,protocolType:R,onResourceUpdated:L,maybeGoToConnectProjectStep:E,goToCreateResourceStep:B,switchTab:_}=(0,j.useResourceModalsContext)(),{data:$}=(0,u.useResourceList)({protocolType:R}),O=(0,S.useRouter)(),D=(0,d.useServerFlag)("enable-marketplace-drains",!1),z=`create-connect-${M.modalKey}`,[F,U]=(0,o.useState)(),q=(0,o.useRef)(null),W=(0,o.useCallback)(()=>{U(void 0),A()},[A]),V=(0,o.useCallback)(()=>{U(void 0),N()},[N]),K=(0,o.useCallback)(e=>{"integration"===e.type&&(0,f.supportsAnyDrainProtocol)(e.product)&&D?(L({resource:e,isConnected:!0}),N()):(L({resource:e,isConnected:!1}),E(e))},[E,L,N,D]);switch(M.type){case v.ResourceModalsActionTypes.ModalClosed:return(0,t.jsx)(r.Modal.Modal,{active:M.active,allowOverflow:!0,onAnimationDone:W,onClickOutside:N,width:620,children:(0,t.jsx)("div",{})},z);case v.ResourceModalsActionTypes.BrowseProudctsOrSelectResources:return(0,t.jsx)(r.Modal.Modal,{active:M.active,allowOverflow:!0,onAnimationDone:W,onClickOutside:N,width:"browse-new"===M.tab?540:620,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Body,{className:"p-8",children:(0,t.jsxs)(n.Stack,{gap:6,ref:q,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsx)(r.Modal.Title,{center:!0,children:(0,h.browseProductsOrSelectResourcesModalTitle)(R)})}),(0,t.jsxs)(i.Switch,{name:"switch-new-existing-tab",children:[(0,t.jsx)(i.Switch.Control,{defaultChecked:"browse-new"===M.tab,label:"Create New",onChange:()=>{_("browse-new")},size:"large",value:"create",width:104}),(0,t.jsx)(i.Switch.Control,{defaultChecked:"browse-existing"===M.tab,disabled:$?.stores.length===0,label:"Select Existing",onChange:()=>{_("browse-existing")},size:"large",value:"connect",width:122})]}),"browse-new"===M.tab?(0,t.jsx)(b.BrowseProducts,{onClickProduct:e=>{U(e)},protocolType:R,selectedProduct:F}):null,"browse-existing"===M.tab?(0,t.jsx)(p.SelectResources,{hasCreateConnectButton:!1,onClickConnectStoreModal:e=>{E(e)},protocolType:R}):null]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:V,type:"secondary",children:"Cancel"}),"browse-new"===M.tab?(0,t.jsx)(r.Modal.Action,{disabled:!F,onClick:()=>{F&&("integration"===F.type?O.push((0,C.getIntegrationCheckoutUrl)({params:{teamSlug:e??"",integrationSlug:F.integration.slug},searchParams:{productSlug:F.product.slug,projectSlug:P??void 0,cancelUrl:e?`/${e}/~/integrations/${F.integration.slug}`:`/marketplace/${F.integration.slug}`}})):B(F))},children:"Continue"}):null]})]})},z);case v.ResourceModalsActionTypes.BrowseProducts:return(0,t.jsx)(r.Modal.Modal,{active:M.active,allowOverflow:!0,onAnimationDone:W,onClickOutside:N,width:540,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Modal.Body,{className:"p-8",children:(0,t.jsxs)(n.Stack,{gap:6,ref:q,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsx)(r.Modal.Title,{center:!0,children:(0,h.browseProductsModalTitle)(R)})}),(0,t.jsx)(b.BrowseProducts,{onClickProduct:e=>{U(e)},protocolType:R,selectedProduct:F})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:V,type:"secondary",children:"Cancel"}),(0,t.jsx)(r.Modal.Action,{disabled:!F,onClick:()=>{F&&("integration"===F.type?(O.push((0,C.getIntegrationCheckoutUrl)({params:{teamSlug:e??"",integrationSlug:F.integration.slug},searchParams:{productSlug:F.product.slug,projectSlug:P??void 0,cancelUrl:`${window.location.pathname}${window.location.search}`}})),s.analytics.track(l.AnalyticsEvent.MARKETPLACE_PRODUCT_INSTALL_CLICKED,{source:"storage",integration:{id:F.integration.id,slug:F.integration.slug},productSlug:F.product.slug})):B(F))},children:"Continue"})]})]})},z);case v.ResourceModalsActionTypes.CreateResource:{if("integration"!==M.resourceWithProduct.type)return null;let n=M.resourceWithProduct.integration;return(0,t.jsx)(r.Modal.Modal,{active:M.active,allowOverflow:!0,onAnimationDone:W,onClickOutside:N,width:540,children:(0,t.jsx)(w.CreateResourceModal,{cancelLabel:M.backOrCancelLabel,initialConfigurationStatus:(0,g.getConfigurationStatusByIntegrationId)(a,n.id),integration:n,neonIntegrationStatus:{isNeonDisabled:!1,isLoading:!1},onBack:T,onIntegrationResourceCreate:K,product:(0,f.getProductWithSupportedProtocols)(M.resourceWithProduct.product),teamSlug:e??""})},z)}case v.ResourceModalsActionTypes.CreateEnvs:if(M.connection)return(0,t.jsx)(y.UpdateResourceConnectionModal,{active:M.active,connection:M.connection,onAnimationDone:W,onClickOutside:N,onConnectionCreated:()=>L({resource:M.resource,isConnected:!0}),resourceId:M.resource.id,store:M.resource},z);if(I)return(0,t.jsx)(r.Modal.Modal,{active:M.active,allowOverflow:!0,onAnimationDone:W,onClickOutside:N,width:540,children:(0,t.jsx)(y.ConnectResourceForCurrentProjectStep,{resource:M.resource})},z);return(0,t.jsx)(y.CreateResourceConnectionModal,{active:M.active,onAnimationDone:W,onClickOutside:N,onConnectionCreated:()=>L({resource:M.resource,isConnected:!0}),resourceId:M.resource.id,store:M.resource},z);case v.ResourceModalsActionTypes.DeleteEnvs:return(0,t.jsx)(k.DeleteStoreConnectionModal,{active:M.active,connections:M.connections,onAnimationDone:W,onClickOutside:N,resourceId:M.resourceId,resource:M.resource},z)}}function P(e){let{children:n,protocolType:r}=e;return(0,t.jsx)(a.ResourceModalsProviderBase,{Modal:(0,t.jsx)(I,{}),protocolType:r,children:n})}e.s(["ResourceModalsProvider",()=>P],15312)}]);

//# sourceMappingURL=320b31c061888227.js.map
//# debugId=fdd50fe6-9829-5755-839e-c11becd5d388
