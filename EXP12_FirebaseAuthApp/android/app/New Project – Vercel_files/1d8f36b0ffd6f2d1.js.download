
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="00b6b1cf-f7cb-5582-87bd-9b087c1505a7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6857421,e=>{"use strict";var t=e.i(6468255),a=e.i(6696646),r=e.i(2962582),l=e.i(6195642),s=e.i(6143247);let i=(0,a.forwardRef)((e,a)=>{let{className:r,overflow:l=!0,containerClassName:i,...n}=e;return(0,t.jsx)("div",{className:"tailwind-preflight",children:(0,t.jsx)("div",{className:(0,s.cn)("relative w-full",{"overflow-auto":l},i),children:(0,t.jsx)("table",{className:(0,s.cn)("w-full caption-bottom text-sm text-gray-900",r),ref:a,...n})})})});i.displayName="Table";let n=(0,a.forwardRef)((e,a)=>{let{className:r,removeSpacing:l=!1,...i}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("thead",{className:(0,s.cn)("[&_th]:border-b",r),ref:a,...i}),l?null:(0,t.jsx)("tbody",{"aria-hidden":!0,className:"table-row h-3"})]})});n.displayName="TableHeader";let o=(0,a.forwardRef)((e,l)=>{let{className:i,striped:n,interactive:o,bordered:d,virtualize:c=!1,children:m,...u}=e,x=(0,a.useMemo)(()=>Array.isArray(m)&&c?m.filter(Boolean):m,[m,c]),h=Array.isArray(x)?x.length:0,g=(0,a.useRef)(null),[f,p]=(0,a.useState)({}),y=(0,a.useRef)(!1),b=(0,a.useMemo)(()=>{if(!c)return{start:0,end:0};let e=g.current,t=e?.getBoundingClientRect().top??0,a=y.current?window.innerHeight:2e3,r=Math.max(0,Math.min(Math.floor((-150-t)/40),h-1)),l=Math.max(r,Math.min(Math.ceil(Math.min(a+150-t)/40),h-1));return{start:r,end:l}},[f,h]);return(0,a.useLayoutEffect)(()=>{if(y.current=!0,!c)return;let e=0,t=()=>{p({})};t();let a=()=>{cancelAnimationFrame(e),e=requestAnimationFrame(t)};window.addEventListener("scroll",a),window.addEventListener("resize",a);let r=new MutationObserver(e=>{for(let t of e)if(!g.current?.contains(t.target)){a();break}});return g.current?.parentElement&&r.observe(document.body,{childList:!0,subtree:!0}),()=>{cancelAnimationFrame(e),window.removeEventListener("scroll",a),window.removeEventListener("resize",a),r.disconnect()}},[c]),(0,t.jsx)("tbody",{className:(0,s.cn)(n?"[&_tr:where(:nth-child(odd))]:bg-background-200":void 0,"[&_td:first-child]:rounded-l-sm [&_td:last-child]:rounded-r-sm",o?"[&_tr:hover]:bg-gray-100":void 0,d?"[&_tr:not(:last-child)]:border-b":void 0,i),ref:(0,r.mergeRefs)([g,l]),style:c?{height:40*h}:void 0,...u,children:c&&Array.isArray(x)?(0,t.jsxs)(t.Fragment,{children:[b.start%2?(0,t.jsx)("tr",{"aria-hidden":!0,style:{height:0}}):null,(0,t.jsx)("tr",{"aria-hidden":!0,style:{height:40*b.start}}),x.slice(b.start,b.end+1),(0,t.jsx)("tr",{"aria-hidden":!0,style:{height:(h-b.end-1)*40}})]}):x})});o.displayName="TableBody";let d=(0,a.forwardRef)((e,a)=>{let{className:r,...l}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("tbody",{"aria-hidden":!0,className:"table-row h-3"}),(0,t.jsx)("tfoot",{className:(0,s.cn)("font-medium [&_td]:border-t",r),ref:a,...l})]})});d.displayName="TableFooter";let c=(0,a.forwardRef)((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("tr",{className:(0,s.cn)("transition-colors",r),ref:a,...l})});c.displayName="TableRow";let m=(0,a.forwardRef)((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("th",{className:(0,s.cn)("text-muted-foreground h-10 px-2 text-left align-middle font-medium last:text-right [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px] border-gray-400",r),ref:a,...l})});m.displayName="TableHead";let u=(0,a.forwardRef)((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("td",{className:(0,s.cn)("px-2 py-2.5 align-middle last:text-right [&:has([data-cell-link=true])]:p-0 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),ref:a,...l})});u.displayName="TableCell";let x=(0,a.forwardRef)((e,a)=>{let{className:r,...i}=e;return(0,t.jsx)(l.Link,{className:(0,s.cn)("block px-2 py-2.5",r),"data-cell-link":!0,ref:a,...i})});x.displayName="TableCellLink";let h=(0,a.forwardRef)((e,a)=>{let{...r}=e;return(0,t.jsx)("colgroup",{ref:a,...r})});h.displayName="TableColgroup";let g=(0,a.forwardRef)((e,a)=>{let{className:r,...l}=e;return(0,t.jsx)("col",{className:(0,s.cn)("w-auto",r),ref:a,...l})});g.displayName="TableCol";let f=Object.assign(i,{Header:n,Head:m,Body:o,Footer:d,Row:c,Cell:u,CellLink:x,Colgroup:h,Col:g});e.s(["CompoundedTable",0,f,"TableBody",0,o,"TableCell",0,u,"TableCellLink",0,x,"TableCol",0,g,"TableColgroup",0,h,"TableFooter",0,d,"TableHead",0,m,"TableHeader",0,n,"TableRoot",0,i,"TableRow",0,c])},3169345,e=>{"use strict";var t=e.i(6857421);e.s(["Table",()=>t.CompoundedTable])},3993360,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75ZM13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z" fill="currentColor"/>');e.s(["Download",0,t])},2640541,e=>{e.v({base:"material-module__NnW5zG__base",fullscreen:"material-module__NnW5zG__fullscreen",large:"material-module__NnW5zG__large",material:"material-module__NnW5zG__material",medium:"material-module__NnW5zG__medium",menu:"material-module__NnW5zG__menu",modal:"material-module__NnW5zG__modal",small:"material-module__NnW5zG__small",tooltip:"material-module__NnW5zG__tooltip"})},5223937,e=>{"use strict";var t=e.i(6468255),a=e.i(9722978),r=e.i(9508212),l=e.i(2640541);function s(e){let{type:s="base",className:i,...n}=e;return(0,t.jsx)(r.Stack,{className:(0,a.clsx)(l.default.material,l.default[s],i),...n})}e.s(["Material",()=>s])},3804618,e=>{"use strict";var t=e.i(6468255),a=e.i(3306538),r=e.i(8761240),l=e.i(9386557);function s(e){if("error_anomaly"===e.type){let{statusGroup:t,route:a,cause:r}=e.data;return`${"function"===r?"Function Invocation":"Middleware Invocation"} by ${a} ${"4xx"===t?"with 4xx errors":"with 5xx errors"}`}return e.title}function i(e){return{type:e.type,title:"error_anomaly"===e.type?`${e.data.route} ${e.data.statusGroup}`:e.title,changeDirection:`${e.formattedValues.changeDirection}d`,changeAmount:e.formattedValues.changeAmount,changeDescription:`${e.formattedValues.formattedAvg} → ${e.formattedValues.formattedCount} ${e.unit}`}}function n(e){let s=(()=>{switch(e.status){case"active":return(0,t.jsx)(a.Badge,{icon:(0,t.jsx)(l.WarningFill,{}),variant:"red-subtle",children:"Active"});case"resolved":return(0,t.jsx)(a.Badge,{className:"text-gray-900",icon:(0,t.jsx)(r.CheckCircleFill,{className:"size-3 -ml-1"}),variant:"gray-subtle",children:"Resolved"})}})();return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[s,e.isInternal&&(0,t.jsx)(a.Badge,{variant:"gray-subtle",children:"Internal"})]})}function o(e){return e?`${e.minutes}m`:void 0}e.s(["getAlertInfo",()=>i,"getAlertTitle",()=>s,"getStatusBadge",()=>n,"granularityToQueryParam",()=>o])},9997017,e=>{"use strict";var t=e.i(6468255),a=e.i(3804618),r=e.i(6143247),l=e.i(9459801),s=e.i(5468328),i=e.i(3219703);let n="leading-tight font-medium space-x-1 min-w-0 items-center min-h-[22px] truncate";function o(e){let{alert:o,className:d,size:c="regular"}=e,m=(0,a.getAlertInfo)(o);return"error_anomaly"===o.type?(0,t.jsxs)("span",{className:(0,r.cn)(n,"flex",d),children:[(0,t.jsx)("span",{className:"text-gray-900 flex-shrink-0 flex items-center gap-1",children:(0,t.jsx)(i.StatusCodeBadge,{variant:"large"===c?"large":"regular",statusCode:o.data.statusGroup})}),(0,t.jsx)("span",{className:"text-gray-900 whitespace-nowrap",children:"error spike on"}),(0,t.jsx)(s.Tooltip,{className:"truncate min-w-0 inline-block text-ellipsis py-px",text:o.data.route,children:(0,t.jsx)(l.RouteHighlighter,{route:o.data.route,segmentClassName:"large"===c?"text-lg my-1 py-px":"text-[13px]"})})]}):(0,t.jsxs)("span",{className:(0,r.cn)(n,d),children:[(0,t.jsx)("span",{className:"text-gray-1000",children:m.title}),(0,t.jsxs)("span",{className:"text-gray-900",children:[m.changeDirection," by"]}),(0,t.jsx)("span",{className:"text-gray-1000",children:m.changeAmount})]})}e.s(["AlertTitle",()=>o])},3494530,3651903,e=>{"use strict";var t=e.i(3911483),a=e.i(5338940),r=e.i(1138941),l=e.i(9979783),s=e.i(6060673),i=e.i(9171423);function n(e){throw Error(`Unknown alert type: ${e}`)}function o(){let{team:e}=(0,a.useTeam)(),i=(0,r.useProjectIdOrName)(),{data:n}=(0,s.useProject)(i);return(0,t.default)(()=>e?`alerts-${e.id}-${n?.id||"all"}`:null,async()=>{if(!e?.id)return;let{body:t}=await (0,l.typedFetch)("/alerts/v2/alerts","get",{teamId:e.id,projectId:n?.id},{throwOnHTTPError:!0});return{alerts:t}})}function d(e){let{team:i}=(0,a.useTeam)(),n=(0,r.useProjectIdOrName)(),{data:o}=(0,s.useProject)(n);return(0,t.default)(()=>i?`alert-${e}-${i.id}-${o?.id||"all"}`:null,async()=>{if(!i?.id)return;let{body:t}=await (0,l.typedFetch)("/alerts/v2/alerts/{alertId}","get",{teamId:i.id,alertId:e},{throwOnHTTPError:!0});return t})}function c(){let{team:e}=(0,a.useTeam)(),r=(0,t.default)(()=>e?`/alerts/v2/flags?teamId=${e.id}`:null,async t=>{if(e?.id)return await (0,i.fetchApi)(t)}),l=e=>!!e&&(r?.data?.[e]??!1);return{isAlertTypeEnabled:l,isWebhookEnabled:e=>l(m(e)),isNotificationEnabled:e=>l(function(e){switch(e){case"alerts-usage-anomaly":return"usage_anomaly";case"alerts-error-anomaly":return"error_anomaly";case"alerts-botid-anomaly":return"botId_anomaly";default:return n(e)}}(e)),...r}}function m(e){switch(e){case"observability.usage-anomaly":return"usage_anomaly";case"observability.error-anomaly":return"error_anomaly";case"observability.anomaly-botId":return"botId_anomaly";default:return null}}e.s(["assertNever",()=>n],3651903),e.s(["mapWebhookEventToO11yAlertType",()=>m,"useO11yAlert",()=>d,"useO11yAlerts",()=>o,"useO11yAlertsFlags",()=>c],3494530)},7163088,e=>{"use strict";var t=e.i(6468255),a=e.i(57106),r=e.i(6696646),l=e.i(3911483),s=e.i(5338940),i=e.i(8521184),n=e.i(2936702),o=e.i(3646124);e.i(9623499);var d=e.i(5576066),c=e.i(3993360),m=e.i(6317369),u=e.i(2504781),x=e.i(8161149),h=e.i(7608222),g=e.i(6062041);let f=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],p=e=>`$${e.toFixed(3)}`,y=e=>e.toString(),b=e=>{if(e<60)return`${e}s`;let t=Math.floor(e/60),a=e%60;if(t<60)return a>0?`${t}m ${a}s`:`${t}m`;let r=Math.floor(t/60),l=t%60;return l>0?`${r}h ${l}m`:`${r}h`},v=r.default.memo(function(e){let{repositoryOwner:a,repositoryName:r,pullRequestNumber:l,commitSha:s}=e.row.original,i=`https://github.com/${a}/${r}/pull/${l}`,n=(0,g.nameToColor)(`${r}`),o=s?s.substring(0,7):"";return(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-ellipsis text-nowrap py-2 text-gray-900",children:[(0,t.jsx)("div",{className:"inline-block w-0.5 rounded h-[14px] shrink-0 -ml-1.5 mr-1",style:{backgroundColor:n}}),(0,t.jsx)(d.Link,{href:i,external:!0,icon:!1,className:"hover:underline text-gray-900 truncate",children:`${a}/${r} #${l}${o?` (${o})`:""}`})]})}),j=r.default.memo(function(e){let{row:a,cell:r,column:l}=e,s=a.original.maxCost;return(0,t.jsx)(o.BarCell,{...e,cell:{...r,value:a.original.numericCost},maxValue:s,column:{...l,cellFormatter:p}})}),w=r.default.memo(function(e){let{row:a,cell:r,column:l}=e,s=a.original.maxComments;return(0,t.jsx)(o.BarCell,{...e,cell:{...r,value:a.original.reviewComments||0},maxValue:s,column:{...l,cellFormatter:y}})}),C=r.default.memo(function(e){let{row:a,cell:r,column:l}=e,s=a.original.maxReviewTime,i=a.original.reviewTimeSeconds||0;return(0,t.jsx)(o.BarCell,{...e,cell:{...r,value:i},maxValue:s,column:{...l,cellFormatter:b}})}),N=r.default.memo(function(e){let{row:a,cell:r,column:l}=e,s=a.original.maxFilesRead,i=a.original.filesRead||0;return(0,t.jsx)(o.BarCell,{...e,cell:{...r,value:i},maxValue:s,column:{...l,cellFormatter:y}})});function T(e){let{data:l,team:s}=e,d=void 0===l,[g,y]=(0,r.useState)(!1),b=(0,r.useCallback)((e,t,a)=>{let r=(a||"").toLowerCase().trim();return r?e.filter(e=>{if(e.original.isSkeleton)return!1;let t=e.original,a=String(t.repository||"").toLowerCase(),l=String(t.pullRequestNumber||"").toLowerCase(),s=String(t.repositoryOwner||"").toLowerCase(),i=String(t.repositoryName||"").toLowerCase(),n=String(t.commitSha||"").toLowerCase();return a.includes(r)||l.includes(r)||s.includes(r)||i.includes(r)||n.includes(r)}):e},[]),T=(0,r.useMemo)(()=>{if(!l||0===l.length)return[];let e=[...l].sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),t=0,a=0,r=0,s=0;for(let l of e){let e=l.cost||l.tokenCost||0,i=l.reviewComments||0,n=l.reviewTimeSeconds||0,o=l.filesRead||0;e>t&&(t=e),i>a&&(a=i),n>r&&(r=n),o>s&&(s=o)}return e.map(e=>{let l,i,n,o=e.cost||e.tokenCost||0,d=new Date(e.timestamp.endsWith("Z")?e.timestamp:`${e.timestamp}Z`);return{...e,formattedTime:(l=d.getHours().toString().padStart(2,"0"),i=d.getMinutes().toString().padStart(2,"0"),n=d.getSeconds().toString().padStart(2,"0"),`${f[d.getMonth()]} ${d.getDate()} ${l}:${i}:${n}`),timestampDate:d,repository:`${e.repositoryOwner}/${e.repositoryName} #${e.pullRequestNumber}`,formattedCost:p(o),numericCost:o,maxCost:t,maxComments:a,maxReviewTime:r,maxFilesRead:s}})},[l]),R=(0,r.useCallback)(async()=>{try{y(!0),await new Promise(e=>setTimeout(e,0));let e=(Array.isArray(l)?l:[]).map(e=>{let t=e.timestamp.endsWith("Z")?e.timestamp:`${e.timestamp}Z`,a=e.cost||e.tokenCost||0;return[String(t),`${e.repositoryOwner}/${e.repositoryName}`,String(e.pullRequestNumber||""),String(e.commitSha||""),Number.isFinite(e.reviewComments)?String(e.reviewComments):"0",Number.isFinite(a)?String(a):"0",Number.isFinite(e.reviewTimeSeconds)?String(1e3*e.reviewTimeSeconds):"0",Number.isFinite(e.filesRead)?String(e.filesRead):"0"]}),t=["Time,Repository,Pull Request,Commit SHA,Suggestions,Cost,Review Time (ms),Files Read",...e.map(e=>e.map((e,t)=>{let a,r;return t<=3?(a=/[",\n\r]/.test(e),r=e.replace(/"/g,'""'),a?`"${r}"`:r):e}).join(","))].join("\r\n"),a=new Blob([`\uFEFF${t}`],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="pr-review-usage-events.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}finally{y(!1)}},[l]),$=(0,r.useMemo)(()=>[{Header:"Review",accessor:"repository",sortDescFirst:!1,Cell:v},{Header:"Suggestions",accessor:"reviewComments",columnClassName:"w-28 max-w-28 min-w-28 hidden lg:table-cell",Cell:w},{Header:"Review Time",accessor:"reviewTimeSeconds",columnClassName:"w-32 max-w-32 min-w-32",Cell:C},{Header:"Files Read",accessor:"filesRead",columnClassName:"w-32 max-w-32 min-w-32",Cell:N},{Header:"Cost",accessor:"numericCost",columnClassName:"w-32 max-w-32 min-w-32 hidden lg:table-cell",Cell:j},{Header:"Time",accessor:"timestampDate",columnClassName:"w-20 max-w-20 min-w-20",sortDescFirst:!1,Cell:o.RelativeTimeCell}],[]);if(!d&&0===T.length){let e=s?.vadeReview?.enabled??!1,r=s?.slug;return e?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,t.jsx)(x.EmptyState.Root,{icon:(0,t.jsx)(x.EmptyState.Icon,{icon:(0,t.jsx)(m.GitPullRequest,{size:32})}),title:"No reviews yet",description:`Reviews are made on pull requests that are created after ${h.VERCEL_AGENT_NAME} is enabled.`})}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,t.jsx)(x.EmptyState.Root,{title:`${h.VERCEL_AGENT_NAME} not enabled`,description:`${h.VERCEL_AGENT_NAME} automatically reviews pull requests with deep understanding of your code and how it behaves in production.`,children:r&&(0,t.jsxs)(a.ButtonLink,{type:"default",href:`/${r}/~/settings#${h.VERCEL_AGENT_NAME.toLowerCase().replaceAll(" ","-")}`,children:["Enable ",h.VERCEL_AGENT_NAME]})})})}return(0,t.jsx)(n.SonarTable,{columns:$,data:T,defaultSort:[{id:"timestampDate",desc:!0}],isLoading:d,plugins:[i.useGlobalFilter,i.useSortBy,i.usePagination],globalFilter:b,autoResetPage:!0,renderCustomActions:()=>(0,t.jsx)(u.Button,{prefix:(0,t.jsx)(c.Download,{}),type:"secondary",loading:g,disabled:d||g||!l||0===l.length,onClick:R,children:g?"Exporting…":"Export CSV"})})}var R=e.i(3169345),$=e.i(5223937),S=e.i(1344973),E=e.i(198667);function _(e){let{onRetry:a}=e;return(0,t.jsx)($.Material,{className:"flex flex-col p-4 space-y-4 md:max-w-sm [@media(width>=700px)]:max-w-full",children:(0,t.jsxs)(R.Table,{children:[(0,t.jsxs)(R.Table.Colgroup,{children:[(0,t.jsx)(R.Table.Col,{}),(0,t.jsx)(R.Table.Col,{}),(0,t.jsx)(R.Table.Col,{}),(0,t.jsx)(R.Table.Col,{className:"hidden lg:table-cell"}),(0,t.jsx)(R.Table.Col,{className:"hidden lg:table-cell"}),(0,t.jsx)(R.Table.Col,{})]}),(0,t.jsx)(R.Table.Header,{children:(0,t.jsxs)(R.Table.Row,{children:[(0,t.jsx)(R.Table.Head,{children:"Duration"}),(0,t.jsx)(R.Table.Head,{children:"Repository"}),(0,t.jsx)(R.Table.Head,{children:"PR"}),(0,t.jsx)(R.Table.Head,{className:"hidden lg:table-cell",children:"Comments"}),(0,t.jsx)(R.Table.Head,{className:"hidden lg:table-cell",children:"Cost"}),(0,t.jsx)(R.Table.Head,{children:"Review Time"})]})}),(0,t.jsx)(R.Table.Body,{children:(0,t.jsx)(R.Table.Row,{children:(0,t.jsx)(R.Table.Cell,{colSpan:6,className:"text-center py-8",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)(S.Text,{color:"gray-700",children:"Failed to load PR review events"}),a&&(0,t.jsx)(u.Button,{type:"secondary",onClick:a,prefix:(0,t.jsx)(E.RefreshClockwise,{}),children:"Retry"})]})})})})]})})}var A=e.i(8151845),L=e.i(2415772),k=e.i(1233856);function F(){let{team:e}=(0,s.useTeam)(),{start:a,end:i}=(0,A.useRangeFromQueryState)(),{stableStart:n,stableEnd:o}=(0,r.useMemo)(()=>{let e={minutes:1};return{stableStart:(0,k.startOfDuration)(a,e),stableEnd:(0,k.startOfDuration)(i,e)}},[a,i]),d=(0,r.useMemo)(()=>{if(!e)return null;let t=(0,L.tbDateTime)(n),a=(0,L.tbDateTime)(o);return`/api/agent/pr-review-usage-events?ownerId=${e.id}&startTime=${t}&endTime=${a}`},[e,n,o]),{data:c,error:m,mutate:u}=(0,l.default)(d,async e=>{let t=await fetch(e);if(!t.ok){let e=Error("Failed to fetch PR review events");throw e.status=t.status,e}return t.json()},{revalidateIfStale:!1,refreshInterval:0});return m?(0,t.jsx)(_,{onRetry:()=>u()}):(0,t.jsx)(T,{data:c?.data,team:e})}var M=e.i(5182595),H=e.i(3351543),I=e.i(9179929),V=e.i(5481907),B=e.i(2466450);function D(){let{data:e,isLoading:a,isRelativeTime:r,builderQuery:l}=(0,V.useSonarQuery)({event:"prReview",rollups:{value:{measure:"cost",aggregation:"sum"}},groupBy:["repositoryName"],reason:"agent",summaryOnly:!1,limit:5,tailRollup:"others",granularity:{hours:1}},{noEnvironmentFilter:!0}),s=(0,I.useTimeseriesData)(e,{category:"repositoryName",rollupName:"value"});return(0,t.jsxs)(H.ChartCard,{children:[(0,t.jsx)(H.CardHeader,{title:"Cost"}),(0,t.jsx)("div",{className:"-mt-0.5 h-[190px]",children:(0,t.jsx)(M.LineChart,{builderQuery:l?.value,sonarQueryResults:e,data:s??[],getColor:e=>(0,g.nameToColor)(e),disableLegend:!0,isLoading:a,isRelativeTime:r,lineType:"step",granularity:{hours:1},formatAxisValue:e=>(0,B.formatCurrency)(100*e,"usd","short"),formatValue:e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:3,maximumFractionDigits:3}).format(e)})})]})}function O(){let e={hours:1},{data:a,isLoading:l,isRelativeTime:s,builderQuery:i}=(0,V.useSonarQuery)({event:"reviewedPrComplete",rollups:{positiveComments:{measure:"goodReviewComments",aggregation:"sum"},totalComments:{measure:"totalReviewComments",aggregation:"sum"}},reason:"agent",summaryOnly:!1,granularity:e},{noEnvironmentFilter:!0}),n=(0,r.useMemo)(()=>a?.data?a.data.map(e=>{let t=Number(e.positiveComments)||0,a=Math.max(0,(Number(e.totalComments)||0)-t);return{name:e.timestamp.toISOString(),Accepted:t,Ignored:a}}):[],[a?.data]);return(0,t.jsxs)(H.ChartCard,{children:[(0,t.jsx)(H.CardHeader,{href:"",title:"Suggestions Made"}),(0,t.jsx)("div",{className:"-mt-0.5 h-[190px]",children:(0,t.jsx)(M.LineChart,{builderQuery:i?.positiveComments,sonarQueryResults:a,data:n??[],getColor:e=>"Accepted"===e?"var(--ds-green-700)":"var(--ds-gray-500)",disableLegend:!0,isLoading:l,isRelativeTime:s,lineType:"step",granularity:e})})]})}function G(){return(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,t.jsx)(O,{}),(0,t.jsx)(D,{})]})}var P=e.i(5255926),z=e.i(3494530),U=e.i(9997017);let W=e=>Number(e)?`$${Number(e).toFixed(3)}`:"-",q=e=>{if(void 0===e)return"-";let t=Math.round(e);if(t<60)return`${t}s`;let a=Math.floor(t/60),r=t%60;if(a<60)return r>0?`${a}m ${r}s`:`${a}m`;let l=Math.floor(a/60),s=a%60;return s>0?`${l}h ${s}m`:`${l}h`},Q=r.default.memo(function(e){let{alertId:a,teamSlug:r}=e.row.original,l=`/${r}/~/observability/alerts/${a}`,s=(0,g.nameToColor)(`${r}`);return(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-ellipsis text-nowrap py-2 text-gray-900",children:[(0,t.jsx)("div",{className:"inline-block w-0.5 rounded h-[14px] shrink-0 -ml-1.5 mr-1",style:{backgroundColor:s}}),(0,t.jsx)(d.Link,{href:l,external:!0,icon:!1,className:"hover:underline text-gray-900 truncate",children:void 0===a?"Error Alert":(0,t.jsx)(Z,{alertId:a})})]})});function Z(e){let{alertId:a}=e,{data:r,isLoading:l}=(0,z.useO11yAlert)(a);return l||void 0===r?(0,t.jsx)(P.Skeleton,{width:100,height:14}):(0,t.jsx)(U.AlertTitle,{alert:r,size:"regular"})}function J(e){let{data:l,team:s}=e,d=void 0===l,c=(0,r.useMemo)(()=>{if(!l||0===l.length)return[];let e={maxValue:{duration:0,cost:0}},t=l.map(t=>({...t,meta:e,teamSlug:s?.slug,alertId:t.metadata?.alertId,duration:t.metadata?.durationSeconds===void 0?void 0:Number(t.metadata?.durationSeconds),cost:t.metadata?.totalCostUsd===void 0?void 0:Number(t.metadata?.totalCostUsd)})),a=t.reduce((e,t)=>Math.max(e,t.duration??0),0),r=t.reduce((e,t)=>Math.max(e,t.cost??0),0);return e.maxValue.duration=a,e.maxValue.cost=r,t},[l,s?.slug]),u=(0,r.useMemo)(()=>[{Header:"Alert",accessor:"alertId",sortDescFirst:!1,Cell:Q},{Header:"Duration",accessor:"duration",columnClassName:"w-28 max-w-28 min-w-28 hidden lg:table-cell",Cell:o.BarCell,cellFormatter:q},{Header:"Cost",accessor:"cost",columnClassName:"w-32 max-w-32 min-w-32 hidden lg:table-cell",Cell:o.BarCell,cellFormatter:W},{Header:"Time",accessor:"createdAt",columnClassName:"w-20 max-w-20 min-w-20",sortDescFirst:!1,Cell:o.RelativeTimeCell}],[]);if(!d&&0===c.length){let e=s?.alertInvestigation?.enabled??!1,r=s?.slug;return e?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,t.jsx)(x.EmptyState.Root,{icon:(0,t.jsx)(x.EmptyState.Icon,{icon:(0,t.jsx)(m.GitPullRequest,{size:32})}),title:"No Investigations Yet",description:`Investigations are performed on alerts that are created after ${h.VERCEL_AGENT_NAME} Investigations are enabled.`})}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,t.jsx)(x.EmptyState.Root,{title:`${h.VERCEL_AGENT_NAME} Investigations are not enabled`,description:`${h.VERCEL_AGENT_NAME} automatically investigates anomaly alerts.`,children:r&&(0,t.jsxs)(a.ButtonLink,{type:"default",href:`/${r}/~/settings#${h.VERCEL_AGENT_NAME.toLowerCase().replaceAll(" ","-")}`,children:["Enable ",h.VERCEL_AGENT_NAME]})})})}return(0,t.jsx)(n.SonarTable,{columns:u,data:c,defaultSort:[{id:"createdAt",desc:!0}],isLoading:d,plugins:[i.useSortBy,i.usePagination],autoResetPage:!0,showSearch:!1})}function K(e){let{onRetry:a}=e;return(0,t.jsx)($.Material,{className:"flex flex-col p-4 space-y-4 md:max-w-sm [@media(width>=700px)]:max-w-full",children:(0,t.jsxs)(R.Table,{children:[(0,t.jsxs)(R.Table.Colgroup,{children:[(0,t.jsx)(R.Table.Col,{}),(0,t.jsx)(R.Table.Col,{className:"hidden lg:table-cell"}),(0,t.jsx)(R.Table.Col,{})]}),(0,t.jsx)(R.Table.Header,{children:(0,t.jsxs)(R.Table.Row,{children:[(0,t.jsx)(R.Table.Head,{children:"Alert"}),(0,t.jsx)(R.Table.Head,{children:"Duration"}),(0,t.jsx)(R.Table.Head,{className:"lg:table-cell",children:"Cost"}),(0,t.jsx)(R.Table.Head,{children:"Time"})]})}),(0,t.jsx)(R.Table.Body,{children:(0,t.jsx)(R.Table.Row,{children:(0,t.jsx)(R.Table.Cell,{colSpan:4,className:"text-center py-8",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,t.jsx)(S.Text,{color:"gray-700",children:"Failed to load investigation tasks"}),a&&(0,t.jsx)(u.Button,{type:"secondary",onClick:a,prefix:(0,t.jsx)(E.RefreshClockwise,{}),children:"Retry"})]})})})})]})})}function Y(){let{team:e}=(0,s.useTeam)(),{start:a,end:i}=(0,A.useRangeFromQueryState)(),{stableStart:n,stableEnd:o}=(0,r.useMemo)(()=>{let e={minutes:1};return{stableStart:(0,k.startOfDuration)(a,e),stableEnd:(0,k.startOfDuration)(i,e)}},[a,i]),d=(0,r.useMemo)(()=>e?`/vercel-agent/api/activity?teamId=${e.id}&startTime=${n.toISOString()}&endTime=${o.toISOString()}`:null,[e,n,o]),{data:c,error:m,mutate:u}=(0,l.default)(d,async e=>{let t=await fetch(e);if(!t.ok){let e=Error("Failed to fetch investigation tasks");throw e.status=t.status,e}return t.json()},{revalidateIfStale:!1,refreshInterval:0});return m?(0,t.jsx)(K,{onRetry:()=>u()}):(0,t.jsx)(J,{data:c?.activities,team:e})}var X=e.i(5285422);function ee(){return(0,t.jsx)(X.SonarContextProvider,{children:(0,t.jsx)("div",{className:"w-full space-y-10",children:(0,t.jsxs)("div",{className:"space-y-10",children:[(0,t.jsxs)("section",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h2",{className:"text-heading-20",children:"Code Reviews"}),(0,t.jsxs)("p",{className:"max-w-[800px] text-gray-900",children:["Catch bugs before they reach production."," ",(0,t.jsx)(a.Link,{className:"text-blue-900",external:!0,href:"/docs/agent/overview",children:"Learn more"})]})]}),(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsx)(G,{}),(0,t.jsx)(F,{})]})]}),(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h2",{className:"text-heading-20",children:"Investigations"}),(0,t.jsxs)("p",{className:"text-gray-900",children:["Understand & fix production incidents faster with root-cause analysis."," ",(0,t.jsx)(a.Link,{className:"text-blue-900",external:!0,href:"/docs/agent/investigation",children:"Learn more"})]})]}),(0,t.jsx)(Y,{})]})]})})})}e.s(["default",()=>ee],7163088)}]);

//# sourceMappingURL=bdc4b09840a1e2c8.js.map
//# debugId=00b6b1cf-f7cb-5582-87bd-9b087c1505a7
