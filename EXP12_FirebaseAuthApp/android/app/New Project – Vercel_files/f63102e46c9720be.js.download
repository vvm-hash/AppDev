
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="30b3c31d-95db-5509-8104-2c7731992e0d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1303150,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),s=e.i(9722978),l=e.i(9100551),r=e.i(1344973),a=e.i(57106),i=e.i(119294),o=e.i(6352514),d=e.i(1681029),u=e.i(4478191),c=e.i(8518548),m=e.i(6613731),h=e.i(5338940),p=e.i(6656921),g=e.i(1895466),x=e.i(2504781),y=e.i(5838627),f=e.i(9334091),b=e.i(5468328),j=e.i(5323212),C=e.i(3500331),v=e.i(4237893);function I(e){let{deployment:n,teamId:s}=e,{method:l,setMethod:r,pathname:a,setPathname:i,microViewTab:o,setMicroViewTab:d,requestTab:u,setRequestTab:c,responseTab:m,setResponseTab:h,requestBody:I,setRequestBody:k,responseHar:w,sendRequest:E,urlBase:S,requestHeaders:N,responseHeaders:B}=(0,p.useRequestBuilder)({deploymentId:n.id,deploymentUrl:`https://${n.url}`,teamId:s}),R=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Tabs,{tabs:(0,g.makeTabs)(g.requestTabs),selected:u,setSelected:c,variant:"secondary",className:"my-1 shrink-0"}),"Body"===u?(0,t.jsx)(f.Textarea,{style:{fieldSizing:"content"},className:"flex grow font-mono h-full overflow-y-auto",value:I,onChange:e=>k(e.target.value)}):null,"Params"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null,"Headers"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(y.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(N.reduce((e,t)=>{let{name:n,value:s}=t;return{...e,[n]:s}},{}),null,2)})}):null,"Snippets"===u?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:"not yet implemented"}):null]}),L=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Tabs,{tabs:(0,g.makeTabs)(g.responseTabs),selected:m,setSelected:h,variant:"secondary",className:"my-1 shrink-0"}),(0,t.jsxs)("div",{className:"overflow-y-scroll",children:["Body"===m?(0,t.jsx)(y.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(w,null,2)}):null,"Headers"===m?(0,t.jsx)("div",{className:"text-muted-foreground p-4",children:(0,t.jsx)(y.CodeBlock,{className:"m-0 p-0",language:"json",hideLineNumbers:!0,children:JSON.stringify(B.reduce((e,t)=>{let{name:n,value:s}=t;return{...e,[n]:s}},{}),null,2)})}):null]})]});return(0,t.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,t.jsxs)("div",{className:"flex flex-row",style:{borderBottom:"1px solid var(--ds-gray-400)"},children:[(0,t.jsx)(j.Select,{selectClassName:"px-2 w-[54px] rounded-none shadow-none",value:l,onChange:e=>r(e.target.value),size:"small",suffix:null,style:{borderRight:"1px solid var(--ds-gray-400)"},children:g.methods.map(e=>(0,t.jsx)("option",{value:e,children:e},e))}),(0,t.jsx)(C.Input,{"aria-label":"request builder",innerWrapperClassName:"w-full rounded-none shadow-none border-l-1",prefix:(0,t.jsx)(b.Tooltip,{text:`The request will be sent with the base path: ${S}`,children:"/"}),value:a,onChange:e=>{i(e.target.value)},size:"small"}),(0,t.jsx)(b.Tooltip,{text:"Send Request",children:(0,t.jsx)(x.Button,{style:{borderRadius:0},size:"small",onClick:E,children:"Send"})})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(v.Tabs,{className:"shrink-0",tabs:(0,g.makeTabs)(g.microViewTabs),selected:o,setSelected:d,tabClassName:"py-2"}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 mt-1 max-h-full",children:["Request"===o?R:null,"Response"===o?L:null]})]})]})}var k=e.i(7087273),w=e.i(9318197),E=e.i(4450569),S=e.i(9716741);let N=e=>{let{title:n,message:s,link:l,action:r="Learn More",onDismiss:i}=e;return(0,t.jsxs)(E.default,{style:{padding:"var(--geist-gap)",width:"100%",height:"100%",position:"absolute"},children:[(0,t.jsx)(S.default,{Component:"span",h5:!0,children:n}),(0,t.jsx)(w.Spacer,{y:1/3}),(0,t.jsx)(E.default,{className:"min-h-0 break-words",children:(0,t.jsx)(k.Scroller,{children:(0,t.jsx)(S.default,{Component:"p",noMargin:!0,small:!0,type:"secondary",children:s})})}),(0,t.jsx)(w.Spacer,{y:2/3}),(0,t.jsxs)(E.default,{row:!0,style:{justifyContent:"center",alignItems:"flex-end"},children:[(0,t.jsx)(x.Button,{onClick:i,size:"small",style:{flex:"1"},type:"secondary",children:"Dismiss"}),l?(0,t.jsx)(w.Spacer,{x:.5}):null,l?(0,t.jsx)(a.ButtonLink,{href:l,size:"small",style:{flex:"1"},children:r}):null]})]})},B=["https://vercel.com/","https://zeit.ink/","https://vercel.link/","https://err.sh/","https://github.com/zeit/","https://github.com/vercel/"];var R=e.i(762945),L=e.i(6226725),T=e.i(2425341);let D=e=>{let{title:n,status:s,link:l,actionButton:r,buttonText:a,message:i}=e;return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"border-b border-solid border-gray-alpha-400 w-full p-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["ERROR"===s?(0,t.jsx)(R.Warning,{color:"red-900"}):null,"CANCELED"===s?(0,t.jsx)(L.CrossCircle,{color:"gray-900"}):null,"QUEUED"===s?(0,t.jsx)(T.Stopwatch,{color:"gray-900"}):null,(0,t.jsx)("h3",{className:"text-label-14 text-gray-1000 font-medium",children:n})]})}),(0,t.jsxs)("div",{className:"p-3 flex flex-col h-[calc(100%-45px)]",children:[(0,t.jsx)(k.Scroller,{children:(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:i||"Your deployment has failed to build successfully. Please check out the logs for more details."})}),(0,t.jsx)("div",{className:"mt-auto",children:l||r?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-y-2",children:[l?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(U,{buttonText:a,link:l,status:s})}):(0,t.jsx)(w.Spacer,{y:1/6}),r?(0,t.jsx)(t.Fragment,{children:r}):null]})}):null})]})]})},U=e=>{let{status:n,link:s,buttonText:l}=e;return"string"==typeof s&&B.some(e=>s.startsWith(e))?(0,t.jsx)(a.ButtonLink,{href:s,size:"small",type:"secondary",children:"Learn More"}):"QUEUED"===n&&s?(0,t.jsx)(a.ButtonLink,{href:s,size:"small",children:l||"Add Concurrent Builds"}):(0,t.jsx)(x.Button,{passthroughOnClick:e=>{e.preventDefault();let t=document.querySelector("[data-status=error]");t&&(t?.dataset.state!=="open"&&t.querySelector("button")?.click(),t.scrollIntoView({behavior:"smooth"}))},type:"secondary",children:"View Logs"})};var A=e.i(942336),M=e.i(5255926),O=e.i(6280036),_=e.i(6677848),P=e.i(4597921);function F(e,t){switch(t.type){case"LIGHT_IMAGE_LOADING":return{...e,lightImage:"pending"};case"LIGHT_IMAGE_SUCCESS":return{...e,lightImage:"success"};case"LIGHT_IMAGE_FAILURE":return{...e,lightImage:"failure"};case"DARK_IMAGE_LOADING":return{...e,darkImage:"pending"};case"DARK_IMAGE_SUCCESS":return{...e,darkImage:"success"};case"DARK_IMAGE_FAILURE":return{...e,darkImage:"failure"};default:return e}}let $={lightImage:"pending",darkImage:"pending"};function Q(e,t,n,s,l){let r=new URL(l?"/api/screenshot/v2":"/api/screenshot","production"!==A.default.env.VERCEL_ENV&&A.default.env.VERCEL_URL?`https://${A.default.env.VERCEL_URL}`:"https://vercel.com");return t?(r.searchParams.set("dark","dark"===e?"1":"0"),r.searchParams.set("deploymentId",t),n&&r.searchParams.set("teamId",n),s&&r.searchParams.set("withStatus","1"),`${r.pathname}${r.search}`):""}function z(e){let{srcLight:n,srcDark:s,onLoad:l,onError:r,alt:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G,{alt:a,className:"absolute block size-full dark:hidden",onError:()=>r("light"),onLoad:()=>l("light"),src:n}),(0,t.jsx)(G,{alt:a,className:"absolute hidden size-full dark:block",onError:()=>r("dark"),onLoad:()=>l("dark"),src:s})]})}function G(e){let{src:l,onLoad:r,renderScale:a=3,onError:i,className:o,alt:d}=e,u=(0,n.useRef)(null),c=(0,n.useRef)(null),[m,h]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=u.current;if(!e)return;c.current||(c.current=new Image);let t=c.current,n=()=>{let n=e.getContext("2d");if(!n)return;let s=e.offsetWidth,l=e.offsetHeight,r=s*a,i=l*a;e.width=r,e.height=i,n.scale(a,a),n.clearRect(0,0,r,i);let o=Math.min(s/t.width,l/t.height),d=s/2-t.width/2*o;n.drawImage(t,d,0,t.width*o,t.height*o)};if(t.src===l)return;t.src=l,t.onload=()=>{r(),h(!0),n()},t.onerror=()=>{i()};let s=()=>{n()};return window.addEventListener("resize",s),s(),()=>{window.removeEventListener("resize",s)}},[l,a]),(0,t.jsx)("canvas",{"aria-hidden":"true","aria-label":d,className:(0,s.clsx)(o,"size-full",{"animate-blurIn":m}),ref:u,role:"img",style:{width:"100%",height:"100%"}})}let q=n.default.memo(e=>{let{deployment:r,placeholder:a,noBorderRadius:i=!1,withReachable:o=!1,withImageWrapper:d=!0,onReady:u,height:c=400,width:m=640,onScreenshotFailed:h=()=>null}=e,p="string"==typeof r?.url?r.url:"",g="string"==typeof r?.id?r.id:void 0,x=m?{"--width":(0,_.px)(m)}:{},{teamSlug:y=""}=(0,l.useParams)()??{},f=(0,P.useServerFlag)("enable-screenshot-v2",!1),b=(0,n.useMemo)(()=>Q("dark",g,y,o,f),[g,y,o,f]),j=(0,n.useMemo)(()=>Q("light",g,y,o,f),[g,y,o,f]),[C,v]=(0,n.useReducer)(F,$),{resolvedTheme:I}=(0,O.useTheme)(),k=(0,n.useCallback)(e=>{void 0===e?(v({type:"LIGHT_IMAGE_SUCCESS"}),v({type:"DARK_IMAGE_SUCCESS"})):v({type:"dark"===e?"DARK_IMAGE_SUCCESS":"LIGHT_IMAGE_SUCCESS"}),u?.(!0)},[u]),w=(0,n.useCallback)(e=>{b&&j&&(void 0===e?(v({type:"LIGHT_IMAGE_FAILURE"}),v({type:"DARK_IMAGE_FAILURE"}),u?.(!1)):("dark"===e?b:j)&&(v({type:"dark"===e?"DARK_IMAGE_FAILURE":"LIGHT_IMAGE_FAILURE"}),u?.(!1)))},[u,b,j]),E="dark"===I?"failure"===C.darkImage:"failure"===C.lightImage,S=a||("dark"===I?"pending"===C.darkImage:"pending"===C.lightImage);if(E||!S&&!r)return h();let N=(0,t.jsx)(z,{alt:`Preview Screenshot of ${p}`,onError:w,onLoad:k,srcDark:b,srcLight:j});return(0,t.jsx)(M.Skeleton,{show:S,squared:i,style:{width:"100%",height:"100%"},children:d?(0,t.jsx)("div",{className:(0,s.clsx)("relative aspect-[var(--width,640)/var(--height,400)] size-full",{"rounded-none":i}),style:c?{"--height":(0,_.px)(c),...x}:{},children:N}):N})});var H=e.i(9508212),V=e.i(7917902),W=e.i(1717203),K=e.i(7557283),Y=e.i(8366444),J=e.i(380513);e.i(6483798);var Z=e.i(8287059),X=e.i(5023172),ee=e.i(6060673),et=e.i(5129431),en=e.i(6625227),es=e.i(5072965),el=e.i(6891161),er=e.i(455575),ea=e.i(277234),ei=e.i(4244280),eo=e.i(7837522),ed=e.i(7780974);function eu(e){let s=(0,l.useRouter)(),[i,o]=(0,n.useState)(!1),d=(0,er.useToasts)(),{track:u}=(0,eo.useTrackActivity)(),{can:c}=(0,W.default)(),m=c(K.Action.Update,K.Resource.ConcurrentBuilds),h=(0,n.useCallback)(async()=>{if(e.deploymentId&&e.teamId&&e.projectName){o(!0),u(ed.VercelActivityAction.DeploymentOverviewEnhancedBuildUpgrade,{});{let t=new URLSearchParams;t.append("teamId",e.teamId),200===(await (0,ea.fetchAPI)(`${(0,ei.API_PROJECTS_VERSION)("v9")}/${e.projectName}?${t.toString()}`,{method:"PATCH",body:JSON.stringify({resourceConfig:{elasticConcurrencyEnabled:!0,buildMachineType:e.buildMachineType}}),throwOnHTTPError:!1,returnStatus:!0})).status?d.success(`Enabled ${e.buildMachineTypeLabel}`):(d.error("Something went wrong"),o(!1),e.onClose())}{let t=new URLSearchParams;t.append("teamId",e.teamId),t.append("forceNew","1"),t.append("withCache","1");let n=`${(0,ei.API_DEPLOYMENTS)("v13")}?${t.toString()}`,l=await (0,ea.fetchAPI)(n,{method:"POST",body:JSON.stringify({deploymentId:e.deploymentId,meta:{action:"redeploy",buildMachineUpgradeReason:e.upgradeReasonCode,buildMachineAfterUpgrade:e.buildMachineType},name:e.projectName}),throwOnHTTPError:!1,returnStatus:!0});if(200===l.status&&l.body.inspectorUrl){e.onSuccess?.();let t=new URL(l.body.inspectorUrl);s.push(t.pathname)}else d.error("Something went wrong")}o(!1)}},[e,d,s,u]);return(0,t.jsxs)(el.Modal.Modal,{active:e.active,onClickOutside:e.onClose,width:"500px",children:[(0,t.jsxs)(el.Modal.Body,{children:[(0,t.jsx)(el.Modal.Header,{children:(0,t.jsx)(el.Modal.Title,{children:(0,t.jsxs)(H.Stack,{align:"center",direction:"row",gap:2,children:["Enable ",e.buildMachineTypeLabel]})})}),(0,t.jsxs)(H.Stack,{align:"center",direction:"column",gap:2,children:[(0,t.jsxs)(r.Text,{children:["Overcome memory constraints by activating On-demand Concurrency with"," ",e.buildMachineTypeLabel,"."]}),e.teamId&&e.projectName?(0,t.jsxs)(r.Text,{children:["Adjust this setting anytime via your project's"," ",(0,t.jsx)(a.Link,{as:`/${e.teamId}/${encodeURIComponent(e.projectName)}/settings/build-and-deployment#build-machine`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",variant:"highlight",children:"On-Demand Concurrent Builds"})," ","options."]}):null,(0,t.jsxs)(r.Text,{children:['By clicking "Confirm & Redeploy" you agree to be charged for On-demand Concurrency.'," ",(0,t.jsx)(a.Link,{href:"/docs/deployments/managing-builds#build-machine-types",target:"_blank",variant:"highlight",children:"Learn more"})]})]})]}),(0,t.jsxs)(el.Modal.Actions,{children:[(0,t.jsx)(el.Modal.Action,{loading:!1,onClick:e.onClose,type:"secondary",children:"Close"}),(0,t.jsx)(b.Tooltip,{text:m?void 0:`You don't have permission to Enable ${e.buildMachineTypeLabel}.`,children:(0,t.jsx)(el.Modal.Action,{disabled:i||!m,loading:i,onClick:h,children:"Confirm & Redeploy"})})]})]})}function ec(e){let{deploy:s,projectName:r,team:a}=e,{errorMessage:i="Your deployment has failed to build successfully. Please check out the logs for more details.",errorLink:o=""}=s,d=(0,l.useRouter)(),u=(0,l.useSearchParams)(),c=(0,ee.useProject)(r),m=!!u?.has("enabledEnhancedBuilds"),h=(0,n.useMemo)(()=>c.isLoading||!c.data?null:void 0===c.data.resourceConfig||!1===c.data.resourceConfig.elasticConcurrencyEnabled||void 0===c.data.resourceConfig.buildMachineType?"enhanced":"enhanced"===c.data.resourceConfig.buildMachineType?"turbo":null,[c]),p=(0,n.useCallback)(()=>{let e=new URLSearchParams(u?.toString());e.set("enabledEnhancedBuilds","1"),d.replace(`?${e.toString()}`)},[u,d]),g=(0,n.useCallback)(()=>{if(!u?.has("enabledEnhancedBuilds"))return;let e=new URLSearchParams(u?.toString());e.delete("enabledEnhancedBuilds"),d.replace(`?${e.toString()}`)},[u,d]);if(h){let e="out-of-memory"===s.oomReport,n="Your deployment's build step did not complete within the maximum of 45min"===i,l=`${h[0].toUpperCase()+h.slice(1)} Builds`,o=(0,es.createTrackingAttributes)({id:"enable-enhanced-builds-modal-opened",upgradeTarget:h??"",plan:a?.billing?.plan??""});if(e||n){let i,d,u;if(e)i="Build Failed (out of memory)",d=`Your build failed because it exceeded the amount of memory available. Enable ${l} to increase machine size and available memory.`,u=s.oomReport||"out-of-memory";else if(n)i="Build Failed (timed out)",d=`Your build exceeded the 45 minute limit. Enable ${l} to increase machine size and reduce build times.`,u="build-timed-out";else throw Error("This should never happen, satisfy typescript");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{title:i,message:d,status:"ERROR",actionButton:(0,t.jsxs)(x.Button,{className:"w-full",onClick:p,size:"small",type:"default",...o,children:["Enable ",l]})}),(0,t.jsx)(eu,{active:m,buildMachineType:h,buildMachineTypeLabel:l,deploymentId:s.id||null,onClose:g,upgradeReasonCode:u,projectName:r??null,teamId:a.slug})]})}}return(0,t.jsx)(D,{link:o,message:i,status:"ERROR",title:"Build Failed"})}var em=e.i(9041876);function eh(e){let{team:s,projectName:l}=e,r=(0,ee.useProject)(l),a=(0,n.useMemo)(()=>!r.isLoading&&r.data&&s?{enhancedBuilds:(0,em.isUpgradedBuildMachine)(r.data,s),onDemandBuilds:r.data.resourceConfig?.elasticConcurrencyEnabled??!1}:null,[r,s]);return a&&s&&l?s?.billing?.plan==="hobby"?(0,t.jsx)(ep,{team:s}):a.onDemandBuilds&&a.enhancedBuilds?(0,t.jsx)(ex,{}):a.enhancedBuilds?(0,t.jsx)(eg,{upgradeMessage:"Enable On-Demand Concurrent Builds to skip all queueing and build instantly.",projectName:l,team:s,settings:a}):(0,t.jsx)(eg,{upgradeMessage:"Switch to Enhanced Build Machines for faster builds with more CPU and memory.",projectName:l,team:s,settings:a}):(0,t.jsx)(ex,{})}function ep(e){let n,{team:s}=e,l=(0,Z.useOpenUpgradeModal)();return(0,t.jsx)(D,{message:"Upgrade to Pro for faster builds with more CPU and memory.",status:"BUILDING",title:"Building…",actionButton:(n=(0,es.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:"0",id:"faster-builds",plan:s?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(a.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(x.Button,{className:"w-full",size:"small",type:"default",onClick:()=>{l({teamHint:s.id,source:"deployment-building-status"})},...n,children:"Get Faster Builds with Pro"})]}))})}function eg(e){let n,{projectName:s,team:l,upgradeMessage:r,settings:i}=e;return(0,t.jsx)(D,{message:r,status:"BUILDING",title:"Building…",actionButton:(n=(0,es.createTrackingAttributes)({section:"deployment-status",onDemandBuildsEnabled:i.onDemandBuilds?"1":"0",id:"faster-builds",plan:l?.billing?.plan??""}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(a.ButtonLink,{href:"/docs/deployments/managing-builds#on-demand-concurrent-builds",target:"_blank",className:"w-full",size:"small",type:"secondary",children:"Read Docs"}),(0,t.jsx)(a.ButtonLink,{href:`/${l.slug}/${encodeURIComponent(s)}/settings/build-and-deployment#build-machine`,className:"w-full",size:"small",type:"default",...n,children:"Get Faster Builds"})]}))})}function ex(){return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Building..."})}let ey=new Map([["enterprise-non-unbundled","Contact sales to enable On-Demand Concurrent Builds"],["pro-non-active","Upgrade to Pro to enable On-Demand Concurrent Builds"],["no-permission","Only project admins and team owners can trigger builds on-demand"]]),ef=e=>{let{deploy:n,projectName:s}=e,l=(0,ee.useProject)(s),{data:r}=(0,en.default)(n.id),{modal:a,open:i}=(0,et.default)(l.data),o=(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{children:"An unexpected error happened when running this build. This issue is likely temporary."}),(0,t.jsx)("p",{children:"Please try to redeploy in a few minutes."})]})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{message:o,status:"ERROR",title:"Build Failed",actionButton:(0,t.jsx)(x.Button,{className:"w-full",disabled:!r,onClick:()=>{r&&i(r)},size:"small",type:"default",children:"Redeploy"})}),a]})};function eb(e){let{onClick:n,enabled:s,reasonWhyStartBuildingNowIsDisabled:l}=e;return void 0!==l?(0,t.jsx)(b.Tooltip,{position:"right",style:{alignItems:"center",flex:"1",justifyContent:"center",width:"100%"},text:l,children:(0,t.jsx)(x.Button,{disabled:!0,size:"small",style:{alignItems:"center",flex:"1",justifyContent:"center"},children:"Start Building Now"})}):(0,t.jsx)(x.Button,{disabled:!s,onClick:n,size:"small",type:"default",children:"Start Building Now"})}function ej(e){let{deploy:s,showError:l,isInConcurrentBuildsQueue:r,isInSystemBuildsQueue:i,compact:o,ctaOverride:d,projectName:u}=e,{status:c,errorMessage:m,errorLink:h=""}=s,{data:p}=(0,J.useFeatureFlag)("enable-team-deployments-page"),{user:g,team:y}=(0,V.useAccount)(),f=(0,Z.useOpenUpgradeModal)(),j=s.target?K.Resource.Deployment:K.Resource.DeploymentPreview,{can:C}=(0,W.default)(),v=C(K.Action.Update,j),[I,k]=(0,n.useState)(null),w="string"==typeof s.id?s.id:void 0,{enabled:E,disabledReason:S}=(0,Y.useOnDemandConcurrentBuilds)(y,v),N=E||S&&ey.has(S),B=S?ey.get(S):void 0,[R,L]=(0,n.useState)(E),T=N?(0,t.jsx)(eb,{enabled:R,onClick:()=>k(w??null),reasonWhyStartBuildingNowIsDisabled:B}):null,U=new URLSearchParams({content:"I'd like to add extra concurrent builds to my contract."});if(!y)return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Loading…"});if(g?.email&&U.set("email",g.email),"ERROR"===c)return l?"temporary_failure"===s.errorCode?(0,t.jsx)(ef,{deploy:s,projectName:u}):(0,t.jsx)(ec,{deploy:s,team:y,projectName:u}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-red-600",children:"Deployment Failed"});if("FROZEN"===c||"FAILED"===c)return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"No Screenshot Available"});if("NO_PRODUCTION"===c)return(0,t.jsx)(b.Tooltip,{className:"m-auto text-center",delay:!1,text:"To deploy to production, push to the Repository Default branch.",children:(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"No Production Deployment"})});if("CANCELED"===c)return l&&m?(0,t.jsx)(D,{link:h,message:m||"Deployment canceled.",status:c,title:"Build Canceled"}):(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Canceled"});if("QUEUED"===c&&i)return(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Initializing..."});if("QUEUED"===c||d){let e="Deployments",n=p?(0,t.jsx)(a.Link,{href:`/${y.slug}/~/deployments?status=building%2Cqueued`,underline:!0,children:e}):e;if("pro-concurrent-builds"===d||y.billing?.plan==="pro"&&r){let e=(y?.billing?.invoiceItems?.concurrentBuilds?.quantity??1)>1,s=y.billing?.planIteration!=="plus"||e?(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Add"," ",(0,t.jsx)(a.Link,{as:`/${y.slug}/~/settings/build-and-deployment#concurrent-builds`,href:"/[teamSlug]/~/settings/build-and-deployment#concurrent-builds",target:"_blank",underline:!0,children:"concurrent build slots"})," ","or use"," ",(0,t.jsx)(a.Link,{as:`/${y.slug}/${encodeURIComponent(u??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]}):(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Use"," ",(0,t.jsx)(a.Link,{as:`/${y.slug}/${encodeURIComponent(u??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{message:s,actionButton:T,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(X.StartBuildingNowModal,{active:!!I,deploymentId:I,onClose:()=>{k(null)},onSuccess:()=>{L(!1)},projectName:u??null,teamId:y.slug})]})}return"enterprise-concurrent-builds"===d||y.billing?.plan==="enterprise"&&r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{message:(0,t.jsxs)(H.Stack,{direction:"column",gap:1,children:[(0,t.jsxs)("div",{children:["The build will start once your other ",n," have finished."]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(a.Link,{href:`/contact/sales?${U.toString()}`,underline:!0,children:"Contact Sales"})," ","to add concurrent build slots or use"," ",(0,t.jsx)(a.Link,{as:`/${y.slug}/${encodeURIComponent(u??"")}/settings/build-and-deployment`,href:"/[teamSlug]/[project]/settings/build-and-deployment",target:"_blank",underline:!0,children:"On-Demand Concurrent Builds"})," ","to avoid the queue."]})]}),actionButton:T,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(X.StartBuildingNowModal,{active:!!I,deploymentId:I,onClose:()=>{k(null)},onSuccess:()=>{L(!1)},projectName:u??null,teamId:y.slug})]}):"hobby-concurrent-builds"===d||y.billing?.plan==="hobby"&&r?(0,t.jsx)(D,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once your other ",n," have finished. Pro teams can use On-Demand Concurrent Builds to avoid the queue."]}),status:"QUEUED",title:"Another build is in progress",actionButton:(0,t.jsx)(x.Button,{onClick:()=>{f({teamHint:y.id,source:"concurrent-builds-queue"})},size:"small",type:"default",children:"Upgrade to Pro"})}):o?(0,t.jsx)("p",{className:"m-auto text-center text-sm text-gray-600",children:"Deployment Queued"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D,{message:(0,t.jsxs)(t.Fragment,{children:["The build will start once other"," ",u?(0,t.jsx)(a.Link,{href:`/${y.slug}/${u}/deployments?status=building%2Cqueued`,underline:!0,children:e}):e," ","for this branch have finished."," ",(0,t.jsx)(a.Link,{href:"/docs/builds/build-queues#git-branch-queue",underline:!0,children:"Learn more."})]}),actionButton:T,status:"QUEUED",title:"Deployment Queued"}),(0,t.jsx)(X.StartBuildingNowModal,{active:!!I,deploymentId:I,onClose:()=>{k(null)},onSuccess:()=>{L(!1)},projectName:u??null,teamId:y.slug})]})}return(0,t.jsx)(eh,{team:y,projectName:u})}var eC=e.i(542164);let ev=new Map;window.addEventListener("storage",e=>{e.key&&(null===e.newValue?ev.delete(e.key):ev.set(e.key,e.newValue))});class eI{key;defaultValue;constructor(e,t){this.key=e,this.defaultValue=t,this.init()}init(){if(!ev.has(this.key))try{ev.set(this.key,window.localStorage?.getItem(this.key))}catch(e){}}reset(){this.set(this.defaultValue)}get(){let e=ev.get(this.key);if(!e)return this.defaultValue;try{return JSON.parse(e)}catch(e){return this.defaultValue}}set(e){try{let t=JSON.stringify(e);window.localStorage?.setItem(this.key,t),ev.set(this.key,t)}catch(e){}}remove(){try{window.localStorage?.removeItem(this.key),ev.delete(this.key)}catch(e){}}}function ek(e,t){let n=t?.name||e.url;return!n||(0,eC.default)(n)?e.url:n}let ew=["nitro","express","fastapi","hono","xmcp"];function eE(e){let{deployment:p,ignoreAliasWarning:g=!0,placeholder:x,toolbarVia:y,customHref:f,compact:b,...j}=e,{showError:C=!1,link:v=!0,empty:k=!1,noHighlight:w,noBorder:E,noBorderRadius:S,useDeploymentUrl:B=!1,onClick:R}=j,L=null!=p&&"project"in p?p.project?.name:void 0,T=(0,l.useSearchParams)(),{domain:U}=(0,c.useBestProductionDomain)(L),A=U||j.projectDomain||null,M=(0,P.useServerFlag)("request-builder",!1),[O,_]=function(e){let t=(0,n.useMemo)(()=>e?new eI(`show-deployment-warning:${e.uid||e.id}`,!0):null,[e]),[s,l]=(0,n.useState)(()=>{let e=t?.get();return"boolean"!=typeof e||e});return[s,e=>{t?.set(e),l(e)}]}(p),{onClick:F,...$}=(0,m.useWrappedToolbarAuthLinkHandler)({via:y??"project-screenshot",deployment:v?p:void 0}),{team:Q}=(0,h.useTeam)(),z=function(e){if(!e||!("microfrontends"in e)||!e.microfrontends)return!1;let t=e.microfrontends;return!t.isDefaultApp&&!t.defaultRoute}(p),G=`/${Q?.slug}/${L}/settings/microfrontends#default-route`,H=(0,n.useMemo)(()=>(function(e){if(null!==e){if(null!==e.get("overrideHobbyConcurrentBuildsCta"))return"hobby-concurrent-builds";if(null!==e.get("overrideProConcurrentBuildsCta"))return"pro-concurrent-builds";if(null!==e.get("overrideEnterpriseConcurrentBuildsCta"))return"enterprise-concurrent-builds"}})(T),[T]),V=(()=>{let e=(0,l.useParams)(),{data:t}=(0,ee.useProject)(e?.project);return!!t&&"framework"in t&&!!t.framework&&!!ew.includes(t?.framework)})(),W=(0,n.useMemo)(()=>{if(!p)return k?{status:"NO_PRODUCTION"}:null;let e=B?p.url:ek(p,A);return{id:p.uid||p.id,url:e,target:p.target,status:p.readyState,errorCode:p.errorCode,errorMessage:p.readyStateReason||p.errorMessage,errorLink:p.errorLink,aliasWarning:p.aliasWarning,oomReport:p.oomReport}},[B,p,k,A]),K=!g&&O&&W?.status==="READY"&&W?.aliasWarning?.code==="deprecated_now_sh",Y=W&&"READY"!==W.status,J=W?.status==="ERROR"||p?.aliasError,Z=(0,n.useCallback)(()=>(0,t.jsx)(ej,{deploy:{...W,status:"FAILED"},isInConcurrentBuildsQueue:p?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:p?.isInSystemBuildsQueue,projectName:L,showError:C}),[W,C,L,p?.isInConcurrentBuildsQueue,p?.isInSystemBuildsQueue]),X=(0,n.useMemo)(()=>H?(0,t.jsx)(ej,{ctaOverride:H,deploy:W??{},isInConcurrentBuildsQueue:p?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:p?.isInSystemBuildsQueue,projectName:L,showError:C}):p?.aliasError?(0,t.jsx)(D,{message:p.aliasError.message,status:"ERROR",title:"Domain Error"}):K?(0,t.jsx)(N,{link:W.aliasWarning.link,message:W.aliasWarning.message,onDismiss:()=>_(!1),title:"Warning"}):Y?(0,t.jsx)(ej,{compact:b,deploy:W,isInConcurrentBuildsQueue:p?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:p?.isInSystemBuildsQueue,projectName:L,showError:C}):z?(0,t.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[(0,t.jsx)(r.Text,{size:16,weight:600,children:"Default Route Missing"}),(0,t.jsxs)(r.Text,{className:"text-[var(--geist-secondary)]",children:[(0,t.jsx)(a.Link,{href:G,underline:!0,children:"Set the default route"})," ","for this microfrontend to screenshot the correct path. The default route is used anywhere that the microfrontend domain is referenced for this project."," ",(0,t.jsx)(a.Link,{external:!0,href:"/docs/microfrontends/managing-microfrontends#set-a-default-route",tab:!0,type:"highlight",children:"Learn More"})]})]}):V&&M?(0,t.jsx)(I,{deployment:p,teamId:Q?.id}):v&&p?.url?(0,t.jsx)(a.Link,{"aria-label":"Visit Deployment",href:f||(0,u.withDefaultRoute)((0,d.domainToUrl)(B?p.url:ek(p,A)),p.defaultRoute),...$,onClick:e=>{R?.(e),F?.(e),i.analytics.track(o.AnalyticsEvent.DEPLOYMENT_OVERVIEW_CLICKED_SCREENSHOT,{projectId:p.projectId||A?.projectId,deploymentId:p.id,deploymentTarget:p.target})},style:{width:"100%"},tab:!0,children:(0,t.jsx)(q,{deployment:W,onScreenshotFailed:Z,placeholder:x,withReachable:!0,...j})}):(0,t.jsx)(q,{deployment:W,onScreenshotFailed:()=>(0,t.jsx)(ej,{deploy:{...W,status:"FAILED"},isInConcurrentBuildsQueue:p?.isInConcurrentBuildsQueue,isInSystemBuildsQueue:p?.isInSystemBuildsQueue,projectName:L,showError:C}),placeholder:x,withReachable:!0,...j}),[H,W,p,v,A,j,_,Y,K,C,B,Z,x,L,R]);return(0,t.jsx)("div",{className:(0,s.clsx)("geist-ratio","size-full p-0","border border-solid border-[var(--ds-gray-400)]","rounded-[var(--geist-radius)]","flex flex-none justify-center","overflow-hidden","aspect-[640/400]",{"w-screen max-w-full":Y,"bg-[var(--ds-background-200)]":W?.status==="CANCELED"||W?.status==="QUEUED"||W?.status==="FROZEN"||W?.status==="FAILED",group:!w,"border-[var(--ds-red-500)]":J,"border-[var(--ds-amber-400)]":K,"min-w-[108px]":W?.status==="NO_PRODUCTION","border-0":E,"rounded-none":S}),style:{"--ratio":"62.5%"},children:X})}e.s(["DeploymentPreview",()=>eE],1303150)}]);

//# sourceMappingURL=01d73434616fef9b.js.map
//# debugId=30b3c31d-95db-5509-8104-2c7731992e0d
