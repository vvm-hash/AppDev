
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7a3c1243-8b3d-560b-afda-f2b26969c406")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9263987,e=>{e.v({bounce:"deploying-module__iZpPmG__bounce",buttonsContainer:"deploying-module__iZpPmG__buttonsContainer",chevron:"deploying-module__iZpPmG__chevron",commitMessage:"deploying-module__iZpPmG__commitMessage",commitMessageContainer:"deploying-module__iZpPmG__commitMessageContainer",error:"deploying-module__iZpPmG__error",header:"deploying-module__iZpPmG__header",logs:"deploying-module__iZpPmG__logs",logsError:"deploying-module__iZpPmG__logsError",logsText:"deploying-module__iZpPmG__logsText",logsTimestamp:"deploying-module__iZpPmG__logsTimestamp",panel:"deploying-module__iZpPmG__panel",pop:"deploying-module__iZpPmG__pop",root:"deploying-module__iZpPmG__root",slideDown:"deploying-module__iZpPmG__slideDown",slideUp:"deploying-module__iZpPmG__slideUp",step:"deploying-module__iZpPmG__step",warning:"deploying-module__iZpPmG__warning"})},2148480,e=>{"use strict";var t=e.i(6468255),r=e.i(1696541),a=e.i(9429645),i=e.i(9722978),o=e.i(8248823),n=e.i(1991452),s=e.i(2504781),l=e.i(9318197),u=e.i(9508212),c=e.i(455575),d=e.i(57106),m=e.i(6696646),p=e.i(119294),g=e.i(6352514),f=e.i(8042625),y=e.i(277234),h=e.i(4244280),S=e.i(5338940),x=e.i(5140444),v=e.i(3322724),b=e.i(9716741),w=e.i(4787991),P=e.i(6038905),j=e.i(2695633);e.i(5224197);var _=e.i(7442785),C=e.i(855127),T=e.i(6060673),E=e.i(5466001),A=e.i(2574789),R=e.i(9375869),k=e.i(9263987);function I(e){let I,{flow:N,deployment:D,mutateDeployment:O,dispatch:M,isVercelTutor:L,vercelTutorPrUrl:G,clonedFrom:$,flowId:z,microfrontendsGroupId:F}=e,U=(0,c.useToasts)(),q=(0,n.useRouter)(),{active:B}=(0,P.useCardContext)(),[V,Z]=(0,m.useState)(!1),{expandedSteps:Y,setExpandedSteps:H}=(0,C.useExpandedSteps)(D),{team:W}=(0,S.useTeam)(),{user:J}=(0,x.useUser)(),Q=(0,m.useCallback)(async()=>{Z(!0);try{let e=await (0,y.fetchAPI)(`${(0,h.API_DEPLOYMENTS)("v12")}/${D?.id}/cancel${(0,f.encode)({teamId:D?.team?.id})}`,{method:"PATCH",throwOnHTTPError:!0});"CANCELED"===e.readyState&&(U.success("Deployment canceled."),(0,a.mutate)(D?.id??""),"import"===N&&M&&M({type:"SET_DEPLOYING",deploying:!1}))}catch(e){U.error((0,o.errorToString)(e))}finally{Z(!1)}},[D,U,M,N]),X=D&&["ERROR","CANCELED","READY"].includes(D.readyState)||!B;D?.meta?.githubDeployment?I=(0,j.getGithubMetaInfo)(D.meta):D?.meta?.gitlabDeployment?I=(0,j.getGitlabMetaInfo)(D.meta):D?.meta?.bitbucketDeployment&&(I=(0,j.getBitbucketMetaInfo)(D.meta));let{data:K}=(0,T.useProject)(D?.projectId),ee=(0,w.useNewProjectLink)(),{mutate:et}=(0,E.useRemainingEligibleProjects)(),er=(0,A.useLogImportProgressEvent)();(0,m.useEffect)(()=>{q.prefetch(`${ee}/success`)},[q,ee]);let ea=(0,m.useCallback)(()=>{p.analytics.track(g.AnalyticsEvent.PROJECT_CREATION_SUCCESS,{version:3,flow:N}),p.analytics.track(g.AnalyticsEvent.CREATE_PROJECT,{onboarding:"true"===q.query.onboarding});let e=q.query.remainingProjects,t=q.query.totalProjects;"string"==typeof e&&"string"==typeof t&&er(Number.parseInt(e)-1,Number.parseInt(t),"import");let a=(0,r.stringify)({"auto-redirect":!0,"developer-id":q.query["developer-id"],"external-id":q.query["external-id"],"redirect-url":q.query["redirect-url"],branch:K?.link?.productionBranch??"master",deploymentUrl:D?.url??"",projectName:K?.name??"",s:q.query.s??I?.branchUrl,gitOrgLimit:q.query.gitOrgLimit,hasTrialAvailable:q.query.hasTrialAvailable,totalProjects:q.query.totalProjects,...L?{"vercel-tutor":!0}:{},...G?{"vercel-tutor-pr-url":G}:{},...$?{"cloned-from":$}:{},...z?{"flow-id":z}:{},..."1"===q.query.microfrontends?{microfrontends:"1"}:{},...F?{microfrontendsGroupId:F}:{}});et().then(()=>{q.push(`${ee}/success?${a}`)})},[$,N,q,K?.link?.productionBranch,K?.name,D?.url,I?.branchUrl,et,er,ee,L,G,z,F]),ei=!!I,eo=(0,v.useIsMobile)(),en=D?.readyState==="ERROR",es=(0,m.useMemo)(()=>{let e=`/${W?.slug??J?.username??""}`;return`${e}/${K?.name??""}`},[K?.name,W,J?.username]),el=(0,R.useDeploymentLink)(D),eu=(0,m.useMemo)(()=>({sm:"column",md:"row",lg:"row"}),[]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.DeploySteps,{creationFlow:!0,deployment:D,expandedSteps:Y,mutateDeployment:O,onComplete:ea,onExpandedStepsChange:e=>H(e),teamSlug:W?.slug,context:"new-project-flow"}),(0,t.jsx)(l.Spacer,{expand:!0}),(0,t.jsxs)(u.Stack,{direction:eo?"column":"row",gap:4,justify:ei&&!eo?"space-between":"center",children:[I?(0,t.jsxs)(u.Stack,{align:"center",className:k.default.commitMessageContainer,direction:"row",flex:1,gap:2,children:[(0,t.jsx)(d.Link,{external:!0,href:I.commitUrl}),(0,t.jsxs)(b.default,{Component:"span",className:(0,i.clsx)(k.default.commitMessage),h6:!0,noMargin:!0,style:{color:B?"var(--accents-5)":"var(--accents-3)"},title:I.commitMessage,weight:400,children:[I.commitMessage.split("\n")[0]," - ",I.sha.slice(0,6)]})]}):(0,t.jsx)("div",{style:{height:21}}),en||"import"===N?(0,t.jsxs)(u.Stack,{className:k.default.buttonsContainer,direction:eu,gap:2,justify:"flex-end",children:[en?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.ButtonLink,{href:es,size:"small",type:"secondary",children:"Go to Project"}),(0,t.jsx)(d.ButtonLink,{href:el,size:"small",children:"Inspect Deployment"})]}):null,en||"import"!==N?null:(0,t.jsx)(s.Button,{disabled:X,loading:V||D?.readyState==="READY",onClick:()=>void Q(),size:"small",type:"secondary",children:D?.readyState==="READY"?"Completing Deployment…":"Cancel Deployment"})]}):null]})]})}e.s(["default",()=>I])},8492314,e=>{"use strict";var t=e.i(6696646),r=e.i(6625227),a=e.i(100247),i=e.i(7783521),o=e.i(229875);function n(e){let[n,s]=(0,t.useState)(0),l=(0,r.default)(e,{refreshInterval:n},{automaticAliases:!0}),{data:u,mutate:c}=l,d=u?.readyState,m=u?.aliasAssigned||"ERROR"===d||"CANCELED"===d,p=(0,t.useMemo)(()=>(0,o.withThrottle)(e??"",()=>{c()}),[e,c]),{isListening:g}=(0,i.useDeploymentStatusPing)(m?void 0:u,p),{areChecksRunning:f,areDomainsAssigning:y}=(0,a.getDeploymentStatus)(u),h=(!u||m)&&!f&&!y||g,S=u?.readyState==="QUEUED";return(0,t.useEffect)(()=>{S?s(1e3):s(3e3*!h)},[h,S]),l}e.s(["useNewDeploymentInterval",()=>n])},4963367,e=>{e.v({deployCard:"deploy-card-module__wIQjha__deployCard"})},9187364,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),a=e.i(1991452),i=e.i(8735244),o=e.i(9508212),n=e.i(6232213),s=e.i(7218483),l=e.i(100247),u=e.i(2148480),c=e.i(6038905),d=e.i(8492314),m=e.i(4963367),p=e.i(4422059);function g(e){let{deploymentId:g,flow:f,resetDeploying:y,isVercelTutor:h,vercelTutorPrUrl:S,clonedFrom:x,flowId:v,microfrontendsGroupId:b,...w}=e,P=(0,a.useRouter)(),{data:j,mutate:_}=(0,d.useNewDeploymentInterval)(g);(0,r.useEffect)(()=>{if(g){let e=P.query.deploymentId,t=Array.from(new Set(Array.isArray(e)?e.concat([g]):[e??g,g]));P.replace({query:{...P.query,deploymentIds:t}},void 0,{shallow:!0})}},[g]);let{areChecksRunning:C,areDomainsAssigning:T}=(0,l.getDeploymentStatus)(j),E=(0,s.useAgo)(j?.createdAt,{justNowThreshold:0}),A=(0,r.useMemo)(()=>{if(!j)return"Preparing deployment…";switch(j.readyState){case"QUEUED":return(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment queued..."]});case"READY":if(C||T)return(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment started ",E,"..."]});return"Deployment completed.";case"ERROR":return"Deployment failed with error.";case"CANCELED":return"Deployment canceled.";default:return(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(i.Spinner,{size:16}),"Deployment started ",E,"..."]})}},[j,E,C,T]);return!function(e){let{callback:t,deployment:a}=e,i=(0,p.usePrevious)(a?.id),o=(0,p.usePrevious)(a?.readyState);(0,r.useEffect)(()=>{a?.id&&i&&o&&i===a.id&&o!==a.readyState&&("CANCELED"===a.readyState||"ERROR"===a.readyState)&&t(a.readyState)},[a?.readyState,t,a?.id,i,o])}({callback:(0,r.useCallback)(()=>{(0,n.postToStatsigClient)({events:[{eventName:`${f}_deploy_error`}]}),y?.()},[f,y]),deployment:j}),(0,t.jsx)(c.default,{className:m.default.deployCard,subtitle:A,title:"Deployment",...w,children:(0,t.jsx)(u.default,{deployment:j,flow:f,isVercelTutor:h,mutateDeployment:_,vercelTutorPrUrl:S,clonedFrom:x,flowId:v,microfrontendsGroupId:b})})}e.s(["default",()=>g])},7374478,e=>{"use strict";var t=e.i(6468255),r=e.i(9739627);function a(){return(0,t.jsx)(r.Image,{alt:"Slash Divider",height:40,srcDark:"https://assets.vercel.com/image/upload/v1689795055/front/new/slash-divider-dark.svg",srcLight:"https://assets.vercel.com/image/upload/v1689795055/front/new/slash-divider-light.svg",width:40})}e.s(["SlashDivider",()=>a])},7691989,e=>{"use strict";var t=e.i(8042625),r=e.i(277234),a=e.i(4244280);e.s(["displayError",0,e=>e?.code==="tarball_not_found"?"Your codebase could not be retrieved. Please check that your repository is not empty.":e?.keyword==="additionalProperties"?"Additional property `"+e.params?.additionalProperty+"` is not allowed. Please check the `vercel.json` or `now.json` file in your repository.":e?.message||e?.toString?.(),"getProject",0,e=>{let{id:i,teamId:o}=e;return(0,r.fetchAPI)(`${a.API_PROJECTS}/${i}${(0,t.encode)({teamId:o})}`,{throwOnHTTPError:!0})},"getProjectInfo",0,e=>{let{name:i,teamId:o}=e;return(0,r.fetchAPI)(`${a.API_PROJECTS}/${encodeURIComponent(i||"")}${(0,t.encode)({teamId:o,deploymentInfo:0})}`,{throwOnHTTPError:!0})}])},5394280,e=>{"use strict";var t=e.i(8042625),r=e.i(277234),a=e.i(4244280);async function i(e){let{type:i,source:o,target:n,teamId:s,branch:l}=e;return(0,r.fetchAPI)(`${a.API_INTEGRATION_CONTROLLER}/push-to-repo${(0,t.encode)({teamId:s})}`,{method:"POST",body:JSON.stringify({type:i,source:o,repo:n,branch:l}),throwOnHTTPError:!0,wrapErrorsLegacy:!0})}e.s(["pushRepo",()=>i])},3332814,e=>{"use strict";function t(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;return!0}let r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(let a of r)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0}e.s(["shallow",()=>t])},5680277,e=>{"use strict";var t=e.i(2692457),r=e.i(6696646),a=e.i(3332814);let i={loading:!1,gitType:void 0,repoNameStates:{},isPrivate:!0,gitError:null,isTeamRepo:!1},o=(0,t.create)(e=>({...i,setLoading:t=>e(e=>({...e,loading:t})),setGitType:t=>e(e=>({...e,gitType:t})),setRepoNameStates:t=>{e(e=>{let r=t(e.repoNameStates);return{...e,repoNameStates:r}})},setIsPrivate:t=>e(e=>({...e,isPrivate:t})),setGitError:t=>e(e=>({...e,gitError:t})),reset:()=>e(i),setIsTeamRepo:t=>e({isTeamRepo:t})}));e.s(["useGitInputStore",0,o,"useNewNamespace",0,()=>{let e=o((0,r.useCallback)(e=>e.gitType,[]),a.shallow),t=o((0,r.useCallback)(e=>e.repoNameStates,[]),a.shallow)[e||""];return Array.isArray(t)?t[0]:null},"useNewRepo",0,()=>{let e=o((0,r.useCallback)(e=>e.gitType,[]),a.shallow),t=o((0,r.useCallback)(e=>e.repoNameStates,[]),a.shallow)[e||""];return Array.isArray(t)?t[1]:null}])},5432439,e=>{"use strict";var t=e.i(9385057),r=e.i(6696646),a=e.i(3332814),i=e.i(8248823),o=e.i(134877),n=e.i(7691989),s=e.i(5680277);function l(){let{setLoading:e,setGitError:l}=(0,s.useGitInputStore)((0,r.useCallback)(e=>({setLoading:e.setLoading,setGitError:e.setGitError}),[]),a.shallow),u=(0,s.useNewRepo)();return async(r,a)=>{if(!u&&!a)return;let s=(0,t.customAlphabet)("123456789abcdefghijklmnopqrstuvwxyz",4),c=u?u.slice(0,95):"",d=a??c;try{await (0,n.getProject)({id:d,teamId:r}),d=`${d}-${s()}`}catch(t){if((0,o.isAPIError)(t)&&"not_found"!==t.code){e(!1),l((0,i.normalizeError)(t));return}}return d}}e.s(["useGetProjectName",()=>l])},6475061,8334396,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),a=e.i(9100551),i=e.i(5338940),o=e.i(9508212),n=e.i(1344973),s=e.i(5140444);function l(e){let[t,a]=(0,r.useState)(!1),i=(0,r.useRef)(!1),o=(0,r.useRef)(e),n=(0,r.useCallback)(r=>{a(r),i.current=t,o.current=e},[e,t]);return(0,r.useMemo)(()=>({data:t?o.current:e,frozen:t,setFrozen:n}),[e,t,n])}var u=e.i(5255926);function c(){return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,t.jsx)(u.Skeleton,{className:"flex-1",height:"68px"}),(0,t.jsx)(u.Skeleton,{className:"flex-1",height:"68px"})]}),(0,t.jsx)(u.Skeleton,{height:"24px",width:"auto"}),(0,t.jsx)(u.Skeleton,{height:"40px",width:"auto"})]})}var d=e.i(6079422),m=e.i(6489459),p=e.i(455575),g=e.i(1991452),f=e.i(5523169);e.i(7197081);var y=e.i(626404),h=e.i(6352514),S=e.i(119294),x=e.i(8631221),v=e.i(3196486),b=e.i(1628687);let w=e=>{S.analytics.track(h.AnalyticsEvent.NEW_FLOW_CONVERTED,e),(0,v.sendToSnowflake)(x.Topic.VercelAppV0NewFlowConverted,{conversion_type:(0,b.snowflakeify)(e.conversionType),source:e.source,actor_id:e.actorId,team_id:e.teamId,team_created_at:(0,b.floor)(e.teamCreatedAt),prior_plan:(0,b.snowflakeify)(e.priorPlan),new_plan:(0,b.snowflakeify)(e.newPlan),cart_total:(0,b.floor)(e.cartTotal)},"vercel-app")};var P=e.i(9588822),j=e.i(7846892),_=e.i(8378310),C=e.i(2401140),T=e.i(4736806),E=e.i(1450448),A=e.i(5786585);let R=(0,P.withStripe)(function(e){let{user:a,active:i,source:o,teamManager:n,close:s,continueAction:l,isProTrialAndRequirePayment:u}=e,{team:c,members:d,cartTotal:m,setCartTotal:p,isSubmitting:g,setIsSubmitting:f,scrollToRef:y,paymentMethodInfo:h,showSkeleton:S,onBillingFormReady:x,submit:v,makeDefaultBillingAddress:b,elements:w,billingFormProps:P,addressError:R,setAddressError:k}=(0,E.usePaymentInfoStep)({teamManager:n}),[I,N]=(0,r.useState)(),[D,O]=(0,r.useState)({}),[M,L]=(0,r.useState)(),G=(0,A.usePaymentInfoContinue)({type:"new-flow",team:c,setIsSubmitting:f,submit:v,makeDefaultBillingAddress:b,elements:w,setAddressError:k,cartTotal:m,continueAction:l,paymentMethodInfo:h,taxId:M,teamManager:n,unparsedAddress:D,setSubmissionError:N});return(0,t.jsx)(j.SheetWrapper,{open:i,onClose:s,teamManager:n,children:(0,t.jsx)(C.SheetStepWrapper,{hideFooter:S,title:(0,t.jsx)(_.DefaultTitle,{teamManager:n}),defaultCancelText:"Cancel",defaultContinueText:l.text,cancelButton:{text:"Cancel",onClick:s,disabled:g},continueButton:{text:l.text,onClick:()=>void G(),disabled:"loading"===h.type},loading:g,onCancel:s,onContinue:()=>void G(),children:(0,t.jsx)(T.PaymentInfoShared,{user:a,team:c,teamManager:n,setCartTotal:p,members:d,source:o,showSkeleton:S,paymentMethodInfo:h,makeDefaultBillingAddress:b,onBillingFormReady:x,billingFormProps:P,isSubmitting:g,addressError:R,scrollToRef:y,type:"new-flow",setUnparsedAddress:O,setTaxId:L,submissionError:I,continueButtonText:l.text,isProTrialAndRequirePayment:u})})})});var k=e.i(2504781),I=e.i(8248823),N=e.i(4976875),D=e.i(3238154),O=e.i(8668551);function M(e){let{teamManager:a,planSelector:i,continueAction:o,frozen:n}=e,{validationError:s,setValidationError:l,validate:u,onBlur:c}=(0,N.useTeamNameInput)({teamManager:a}),[d,m]=(0,r.useState)(),[p,g]=(0,r.useState)(!1),f=(0,r.useCallback)(async()=>{m(void 0),g(!0);try{let e=u();if(e)return void l(e);await o.onContinue()}catch(e){m((0,I.normalizeError)(e).message)}finally{g(!1)}},[o,u,l]);return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(D.TeamNameInput,{validationError:s,onBlur:c,teamManager:a,isNewProjectFlow:!0,frozen:n}),(0,t.jsx)(O.SelectorSection,{planSelector:i,errorMessage:d,className:"flex flex-col gap-3",frozen:n}),(0,t.jsx)(k.Button,{loading:p||n,onClick:()=>void f(),typeName:"button",children:o.text})]})}function L(e){let{user:r,continueAction:a,teamManager:i,stepState:o,planSelector:n,source:s,frozen:l,isProTrialAndRequirePayment:u}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M,{continueAction:a,frozen:l,planSelector:n,teamManager:i}),(0,t.jsx)(R,{user:r,active:"payment-info"===o.step,close:()=>{o.goto.step("select-team-and-plan")},continueAction:a,source:s,teamManager:i,isProTrialAndRequirePayment:u})]})}var G=e.i(2762499),$=e.i(1347988),z=e.i(4597921),F=e.i(4429918),U=e.i(8851095);function q(e){return(0,t.jsx)(U.SafeSuspense,{error:(0,t.jsx)(V,{...e,proTrialRequirePaymentFlagVal:null}),loading:null,children:(0,t.jsx)(B,{...e})})}function B(e){let{value:r}=(0,z.useServerFlag)("pro-trial-require-payment-on-upgrade",(0,F.statsigOption)(null));return(0,t.jsx)(V,{...e,proTrialRequirePaymentFlagVal:r})}function V(e){let{user:i,teamManager:o,planSelector:n,source:s,onConversionError:l,onConversionSuccess:u,onConversionStart:c,mutate:d,frozen:m,setFrozen:h,proTrialRequirePaymentFlagVal:S}=e,x=(0,y.useSteps)({steps:["select-team-and-plan","payment-info"],workflowName:"new-flow-upgrade"}),v=(0,g.useRouter)(),b=(0,a.useSearchParams)(),P=(0,a.usePathname)(),j=(0,r.useRef)(null),_=!!(S&&"pro-trial"===n.selectedPlan),C=(0,G.useCreateTeam)({teamManager:o,onConversionStart:c,planSelector:n,mutate:d,onConversionError:l,router:v,customCreateTeamApiSource:"new-flow-upgrade",customPostCreationFlow:e=>{let{team:t,cartTotal:r,selectedPlan:a}=e;j.current=t,w({conversionType:"create",source:s,actorId:i.uid,teamId:t.id,teamCreatedAt:t.createdAt,priorPlan:"hobby",newPlan:a,cartTotal:r});let o=new URLSearchParams(b?.toString());o.set("teamSlug",t.slug),v.replace(`${P}?${o.toString()}`,void 0,{scroll:!1}),p.toasts.success({text:"Your team has been created."})}}),T=(0,$.useUpgradeTeam)({teamManager:o,onConversionStart:c,planSelector:n,mutate:d,onConversionError:l,router:v,source:s,customPostUpgradeFlow:e=>{let{team:t,selectedPlan:r,cartTotal:a}=e;w({conversionType:"upgrade-existing",source:s,actorId:i.uid,teamId:t.id,teamCreatedAt:t.createdAt,priorPlan:"hobby",newPlan:r,cartTotal:a})},awaitMutate:!0}),E="pro"===n.selectedPlan||_,A=(0,r.useMemo)(()=>"select-team-and-plan"===x.step&&E?"Continue to Payment":"create"===o.userIntent?"Create Team and Deploy":"Upgrade and Deploy",[E,x.step,o.userIntent]),R=(0,r.useCallback)(async e=>{if("select-team-and-plan"===x.step&&E)return void x.goto.step("payment-info");h(!0),await c();try{"create"===o.userIntent?await C(e):await T(e?{upgradeTimingOption:"now",...e}:{upgradeTimingOption:"now",cartTotal:0}),await u(j.current??void 0)}catch(e){throw h(!1),await l().catch(f.default),e}},[C,E,l,c,u,h,x.goto,x.step,o.userIntent,T]),k=(0,r.useMemo)(()=>({onContinue:R,text:A}),[A,R]);return(0,t.jsx)(L,{user:i,continueAction:k,frozen:m,planSelector:n,source:s,stepState:x,teamManager:o,isProTrialAndRequirePayment:_})}function Z(e){let{user:r,team:a,disallowHobby:i,source:o,onConversionError:n,onConversionSuccess:s,onConversionStart:u,mutate:p,frozen:g,setFrozen:f}=e,{data:y,frozen:h,setFrozen:S}=l((0,m.useTeamManagerFromTeam)({team:a})),{data:x,frozen:v,setFrozen:b}=l((0,d.usePlanSelector)({teamManager:y,disallowHobby:i}));return x.loading?(0,t.jsx)(c,{}):(0,t.jsx)(q,{frozen:g||h||v,mutate:p,onConversionError:n,onConversionStart:u,onConversionSuccess:s,planSelector:x.data,setFrozen:e=>{f(e),S(e),b(e)},source:o,teamManager:y,user:r})}let Y=()=>Promise.resolve();function H(e){let{selectedTeamSlug:r,disallowHobby:a,source:o,onConversionError:n=Y,onConversionSuccess:u=Y,onConversionStart:d=Y}=e,{user:m,isLoading:p,mutate:g}=(0,s.useUser)(),{team:f,isLoading:y,mutate:h}=(0,i.useTeam)(r),{data:S,frozen:x,setFrozen:v}=l(f),b=async()=>{await Promise.all([g(),h()])};return p||y?(0,t.jsx)(c,{}):!m||S&&S.billing?.plan!=="hobby"?null:(0,t.jsx)(Z,{disallowHobby:a,frozen:x,mutate:b,onConversionError:n,onConversionStart:d,onConversionSuccess:u,setFrozen:v,source:o,team:S??void 0,user:m})}let W=e=>{switch(e){case"github":return"GitHub organization";case"gitlab":return"GitLab group";case"bitbucket":return"Bitbucket workspace";default:return"organization"}};function J(e){let{disallowHobby:i,selectedTeamSlug:n,onSubmit:s,setFreezeUpgradeUI:l}=e,u=(0,a.usePathname)(),c=(0,r.useMemo)(()=>u?u.includes("import")?"import":u.includes("clone")?"new-clone":u.replace(/\/|\s/g,"-"):"unknown",[u]),d=(0,r.useMemo)(()=>{if(""!==n)return n??void 0},[n]);return(0,t.jsx)(o.Stack,{gap:1,children:(0,t.jsx)(H,{disallowHobby:i,onConversionError:()=>Promise.resolve(l(!1)),onConversionStart:()=>Promise.resolve(l(!0)),onConversionSuccess:s,selectedTeamSlug:d,source:c})})}e.s(["getGitProviderNameAndOrg",0,W],8334396),e.s(["UpgradeCTA",()=>J,"useUpgradeCTA",0,e=>{let{isCreatingTeam:a,isTeamRepo:o,isPrivate:s,gitType:l,selectedTeamSlug:u}=e,{teams:c,team:d,isReady:m}=(0,i.useTeam)(u),p=s&&o,g=d?.billing&&"hobby"!==d.billing.plan,f=m&&c?.length===0,y=p&&!g&&!!d?.billing||a||f,[h,S]=(0,r.useState)(!1),x=y||h;return{upgradeMessage:x?(0,t.jsxs)(t.Fragment,{children:["Deploying from a ",s?"private ":"",W(l)," requires a Vercel Pro plan. Switch to an existing Pro team or"," ",a?"create a new one":(0,t.jsxs)(t.Fragment,{children:["upgrade"," ",(0,t.jsx)(n.Text,{as:"span",color:"inherit",weight:500,children:d?.name})]})," ","to continue."]}):null,showUpgradeCTA:x,setFreezeUpgradeUI:S,disallowHobby:p}}],6475061)},6913536,e=>{"use strict";var t=e.i(6532114);function r(e,r,a){if(null===e)return"";let i=(0,t.getRepoTree)(e.type);return`${e.url}${a?`${e.subdir?"":`/${i}/${e.branch||r||"main"}`}/${a}`:""}`}e.s(["default",()=>r])},8276950,e=>{e.v({comboboxLabel:"team-selector-module__POX1Da__comboboxLabel",input:"team-selector-module__POX1Da__input",tooltip:"team-selector-module__POX1Da__tooltip"})},4909757,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),a=e.i(6881349),i=e.i(5468328),o=e.i(9508212),n=e.i(4585051),s=e.i(5255926),l=e.i(5756088),u=e.i(5883567),c=e.i(1344973),d=e.i(5338940),m=e.i(8977282),p=e.i(9100551),g=e.i(5140444),f=e.i(6228447),y=e.i(4600551),h=e.i(1717203),S=e.i(7557283),x=e.i(4004502),v=e.i(2661670),b=e.i(8276950);let w="create-team-sentinel";function P(e){let{gitProvider:i,gitNamespaceId:o,gitNamespaceSlug:n,disabled:l,onChange:m,value:p,loading:g}=e,f=(0,d.useSortedTeams)(),[y,h]=(0,r.useState)(!1);return(0,t.jsx)(s.Skeleton,{show:g,style:g?{overflow:"hidden"}:void 0,children:(0,t.jsxs)(a.Combobox,{clearable:!1,"data-testid":(0,x.tid)("import-flow","team-selector","combobox-root"),disabled:l,displaySelectedSuffix:!0,noRawSelectedValue:!0,onChange:m,placeholder:"Select a Vercel Team",value:p,children:[(0,t.jsx)(a.Combobox.Input,{className:b.default.input,"data-testid":(0,x.tid)("import-flow","team-selector","combobox-value")}),(0,t.jsx)(a.Combobox.List,{children:(0,t.jsxs)(t.Fragment,{children:[f.map(e=>(0,t.jsx)(j,{disabled:l,gitNamespaceId:o,gitNamespaceSlug:n,gitProvider:i,setShowMissingPermissions:h,team:e},e.slug)),(0,t.jsx)(a.Combobox.Option,{prefix:(0,t.jsx)(u.PlusCircle,{color:"gray-900",size:16}),value:w,children:"Create a Team"}),y?(0,t.jsx)(a.Combobox.Option,{className:b.default.comboboxLabel,disabled:!0,value:"missing-permissions",children:(0,t.jsx)(c.Text,{size:13,children:"Missing Permissions"})}):null]})})]})})}function j(e){let{gitProvider:s,gitNamespaceId:u,gitNamespaceSlug:c,team:d,setShowMissingPermissions:m,disabled:p}=e,g=d.permissions?(0,h.buildCan)(new Map(Object.entries(d.permissions))):()=>!0,{data:x}=(0,v.useVerifyGitExclusivity)({gitProvider:s,gitNamespaceId:u,gitNamespaceSlug:c}),w=g(S.Action.Create,S.Resource.Project),P=(0,f.getTeamLimitedBy)(d),j=1===P.length&&P.includes("mfa"),_=x&&!x.hasAccess||!w||j;(0,r.useEffect)(()=>{_&&m(!0)},[_,m]);let C=(0,r.useMemo)(()=>w?d.limited?j?"You must enable 2FA on your account to create project in this team.":"Re-authentication required.":x&&!x.hasAccess?(0,t.jsxs)(t.Fragment,{children:["This team does not have permission to deploy from"," ",(0,t.jsx)("span",{style:{fontWeight:600},children:c})," as it is a Protected Git Scope."]}):void 0:"You do not have permission to create a project in this team.",[w,x,c,d,j]);return(0,t.jsx)(i.Tooltip,{className:b.default.tooltip,position:"right",style:{display:"inherit"},text:C,children:(0,t.jsx)(a.Combobox.Option,{disabled:_,displayLast:_,label:d.name,prefix:(0,t.jsx)(n.Avatar,{size:16,teamId:d.id}),suffix:(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(y.PlanBadge,{disabled:p,team:d}),C?(0,t.jsx)(i.Tooltip,{text:C,children:(0,t.jsx)(l.LockClosed,{size:16})}):null]}),value:d.slug,children:d.name})})}e.s(["TeamSelector",()=>P,"useSelectedTeamSlug",0,e=>{let{gitProvider:a,gitNamespaceId:i,gitNamespaceSlug:o}=e,{teams:n,team:s,isReady:l}=(0,d.useTeam)(),{user:u}=(0,g.useUser)(),y=(0,p.useRouter)(),x=(0,p.useSearchParams)(),b=(0,p.usePathname)(),[P,j]=(0,r.useState)(null),{can:_}=(0,h.default)(),{data:C}=(0,v.useVerifyGitExclusivity)({gitProvider:a,gitNamespaceId:i,gitNamespaceSlug:o}),T=_(S.Action.Create,S.Resource.Project);(0,r.useEffect)(()=>{if(null===P&&l&&x&&u?.defaultTeamId&&n){let e=(0,m.getScope)(),t=n.find(e=>e.id===u.defaultTeamId)?.slug,r=s?.slug??e??t;j(r??w);let a=x.get("teamSlug");if(a&&a!==r){let e=new URLSearchParams(x.toString());r?e.set("teamSlug",r):e.delete("teamSlug"),y.replace(`${b}?${e.toString()}`,{scroll:!1})}}},[n,P,x,b,y,u,s,l,j]),(0,r.useEffect)(()=>{let e=x?.get("teamSlug");if(P&&e!==P){let e=new URLSearchParams(x?.toString());P===w?e.delete("teamSlug"):(e.set("teamSlug",P),(0,m.setScope)(P)),y.replace(`${b}?${e.toString()}`,{scroll:!1})}},[P]);let E=(0,r.useCallback)(e=>{let t=n?.find(t=>t.slug===e);if(t?.limited){let e=new URLSearchParams(x?.toString());return e.set("teamSlug",t.slug),(0,f.requireAuthentication)({slug:t.slug,next:`${b}?${e.toString()}`,push:e=>{y.push(e)}})}j(e)},[j,n,x,b,y]),A=(0,r.useMemo)(()=>{if(P&&P===s?.slug){if(!T)return(0,t.jsxs)(t.Fragment,{children:["You do not have the required permission to create a project in"," ",(0,t.jsx)(c.Text,{as:"span",color:"inherit",weight:500,children:s.name}),". Select a different Vercel team to continue."]});if(C&&!C.hasAccess)return(0,t.jsxs)(t.Fragment,{children:["This team does not have permission to deploy from"," ",(0,t.jsx)("span",{style:{fontWeight:600},children:o})," as it is a Protected Git Scope. Select a different Vercel team, or change the Git scope to continue."]})}},[T,C,o,P,s?.slug,s?.name]);return{isSelectedTeamSlugReady:"string"==typeof P,isCreatingTeam:P===w,selectedTeamSlug:P,onTeamSlugChange:E,selectedTeamError:A}}])},2138061,e=>{"use strict";let t=/^(?!.*---)[a-z0-9-_.]+$/;function r(e){return t.test(e)&&e.length>0&&e.length<=100}e.s(["PROJECT_NAME_ERROR_MESSAGE",0,"A Project name can only contain up to 100 lowercase letters, digits, and the characters '.', '_', and '-'.","isValidProjectName",()=>r,"sanitizeProjectName",()=>function e(t){return r(t)?t:e(t.slice(0,100).toLowerCase().replace(/[^a-z0-9-_.]|---/g,"-"))}])},3495961,1315623,6979900,e=>{"use strict";var t=e.i(1991452),r=e.i(5140444);function a(){let e=(0,t.useRouter)(),{data:a,isLoading:i}=(0,r.useUser)();i||a||e.replace("/new")}e.s(["useShouldRedirectToNew",()=>a],3495961);var i=e.i(6468255),o=e.i(9739627),n=e.i(6038905);function s(){return(0,i.jsx)(n.default,{active:!1,className:"relative overflow-hidden border-0 border-y border-solid border-gray-400 md:border-0",subtitle:"Once you're ready, start deploying to see the progress here…",title:"Deployment",children:(0,i.jsx)(o.Image,{alt:"Globe",className:"relative -bottom-2 -m-8 mt-4 w-[calc(100%+34px)] max-w-none",height:256,priority:!0,srcDark:"https://assets.vercel.com/image/upload/v1689795055/front/new/globe-outline-dark-2.svg",srcLight:"https://assets.vercel.com/image/upload/v1689795055/front/new/globe-outline-light.svg",width:688})})}e.s(["DeploymentPlaceholderCard",()=>s],1315623);var l=e.i(57106);function u(){return(0,i.jsxs)("div",{className:"mt-4 flex flex-col items-center gap-y-4 px-2",children:[(0,i.jsx)(l.Link,{href:"/new",type:"secondary",children:"Import a different Git Repository →"}),(0,i.jsx)(l.Link,{href:"/new/templates",type:"secondary",children:"Browse Templates →"})]})}e.s(["ImportFooter",()=>u],6979900)},2251791,e=>{"use strict";var t=e.i(7780974),r=e.i(7837522),a=e.i(7562527),i=e.i(6696646),o=e.i(9871375),n=e.i(1177040),s=e.i(9385057),l=e.i(9100551);function u(e){let t=(0,i.useRef)((0,s.nanoid)());return(0,i.useEffect)(()=>{(0,i.startTransition)(()=>{e({type:"SET_FLOW_ID_ONCE",flowId:t.current})})},[e]),t.current}function c(){let e=(0,l.useSearchParams)(),t=(0,a.useRepoQuery)(),r=t?.template===a.VERCEL_TUTOR_TEMPLATE_NAME,o=(0,i.useMemo)(()=>t?`${t.owner}/${t.name}${t.subdir?`/${t.subdir}`:""}`:void 0,[t]),n=e?.get("from")==="templates";return{isVercelTutor:r,clonedFrom:o,templateSlug:e?.get("repository-name")??void 0,isTemplate:n}}function d(){let{track:e}=(0,r.useTrackActivity)(),a=c(),{status:n,cloneRepoStatus:s,dispatch:l}=(0,o.useProjectCloneContext)(),d=(0,i.useRef)(null),m=(0,i.useRef)(s),p=u(l);(0,i.useEffect)(()=>{d.current!==n&&(d.current=n,e(t.VercelActivityAction.NewProjectCloneStatusChanged,{...a,flowId:p,status:n})),m.current!==s&&(m.current=s,e(t.VercelActivityAction.NewProjectCloneRepoStatusChanged,{...a,flowId:p,status:s}))},[p,s,a,n,e])}function m(){let{track:e}=(0,r.useTrackActivity)(),{deploying:a,dispatch:o}=(0,n.useProjectImportContext)(),s=(0,i.useRef)(null),l=u(o);(0,i.useEffect)(()=>{s.current!==a&&null!==a&&(s.current=a,e(t.VercelActivityAction.NewProjectImportDeployingChanged,{deploying:a,flowId:l}))},[a,e,l])}e.s(["useCloneTrackBaseParams",()=>c,"useCloneTrackStatusChanges",()=>d,"useImportTrackStatusChanges",()=>m])}]);

//# sourceMappingURL=e5851f90f0896433.js.map
//# debugId=7a3c1243-8b3d-560b-afda-f2b26969c406
