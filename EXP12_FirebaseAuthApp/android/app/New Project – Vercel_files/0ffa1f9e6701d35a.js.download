
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="684ee8a1-cc25-55c7-9852-0eb3797f421b")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5919007,e=>{"use strict";function t(e){if("number"==typeof e.resourceConfig?.edgeConfigSize)return 1e3*e.resourceConfig.edgeConfigSize;switch(e.billing?.plan){case"enterprise":return 512e3;case"pro":return 64e3;default:return 8e3}}function n(e){if("number"==typeof e.resourceConfig?.edgeConfigs)return e.resourceConfig.edgeConfigs;switch(e.billing?.plan){case"enterprise":return 10;case"pro":return"trialing"===e.billing.status?1:3;default:return 1}}e.s(["EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH",0,52,"getMaxEdgeConfigs",()=>n,"getSizeLimitInBytes",()=>t])},2843591,e=>{"use strict";var t=e.i(3911483),n=e.i(6696646),r=e.i(8815282),o=e.i(8042625),a=e.i(277234),i=e.i(4244280),s=e.i(5338940);e.i(6887680);var l=e.i(6810699);function c(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}/schema${(0,o.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function d(){let e=(0,l.useResourceList)({protocolType:"storage"});return{data:(0,n.useMemo)(()=>e.data?.stores.filter(e=>"edge-config"===e.type),[e.data?.stores])}}function u(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}${(0,o.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function g(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}/items${(0,o.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function m(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}/tokens${(0,o.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function h(e,t,n){let{isReady:l,team:c}=(0,s.useTeam)();return(0,r.default)((t,r)=>{if(!e||!l||r&&!r.pagination.hasNext)return null;let a={teamId:c?.id,metadata:n?.metadata?"true":void 0,limit:n?.limit||25,next:r?.pagination.next};0===t&&(a.limit+=1);let s=`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}/backups`;return`${s}${(0,o.encode)(a)}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),{revalidateFirstPage:!1,revalidateOnFocus:!1,...t})}function p(e,n,r){let{isReady:l,team:c}=(0,s.useTeam)();return(0,t.default)(()=>e&&n&&"current"!==n&&l?`${i.API_EDGE_CONFIG}/${encodeURIComponent(e)}/backups/${encodeURIComponent(n)}${(0,o.encode)({teamId:c?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),r)}function x(e){let{edgeConfig:t,project:n}=e;return{...t,type:"edge-config",projectsMetadata:n?[{projectId:n.id,name:n.name,framework:n.framework,id:"",environments:[],environmentVariables:[],envVarPrefix:null}]:[],name:t.slug,status:"available",totalConnectedProjects:+!!n}}e.s(["mapEdgeConfigToStoreType",()=>x,"useEdgeConfig",()=>u,"useEdgeConfigBackup",()=>p,"useEdgeConfigBackupsInfinite",()=>h,"useEdgeConfigItems",()=>g,"useEdgeConfigSchema",()=>c,"useEdgeConfigTokens",()=>m,"useEdgeConfigs",()=>d])},8564753,e=>{"use strict";e.i(9584471),e.s([])},4348614,e=>{e.v({expanderWrapper:"store-advanced-options-expander-module__QIqk3G__expanderWrapper",expanderWrapperExpanded:"store-advanced-options-expander-module__QIqk3G__expanderWrapperExpanded"})},1261558,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(1344973),o=e.i(9722978);e.i(8703064);var a=e.i(7507521),i=e.i(4348614);function s(e){let{children:s,isExpandedDefault:l}=e;return(0,t.jsx)(a.Expander,{className:(0,o.clsx)(i.default.expanderWrapper),expandedClassName:i.default.expanderWrapperExpanded,isExpandedDefault:l,title:(0,t.jsxs)(n.Stack,{direction:"row",gap:1,paddingX:3,paddingY:2,children:[(0,t.jsx)(a.ExpanderTrigger,{}),(0,t.jsx)(r.Text,{color:"gray-900",size:13,weight:500,children:"Advanced Options"})]}),children:(0,t.jsx)(n.Stack,{paddingX:3,paddingY:2,children:s})})}e.s(["StoreAdvancedOptionsExpander",()=>s])},8206804,e=>{"use strict";var t=e.i(6468255);e.s(["default",0,function(e){let{margin:n=50,className:r}=e;return(0,t.jsx)("hr",{className:r,style:{border:"0",borderTop:"1px solid var(--accents-2)",margin:"number"==typeof n?`${n}px 0`:`${n} 0`}})}])},9512272,e=>{"use strict";var t=e.i(8042625),n=e.i(277234),r=e.i(4244280),o=e.i(5927860);function a(e){return e.startsWith("VERCEL_")}function i(e){return e.map(e=>{let t,n=e.type;return void 0===n&&(n=a(e.name)?o.EnvType.System:o.EnvType.Encrypted),e.target&&(t=Array.isArray(e.target)?e.target:[e.target]),{type:n,key:e.name,value:n===o.EnvType.System?e.name:e.value,target:t??[o.EnvTarget.Production,o.EnvTarget.Preview,o.EnvTarget.Development],gitBranch:e.gitBranch,comment:e.comment,customEnvironmentIds:e.customEnvironmentIds}})}async function s(e,o,a){let s=i(o);return(0,n.fetchAPI)(`${(0,r.API_PROJECTS_VERSION)("v10")}/${e}/env${(0,t.encode)({teamId:a})}`,{method:"POST",body:JSON.stringify(s),throwOnHTTPError:!0})}async function l(e,o,a){await (0,n.fetchAPI)(`${(0,r.API_PROJECTS_VERSION)("v4")}/${e}/env/${o.key}${(0,t.encode)({teamId:a,target:o.target})}`,{method:"DELETE",throwOnHTTPError:!0})}e.s(["addEncryptedEnvs",()=>i,"addEnvs",()=>s,"isSystemEnv",()=>a,"legacyRemoveEnv",()=>l])},4429570,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(6891161),o=e.i(455575),a=e.i(4030453),i=e.i(6696646),s=e.i(8042625),l=e.i(277234),c=e.i(4244280),d=e.i(5927860),u=e.i(7917902),g=e.i(4422059),m=e.i(4004502),h=e.i(5919007),p=e.i(9512272);e.i(7037808);var x=e.i(8824424);e.i(8564753);var C=e.i(9584471),f=e.i(3500331),v=e.i(8206804),j=e.i(2014455),b=e.i(1261558);function y(e){let{advancedOptions:r,tokenLabelPlaceholder:o,onAdvancedOptionsChange:a,isLoading:i}=e;return(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(j.ResourceEnvironmentSelector,{environments:r.environments,error:r.error?.environments,onChange:e=>a({...r,environments:e,error:{...r.error,environments:void 0}}),resourceTitle:"store"}),(0,t.jsx)(b.StoreAdvancedOptionsExpander,{isExpandedDefault:!!r.error,children:(0,t.jsxs)(n.Stack,{gap:3,children:[(0,t.jsx)(n.Stack,{gap:3,children:(0,t.jsx)(f.Input,{"aria-label":"Environment Variable",disabled:i,error:r.error?.envVarName,label:"Environment Variable",onChange:e=>a({...r,envVarName:e.currentTarget.value,error:{...r.error,envVarName:void 0}}),placeholder:"EDGE_CONFIG",value:r.envVarName,width:"100%"})}),(0,t.jsx)(v.default,{margin:0}),(0,t.jsx)(n.Stack,{gap:3,children:(0,t.jsx)(f.Input,{"aria-label":"Token label",disabled:i,label:"Token label",maxLength:h.EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH,onChange:e=>a({...r,tokenName:e.currentTarget.value}),placeholder:o,value:r.tokenName,width:"100%"})})]})})]})}function S(e){let{backOrCancelLabel:x,edgeConfig:f,title:v,subtitle:j,ProjectSelector:b,onClickOutside:S,onConnectionCreated:T,onBack:E,project:k}=e,{mutateByProtocol:w}=(0,C.useMutateResourceCache)(),[_,I]=(0,i.useState)({envVarName:"",tokenName:"",environments:{[d.EnvTarget.Development]:!0,[d.EnvTarget.Preview]:!0,[d.EnvTarget.Production]:!0,...k?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}}),[M,A]=(0,i.useState)(!1),[P,O]=(0,i.useState)(null),{team:R}=(0,u.useAccount)(),$=(0,g.usePrevious)(k);(0,i.useEffect)(()=>{null!==_.error&&(!k||$&&k.id!==$.id)&&I({..._,error:null}),k&&(null===$||$&&k.id!==$.id)&&I({..._,environments:{[d.EnvTarget.Development]:!0,[d.EnvTarget.Preview]:!0,[d.EnvTarget.Production]:!0,...k.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}})},[_,$,k]);let L=(0,i.useMemo)(()=>{if(!k)return"";let e=k.name.slice(0,h.EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH-6);return`${e.replace(/-*$/g,"")}-token`},[k]),N=_.tokenName||L,B=_.envVarName||"EDGE_CONFIG",G=(0,i.useCallback)(async e=>{if(e.preventDefault(),!f||M||!k)return;let t=[d.EnvTarget.Production,d.EnvTarget.Preview,d.EnvTarget.Development,...k.customEnvironments?.map(e=>e.slug)||[]].filter(e=>_.environments[e]);try{if(O(null),A(!0),I({..._,error:null}),0===t.length){I({..._,error:{environments:"Select at least one Environment for your Environment Variable"}}),A(!1);return}if(k.env&&k.env.some(e=>e.key===B&&("string"==typeof e.target?t.includes(e.target):e.target.some(e=>t.includes(e))))){I({..._,error:{envVarName:1===t.length?`This project already has an environment variable called ${B} in the chosen environment.`:`This project already has an environment variable called ${B} in one of the chosen environments.`}}),A(!1);return}let e=await (0,l.fetchAPI)(`${c.API_EDGE_CONFIG}/${f.id}/token${(0,s.encode)({teamId:R?.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:N}});await (0,p.addEnvs)(k.id,[{name:B,value:`https://edge-config.vercel.com/${f.id}?token=${e.token}`,type:d.EnvType.Encrypted,target:t.filter(e=>(0,d.isSystemEnvTarget)(e)),customEnvironmentIds:t.filter(e=>!(0,d.isSystemEnvTarget)(e)).map(e=>{let t=k.customEnvironments?.find(t=>t.slug===e);return t?.id}).filter(e=>void 0!==e)}],R?.id),await T(),S(),o.toasts.success({text:`Connected Project ${k.name} to Edge Config ${f.slug}`,key:f.slug}),await w("storage")}catch(e){if(e instanceof Error)O(e);else throw e}finally{A(!1)}},[f,M,k,_,R?.id,N,B,T,S,w]);return(0,t.jsxs)("form",{onSubmit:e=>void G(e),children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsx)(r.Modal.Title,{center:!0,children:v}),j?(0,t.jsx)(r.Modal.Subtitle,{children:j}):null]}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{gap:6,children:[b,(0,t.jsx)(y,{advancedOptions:_,isLoading:M,onAdvancedOptionsChange:I,tokenLabelPlaceholder:k?L:""}),P?(0,t.jsx)(a.Error,{children:P.message}):null]})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:E,type:"secondary",children:x}),(0,t.jsx)(r.Modal.Action,{buttonType:"submit","data-testid":(0,m.tid)("connect-edge-config-modal","connect-button"),disabled:!k||""===B.trim()||""===N.trim(),loading:M,children:"Connect"})]})]})}function T(e){let{active:n,edgeConfig:o,onClickOutside:a,onConnectionCreated:s,onAnimationDone:l}=e,[c,d]=(0,i.useState)(null),{team:g,user:m}=(0,u.useAccount)(),h=g?g.slug:m?.username;return(0,t.jsx)(r.Modal.Modal,{active:n,allowOverflow:!0,onAnimationDone:l,onClickOutside:a,width:540,children:(0,t.jsx)(S,{ProjectSelector:(0,t.jsx)(x.ResourceProjectSelector,{account:h,allowSelectConnectedProjects:!0,includedInConnectedProjects:e=>e?.env?.some(e=>e.edgeConfigId===o?.id)??!1,onProjectSelected:e=>{d(e)},resourceTitle:"store",selectedProject:c}),backOrCancelLabel:"Cancel",edgeConfig:o,onBack:a,onClickOutside:a,onConnectionCreated:s,project:c,title:"Connect Project"})})}e.s(["ConnectEdgeConfigModal",()=>T,"CreateEdgeConfigConnectionModalStep",()=>S],4429570)},1758334,e=>{"use strict";var t=e.i(6696646);e.i(6887680);var n=e.i(6810699),r=e.i(3798983);function o(e){return"edge-config"===e?64:32}e.s(["MAX_STORE_NAME_LENGTH",0,32,"getStoreNameLengthByType",()=>o,"useStoreName",0,e=>{let{storeType:a,storeId:i,...s}=e,l=(0,t.useMemo)(()=>{if("projectName"in s&&s.projectName){let e=r.storeDefaultNameSuffix[a];return[s.projectName.replaceAll("_","-").slice(0,o(a)-e.length),e].join("")}return"storeName"in s?s.storeName??"":""},[s,a]),[c,d]=(0,t.useState)(),[u,g]=(0,t.useState)(),{isNameTaken:m}=(0,n.useResourceList)({protocolType:"storage"});return{storeNameError:c,name:u??l,setName:(0,t.useCallback)(e=>{let t=e.trim(),n=o(a),r="edge-config"===a?1:5;d(void 0),g(t),t.length<r?d(`The name must be at least ${r} characters.`):t.length>n?d(`The name must be at most ${n} characters.`):/^[a-zA-Z0-9_-\s]*$/.test(t)?m({name:t,storeType:a,storeId:i})&&d("This name is already in use by another store"):d("The name can only contain letters, numbers, and the following characters: _ - ")},[m,a,i]),touched:!!u&&u!==l}}])},2886798,e=>{"use strict";e.i(9691190),e.i(1055938),e.i(680627),e.i(3183079),e.i(7512194),e.i(3788585),e.s([])},562291,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(8522580),o=e.i(1717203),a=e.i(7557283),i=e.i(57106);e.i(8703064);var s=e.i(6798946),l=e.i(4981413),c=e.i(3798983),d=e.i(3703009);function u(e){let{onClickStore:u,storeTypeWithProduct:g,showCreateButton:m=!1}=e,{can:h,isLoading:p}=(0,o.default)(),x={"edge-config":h(a.Action.Create,a.Resource.EdgeConfig),blob:h(a.Action.Create,a.Resource.Blob),integration:h(a.Action.Create,a.Resource.Integration)};return(0,t.jsxs)(n.Stack,{gap:4,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[["edge-config","blob"].map(e=>(0,t.jsx)(s.CreateResourceCard,{Icon:(0,t.jsx)(d.StoreIcon,{size:"large",type:e,useColor:!0}),description:c.storeDescription[e],isDisabled:p||!x[e],isSelected:g?.type===e,name:c.storeTitle[e],onClick:()=>{u({type:e})},showCreateButton:m,tooltip:{text:`You need additional permission to create a ${c.storeTitleFull[e]}.`,isEnabled:!x[e]}},e)),(0,t.jsxs)(r.Note,{fill:!0,type:"secondary",children:["KV and Postgres are now available through the Marketplace."," ",(0,t.jsx)(i.Link,{external:!0,href:"/docs/storage",target:"_blank",children:"Learn more"})]})]}),(0,t.jsx)(l.BrowseProducts,{onClickProduct:u,protocolType:"storage",selectedProduct:g,showCreateButton:m})]})}e.s(["BrowseStoresCards",()=>u],562291)},3322174,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(9508212),o=e.i(1344973),a=e.i(6060673);e.i(7037808);var i=e.i(7137779);e.i(5463680);var s=e.i(39509);e.i(3182268);var l=e.i(7849855);e.i(2886798);var c=e.i(3183079),d=e.i(4429570),u=e.i(3703009),g=e.i(2782729);function m(e){let{store:m}=e,{projectSlug:h}=(0,l.useProjectSlug)(),p=(0,a.useProject)(h),{onBack:x,onClose:C,state:f,onResourceUpdated:v}=(0,c.useResourceModalsContext)(),{type:j}=m,b=(0,n.useCallback)(()=>{v({resource:m,isConnected:!0})},[m,v]);if(f.type!==s.ResourceModalsActionTypes.CreateEnvs)return null;switch(j){case"edge-config":return(0,t.jsx)(d.CreateEdgeConfigConnectionModalStep,{backOrCancelLabel:f.backOrCancelLabel,edgeConfig:{id:m.id,slug:m.name},onBack:x,onClickOutside:C,onConnectionCreated:b,project:p.data,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(o.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(u.StoreIconOrAvatar,{icon:(0,g.getStoreIcon)(m),size:"small",type:m.type,useColor:!0}),(0,t.jsx)(o.Text,{color:"gray-1000",weight:500,children:m.name})]}),title:`Configure ${p.data?.name??""}`});case"blob":case"integration":return(0,t.jsx)(i.CreateResourceConnectionModalStep,{backOrCancelLabel:f.backOrCancelLabel,onBack:x,onClickOutside:C,onConnectionCreated:b,project:p.data,resourceId:m.id,store:m,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(o.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(u.StoreIconOrAvatar,{icon:(0,g.getStoreIcon)(m),size:"small",type:m.type,useColor:!0}),(0,t.jsx)(o.Text,{color:"gray-1000",weight:500,children:m.name})]}),title:`Configure ${p.data?.name??""}`});default:return null}}function h(e){let{active:n,store:r,key:o}=e,{onClose:a,onAnimationDone:s,onResourceUpdated:l}=(0,c.useResourceModalsContext)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.ConnectEdgeConfigModal,{active:"edge-config"===r.type&&n,edgeConfig:r,onAnimationDone:s,onClickOutside:a,onConnectionCreated:a},o),(0,t.jsx)(i.CreateResourceConnectionModal,{active:"edge-config"!==r.type&&n,onAnimationDone:s,onClickOutside:a,onConnectionCreated:()=>l({resource:r,isConnected:!0}),resourceId:r.id,store:r},o)]})}e.s(["ConnectStoreSwitch",()=>m,"ConnectStoreSwitchWithoutProject",()=>h])},4714146,e=>{e.v({"warning-note":"warning-note-module__UV6e7q__warning-note","warning-note-link":"warning-note-module__UV6e7q__warning-note-link"})},8696994,e=>{e.v({betaBadge:"create-store-modal-module__Wmn6LG__betaBadge",itemContent:"create-store-modal-module__Wmn6LG__itemContent",itemDescription:"create-store-modal-module__Wmn6LG__itemDescription",itemTitle:"create-store-modal-module__Wmn6LG__itemTitle",modalBody:"create-store-modal-module__Wmn6LG__modalBody",storeContainer:"create-store-modal-module__Wmn6LG__storeContainer",storeGrid:"create-store-modal-module__Wmn6LG__storeGrid",storeItem:"create-store-modal-module__Wmn6LG__storeItem",storeItemCTA:"create-store-modal-module__Wmn6LG__storeItemCTA",storeItemColSpan2:"create-store-modal-module__Wmn6LG__storeItemColSpan2",storeItemDisabled:"create-store-modal-module__Wmn6LG__storeItemDisabled",storeItemSelected:"create-store-modal-module__Wmn6LG__storeItemSelected"})},8922739,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(1344973),o=e.i(6891161),a=e.i(8923565),i=e.i(4004502),s=e.i(6696646),l=e.i(119294),c=e.i(6352514);e.i(6887680);var d=e.i(6810699);e.i(5463680);var u=e.i(39509);e.i(3182268);var g=e.i(7849855);e.i(2886798);var m=e.i(680627),h=e.i(3183079),p=e.i(1017032),x=e.i(562291),C=e.i(3322174),f=e.i(9668517),v=e.i(4670733),j=e.i(5338940),b=e.i(4597921),y=e.i(2843591),S=e.i(8711152);e.i(553769);var T=e.i(3758860),E=e.i(455575),k=e.i(4030453),w=e.i(3500331),_=e.i(5323212),I=e.i(1637579),M=e.i(1119178),A=e.i(277234),P=e.i(4244280),O=e.i(8042625);e.i(8564753);var R=e.i(9584471),$=e.i(5377189),L=e.i(1758334);function N(e){let{active:a,cancelLabel:i,createLabel:d="Create",onBack:u,onBlobCreated:g,projectName:m}=e,{createStore:h}=function(){let{addResourceToList:e}=(0,R.useMutateResourceCache)(),t=(0,f.useTeamSlug)(),{permissions:n}=(0,$.useStorePermissions)({storeType:"blob",teamSlug:t??void 0});return{createStore:async n=>{let r=await (0,A.fetchAPI)(function(e,t){if("blob"===e)return`${P.API_STORE}/stores/blob${t}`;throw Error(`Unsupported store type: ${e}`)}("blob",(0,O.encode)({teamId:t})),{method:"POST",throwOnHTTPError:!0,body:n});return e(r.store),r},permissions:n}}(),{name:p,setName:x,storeNameError:C}=(0,L.useStoreName)({projectName:m,storeType:"blob"}),[v,j]=(0,s.useState)(!1),[b,y]=(0,s.useState)("iad1"),[S,T]=(0,s.useState)(!1),[N,B]=(0,s.useState)(null),G=(0,s.useCallback)(async e=>{if(e.preventDefault(),j(!0),!C){B(null),T(!0);try{let e=await h({name:p,region:b});await g(e.store),E.toasts.success("Created Blob store successfully"),l.analytics.track(c.AnalyticsEvent.BLOB_STORE_CREATE,{name:p,ownerId:e.store.ownerId})}catch(e){e instanceof Error?B(e.message):B("An error occurred while creating the Blob store"),T(!1)}}},[h,C,p,b,g]),D=(0,s.useRef)(null);return(0,s.useEffect)(()=>{setTimeout(()=>{a&&(D.current?.focus(),D.current?.select())},0)},[a]),(0,t.jsxs)("form",{onSubmit:(0,M.promiseToCallback)(G),children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsx)(o.Modal.Title,{center:!0,children:"Create Blob Store"}),(0,t.jsx)(o.Modal.Subtitle,{children:(0,t.jsx)(n.Stack,{align:"center",direction:"row",gap:0,justify:"center",children:(0,t.jsx)(r.Text,{color:"gray-900",children:"Set up this new Blob Store."})})})]}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(w.Input,{"aria-label":"Store Name",disabled:S,error:v?C:void 0,label:"Store Name",maxLength:32,onChange:e=>x(e.currentTarget.value),placeholder:"store-name",ref:D,value:p,width:"100%"}),(0,t.jsx)(_.Select,{"aria-label":"Region",disabled:S,label:"Region",onChange:e=>y(e.currentTarget.value),value:b,width:"100%",children:Object.entries(I.groups).map(e=>{let[n,r]=e;return(0,t.jsx)("optgroup",{label:n,children:r.map(e=>"bru1"===e.key?null:(0,t.jsx)("option",{value:e.key,children:`${e.name} (${e.cardinal}) – ${e.key}`},`blob-region-${e.key}`))},`blob-region-group-${n}`)})})]})}),N?(0,t.jsx)(k.Error,{children:N}):null]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:u,type:"secondary",children:i}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",disabled:""===p.trim(),loading:S,children:d})]})]})}var B=e.i(4614946),G=e.i(762945),D=e.i(8522580),W=e.i(57106),F=e.i(7917902),U=e.i(4714146),V=e.i(5919007);function H(){let{team:e}=(0,F.useAccount)();return(0,t.jsx)(D.Note,{className:U.default["warning-note"],fill:!0,label:!1,type:"warning",variant:"contrast",children:(0,t.jsxs)(n.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:[(0,t.jsx)(G.Warning,{style:{flexShrink:0}}),(0,t.jsxs)(n.Stack,{align:"start",gap:2,children:[(0,t.jsx)(r.Text,{as:"p",color:"inherit",children:"You reached the maximum number of Edge Configs for your plan."}),(0,t.jsxs)(r.Text,{as:"p",color:"inherit",children:[(0,t.jsx)(W.Link,{href:e?`/${e.slug}/~/settings/billing`:"/account/billing",variant:"blend",children:"Upgrade your plan"})," ","or"," ",(0,t.jsx)(W.Link,{external:!0,href:"https://vercel.com/contact/sales?p=1",variant:"blend",children:"contact our sales team"})," ","to request a higher limit."]})]})]})})}function z(e){let{active:r,onClickOutside:a,onEdgeConfigCreated:i,projectName:d,cancelLabel:u="Cancel",createLabel:g="Create"}=e,{team:m,user:h}=(0,F.useAccount)(),{data:p}=(0,y.useEdgeConfigs)(),{mutate:x}=(0,B.useSWRConfig)(),{addResourceToList:C}=(0,R.useMutateResourceCache)(),[f,v]=(0,s.useState)(!1),j=m||h,b=!f&&!!j&&!!p&&p.length>=(0,V.getMaxEdgeConfigs)(j),{name:S,setName:T,storeNameError:k}=(0,L.useStoreName)({projectName:d,storeType:"edge-config"}),[_,I]=(0,s.useState)(!1),[M,$]=(0,s.useState)(!1),[N,G]=(0,s.useState)(null),D=(0,E.useToasts)(),W=(0,s.useCallback)(async e=>{if(e.preventDefault(),I(!0),!k){G(null),$(!0);try{let e=await (0,A.fetchAPI)(`${P.API_EDGE_CONFIG}${(0,O.encode)({teamId:m?.id})}`,{method:"POST",throwOnHTTPError:!0,body:JSON.stringify({slug:S,items:{greeting:"hello world"}})});await x(`${P.API_EDGE_CONFIG}/${encodeURIComponent(e.id)}${(0,O.encode)({teamId:m?.id})}`,e,{revalidate:!1});let t=(0,y.mapEdgeConfigToStoreType)({edgeConfig:e});await C(t),D.success("Created Edge Config successfully"),l.analytics.track(c.AnalyticsEvent.EDGE_CONFIG_STORE_CREATE,{ownerId:m?.id}),v(!0),await new Promise(e=>{setTimeout(e,0)}),await i(e)}catch(e){e instanceof Error?G(e.message):D.error("Unexpected error while creating Edge Config"),$(!1)}}},[k,S,m?.id,x,C,D,i]),U=(0,s.useRef)(null);return(0,s.useEffect)(()=>{setTimeout(()=>{r&&(U.current?.focus(),U.current?.select())},0)},[r]),(0,t.jsxs)("form",{onSubmit:e=>void W(e),children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(o.Modal.Title,{center:!1,children:"Create Edge Config Store"}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(n.Stack,{gap:3,children:(0,t.jsx)(w.Input,{"aria-label":"Edge Config Name",disabled:M||b,error:_?N??k:void 0,label:"Edge Config Name",maxLength:(0,L.getStoreNameLengthByType)("edge-config"),onChange:e=>T(e.currentTarget.value),placeholder:"my-edge-config-store",ref:U,value:S,width:"100%"})}),b?(0,t.jsx)(H,{}):null]})})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:a,type:"secondary",children:u}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",disabled:""===S.trim()||b,loading:M,children:g})]})]})}var K=e.i(6356390);e.i(6483798);var Y=e.i(8287059),q=e.i(3798983);function X(e){if(e)return q.docs[e].limitReached;throw Error("Invalid store type")}function J(e){let{limit:a,plan:i,storeType:l,onBack:c,onCancel:d}=e,{team:u}=(0,j.useTeam)(),g=(0,Y.useOpenUpgradeModal)(),m=function(e){switch(e){case"edge-config":return`${q.storeTitleFull["edge-config"]}`;case"blob":return`${q.storeTitleFull.blob}`;case"integration":return`${q.storeTitleFull.integration}`;default:throw Error("Invalid store type")}}(l),h=`${m}${1===a?"":"s"}`,p=u?.billing?.plan==="pro"&&"trialing"===u.billing.status,x=(0,s.useCallback)(e=>{e.preventDefault(),l&&(g({source:"storage-limit",forceImmediateUpgrade:!0,addOn:{type:"storage",additionalConfigurations:{storeType:l}}}),d())},[l,g,d]),C=(0,s.useCallback)(e=>{e.preventDefault(),window.open("https://vercel.com/help","_blank")},[]);return"hobby"===i||p?(0,t.jsxs)("form",{onSubmit:x,children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsxs)(o.Modal.Title,{center:!0,children:["Create ",m]})}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{align:"center",gap:5,children:[(0,t.jsx)(G.Warning,{color:"gray-700"}),(0,t.jsxs)(n.Stack,{align:"center",gap:2,style:{paddingLeft:24,paddingRight:24},children:[(0,t.jsxs)(r.Text,{align:"center",weight:500,children:["You have reached the limit of ",m,"s on this plan."]}),(0,t.jsx)(r.Text,{align:"center",color:"gray-900",children:`${p?"Pro Trial teams":"Personal Accounts"} are limited to ${a??""} active ${h}
                at a time. To create additional ${m}s, upgrade your plan
                to Pro or remove an existing ${m}.`}),(0,t.jsx)("div",{children:(0,t.jsx)(W.Link,{external:!0,href:X(l),variant:"highlight",children:"Learn more"})})]})]})})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:c,type:"secondary",children:"Go Back"}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",children:"Upgrade your plan"})]})]}):(0,t.jsxs)("form",{onSubmit:C,children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsxs)(o.Modal.Title,{center:!0,children:["Create ",m]})}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{align:"center",gap:5,children:[(0,t.jsx)(G.Warning,{color:"gray-700"}),(0,t.jsxs)(n.Stack,{align:"center",gap:2,style:{paddingLeft:24,paddingRight:24},children:[(0,t.jsxs)(r.Text,{align:"center",weight:500,children:["You have reached the limit of ",m,"s on this plan."]}),(0,t.jsx)(r.Text,{align:"center",color:"gray-900",children:`${"enterprise"===i?"Enterprise":"Pro"}${u?.billing?.status==="trialing"?" Trial":""} Teams are limited to ${a??""} active ${h} at a time.
To request a higher limit, please contact Support.`}),(0,t.jsx)("div",{children:(0,t.jsx)(W.Link,{external:!0,href:X(l),variant:"highlight",children:"Learn more"})})]})]})})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:c,type:"secondary",children:"Go Back"}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",children:"Contact Support"})]})]})}function Q(e){let{onBack:a,storeType:i}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsxs)(o.Modal.Title,{children:["You do not have access to ",q.eula[i].product]})}),(0,t.jsx)(n.Stack,{gap:6,children:(0,t.jsxs)(r.Text,{children:[q.eula[i].product," is not available on your Enterprise contract. To resolve this, please contact your Vercel account team."]})})]})}),(0,t.jsx)(o.Modal.Actions,{children:(0,t.jsx)(o.Modal.Action,{fullWidth:!0,onClick:a,type:"secondary",children:"Go Back"})})]})}var Z=e.i(4496450);function ee(e){let{installations:r}=e,a=(0,f.useTeamSlug)(),{projectSlug:i}=(0,g.useProjectSlug)(),{isReady:l,status:c}=function(){let{state:e}=(0,h.useResourceModalsContext)(),{team:t,isReady:n}=(0,j.useTeam)(),{getLimits:r,isReady:o}=function(){let{data:e}=(0,d.useResourceList)({keepPreviousData:!0,protocolType:"storage"}),{team:t,user:n}=(0,F.useAccount)(),r=t||n;return{getLimits:(0,s.useCallback)(t=>{let n=e?.stores.filter(e=>e.type===t);if(!r||!n)return{limit:void 0,isLimitReached:!1,plan:void 0};let o=function(e){let{owner:t,storeType:n}=e,r=t.billing?.status==="trialing";switch(n){case"edge-config":return(0,V.getMaxEdgeConfigs)(t);case"blob":if("number"==typeof t.resourceConfig?.blobStores)return t.resourceConfig.blobStores;switch(t.billing?.plan){case"enterprise":return 1e3;case"pro":return r?5:500;default:return 5}case"integration":return 1/0;default:throw Error("Invalid store type")}}({owner:r,storeType:t});return{limit:o,isLimitReached:n.length>=o,plan:r.billing?.plan}},[r,e?.stores]),isReady:!!(e?.stores&&r)}}(),{isStorageEnterpriseEnabled:a,isReady:i}=(0,v.useStorageEnterpriseFlag)(),l=n&&o&&i,[c,u]=(0,s.useState)(null);return(0,s.useEffect)(()=>{if("create-resource"!==e.type||!l||c)return;let{type:n}=e.resourceWithProduct,o=t?.billing?.plan==="enterprise",i=!(0,Z.isLegacyPlanIteration)(t?.billing?.planIteration),s=t?.billing?.status==="trialing",d=r(n);d.isLimitReached?u({limitReached:d,enterpriseBlocked:!1}):o&&!a({storeType:n,isUnbundled:i,isTrialing:s})?u({limitReached:null,enterpriseBlocked:!0}):u({limitReached:null,enterpriseBlocked:!1})},[a,e,t?.billing?.plan,t?.billing?.status,t?.billing?.planIteration,c,l,r]),c?{isReady:!0,status:c}:{isReady:!1,status:null}}(),{state:u,onClose:m,onBack:p,onResourceUpdated:x,maybeGoToConnectProjectStep:C}=(0,h.useResourceModalsContext)(),E=(0,b.useServerFlag)("enable-marketplace-drains",!1),k=(0,s.useCallback)(e=>{"integration"===e.type&&(0,T.supportsAnyDrainProtocol)(e.product)&&E?(x({resource:e,isConnected:!0}),m()):(x({resource:e,isConnected:!1}),C(e)||(x({resource:e,isConnected:!0}),m()))},[x,C,m,E]),w=(0,s.useCallback)(e=>{k((0,y.mapEdgeConfigToStoreType)({edgeConfig:e}))},[k]);if("create-resource"!==u.type)return null;let{type:_}=u.resourceWithProduct;if(!l)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(n.Stack,{gap:2,children:(0,t.jsx)(o.Modal.Title,{center:!0,children:"Create Store"})}),(0,t.jsx)(o.Modal.Inset,{last:!0,children:"Loading…"})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:p,type:"secondary",children:"Go Back"}),(0,t.jsx)(o.Modal.Action,{buttonType:"submit",disabled:!0,children:"Continue"})]})]});if(c.limitReached)return(0,t.jsx)(J,{limit:c.limitReached.limit,onBack:p,onCancel:m,plan:c.limitReached.plan,storeType:_});if(c.enterpriseBlocked)return(0,t.jsx)(Q,{onBack:p,storeType:_});switch(_){case"edge-config":return(0,t.jsx)(z,{active:!0,cancelLabel:u.backOrCancelLabel,onClickOutside:p,onEdgeConfigCreated:w,projectName:i??void 0});case"blob":return(0,t.jsx)(N,{active:!0,cancelLabel:u.backOrCancelLabel,onBack:p,onBlobCreated:k,projectName:i??void 0});case"integration":{let e=u.resourceWithProduct.integration;return(0,t.jsx)(K.CreateResourceModal,{cancelLabel:u.backOrCancelLabel,initialConfigurationStatus:(0,S.getConfigurationStatusByIntegrationId)(r,e.id),integration:e,neonIntegrationStatus:{isNeonDisabled:!1,isLoading:!1},onBack:p,onIntegrationResourceCreate:k,onSkipOnboarding:e=>{e?k(e):m()},product:(0,T.getProductWithSupportedProtocols)(u.resourceWithProduct.product),teamSlug:a??""})}default:return null}}var et=e.i(8696994),en=e.i(3584802),er=e.i(9100551);function eo(){let{hasProject:e}=(0,g.useProjectSlug)(),{team:f}=(0,j.useTeam)(),{state:v,onClose:b,onAnimationDone:y,maybeGoToConnectProjectStep:S,switchTab:T,goToCreateResourceStep:E}=(0,h.useResourceModalsContext)(),{data:k}=(0,p.useConfigurations)({type:"marketplace",skipBillingData:!0}),{data:w}=(0,d.useResourceList)({protocolType:"storage"}),_=`create-connect-${v.modalKey}`,[I,M]=(0,s.useState)(),A=(0,er.useRouter)(),P=(0,s.useRef)(null),O=(0,s.useCallback)(()=>{M(void 0),y()},[y]),R=(0,s.useCallback)(()=>{M(void 0),b()},[b]);switch(v.type){case u.ResourceModalsActionTypes.ModalClosed:return(0,t.jsx)(o.Modal.Modal,{active:v.active,allowOverflow:!0,onAnimationDone:O,onClickOutside:b,width:620,children:(0,t.jsx)("div",{})},_);case u.ResourceModalsActionTypes.BrowseProudctsOrSelectResources:return(0,t.jsx)(o.Modal.Modal,{active:v.active,allowOverflow:!0,onAnimationDone:O,onClickOutside:b,width:"browse-new"===v.tab?540:620,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Modal.Body,{className:et.default.modalBody,children:(0,t.jsxs)(n.Stack,{gap:6,ref:P,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsx)(o.Modal.Title,{center:!0,children:"Browse Storage"}),(0,t.jsx)(o.Modal.Subtitle,{children:(0,t.jsx)(r.Text,{align:"center",color:"gray-900",children:"Create databases and stores that you can connect to your projects."})})]}),(0,t.jsxs)(a.Switch,{name:"switch-new-existing-tab",children:[(0,t.jsx)(a.Switch.Control,{defaultChecked:"browse-new"===v.tab,label:"Create New",onChange:()=>{T("browse-new")},size:"large",value:"create",width:104}),(0,t.jsx)(a.Switch.Control,{defaultChecked:"browse-existing"===v.tab,disabled:w?.stores.length===0,label:"Select Existing",onChange:()=>{T("browse-existing")},size:"large",value:"connect",width:122})]}),"browse-new"===v.tab?(0,t.jsx)(x.BrowseStoresCards,{onClickStore:e=>{M(e)},storeTypeWithProduct:I}):null,"browse-existing"===v.tab?(0,t.jsx)(m.SelectResources,{hasCreateConnectButton:!1,onClickConnectStoreModal:e=>{S(e)},protocolType:"storage"}):null]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:R,type:"secondary",children:"Cancel"}),"browse-new"===v.tab?(0,t.jsx)(o.Modal.Action,{disabled:!I,onClick:()=>{I&&E(I)},children:"Continue"}):null]})]})},_);case u.ResourceModalsActionTypes.BrowseProducts:return(0,t.jsx)(o.Modal.Modal,{active:v.active,allowOverflow:!0,onAnimationDone:O,onClickOutside:b,width:540,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Modal.Body,{className:et.default.modalBody,children:(0,t.jsxs)(n.Stack,{gap:6,ref:P,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsx)(o.Modal.Title,{center:!0,children:"Browse Storage"}),(0,t.jsx)(o.Modal.Subtitle,{children:(0,t.jsx)(r.Text,{align:"center",color:"gray-900",children:"Create databases and stores that you can connect to your projects."})})]}),(0,t.jsx)(x.BrowseStoresCards,{onClickStore:e=>{M(e)},storeTypeWithProduct:I})]})}),(0,t.jsxs)(o.Modal.Actions,{children:[(0,t.jsx)(o.Modal.Action,{onClick:R,type:"secondary",children:"Cancel"}),(0,t.jsx)(o.Modal.Action,{"data-testid":(0,i.tid)("create-store-modal","continue"),disabled:!I,onClick:()=>{I&&("integration"===I.type?(A.push((0,en.getIntegrationCheckoutUrl)({params:{teamSlug:f?.slug??"",integrationSlug:I.integration.slug},searchParams:{productSlug:I.product.slug,cancelUrl:f?`/${f.slug}/~/integrations/${I.integration.slug}`:`/marketplace/${I.integration.slug}`}})),l.analytics.track(c.AnalyticsEvent.MARKETPLACE_PRODUCT_INSTALL_CLICKED,{source:"storage",integration:{id:I.integration.id,slug:I.integration.slug},productSlug:I.product.slug})):E(I))},children:"Continue"})]})]})},_);case u.ResourceModalsActionTypes.CreateResource:return(0,t.jsx)(o.Modal.Modal,{active:v.active,allowOverflow:!0,onAnimationDone:O,onClickOutside:b,width:540,children:(0,t.jsx)(ee,{installations:k})},_);case u.ResourceModalsActionTypes.CreateEnvs:return e?(0,t.jsx)(o.Modal.Modal,{active:v.active,allowOverflow:!0,onAnimationDone:O,onClickOutside:b,width:540,children:(0,t.jsx)(C.ConnectStoreSwitch,{store:v.resource})},_):(0,t.jsx)(C.ConnectStoreSwitchWithoutProject,{active:v.active,store:v.resource},_);case u.ResourceModalsActionTypes.DeleteEnvs:throw Error("State not supported")}}e.s(["CreateStoreModal",()=>eo],8922739)}]);

//# sourceMappingURL=50032d1f92249e9f.js.map
//# debugId=684ee8a1-cc25-55c7-9852-0eb3797f421b
