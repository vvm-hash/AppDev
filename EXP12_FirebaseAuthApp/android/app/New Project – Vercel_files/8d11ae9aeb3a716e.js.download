
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c426b570-d72e-55a2-83c3-0f43f94515f8")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6307619,e=>{e.v({afterName:"deploy-step-module__kdfw_G__afterName",age:"deploy-step-module__kdfw_G__age",content:"deploy-step-module__kdfw_G__content",contentClose:"deploy-step-module__kdfw_G__contentClose",contentFadeIn:"deploy-step-module__kdfw_G__contentFadeIn",contentFadeOut:"deploy-step-module__kdfw_G__contentFadeOut",contentOpen:"deploy-step-module__kdfw_G__contentOpen",contentWrapperPaddingBoth:"deploy-step-module__kdfw_G__contentWrapperPaddingBoth",contentWrapperPaddingVertical:"deploy-step-module__kdfw_G__contentWrapperPaddingVertical",contentWrapperPaddingVerticalBottom:"deploy-step-module__kdfw_G__contentWrapperPaddingVerticalBottom",header:"deploy-step-module__kdfw_G__header",icon:"deploy-step-module__kdfw_G__icon",item:"deploy-step-module__kdfw_G__item",name:"deploy-step-module__kdfw_G__name",trigger:"deploy-step-module__kdfw_G__trigger",triggerContent:"deploy-step-module__kdfw_G__triggerContent",triggerIcon:"deploy-step-module__kdfw_G__triggerIcon"})},9286433,e=>{e.v({creationFlow:"index-module__958Mra__creationFlow",logPreviewText:"index-module__958Mra__logPreviewText",mask:"index-module__958Mra__mask"})},7921739,e=>{e.v({accordion:"deploy-steps-module__0qoykW__accordion",afterNameContainer:"deploy-steps-module__0qoykW__afterNameContainer",cacheBadgeName:"deploy-steps-module__0qoykW__cacheBadgeName",cacheBadgeTooltipContainer:"deploy-steps-module__0qoykW__cacheBadgeTooltipContainer",checksFilter:"deploy-steps-module__0qoykW__checksFilter",checksStatus:"deploy-steps-module__0qoykW__checksStatus",connectionCircle:"deploy-steps-module__0qoykW__connectionCircle",connectionIcon:"deploy-steps-module__0qoykW__connectionIcon",filterMessage:"deploy-steps-module__0qoykW__filterMessage",linkText:"deploy-steps-module__0qoykW__linkText",noData:"deploy-steps-module__0qoykW__noData"})},4080109,e=>{e.v({action:"domain-row-module__MaxPfa__action",domain:"domain-row-module__MaxPfa__domain",domainContainer:"domain-row-module__MaxPfa__domainContainer",header:"domain-row-module__MaxPfa__header",heading:"domain-row-module__MaxPfa__heading",separator:"domain-row-module__MaxPfa__separator",wrapper:"domain-row-module__MaxPfa__wrapper"})},7784834,e=>{e.v({loadMore:"domain-step-module__nlP40W__loadMore",stepMessage:"domain-step-module__nlP40W__stepMessage"})},4303122,e=>{e.v({closedAll:"switcher-module__0BRQ2W__closedAll",collapsedBadgeName:"switcher-module__0BRQ2W__collapsedBadgeName",collapsedBadgesWrapper:"switcher-module__0BRQ2W__collapsedBadgesWrapper",iconLabel:"switcher-module__0BRQ2W__iconLabel",tooltip:"switcher-module__0BRQ2W__tooltip"})},9907554,e=>{e.v({badge:"log-row-module__w74U9q__badge",badgesWrapper:"log-row-module__w74U9q__badgesWrapper",content:"log-row-module__w74U9q__content",contentClose:"log-row-module__w74U9q__contentClose",contentOpen:"log-row-module__w74U9q__contentOpen",downloadButton:"log-row-module__w74U9q__downloadButton",frameworkWrapper:"log-row-module__w74U9q__frameworkWrapper",header:"log-row-module__w74U9q__header",iconWrapper:"log-row-module__w74U9q__iconWrapper",isrIconWrapper:"log-row-module__w74U9q__isrIconWrapper",link:"log-row-module__w74U9q__link",middlewareList:"log-row-module__w74U9q__middlewareList",radixTrigger:"log-row-module__w74U9q__radixTrigger",scroller:"log-row-module__w74U9q__scroller",title:"log-row-module__w74U9q__title",trigger:"log-row-module__w74U9q__trigger",wrapper:"log-row-module__w74U9q__wrapper"})},1160917,e=>{e.v({active:"badge-module__2RpGha__active",badge:"badge-module__2RpGha__badge",badgeContent:"badge-module__2RpGha__badgeContent"})},2608999,e=>{e.v({allPathsMiddlewareRow:"artefacts-list-module__PbE2WW__allPathsMiddlewareRow",arrowColumn:"artefacts-list-module__PbE2WW__arrowColumn",button:"artefacts-list-module__PbE2WW__button",copyFlagIcon:"artefacts-list-module__PbE2WW__copyFlagIcon",copyFlagIconWrapper:"artefacts-list-module__PbE2WW__copyFlagIconWrapper",copyIcon:"artefacts-list-module__PbE2WW__copyIcon",copyIconContainer:"artefacts-list-module__PbE2WW__copyIconContainer",copyIconWrapper:"artefacts-list-module__PbE2WW__copyIconWrapper",cronJobItem:"artefacts-list-module__PbE2WW__cronJobItem",cronJobItemAsterisk:"artefacts-list-module__PbE2WW__cronJobItemAsterisk",destinationColumn:"artefacts-list-module__PbE2WW__destinationColumn",hasTrigger:"artefacts-list-module__PbE2WW__hasTrigger",headerContent:"artefacts-list-module__PbE2WW__headerContent",isrFunctionRow:"artefacts-list-module__PbE2WW__isrFunctionRow",item:"artefacts-list-module__PbE2WW__item",list:"artefacts-list-module__PbE2WW__list",middlewareInfoIcon:"artefacts-list-module__PbE2WW__middlewareInfoIcon",pathWrapper:"artefacts-list-module__PbE2WW__pathWrapper",regionBadge:"artefacts-list-module__PbE2WW__regionBadge",regionBadgeContainer:"artefacts-list-module__PbE2WW__regionBadgeContainer",singleDigit:"artefacts-list-module__PbE2WW__singleDigit",size:"artefacts-list-module__PbE2WW__size",sourceColumn:"artefacts-list-module__PbE2WW__sourceColumn",staticAssetGrid:"artefacts-list-module__PbE2WW__staticAssetGrid",staticRoute:"artefacts-list-module__PbE2WW__staticRoute",staticRouteButton:"artefacts-list-module__PbE2WW__staticRouteButton",staticRoutesContainer:"artefacts-list-module__PbE2WW__staticRoutesContainer",trigger:"artefacts-list-module__PbE2WW__trigger",truncate:"artefacts-list-module__PbE2WW__truncate",typeBadge:"artefacts-list-module__PbE2WW__typeBadge",typeBadgeContainer:"artefacts-list-module__PbE2WW__typeBadgeContainer",typeIcon:"artefacts-list-module__PbE2WW__typeIcon",variantItemGrid:"artefacts-list-module__PbE2WW__variantItemGrid",variantItemUpstream:"artefacts-list-module__PbE2WW__variantItemUpstream",virtualListAtBottom:"artefacts-list-module__PbE2WW__virtualListAtBottom",virtualListAtTop:"artefacts-list-module__PbE2WW__virtualListAtTop"})},6618181,e=>{e.v({header:"header-module__W7AuxW__header",headerStatContainer:"header-module__W7AuxW__headerStatContainer",headerStatMetric:"header-module__W7AuxW__headerStatMetric",headerStatTitle:"header-module__W7AuxW__headerStatTitle",headerStats:"header-module__W7AuxW__headerStats",headerTitle:"header-module__W7AuxW__headerTitle",headerTitleContainer:"header-module__W7AuxW__headerTitleContainer"})},7935689,e=>{e.v({sidebar:"sidebar-module__m58S2q__sidebar",sidebarDivider:"sidebar-module__m58S2q__sidebarDivider",sidebarFooter:"sidebar-module__m58S2q__sidebarFooter",sidebarTaskContainer:"sidebar-module__m58S2q__sidebarTaskContainer",sidebarTitle:"sidebar-module__m58S2q__sidebarTitle"})},5224197,458149,1367170,7442785,855127,e=>{"use strict";var t,n,a,s=e.i(6468255),r=e.i(1435235),i=e.i(6696646),l=e.i(9722978),o=e.i(4756166),c=e.i(9574532),d=e.i(4597921),u=e.i(57106),m=e.i(7450862),p=e.i(1344973),h=e.i(9139501),g=e.i(1717203),x=e.i(7557283),f=e.i(2504781),y=e.i(8674454),j=e.i(6694387),v=e.i(4991687),C=e.i(8459493),_=e.i(9508212),b=e.i(8923565),k=e.i(5468328),w=e.i(5761705),S=e.i(7749365),N=e.i(6226725),I=e.i(109803),A=e.i(992159),T=e.i(7957251),R=e.i(8646538),P=e.i(6401841),E=e.i(762945),L=e.i(7674801),W=e.i(9100551),M=e.i(6159310),B=e.i(1282571),D=e.i(8525850),V=e.i(100247),F=e.i(4844919),H=e.i(3758860);e.i(6887680);var z=e.i(6810699),O=e.i(7743427),U=e.i(4443312),$=e.i(847180),q=e.i(4641028);let G="Running Checks",Z="Marketplace Checks",Y="Deployment Checks",J="Assigning Domains",K="Deployment Summary",Q=["Build Logs",K,J];var X=e.i(9334638);let ee=(0,X.withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8ZM16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM5.53033 4.46967L5 3.93934L3.93934 5L4.46967 5.53033L10.4697 11.5303L11 12.0607L12.0607 11L11.5303 10.4697L5.53033 4.46967Z" fill="currentColor"/>');var et=e.i(8761240),en=e.i(9386557),ea=e.i(9584456),es=e.i(9429910),er=e.i(5756088),ei=e.i(5255926),el=e.i(8735244),eo=e.i(2560270),ec=e.i(361349),ed=e.i(85019),eu=e.i(6307619),em=((t={}).Building="BUILDING",t.FetchingSourceCode="FETCHING_SOURCE_CODE",t.PopulatingBuildCache="POPULATING_BUILD_CACHE",t.PreparingBuildEnv="PREPARING_BUILD_ENV",t.RestoringBuildCache="RESTORING_BUILD_CACHE",t.UploadingBuildOutputs="UPLOADING_BUILD_OUTPUTS",t),ep=((n={}).Delimiter="delimiter",n.Stdout="stdout",n.Stderr="stderr",n),eh=((a={}).Canceled="cancelled",a.Complete="complete",a.Error="error",a.Warning="warning",a.InProgress="in-progress",a.Pending="pending",a.Skipped="skipped",a.NoData="no-data",a.Partial="partial",a.MissingPermissions="missing-permissions",a);let eg={both:eu.default.contentWrapperPaddingBoth,vertical:eu.default.contentWrapperPaddingVertical,"vertical-bottom":eu.default.contentWrapperPaddingVerticalBottom,none:void 0};function ex(e){let{id:t,name:n}=e,a="string"==typeof n?`${n.length}ch`:"200px";return(0,s.jsx)(r.Item,{className:eu.default.item,disabled:!0,value:t,children:(0,s.jsx)(r.Header,{asChild:!0,className:eu.default.header,children:(0,s.jsx)("h2",{children:(0,s.jsx)(r.Trigger,{asChild:!0,className:eu.default.triggerContent,children:(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(ei.Skeleton,{height:16,style:{width:a,fontSize:"14px"}}),(0,s.jsx)(ei.Skeleton,{className:eu.default.icon,height:20,rounded:!0,width:20})]})})})})})}function ef(e){let{action:t,children:n,disabled:a,finishedAt:o,id:c,customDuration:d,name:u,paddingType:m="vertical",skeleton:h,startedAt:g,status:x,afterName:f,showDurationWhenSkipped:y}=e,[j,v]=i.useState(null),C=i.useMemo(()=>{switch(x){case"cancelled":case"pending":return(0,s.jsx)(S.Clock,{color:"gray-500",size:20});case"skipped":case"partial":return(0,s.jsx)(ee,{color:"gray-500",size:20});case"complete":return(0,s.jsx)(et.CheckCircleFill,{color:"blue-700",size:20});case"warning":return(0,s.jsx)(en.WarningFill,{color:"amber-700",size:20});case"error":return(0,s.jsx)(ea.StopFill,{color:"red-700",size:20});case"no-data":return(0,s.jsx)(es.InformationFill,{color:"gray-700",size:20});case"missing-permissions":return(0,s.jsx)(er.LockClosed,{color:"gray-700",size:20});default:return(0,s.jsx)(el.Spinner,{size:20})}},[x]);(0,ec.useInterval)(()=>{g&&v(Date.now()-g)},o?null:1e3,!0),i.useEffect(()=>{null===j&&g&&o&&v(o-g)},[j,o,g]);let _="skipped"===x;return(0,s.jsxs)(r.Item,{className:eu.default.item,"data-status":x,disabled:a,value:c,children:[(0,s.jsx)(r.Header,{asChild:!0,className:eu.default.header,children:(0,s.jsx)("h2",{children:(0,s.jsx)(r.Trigger,{asChild:!0,className:(0,l.clsx)(eu.default.triggerContent,{"flex-nowrap":c===em.Building}),children:(0,s.jsxs)("div",{children:[(0,s.jsx)(eo.ChevronDown,{className:eu.default.triggerIcon,color:a?"gray-800":"gray-900"}),(0,s.jsx)(p.Text,{as:"span",className:eu.default.name,weight:500,children:u}),f?(0,s.jsx)(p.Text,{as:"span",className:eu.default.afterName,children:f}):null,t,h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:eu.default.age}),(0,s.jsx)(ei.Skeleton,{className:eu.default.icon,height:20,rounded:!0,width:20})]}):(0,s.jsxs)(s.Fragment,{children:[(!_||y)&&(d||j)&&c!==K?(0,s.jsx)("span",{className:"text-label-14 flex-none text-gray-900 tabular-nums",children:(0,ed.age)(d||j||void 0,{includeSeconds:!0})}):null,_?(0,s.jsx)("span",{className:"text-label-14 flex-none text-gray-900",children:"Skipped"}):null,(0,s.jsx)("div",{className:eu.default.icon,children:C})]})]})})})}),(0,s.jsx)(r.Content,{className:eu.default.content,children:(0,s.jsx)("div",{className:`${eg[m]??""} tailwind`,children:n})})]})}var ey=e.i(472117),ej=e.i(5838262),ev=e.i(277234),eC=e.i(8042625);function e_(e){let{checkId:t,deploymentId:n,teamSlug:a,onSuccess:r,disabled:l=!1,checksConclusion:o}=e,[c,d]=(0,i.useTransition)(),[u,m]=(0,i.useState)(0);(0,i.useEffect)(()=>()=>{u&&clearTimeout(u)},[u]);let p=async()=>{await (0,ev.fetchAPI)(`/v1/deployments/${n}/checks/${t}/rerequest${(0,eC.encode)({teamId:a,autoUpdate:!0})}`,{method:"POST"}),await r?.(),u&&clearTimeout(u);let e=window.setTimeout(()=>{m(0)},5e3);m(e)};return(0,s.jsx)(f.Button,{onClick:()=>d(p),size:"small",type:"secondary",disabled:l||c||"skipped"===o||!!u,loading:c,children:"Rerun"})}function eb(){let e=(0,W.useSearchParams)(),t=(0,W.usePathname)(),n=(0,W.useRouter)(),a=new Set(["all","failed","succeeded","running","queued"]),s=e?.get("promotion-requirements");return{activeFilter:a.has(s)?s??"all":"all",handleFilterChange:a=>{let s=new URLSearchParams(e?.toString());"all"===a?s.delete("promotion-requirements"):s.set("promotion-requirements",a),n.replace(`${t}?${s.toString()}`,{scroll:!1})},hasFilter:!!s}}function ek(e){let{deployment:t,teamSlug:n,expandedSteps:a,onExpandedStepsChange:r}=e,l=(0,ey.useCiChecksAndPoliciesFlagV2)(),{data:o}=(0,U.useProjectCheckRuns)({deploymentId:t.id,enableCiChecksAndPolicies:l}),{areChecksRunning:c}=(0,V.getDeploymentStatus)(t),{checks:d,mutate:u}=(0,q.default)({deploymentId:t.id,teamId:n},{refreshInterval:c?U.CHECK_RUNS_REFRESH_INTERVAL:0}),{ciChecks:m,checksV1ById:p}=(0,i.useMemo)(()=>({ciChecks:[...o?.runs??[],...d.map(e=>{let n;return n="registered"===e.status?"queued":e.status,{id:e.id,name:e.name,checkId:e.id,status:n,conclusion:e.conclusion,source:{kind:"integration",integrationId:e.integrationId,integrationConfigurationId:e.integrationId,externalResourceId:e.externalId},externalUrl:e.externalUrl,externalId:e.externalId,createdAt:e.createdAt,startedAt:e.startedAt,completedAt:e.completedAt,updatedAt:e.updatedAt,ownerId:t.team?.id||t.ownerId||"",projectId:t.projectId,deploymentId:t.id,output:e.output}})],checksV1ById:new Map(d.map(e=>[e.id,e]))}),[o,d,t]),h=(0,i.useRef)(!1),{hasFilter:g}=eb();(0,i.useEffect)(()=>{h.current||!g||a.includes(Y)||r([...a,Y]),m.length&&(h.current=!0)},[g,a,r,m]);let x=eh.Pending;0===m.length?eh.Pending:m.some(e=>"failed"===e.conclusion)?x=eh.Error:m.some(e=>"running"===e.status)?x=eh.InProgress:m.every(e=>"succeeded"===e.conclusion)&&(x=eh.Complete);let f=a.includes(Y),y="production"===t.target;return(0,s.jsx)(ew,{isProduction:y,isExpanded:f,combinedStatus:x,ciChecks:m,teamSlug:n,deployment:t,expandedSteps:a,checksV1ById:p,mutateChecksV1:u})}function ew(e){let{isProduction:t,combinedStatus:n,ciChecks:a,teamSlug:r,deployment:l,expandedSteps:o,checksV1ById:c,mutateChecksV1:d}=e,{activeFilter:u}=eb(),{can:m}=(0,g.default)(),h=(0,i.useMemo)(()=>m(x.Action.All,x.Resource.DeploymentCheck),[m]),f=(0,i.useMemo)(()=>"all"===u?a:a.filter(e=>{switch(u){case"failed":return"failed"===e.conclusion||"timeout"===e.conclusion||"skipped"===e.conclusion;case"running":return"running"===e.status;case"queued":return"queued"===e.status;case"succeeded":return"succeeded"===e.conclusion;default:return!0}}),[a,u]),y=(0,z.useResourceList)({resourceIds:f.flatMap(e=>"integration"===e.source.kind&&e.source.resourceId?[e.source.resourceId]:[])}),j=(0,i.useMemo)(()=>{let e=new Map;return y.data?.stores?.forEach(t=>{"integration"===t.type&&e.set(t.id,t)}),e},[y.data?.stores]);return 0===a.length?(0,s.jsx)(ef,{id:Y,name:Y,status:eh.Pending,children:(0,s.jsx)(ej.EmptyChecksCard,{})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ef,{action:(0,s.jsx)(eN,{isProduction:t,ciChecks:a,expandedSteps:o}),id:Y,name:Y,paddingType:"none",status:n,children:0===f.length?(0,s.jsx)(eP,{size:"sm",children:(0,s.jsx)(_.Stack,{align:"center",className:"ml-5",direction:"row",gap:2,children:(0,s.jsx)(p.Text,{variant:"label-14",weight:500,className:"text-gray-900",children:"No requirements match this filter."})})}):f.sort((e,t)=>{let n=e=>"failed"===e.conclusion?0:"canceled"===e.conclusion?9:"running"===e.status?1:"queued"===e.status?2:"succeeded"===e.conclusion?8:"skipped"===e.conclusion?9:10,a=n(e),s=n(t);return a!==s?a-s:e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}).map(e=>{let t="resourceId"in e.source&&e.source.resourceId?j.get(e.source.resourceId):void 0;return(0,s.jsx)(eT,{check:e,resource:t,teamSlug:r,deployment:l,canUpdateDeploymentRequirements:h,checkV1:c.get(e.id),mutateChecksV1:d},e.name)})})})}function eS(e){let{ciChecks:t,expandedSteps:n}=e,a=(0,i.useMemo)(()=>({all:t.length,failed:t.filter(e=>"failed"===e.conclusion).length,running:t.filter(e=>"running"===e.status).length,registered:t.filter(e=>"queued"===e.status).length,succeeded:t.filter(e=>"succeeded"===e.conclusion).length,skipped:t.filter(e=>"skipped"===e.conclusion||"canceled"===e.conclusion).length}),[t]),{activeFilter:r,handleFilterChange:o}=eb(),c=[{value:"all",icon:(0,s.jsx)("span",{children:"All"}),count:a.all},{value:"failed",icon:(0,s.jsx)(eR,{check:{status:"completed",conclusion:"failed"}}),count:a.failed},{value:"succeeded",icon:(0,s.jsx)(eR,{check:{status:"completed",conclusion:"succeeded"}}),count:a.succeeded},{value:"running",icon:(0,s.jsx)(eR,{check:{status:"running",conclusion:"neutral"}}),count:a.running},{value:"queued",icon:(0,s.jsx)(eR,{check:{status:"queued",conclusion:"neutral"}}),count:a.registered}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,l.clsx)("transition-opacity duration-200",n.includes(Y)?"pointer-events-auto opacity-100":"pointer-events-none opacity-0"),children:(0,s.jsx)(b.Switch,{size:"small",onClick:e=>e.stopPropagation(),className:"hidden [@media(min-width:750px)]:flex",children:c.map(e=>{let{value:t,icon:n,count:a}=e;return(0,s.jsx)(b.Switch.Control,{checked:t===r,label:(0,s.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:[n," ",(0,s.jsx)("span",{className:"all"===t?"ml-[2px]":"",children:a})]}),onChange:()=>{o(t)},value:t},t)})})}),(0,s.jsxs)(v.MenuContainer,{children:[(0,s.jsx)(j.MenuButton,{size:"small",shape:"square",svgOnly:!0,"aria-label":"Filter Deployment Checks",type:"secondary",className:"block w-[23px] !p-0 text-sm font-normal [@media(min-width:750px)]:hidden",children:(0,s.jsx)(A.Filter,{size:16,color:"gray-900"})}),(0,s.jsx)(y.Menu,{className:"font-normal [@media(min-width:750px)]:hidden",children:c.map(e=>{let{value:t,icon:n,count:a}=e;return(0,s.jsx)(C.MenuItem,{onClick:e=>{e.stopPropagation(),o(t)},children:(0,s.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:4},children:["all"!==t?n:void 0," ",(0,s.jsxs)("span",{children:[(0,F.default)(t)," (",a,")"]})]})},t)})})]})]})}function eN(e){let{isProduction:t,ciChecks:n,expandedSteps:a}=e,r=(0,ey.useChecksSettingsFlag)(),i=(0,ey.useCiChecksAndPoliciesFlagV2)();return t&&i?(0,s.jsxs)(s.Fragment,{children:[n.length>0&&(0,s.jsx)(eS,{ciChecks:n,expandedSteps:a}),r&&(0,s.jsx)(M.DashboardButtonLink,{route:"/[teamSlug]/[project]/settings/build-and-deployment",hash:"#deployment-checks",size:"small",type:"secondary",prefix:(0,s.jsx)(I.External,{color:"gray-900"}),target:"_blank",children:"Manage"})]}):null}function eI(e){let{check:t,integration:n,checkV1:a}=e,r=(0,i.useMemo)(()=>a?a.externalUrl||a.detailsUrl:t.externalUrl?n&&"integration"===t.source.kind?(0,H.getIntegrationAbsoluteOrSsoLink)(t.externalUrl,{teamIdOrSlug:t.ownerId,integrationConfigurationId:t.source.integrationConfigurationId,externalResourceId:t.source.externalResourceId,projectId:t.projectId,checkId:t.id}):t.externalUrl:"integration"===t.source.kind?(0,H.getIntegrationDeepLink)({teamIdOrSlug:t.ownerId,integrationConfigurationId:t.source.integrationConfigurationId,externalResourceId:t.source.externalResourceId,projectId:t.projectId,checkId:t.id}):null,[t,n,a]),{name:l,status:o,conclusion:c}=t,d=(0,s.jsx)(p.Text,{size:14,weight:500,children:l}),m=(0,s.jsx)(eR,{check:{conclusion:c,status:o}});return(0,s.jsxs)(_.Stack,{direction:"row",gap:4,align:"center",className:"flex-1 min-w-0",children:[m,(0,s.jsxs)(_.Stack,{direction:"row",gap:2,align:"center",className:"flex-1 min-w-0",children:[(0,s.jsx)(eA,{check:t,integration:n}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:r?(0,s.jsx)(u.Link,{external:!0,href:r,children:d}):d}),t.conclusionText&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Text,{as:"span",color:"gray-900",className:"flex-shrink-0",children:"·"}),(0,s.jsx)(k.Tooltip,{as:"div",className:"flex-1 min-w-0",text:t.conclusionText,children:(0,s.jsx)("div",{className:"overflow-hidden",children:(0,s.jsx)(p.Text,{size:14,color:"gray-900",className:"truncate whitespace-nowrap overflow-hidden text-ellipsis",children:t.conclusionText})})})]})]})]})]})}function eA(e){let{check:t,integration:n}=e;return n?(0,s.jsx)(B.MarketplaceIntegrationCardIcon,{size:20,icon:n.icon,name:n.name}):"git-provider"===t.source.kind?(0,s.jsx)(L.LogoGithub,{size:20}):null}function eT(e){let{check:t,resource:n,teamSlug:a,deployment:r,canUpdateDeploymentRequirements:i,checkV1:o,mutateChecksV1:c}=e,{status:d,conclusion:m,source:h}=t,{data:g}=(0,O.useIntegration)("integration"===t.source.kind?t.source.integrationId:void 0),{mutate:x}=(0,U.useProjectCheckRuns)({deploymentId:r.id,enableCiChecksAndPolicies:!0}),y=(0,$.useSkipCheckRun)({teamId:r.team?.id,deploymentId:r.id,checkRunId:t.id,onSuccess:()=>{x()}}),j=(0,$.useSkipCheckV1)({teamId:a,deploymentId:r.id,checkId:t.id,onSuccess:()=>{c?.(),x()}}),v=async()=>{c?.(),await x()},C=()=>(0,l.clsx)("hover:bg-[var(--ds-gray-100)]"),b=n&&a&&(0,D.getResourceDetailsPath)(n,a),w=async()=>{o?await j.trigger():await y.trigger()},S="git-provider"===h.kind,N=i&&!S&&("running"===d||"queued"===d||"completed"===d&&"failed"===m),I=i&&"failed"===m&&!!o;return(0,s.jsxs)(eP,{className:C(),size:"sm","data-check-status":"failed"===m?"failed":d,children:["queued"===d?(0,s.jsx)(k.Tooltip,{text:"This requirement is expected to run, but has not provided a status yet.",children:(0,s.jsx)(eI,{check:t,integration:g,checkV1:o})}):(0,s.jsx)(eI,{check:t,integration:g,checkV1:o}),(0,s.jsxs)(_.Stack,{direction:"row",gap:4,children:[b?(0,s.jsx)(u.Link,{className:(0,l.clsx)(C(),"hidden flex-row items-center gap-2 bg-transparent text-gray-900 md:flex"),external:!0,href:b,children:(0,s.jsx)(p.Text,{className:(0,l.clsx)(C(),"flex-row items-center gap-2 bg-transparent text-gray-900 flex"),children:n.name})}):null,I&&(0,s.jsx)(e_,{checkId:t.id,deploymentId:r.id,teamSlug:a,onSuccess:v,checksConclusion:r.checksConclusion}),N&&(0,s.jsx)(k.Tooltip,{text:"Skip this check",children:(0,s.jsx)(f.Button,{size:"small",type:"secondary",onClick:w,disabled:y.isMutating||j.isMutating,"aria-label":"Skip check",children:y.isMutating||j.isMutating?"Skipping…":"Skip"})})]})]})}function eR(e){let{check:t}=e;return t?.status==="running"?(0,s.jsx)(R.StatusBordered,{size:16,color:"amber-600"}):t?.status==="completed"&&"succeeded"===t.conclusion?(0,s.jsx)(w.CheckCircle,{size:16,color:"green-700"}):t?.status==="completed"&&"failed"===t.conclusion?(0,s.jsx)(P.Stop,{size:16,color:"red-700"}):t?.status==="completed"&&"neutral"===t.conclusion?(0,s.jsx)(E.Warning,{size:16,color:"amber-700"}):t?.status==="completed"&&"skipped"===t.conclusion||t?.status==="completed"&&"canceled"===t.conclusion||t?.status==="completed"&&"neutral"===t.conclusion||t?.status==="completed"&&"neutral"===t.conclusion?(0,s.jsx)(T.MinusCircle,{color:"gray-500",size:16}):t?.status==="queued"?(0,s.jsx)(S.Clock,{size:16}):(0,s.jsx)(N.CrossCircle,{color:"gray-500",size:16})}function eP(e){let{children:t,className:n,onClick:a,size:r="lg"}=e;return(0,s.jsx)(_.Stack,{className:(0,l.clsx)("hsla(var(--ds-gray-200-value),1) px-3 sm:px-[var(--geist-space-gap)] [&:not(:last-child)]:border-b",{"py-[var(--geist-space-4x)]":"lg"===r},{"py-[var(--geist-space-gap-half)]":"sm"===r},n),direction:"row",gap:2,justify:"space-between",onClick:a,children:t})}var eE=e.i(9031150),eL=e.i(119294),eW=e.i(6352514),eM=e.i(4670733),eB=e.i(7837522),eD=e.i(7780974);class eV extends TransformStream{#e="";#t=!1;#n=!1;#a=e=>e;constructor(e){super({transform:(e,t)=>this.#s(e,t),flush:e=>this.#s("\r\n",e)}),this.#t=e?.allowCR??!1,this.#n=e?.returnEmptyLines??!1,this.#a=e?.mapperFun??this.#a}#s(e,t){for(e=this.#e+e;;){let n=e.indexOf("\n");if(this.#t){let a=e.indexOf("\r");if(-1!==a&&a!==e.length-1&&(-1===n||n-1>a)){let n=this.#a(e.slice(0,crOrLfIndex));(this.#n||n)&&t.enqueue(n),e=e.slice(a+1);continue}}if(-1!==n){let a=n;"\r"===e[n-1]&&a--;let s=this.#a(e.slice(0,a));(this.#n||s)&&t.enqueue(s),e=e.slice(n+1);continue}break}this.#e=e}}var eF=e.i(5802506),eH=e.i(4244280),ez=e.i(6549540);let eO=e=>e.type===ep.Delimiter,eU=e=>{let{url:t,onLog:n,onResponse:a,signal:s,since:r,deploymentRef:i}=e,l={builds:1,since:r,direction:"forward",follow:(0,ez.default)(i.current)?void 0:1},o=r??0;return fetch(`${t}${(0,eC.encode)(l)}`,{signal:s}).then(async e=>{if(a?.(e),e.status<200||e.status>=300){let t=await e.text();throw Error(`Failed to fetch log stream: ${e.status} ${t}`)}if(1!==l.follow){for(let t of(await e.json()))n(t);return}let r=e.body?.pipeThrough(new TextDecoderStream,{signal:s}).pipeThrough(new eV({mapperFun:e=>{try{return JSON.parse(e)}catch{return null}}}),{signal:s}).getReader();if(r){for(;;){let{value:e,done:t}=await r.read();if(s.aborted)return;if(t||!e)break;e.created&&(o=e.created+1,n(e))}if(await new Promise(e=>{setTimeout(e,1e3)}),!s.aborted)return eU({url:t,signal:s,deploymentRef:i,since:o,onLog:n,onResponse:a})}})};var e$=e.i(4470704),eq=e.i(6891161),eG=e.i(9318197),eZ=e.i(455575);let eY=e=>{let{active:t,deployment:n,onClose:a,mutateDeployment:r}=e,[l,o]=(0,i.useState)(!1),c=(0,eZ.useToasts)(),d=async()=>{o(!0);let{error:e}=await (0,ev.fetchAPI)(`/v1/deployments/${n?.id}/checks/skip${(0,eC.encode)({teamId:n.team?.id})}`,{method:"POST"});e&&c.error({text:e.message||"An error occurred while skipping checks"}),o(!1),a(),r?.()};return(0,s.jsxs)(eq.Modal.Modal,{active:t,onClickOutside:a,width:"500px",children:[(0,s.jsxs)(_.Stack,{align:"center",justify:"center",children:[(0,s.jsx)(eG.Spacer,{y:1}),(0,s.jsx)(p.Text,{as:"h3",size:24,children:"Skip Checks"})]}),(0,s.jsx)(eq.Modal.Body,{children:(0,s.jsx)(p.Text,{align:"center",size:14,children:"Are you sure you want to continue?"})}),(0,s.jsxs)(eq.Modal.Actions,{children:[(0,s.jsx)(eq.Modal.Action,{onClick:a,type:"secondary",children:"Cancel"}),(0,s.jsx)(eq.Modal.Action,{disabled:l,loading:l,onClick:d,children:"Skip Checks"})]})]})};var eJ=e.i(3911483),eK=e.i(9668517);function eQ(e){let{meta:t={}}=e??{};return"githubCommitRef"in t?{refType:"github",refValue:t.githubCommitRef??void 0}:"gitlabCommitRef"in t?{refType:"gitlab",refValue:t.gitlabCommitRef??void 0}:"bitbucketCommitRef"in t?{refType:"bitbucket",refValue:t.bitbucketCommitRef??void 0}:{}}var eX=e.i(3001456),e0=e.i(7710663),e1=e.i(1116271);let e5=e=>(0,i.useEffect)(e,[]);var e2=e.i(9844152),e4=e.i(4201247),e9=e.i(1360174),e3=e.i(8320377),e7=e.i(9286433);function e8(e){let{label:t,latestLog:n,creationFlow:a,afterLabel:r}=e,[o,c]=(0,i.useState)(void 0),[d,u]=(0,i.useState)(!0),m=(0,i.useRef)((0,e9.default)(e=>{c(e)},250,{trailing:!0}));return(0,i.useEffect)(()=>{d||n?.text===""||(n?.text===void 0?c(void 0):m.current(n.text))},[d,n?.text]),(0,i.useEffect)(()=>{let e=m.current;return()=>{e.cancel()}},[]),(0,i.useEffect)(()=>{let e=setTimeout(()=>{u(!1)},1e3);return()=>{clearInterval(e)}},[]),(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-3 w-full",children:[(0,s.jsx)("span",{children:t}),r,(0,s.jsx)(e2.AnimatePresence,{mode:"popLayout",presenceAffectsLayout:!0,children:o?(0,s.jsx)("div",{className:e7.default.mask,id:"deploy-log-preview",children:(0,s.jsx)(e2.AnimatePresence,{mode:"popLayout",presenceAffectsLayout:!0,children:(0,s.jsx)(e4.motion.div,{animate:{y:0},className:(0,l.clsx)(e7.default.logPreviewText,{[e7.default.creationFlow]:a}),exit:{y:-24},initial:{y:24},style:{color:"var(--ds-gray-900)"},transition:{type:"tween",duration:.225},children:(0,s.jsx)(p.Text,{as:"span",color:"gray-900",monospace:!0,size:14,children:(0,s.jsx)(e3.Ansi,{disableColors:!0,children:o})})},o)})}):null})]})}var e6=e.i(8529990),te=e.i(1474855),tt=e.i(3322724),tn=e.i(2455417),ta=e.i(6143247),ts=e.i(8375248),tr=e.i(5883567);function ti(e){let{children:t}=e;return(0,s.jsx)("span",{className:"bg-background-100",children:t})}function tl(e){let{annotation:t}=e;if(!t)return null;let n={type:"tertiary",className:"!w-fit !px-3 font-sans font-normal *:flex *:gap-2 *:items-center *:!p-0 hover:!bg-transparent hover:!shadow-none hover:underline",prefix:t.icon};return"link"===t.type?(0,s.jsx)(ti,{children:(0,s.jsx)(u.ButtonLink,{href:t.href,...n,children:t.label})}):(0,s.jsx)(ti,{children:(0,s.jsx)(f.Button,{onClick:t.onClick,...n,children:t.label})})}var to=e.i(1120768),tc=e.i(1136434),td=e.i(1230902);let tu=/^L(?<start>[0-9]+)(?:-L(?<end>[0-9]+))?/;function tm(e){return e?`L${e.from+1}${e.from!==e.to?`-L${e.to+1}`:""}`:""}function tp(e){let t=tu.exec(e);return t?.groups?{from:Number(t.groups.start)-1,to:Number(t.groups.end||t.groups.start)-1}:null}function th(e,t){return(0,td.format)(e,t?"HH:mm:ss":"HH:mm:ss.SSS")}function tg(e){return null===e?{index:"LAST"}:{index:"number"==typeof e?e:e.from,offset:-96}}function tx(e,t){let n=[],a=null;for(let[s,r]of e.entries())r.level===t?a?a.to=s:(a={from:s,to:s},n.push(a)):a=null;return n}function tf(e){let{logs:t,className:n}=e,{hash:a,setHash:r}=(0,m.useHash)(),[l,o]=(0,i.useState)(null),c=(0,i.useMemo)(()=>({warning:tx(t,"warning"),error:tx(t,"error")}),[t]),[d,u]=(0,i.useState)(null),p=(0,i.useCallback)(e=>{if(l===e){u(null),o(null),r(null);return}o(e),u(0),r(tm(c[e]?.[0]))},[l,c,r]),h=(0,i.useCallback)(e=>{let t=l?c[l]:null,n=t?.length;if(void 0===n)return;let a=(((d??0)+("next"===e?1:-1))%n+n)%n;u(a),r(tm(t?.[a]??null))},[d,c,l,r]);return(0,i.useEffect)(()=>{let e=tp(a);function t(t){let n=e?c[t]?.findIndex(t=>{let{from:n,to:a}=t;return n===e.from&&a===e.to}):-1;return -1!==n&&(o(t),u(n),!0)}t("error")||t("warning")||(u(null),o(null))},[a,c]),(0,s.jsxs)("div",{className:(0,ta.cn)("flex items-center gap-2",n),children:[(0,s.jsx)(ty,{kind:"error",level:l,total:c.error.length,current:d,onSelect:p,onNavigation:h}),(0,s.jsx)(ty,{kind:"warning",level:l,total:c.warning.length,current:d,onSelect:p,onNavigation:h})]})}function ty(e){let{level:t,kind:n,total:a,current:r,onSelect:i,onNavigation:l}=e,o=Array.from({length:a.toString().length-((r??0)+1).toString().length},(e,t)=>(0,s.jsx)("span",{className:"opacity-0",children:"0"},t)),c="error"===n?(0,s.jsx)(N.CrossCircle,{color:t===n?"red-700":void 0}):(0,s.jsx)(E.Warning,{color:t===n?"amber-700":void 0}),d=t===n;return 0===a?null:(0,s.jsxs)("div",{className:(0,ta.cn)("inline-flex items-center rounded-full px-0 text-sm font-medium transition-all","border border-solid border-transparent",d?"!border border-solid border-gray-300 !bg-background-100":null!==t?"opacity-50":void 0),children:[(0,s.jsxs)(f.Button,{className:(0,ta.cn)("[&>*]:!px-2 [&>*]:!py-1.5 [&>*]:gap-1.5 [&>*]:flex [&>*]:items-center flex items-center hover:opacity-80 p-0 rounded-full text-sm",d?"hover:bg-transparent":"hover:bg-gray-200"),variant:"unstyled",onClick:()=>i(n),"aria-label":`${n} count: ${t===n?`${(r??0)+1} of ${a}`:a}`,children:[c,(0,s.jsxs)("div",{className:"tabular-nums flex items-center",children:[(0,s.jsx)("span",{children:t===n?(0,s.jsxs)(s.Fragment,{children:[o,(r??0)+1]}):a}),(0,s.jsx)(e2.AnimatePresence,{children:d&&(0,s.jsxs)(e4.motion.span,{className:"text-gray-800",initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.18},children:["/",a]})})]})]}),(0,s.jsx)(e2.AnimatePresence,{children:d&&(0,s.jsx)(e4.motion.div,{className:"flex items-center overflow-hidden",initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.18},children:(0,s.jsxs)(e4.motion.div,{className:"flex items-center p-1",initial:{scale:.7},animate:{scale:1},exit:{scale:.7},transition:{duration:.15,delay:.05},children:[(0,s.jsx)("div",{className:"border-l h-3 mr-1 border-gray-400"}),(0,s.jsx)(f.Button,{className:"[&>*]:!p-1 hover:bg-gray-200 rounded-full text-gray-900 hover:text-gray-800 active:bg-gray-300",variant:"unstyled",svgOnly:!0,onClick:()=>l("next"),"aria-label":`find next ${n}`,children:(0,s.jsx)(tc.ChevronDownSmall,{size:16})}),(0,s.jsx)(f.Button,{className:"[&>*]:!p-1 hover:bg-gray-200 rounded-full text-gray-900 hover:text-gray-800 active:bg-gray-300",variant:"unstyled",svgOnly:!0,onClick:()=>l("previous"),"aria-label":`find previous ${n}`,children:(0,s.jsx)(to.ChevronUpSmall,{size:16})})]})})})]})}function tj(e){let{logs:t,className:n,onClick:a}=e,{setHash:r}=(0,m.useHash)(),l=(0,i.useMemo)(()=>({warning:tx(t,"warning"),error:tx(t,"error")}),[t]),o=(0,i.useCallback)(e=>{l[e]?.length&&(r(tm(l[e][0])),a?.())},[l,r,a]);return(0,s.jsxs)("div",{className:(0,ta.cn)("flex items-center gap-2 text-sm font-normal",n),children:[l.error?.length?(0,s.jsx)(f.Button,{shape:"rounded",size:"small",type:"secondary",onClick:()=>o("error"),prefix:(0,s.jsx)(N.CrossCircle,{color:"red-700"}),children:(0,s.jsx)("span",{className:"inline-block -mx-1",children:l.error.length})}):null,l.warning?.length?(0,s.jsx)(f.Button,{shape:"rounded",size:"small",type:"secondary",onClick:()=>o("warning"),prefix:(0,s.jsx)(E.Warning,{color:"amber-700"}),children:(0,s.jsx)("span",{className:"inline-block -mx-1",children:l.warning.length})}):null]})}var tv=e.i(9130958);function tC(e){let{log:t,text:n}=e;if(!t.annotation)return(0,s.jsx)(e3.Ansi,{disableColors:!!t.level,linkifyInternalLink:!0,children:n});let a=n.indexOf(t.annotation.match);if(-1===a)return(0,s.jsx)(e3.Ansi,{disableColors:!!t.level,linkifyInternalLink:!0,children:n});let r=n.slice(0,a),i=n.slice(a,a+t.annotation.match.length),l=n.slice(a+t.annotation.match.length);return(0,s.jsxs)(s.Fragment,{children:[r&&(0,s.jsx)(e3.Ansi,{disableColors:!!t.level,linkifyInternalLink:!0,children:r}),(0,s.jsx)("span",{className:"underline decoration-wavy underline-offset-2 font-medium",children:(0,s.jsx)(e3.Ansi,{disableColors:!!t.level,linkifyInternalLink:!0,children:i})}),l&&(0,s.jsx)(e3.Ansi,{disableColors:!!t.level,linkifyInternalLink:!0,children:l})]})}function t_(e){let{children:t,className:n}=e;return(0,s.jsx)("span",{className:(0,ta.cn)("inline-block whitespace-pre py-0.5 pr-3 md:pr-6",n),children:t})}let tb=(0,i.memo)(function(e){let{log:t,searchPosition:n,className:a}=e;if(!t.text)return null;if(!n)return(0,s.jsx)(t_,{className:a,children:(0,s.jsx)(tC,{log:t,text:t.text})});let r=(0,tv.highlightString)(t.text,n.text),i=0;return(0,s.jsx)(t_,{className:a,children:r.map(e=>e.highlighted?(0,s.jsx)("mark",{className:n.line===t.index&&n.column===i++?"bg-amber-800 dark:text-background-100":"bg-amber-400 dark:text-gray-1000",children:(0,s.jsx)(tC,{log:t,text:e.text})},e.id):(0,s.jsx)(tC,{log:t,text:e.text},e.id))})});var tk=e.i(7921976),tw=e.i(6357175),tS=e.i(9689002),tN=e.i(8835183),tI=e.i(3285452),tA=e.i(1663964),tT=e.i(6942035);let tR=(0,i.forwardRef)(function(e,t){let{logs:n,onNavigate:a,onClear:r}=e,l=(0,i.useRef)(null),[o,c]=(0,i.useState)(),[d,u]=(0,i.useState)(0),[m,p]=(0,i.useState)(),h=(0,tw.useDebouncedValue)(o,300),[g,x]=(0,i.useState)(),y=(0,i.useCallback)(()=>{c(""),p(void 0),r?.()},[r]),j=(0,i.useCallback)(e=>{u(0);let t=e.target.value;t?c(t):y()},[y]),v=(0,i.useCallback)(()=>{if(m?.count){let e=(d+1)%m.count;u(e),a?.(m.positions[e])}},[m,d,a]),C=(0,i.useCallback)(()=>{if(m?.count){let e=(0===d?m.count:d)-1;u(e),a?.(m.positions[e])}},[m,d,a]),_=(0,i.useCallback)(e=>{"Enter"===e.key&&(e.shiftKey?C():v())},[v,C]);if((0,i.useImperativeHandle)(t,()=>({clear:y}),[y]),h!==g){x(h);let e=function(e,t){if(!e||!t.length)return;let n=e.toLowerCase(),a={count:0,positions:[]};for(let s of t){let t=s.text.toLowerCase().split(n);if(t.length>1){let n=t.length-1;a.count+=n,a.positions.push(...Array.from({length:n},(t,n)=>({line:s.index,column:n,text:e})))}}return a}(o,n);p(e),e?.count?a?.(e.positions[d]):a?.(void 0)}return(0,i.useEffect)(()=>{function e(e){let t=document.activeElement?.tagName;(0,tk.isModifierPressed)(e)&&"f"===e.key&&l.current&&function(e){let{top:t,left:n,bottom:a,right:s}=e.getBoundingClientRect();return t>=10&&n>=0&&a<=window.innerHeight&&s<=window.innerWidth}(l.current)&&(document.activeElement===document.body||"INPUT"!==t&&"TEXTAREA"!==t)&&(e.preventDefault(),l.current.select(),l.current.focus())}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l]),(0,s.jsx)(tN.SearchInput,{clearable:!1,onChange:j,onKeyDown:_,placeholder:"Find in logs",ref:l,size:"small",suffix:(0,s.jsx)(e2.AnimatePresence,{children:(o?.length??0)>0?(0,s.jsxs)(e4.motion.div,{animate:{marginTop:0,opacity:1},className:"-mr-1 flex items-center gap-1 whitespace-nowrap",exit:{marginTop:-10,opacity:0},initial:{marginTop:-10,opacity:0},transition:{duration:.1},children:[m?.count===0&&"No results",m?.count?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"pr-1 text-xs",children:[d+1,"/",m.count]}),(0,s.jsx)(f.Button,{"aria-label":"find next occurence",onClick:v,shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,s.jsx)(tI.ArrowDown,{})}),(0,s.jsx)(f.Button,{"aria-label":"find previous occurence",onClick:C,shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,s.jsx)(tA.ArrowUp,{})})]}):null,(0,s.jsx)(f.Button,{"aria-label":"clear results",onClick:y,shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,s.jsx)(tT.Cross,{className:"text-gray-900"})})]}):(0,s.jsx)(tS.Kbd,{className:"-mr-1",meta:!0,children:"F"})}),suffixStyling:!1,value:o,width:"270px"})});var tP=e.i(5356862),tE=e.i(8225664);function tL(e){let{selectedRange:t,logs:n}=e,a=null!==t,r=a?t.to-t.from+1:0,i=t?n[t.to].created-n[t.from].created:0;return(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1 whitespace-nowrap",children:[(0,s.jsx)(tE.CopyButton,{label:`${r||"all"} ${1===r?"line":"lines"}`,size:"small",textToCopy:(a?n.slice(t.from,t.to+1):n).map(e=>{let{created:t,text:n}=e;return`${th(t)} ${n}`}).join("\n"),title:`Copy ${a?"selected":"all"} lines to the clipboard`,type:"tertiary"}),(0,s.jsx)("span",{className:"text-sm text-gray-900",children:a?(0,s.jsxs)(s.Fragment,{children:[r," ",1===r?"line":"lines"," selected",i>0?` (${(0,tP.formatDuration)(n[t.to].created-n[t.from].created)})`:""]}):`${n.length} lines`})]})}var tW=e.i(9351155);let tM=()=>{let[e,t]=(0,tW.useQueryState)("environment-variable-details-open",tW.parseAsString);return{missingEnvVarKey:e,setMissingEnvVarKey:t}};function tB(e){let{logs:t,enableLineHighlighting:n,startedAt:a,status:r,isLoading:l,context:o}=e,c=(0,i.useRef)(null),d=(0,i.useRef)(null),u=(0,i.useRef)(null),p=(0,i.useRef)(null),h=(0,i.useRef)(t.length),g=(0,tt.useIsMobile)(),[x,f]=(0,i.useState)(null),[y,j]=(0,i.useState)(),[v,C]=(0,i.useState)(!0),[_,b]=(0,i.useState)(!0),[k,w]=(0,i.useState)(),[S,N]=(0,i.useState)(n),{hash:I,setHash:A}=(0,m.useHash)(),[T,R]=(0,i.useState)(!1),P=(0,W.useParams)(),{setMissingEnvVarKey:E}=tM(),L=(0,i.useMemo)(()=>t.map((e,t)=>{let n={...e,index:t};return n.annotation=((e,t,n,a)=>{if(null===t)return null;let{teamSlug:r,project:i}=t,l=(e=>{for(let{regex:t,groupIndex:n}of[{regex:/Error:\s*Environment variable\s*"(.+?)"\s*is required but was not specified\./i,groupIndex:1},{regex:/process\.env\.([A-Z0-9_]+)\s+is undefined/i,groupIndex:1},{regex:/(NEXT_PUBLIC_[A-Z0-9_]+)\s+is not defined/i,groupIndex:1},{regex:/process\.env\.([A-Z0-9_]+)\s+is not defined/i,groupIndex:1},{regex:/Error:\s*Missing environment variable:\s*([A-Z0-9_]+)\s*\(check your project settings\)/i,groupIndex:1},{regex:/The\s+([A-Z0-9_]+)\s+environment variable is missing or empty/i,groupIndex:1},{regex:/Error:\s*The\s+([A-Z0-9_]+)\s+environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI\(\{ apiKey: '.*?' \}\)\./i,groupIndex:1}]){let a=t.exec(e.text);if(a&&n&&a[n])return{name:a[n]}}return null})(e);return l?"deployment-details"===n?{type:"link",href:`/${r}/${i}/settings/environment-variables?new=${l.name}`,match:l.name,label:"Add Environment Variable",icon:(0,s.jsx)(tr.PlusCircle,{})}:{type:"button",onClick:()=>a?.addNewVariable(l.name)||(()=>{}),match:l.name,label:"Add Environment Variable",icon:(0,s.jsx)(tr.PlusCircle,{})}:null})(n,P,o,{addNewVariable:E}),n}),[t,P,o,E]);(0,i.useEffect)(()=>{L.length!==h.current&&"complete"!==r&&_&&setTimeout(()=>u.current?.scrollTo(0,u.current.scrollHeight),0),h.current=L.length},[L,r,_]),(0,i.useEffect)(()=>{if(!n)return;let e=tp(I);e!==x&&(e?.from!==x?.from||e?.to!==x?.to)&&(f(e),T&&R(!1),e&&!T&&c.current?.scrollToIndex(tg(e)))},[n,x,I,T]);let M=(0,i.useCallback)(e=>{e instanceof Window||(u.current=e)},[]);e5(()=>{n&&tp(I)&&p.current&&p.current.scrollIntoView({behavior:"smooth",block:"start"})});let B=(0,i.useCallback)((e,t)=>{let n=null;t&&x?n=e<x.from?{from:e,to:x.to}:{from:x.from,to:e}:x?.from!==e&&(n={from:e,to:e}),R(!0),A(n?tm(n):null)},[x,A]),D=(0,i.useCallback)(e=>{w(e),e&&c.current?.scrollToIndex(tg(e.line))},[]),V=(0,i.useCallback)(e=>{let{item:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{"aria-hidden":!0,className:(0,ta.cn)("relative pl-1 py-0.5 md:pl-4 [&>*]:cursor-default text-gray-800",!S&&"select-none"),"data-timestamp":!0,children:[(0,s.jsx)(te.TimestampTooltip,{content:{timestamp:t.created,startTimestamp:t.index>0?a:void 0,previousTimestamp:t.index>0?L[t.index-1].created:void 0},showRelativeToNow:!0,children:th(t.created,g)}),(0,s.jsx)("span",{children:" "})]}),(0,s.jsxs)("div",{className:"inline-flex flex-col w-full",children:[(0,s.jsx)(tb,{className:"pl-1 md:pl-3",log:t,searchPosition:k}),(0,s.jsx)(tl,{annotation:t.annotation})]})]})},[g,L,k,a,S]);return(0,s.jsx)("div",{className:"relative bg-background-200",ref:p,children:L.length&&!l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:(0,ta.cn)(v&&"border-b-transparent","flex flex-wrap min-h-11 w-full border-b p-2 items-start gap-1 md:items-center md:gap-4"),children:[(0,s.jsx)(tL,{logs:L,selectedRange:x}),(0,s.jsx)(tf,{logs:L}),g?null:(0,s.jsx)(tR,{logs:L,onClear:()=>w(void 0),onNavigate:D,ref:d})]}),(0,s.jsx)("div",{className:(0,ta.cn)("relative","overflow-hidden","before:content-['']","before:absolute","before:h-5","before:w-full","before:top-0","before:left-0","before:right-4","before:z-10","before:pointer-events-none","before:translate-y-0","before:bg-gradient-to-b","before:from-background-200","after:content-['']","after:absolute","after:h-5","after:w-full","after:bottom-0","after:left-0","after:right-4","after:z-10","after:pointer-events-none","after:translate-y-0","after:bg-gradient-to-t","after:from-background-200",v?"before:!-translate-y-5":null,_?"after:!translate-y-5":null),children:(0,s.jsx)(ts.Virtuoso,{atBottomStateChange:b,atBottomThreshold:48,atTopStateChange:C,components:{List:tD,Item:tV,Footer:tF},context:{selectedRange:x,handleLineClicked:B,canSelect:n,setTimestampSelectable:N},data:L,defaultItemHeight:24,initialTopMostItemIndex:tg(tp(I)),itemContent:(e,t)=>V({item:t,data:L,index:e}),ref:c,scrollerRef:M,style:{height:"60vh",maxHeight:y},totalListHeightChanged:j})})]}):(0,s.jsx)("div",{className:"p-4 text-center",children:l?(0,s.jsx)("span",{className:"flex items-center justify-center gap-2 text-gray-900",children:(0,s.jsx)(tn.LoadingDots,{size:4,children:"Loading"})}):(0,s.jsx)("span",{children:"No logs to show"})})})}function tD(e){let{context:t,...n}=e;return(0,s.jsx)("div",{className:"inline-flex min-w-full flex-col",...n})}function tV(e){var t;let{item:{index:n,level:a},context:r,style:l,...o}=e,c=(0,i.useCallback)(e=>{if(!(!r?.canSelect||!r?.handleLineClicked||window.getSelection()?.toString()))return window.getSelection()?.removeAllRanges(),e.stopPropagation(),e.preventDefault(),r.handleLineClicked?.(n,e.shiftKey),!1},[r,n]),d=(0,i.useCallback)(e=>{let t=!!e.target.dataset.timestamp||!!e.target.parentElement?.dataset.timestamp;r?.setTimestampSelectable((r?.canSelect&&t)??!1)},[r]),u=!!(t=r?.selectedRange)&&n>=t.from&&n<=t.to,m="error"===a,p="warning"===a;return(0,s.jsx)("div",{className:(0,ta.cn)("cursor-default inline-block text-pretty align-top font-mono text-xs hover:bg-gray-300 md:text-sm border-l-2 border-l-transparent",u&&"border-l-black bg-gray-100",m&&"bg-red-200 text-red-900",p&&"bg-amber-200 text-amber-900",u&&m&&"bg-red-400",u&&p&&"bg-amber-400"),style:{...l,whiteSpace:"nowrap",userSelect:"text"},onMouseDown:d,onClick:c,...o})}function tF(){return(0,s.jsx)("span",{className:"inline-block"})}e.s(["useOpenMissingEnvVar",0,tM],458149);var tH=e.i(7921739),tz=e.i(5338940),tO=e.i(7808943),tU=e.i(1991452),t$=e.i(4450569),tq=e.i(4080109);function tG(e){let{type:t}=e;switch(t){case"warning":return(0,s.jsx)(t$.default,{className:"font-medium text-red-700",noWrap:!0,row:!0,vcenter:!0,children:(0,s.jsx)(P.Stop,{})});case"error":return(0,s.jsx)(t$.default,{className:"font-medium text-red-700",noWrap:!0,row:!0,vcenter:!0,children:(0,s.jsx)(en.WarningFill,{})});case"success":return(0,s.jsx)(t$.default,{className:"text-gray-900",noWrap:!0,row:!0,vcenter:!0,children:(0,s.jsx)(et.CheckCircleFill,{className:"size-5",color:"green-700"})});case"spinner":case"loading":return(0,s.jsx)(t$.default,{row:!0,style:{color:"var(--geist-secondary)"},vcenter:!0,children:(0,s.jsx)(el.Spinner,{size:18})});default:return null}}function tZ(e){let{domain:t,type:n,status:a,note:r}=e,i=(0,tU.useRouter)(),l={automatic:{name:"Learn More",href:"/docs/deployments/generated-urls"},custom:{name:"Manage",href:`/${i.query.teamSlug}/${i.query.project}/settings/domains`},user:{name:"Learn More",href:"/docs/domains/add-a-domain"}}[n];return(0,s.jsx)("div",{className:tq.default.wrapper,children:(0,s.jsxs)("div",{className:tq.default.header,children:[(0,s.jsx)(tG,{type:a}),(0,s.jsxs)("div",{className:tq.default.heading,children:[(0,s.jsxs)(_.Stack,{align:{sm:"start",md:"center",lg:"center"},direction:{sm:"column",md:"row",lg:"row"},gap:{sm:0,md:2,lg:2},style:{overflow:"hidden"},children:[(0,s.jsx)("div",{className:tq.default.domainContainer,children:(0,s.jsx)(u.Link,{as:"a",className:tq.default.domain,external:!0,href:`http://${t.name}`,variant:"highlight",children:(0,s.jsx)(p.Text,{as:"span",color:"blue-900",truncate:!0,weight:500,children:t.name})})}),(0,s.jsx)(p.Text,{as:"span",className:tq.default.separator,color:"gray-900",children:"·"}),(0,s.jsx)(p.Text,{color:"gray-900",size:14,truncate:!0,children:r||({automatic:"Automatic URL",custom:"Custom Domain",user:"Custom Domain"})[n]})]}),(0,s.jsx)(u.Link,{className:tq.default.action,external:!0,href:l.href,variant:"secondary",children:l.name})]})]})})}var tY=e.i(7784834),tJ=e.i(8091742);function tK(e){let t,{id:n,name:a,deployment:r,disabled:l,skeleton:o,status:c,onComplete:d,startedAt:m,finishedAt:p}=e;(0,i.useEffect)(()=>{d&&(c===eh.Complete||c===eh.Skipped)&&d()},[c,d]);let{team:h}=(0,tz.useTeam)(),g=function(e,t,n){let a=(0,tJ.filterAutoAssignedDomains)(e,n.automaticAliases??[]).map(e=>({name:e,type:"automatic"})),s=t.filter(e=>void 0===a.find(t=>t.name===e)).map(e=>({name:e,type:"custom"})),r=[];if(r=r.concat(...s),"production"===n.target){let e=n.userAliases||[];r.concat(e.map(e=>({name:e,type:"user"})))}return r}(h,r.alias.filter(e=>!(r.automaticAliases||[]).includes(e)),r);function x(){return r.checks?.["deployment-alias"]?.state??null}function f(e){return"pending"===x()?"running checks":"failed"===x()?"failed checks":c===eh.Pending||c===eh.InProgress?"loading":c===eh.Error||c===eh.Warning?r.aliasWarning&&r.aliasWarning.message.includes(e.name)?"warning":r.aliasError&&r.aliasError.message.includes(e.name)?"error":"success":c===eh.Complete?"success":"loading"}function y(e){return r.aliasWarning&&r.aliasWarning.message.includes(e.name)?r.aliasWarning.message:r.aliasError&&r.aliasError.message.includes(e.name)?r.aliasError.message:void 0}let j=c===eh.Skipped,v="failed"===x()||"pending"===x();return(0,s.jsx)(ef,{disabled:l,finishedAt:"succeeded"!==x()?void 0:p,id:n,name:a,skeleton:o,startedAt:"succeeded"!==x()?void 0:m,status:(t=x(),v&&"PROMOTED"===r.readySubstate?eh.Warning:"pending"===t?eh.Pending:"failed"===t?eh.Error:c),children:v&&"PROMOTED"===r.readySubstate?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:tY.default.stepMessage,children:"The deployment was force promoted, bypassing Deployment Checks."}),g.map(e=>(0,s.jsx)(tZ,{domain:e,note:y(e),status:f(e),type:e.type},e.name))]}):v?(0,s.jsxs)("div",{className:tY.default.stepMessage,children:["Aliasing to custom domains is blocked by"," ",x()," deployment checks."]}):j?(0,s.jsxs)("div",{className:tY.default.stepMessage,children:["No custom domains have been assigned. This will happen if there are none defined in Project Settings or a Vercel CLI deploy was made with"," ",(0,s.jsx)(tO.default,{children:"vercel deploy --skip-domain"}),"."," ",(0,s.jsx)(u.Link,{external:!0,href:"https://vercel.com/docs/domains/add-a-domain",variant:"highlight",children:"Learn More"})]}):(0,s.jsx)(s.Fragment,{children:g.map(e=>(0,s.jsx)(tZ,{domain:e,note:y(e),status:f(e),type:e.type},e.name))})})}var tQ=e.i(4303122),tX=e.i(3993360),t0=e.i(6280036),t1=e.i(4585051),t5=e.i(1727580),t2=e.i(9907554),t4=e.i(4796599),t9=e.i(261950),t3=e.i(7807066),t7=e.i(787358),t8=e.i(4333930),t6=e.i(2259462),ne=e.i(3487134),nt=e.i(7087273),nn=e.i(8557031),na=e.i(1160917);function ns(e){let{children:t,onClick:n,active:a}=e;return(0,s.jsx)("button",{className:(0,l.clsx)(na.default.badge,"invert-theme",{[na.default.active]:a}),onClick:n,type:"button",children:(0,s.jsx)(p.Text,{className:na.default.badgeContent,size:12,weight:500,children:t})})}var nr=e.i(9822914),ni=e.i(1201436),nl=e.i(1438473),no=e.i(9645681);let nc=(0,X.withNewIcon)(`<path fill-rule="evenodd" clip-rule="evenodd" d="M0 2.25C0 1.00736 1.00736 0 2.25 0H13.75C14.9926 0 16 1.00736 16 2.25V8H14.5V2.25C14.5 1.83579 14.1642 1.5 13.75 1.5H2.25C1.83579 1.5 1.5 1.83579 1.5 2.25V13.75C1.5 14.1642 1.83579 14.5 2.25 14.5H8V16H2.25C1.00736 16 0 14.9926 0 13.75V2.25ZM9.24618 5C8.41986 5 7.75 5.66986 7.75 6.49618V7H8.75H9.5V8.5H8.75H7.75V9.50439C7.75 11.1588 6.40882 12.5 4.75439 12.5H4.00439V11H4.75439C5.58039 11 6.25 10.3304 6.25 9.50439V8.5H5.25H4.5V7H5.25H6.25V6.49618C6.25 4.84144 7.59144 3.5 9.24618 3.5H9.99618V5H9.24618Z" fill="currentColor"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 11.875C11.5 11.6679 11.6679 11.5 11.875 11.5H15.25H16V10H15.25H11.875C10.8395 10 10 10.8395 10 11.875C10 12.2971 10.1395 12.6866 10.3749 13C10.1395 13.3134 10 13.7029 10 14.125C10 15.1605 10.8395 16 11.875 16H15.25H16V14.5H15.25H11.875C11.6679 14.5 11.5 14.3321 11.5 14.125C11.5 13.9179 11.6679 13.75 11.875 13.75H14.25H15V12.25H14.25H11.875C11.6679 12.25 11.5 12.0821 11.5 11.875Z" fill="var(--ds-purple-700)"/>
  `);var nd=e.i(4830423);let nu=(0,X.withNewIcon)(`<path d="M15.7221 11.1407C15.1916 11.2818 14.8294 11.3877 14.3073 11.5288C14.181 11.5641 14.1726 11.5729 14.0631 11.4406C13.9368 11.2906 13.8441 11.1936 13.6673 11.1054C13.1368 10.832 12.6231 10.9113 12.143 11.2377C11.5704 11.6258 11.2756 12.1992 11.2841 12.9137C11.2925 13.6194 11.7557 14.2015 12.4209 14.2986C12.9936 14.3779 13.4736 14.1662 13.8526 13.7164C13.9284 13.6194 13.9957 13.5135 14.0799 13.39C13.7768 13.39 13.3978 13.39 12.4546 13.39C12.2778 13.39 12.2357 13.2753 12.2946 13.1254C12.4041 12.8519 12.6062 12.3933 12.7241 12.1639C12.7494 12.111 12.8083 12.0228 12.9346 12.0228C13.3641 12.0228 14.9473 12.0228 16 12.0228C15.9832 12.2609 15.9832 12.4991 15.9495 12.7373C15.8568 13.3724 15.6295 13.9545 15.2589 14.4662C14.6526 15.3041 13.861 15.8246 12.8588 15.9657C12.0336 16.0804 11.2672 15.9128 10.5935 15.3835C9.97034 14.8896 9.61664 14.2368 9.52401 13.4253C9.41453 12.4638 9.68401 11.5994 10.2398 10.8408C10.8377 10.0204 11.6293 9.50001 12.5978 9.31477C13.3894 9.16482 14.1473 9.26185 14.8294 9.747C15.2758 10.0557 15.5958 10.4791 15.8063 10.9907C15.8568 11.0701 15.8232 11.1142 15.7221 11.1407Z" fill="#00ACD7"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M0 2.25C0 1.00736 1.00736 0 2.25 0H13.75C14.9926 0 16 1.00735 16 2.25V8H14.5V2.25C14.5 1.83579 14.1642 1.5 13.75 1.5H2.25C1.83578 1.5 1.5 1.83578 1.5 2.25V13.75C1.5 14.1642 1.83579 14.5 2.25 14.5H8V16H2.25C1.00735 16 0 14.9926 0 13.75V2.25ZM6.25 6.49618C6.25 4.84144 7.59144 3.5 9.24618 3.5H9.99618V5H9.24618C8.41987 5 7.75 5.66986 7.75 6.49618V7H8.75H9.5V8.5H8.75H7.75V9.50439C7.75 11.1588 6.40883 12.5 4.75439 12.5H4.00439V11H4.75439C5.5804 11 6.25 10.3304 6.25 9.50439V8.5H5.25H4.5V7H5.25H6.25V6.49618Z" fill="currentColor"/>
`),nm=(0,X.withNewIcon)(`<path fill-rule="evenodd" clip-rule="evenodd" d="M0 2.25C0 1.00736 1.00736 0 2.25 0H13.75C14.9926 0 16 1.00735 16 2.25V8H14.5V2.25C14.5 1.83579 14.1642 1.5 13.75 1.5H2.25C1.83578 1.5 1.5 1.83578 1.5 2.25V13.75C1.5 14.1642 1.83579 14.5 2.25 14.5H8V16H2.25C1.00735 16 0 14.9926 0 13.75V2.25ZM6.25 6.49618C6.25 4.84144 7.59144 3.5 9.24618 3.5H9.99618V5H9.24618C8.41987 5 7.75 5.66986 7.75 6.49618V7H8.75H9.5V8.5H8.75H7.75V9.50439C7.75 11.1588 6.40883 12.5 4.75439 12.5H4.00439V11H4.75439C5.5804 11 6.25 10.3304 6.25 9.50439V8.5H5.25H4.5V7H5.25H6.25V6.49618Z" fill="currentColor"/>
  <path d="M15.7246 11.3857L14.548 10.0483H10.4518L9.27511 11.3857C8.92434 11.7843 8.94634 12.3876 9.3252 12.7597L12.4999 15.8775L15.6745 12.7597C16.0533 12.3876 16.0753 11.7844 15.7246 11.3857Z" fill="#CA2A30"/>
  <path fill-rule="evenodd" clip-rule="evenodd" d="M12.4661 9.48831C13.6686 9.49258 14.8004 9.91649 14.7973 10.5166C14.7941 11.1166 13.7447 11.5332 12.5424 11.5287C11.3401 11.5242 10.1984 11.1295 10.2017 10.5296C10.2045 9.92962 11.2638 9.48383 12.4661 9.48831Z" fill="#F87274"/>`);var np=e.i(6307178),nh=e.i(9655125),ng=e.i(559696),nx=e.i(1502273),nf=e.i(9568268),ny=e.i(3306538),nj=e.i(8522580),nv=e.i(2988836),nC=e.i(1637579),n_=e.i(5166685),nb=e.i(9459801),nk=e.i(545405),nw=e.i(4006531),nS=e.i(2608999);let nN=["^/.*$","/:path*"],nI="All paths";function nA(e){let{asset:t}=e;return(0,s.jsx)("div",{style:{paddingLeft:34},title:t.matcher,children:(0,s.jsx)(p.Text,{className:(0,l.clsx)(nS.default.staticAssetGrid,nS.default.copyIconWrapper),color:"gray-900",monospace:!0,size:14,weight:500,children:t.matcher!==nI?(0,s.jsxs)("button",{className:nS.default.pathWrapper,onClick:()=>{(0,nk.copyToClipboard)(t.matcher),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)("span",{children:t.matcher}),(0,s.jsx)("span",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]}):(0,s.jsx)("div",{className:(0,l.clsx)(nS.default.pathWrapper,nS.default.allPathsMiddlewareRow),children:(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:1,children:[(0,s.jsx)(p.Text,{as:"span",monospace:!1,children:t.matcher}),(0,s.jsx)(k.Tooltip,{text:(0,s.jsxs)(s.Fragment,{children:["Middleware is invoked on every path. This behavior can be modified by"," ",(0,s.jsx)(u.Link,{external:!0,href:"/docs/edge-middleware/middleware-api#match-paths-based-on-custom-matcher-config",type:"highlight",children:"configuring a matcher"}),"."]}),children:(0,s.jsx)(nv.InformationFillSmall,{className:nS.default.middlewareInfoIcon})})]})})})})}function nT(e){let{asset:t}=e;return(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",title:`${t.source} → ${t.destination}`,children:[(0,s.jsx)("div",{className:"w-2/5 md:w-[45%] truncate",children:(0,s.jsxs)("button",{className:(0,l.clsx)(nS.default.pathWrapper,nS.default.copyIconWrapper,"w-full"),onClick:()=>{(0,nk.copyToClipboard)(t.source),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)(p.Text,{className:"truncate max-w-[90%]",monospace:!0,size:14,children:t.source}),(0,s.jsx)("span",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]})}),(0,s.jsxs)("div",{className:"w-1/5 md:w-[10%] flex items-center justify-center gap-4",children:[(0,s.jsx)(nl.ArrowRight,{}),(0,s.jsx)(ny.Badge,{className:"cursor-default",variant:"gray-subtle",children:t.statusCode??(t.permanent?308:301)})]}),(0,s.jsx)("div",{className:"w-2/5 md:w-[45%] truncate",children:(0,s.jsxs)("button",{className:(0,l.clsx)(nS.default.pathWrapper,nS.default.copyIconWrapper,"w-full"),onClick:()=>{(0,nk.copyToClipboard)(t.destination),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)(p.Text,{className:"truncate max-w-[90%]",monospace:!0,size:14,children:t.destination}),(0,s.jsx)("span",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]})})]})}function nR(e){let{asset:t}=e;return(0,s.jsx)("div",{title:t.key,children:(0,s.jsx)(p.Text,{className:(0,l.clsx)(nS.default.variantItemGrid,nS.default.copyIconWrapper),monospace:!0,size:14,children:"string"==typeof t.origin?(0,s.jsx)(u.Link,{as:"a",className:nS.default.variantItemUpstream,external:!0,href:t.origin,rel:"noopener noreferrer",target:"_blank",children:t.key}):t.key})})}function nP(e){let{asset:t}=e,n=(0,nr.toString)(t.schedule);return(0,s.jsx)("div",{className:(0,l.clsx)(nS.default.copyIconWrapper),style:{paddingLeft:36},children:(0,s.jsxs)(p.Text,{className:(0,l.clsx)(nS.default.cronJobItem),monospace:!0,size:14,children:[(0,s.jsx)("div",{title:t.path,children:t.path}),(0,s.jsx)("div",{title:t.schedule,children:t.schedule.split(" ").map(e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:(0,l.clsx)({[nS.default.cronJobItemAsterisk]:"*"===e,[nS.default.singleDigit]:1===e.length&&"*"!==e}),children:e})," "]}))}),(0,s.jsx)("div",{title:n,children:n})]})},`${t.path}/${t.schedule}`)}function nE(e){let{asset:t}=e,n=(0,nw.sizeFormatter)(t.size),a=n.split(" ");return(0,s.jsx)("div",{style:{paddingLeft:34},title:t.path,children:(0,s.jsxs)(p.Text,{className:(0,l.clsx)(nS.default.staticAssetGrid,nS.default.copyIconWrapper),color:"gray-900",monospace:!0,size:14,weight:500,children:[(0,s.jsxs)("button",{className:nS.default.pathWrapper,onClick:()=>{(0,nk.copyToClipboard)(t.path),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)("span",{children:t.path}),(0,s.jsx)("div",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]}),(0,s.jsx)("span",{style:{whiteSpace:"nowrap",textAlign:"right",minWidth:60,fontWeight:400},children:1===a[1].length?(0,s.jsxs)(s.Fragment,{children:[`${a[0]} ${a[1]}`," "]}):n})]})})}function nL(e){let{type:t}=e;switch(t){case"ISR":return(0,s.jsx)(np.AcronymIsr,{className:nS.default.typeIcon});case"PPR":return(0,s.jsx)(nh.AcronymPpr,{className:nS.default.typeIcon});case"API":case"Serverless":return(0,s.jsx)(nx.AcronymApi,{className:nS.default.typeIcon});case"Page":return(0,s.jsx)(ng.AcronymPage,{className:nS.default.typeIcon});default:return(0,s.jsx)("div",{className:nS.default.typeBadgeContainer})}}function nW(e){let{asset:t}=e,n="size"in t&&"Meta"!==t.type?(0,nw.sizeFormatter)(t.size,"long",1):"-";return(0,s.jsx)("div",{className:nS.default.copyIconWrapper,title:t.path,children:(0,s.jsxs)(p.Text,{color:"gray-900",monospace:!0,style:{display:"flex",alignItems:"center",gap:4},children:[(0,s.jsx)("div",{className:"w-6",children:(0,s.jsx)(nL,{type:t.type})}),(0,s.jsxs)("button",{className:(0,l.clsx)(nS.default.pathWrapper),onClick:()=>{(0,nk.copyToClipboard)(t.path),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)(nb.RouteHighlighter,{className:"!overflow-visible",route:t.path,segmentClassName:"bg-gray-200 px-0.5 !shadow-none !border-solid border !border-gray-200"}),(0,s.jsx)("div",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]}),(0,s.jsx)(nV,{runtime:"runtime"in t?t.runtime:void 0}),(0,s.jsx)("span",{className:nS.default.size,style:{flexShrink:0,textAlign:"right",whiteSpace:"nowrap",marginLeft:4,fontWeight:400},children:n}),(0,s.jsx)(_.Stack,{align:"center",className:nS.default.regionBadgeContainer,direction:"row",children:(0,s.jsx)(nH,{passiveRegions:Array.isArray(t.passiveRegions)?t.passiveRegions:void 0!==t.passiveRegions?[t.passiveRegions]:void 0,regions:t.regions})})]})})}function nM(e){let{asset:t}=e;return(0,s.jsxs)("div",{className:"flex flex-row justify-between",title:t.path,children:[(0,s.jsxs)(p.Text,{color:"gray-900",monospace:!0,style:{display:"flex",alignItems:"center",gap:4},children:[(0,s.jsxs)("button",{className:(0,l.clsx)(nS.default.pathWrapper,nS.default.copyIconWrapper),onClick:()=>{(0,nk.copyToClipboard)(t.path),eZ.toasts.message("Copied to clipboard")},style:{flexBasis:"fit-content",flexGrow:0},type:"button",children:[(0,s.jsx)(nb.RouteHighlighter,{className:"!overflow-visible",route:t.path,segmentClassName:"bg-gray-200 px-0.5 !shadow-none !border-solid border !border-gray-200"}),"/*"===t.path?(0,s.jsx)(p.Text,{className:"ml-4 italic",children:"(this application serves any path not matched below)"}):null,(0,s.jsx)("div",{className:nS.default.copyIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]}),t.flag?(0,s.jsx)(_.Stack,{className:nS.default.copyFlagIconWrapper,direction:"row",gap:2,style:{flexShrink:0,textAlign:"right",whiteSpace:"nowrap",height:"20px",fontWeight:400},title:t.flag,children:(0,s.jsxs)("button",{className:(0,l.clsx)(nS.default.pathWrapper),onClick:()=>{t.flag&&((0,nk.copyToClipboard)(t.flag),eZ.toasts.message("Copied to clipboard"))},type:"button",children:[(0,s.jsx)(_.Stack,{align:"center",direction:"row",gap:3,children:(0,s.jsx)(k.Tooltip,{text:(0,s.jsxs)(p.Text,{children:["requires flag"," ",(0,s.jsx)(p.Text,{as:"span",monospace:!0,children:t.flag})]}),children:(0,s.jsx)(ny.Badge,{size:"sm",style:{textTransform:"none"},variant:"purple-subtle",children:t.flag})})}),(0,s.jsx)("div",{className:nS.default.copyFlagIcon,children:(0,s.jsx)(ni.Copy,{size:20})})]})}):null]}),t.appName?(0,s.jsx)(ny.Badge,{className:"mr-2 normal-case",size:"sm",variant:"gray-subtle",children:t.appName}):null]})}function nB(e){let{isrFunction:t,accordionValue:n,setAccordionValue:a}=e,i="size"in t?(0,nw.sizeFormatter)(t.size,"long",1):"-",o=t.staticRoutes.length>0,c=`ISR-${t.type}-${t.path}`,d=n.includes(c);return(0,s.jsxs)(r.Item,{className:nS.default.isrFunctionRow,disabled:!o,value:c,children:[(0,s.jsx)(r.Header,{children:(0,s.jsxs)(_.Stack,{className:(0,l.clsx)(nS.default.headerContent,{[nS.default.hasTrigger]:o}),direction:"row",children:[o?(0,s.jsx)(r.Trigger,{className:nS.default.trigger,children:(0,s.jsx)("div",{style:{transform:d?"rotate(90deg)":"none",transition:"transform 200ms",display:"flex",alignItems:"center",marginRight:3},children:(0,s.jsx)(t3.ChevronRight,{})})}):null,(0,s.jsx)("button",{className:nS.default.button,onClick:e=>{!e.defaultPrevented&&o&&(n.includes(c)?a(n.filter(e=>e!==c)):a([...n,c]))},style:{paddingLeft:o?5:void 0},type:"button",children:(0,s.jsx)("div",{className:nS.default.copyIconWrapper,title:t.path,children:(0,s.jsxs)(p.Text,{color:"gray-900",monospace:!0,style:{display:"flex",alignItems:"center",gap:8},children:[(0,s.jsx)("span",{className:(0,l.clsx)(nS.default.pathWrapper),children:(0,s.jsx)("span",{children:t.path})}),(0,s.jsx)(nV,{runtime:"runtime"in t?t.runtime:void 0}),(0,s.jsx)("span",{className:nS.default.size,style:{flexShrink:0,textAlign:"right",whiteSpace:"nowrap",fontWeight:400},children:i}),(0,s.jsx)(_.Stack,{align:"center",className:nS.default.regionBadgeContainer,direction:"row",children:(0,s.jsx)(nH,{passiveRegions:Array.isArray(t.passiveRegions)?t.passiveRegions:void 0!==t.passiveRegions?[t.passiveRegions]:void 0,regions:t.regions})})]})})})]})}),(0,s.jsx)(e2.AnimatePresence,{children:d?(0,s.jsx)(r.Content,{forceMount:!0,children:(0,s.jsx)(t4.m.div,{animate:{height:"auto",opacity:1},className:nS.default.staticRoutesContainer,exit:{height:0,opacity:0},initial:{height:0,opacity:0},transition:{duration:.2},children:t.staticRoutes.map(e=>(0,s.jsxs)("button",{className:nS.default.staticRouteButton,onClick:()=>{(0,nk.copyToClipboard)(e.path),eZ.toasts.message("Copied to clipboard")},type:"button",children:[(0,s.jsx)("span",{className:(0,l.clsx)(nS.default.pathWrapper,nS.default.staticRoute),children:(0,s.jsx)("span",{children:e.path})}),(0,s.jsx)("div",{className:nS.default.copyIconContainer,children:(0,s.jsx)(ni.Copy,{})})]},e.path))})}):null})]})}let nD={nodejs:{logo:(0,s.jsx)(no.FunctionNode,{}),label:"Node.js"},bun:{logo:(0,s.jsx)(nf.FunctionBun,{}),label:"Bun"},ruby:{logo:(0,s.jsx)(nm,{}),label:"Ruby"},go:{logo:(0,s.jsx)(nu,{}),label:"Go"},python:{logo:(0,s.jsx)(nd.FunctionPython,{}),label:"Python"}};function nV(e){var t;let{runtime:n}=e,[a,r]=(t=n||"",[/[a-zA-Z]+/.exec(t)?.[0]||"",/\d+(?<version>\.\w+)?/.exec(t)?.[0]||""]),i=a in nD?nD[a]:void 0;return(0,s.jsx)(_.Stack,{direction:"row",gap:2,style:{flexShrink:0,textAlign:"right",whiteSpace:"nowrap",height:"20px",fontWeight:400},children:(0,s.jsx)(_.Stack,{align:"center",direction:"row",gap:3,children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{children:[i?.label||a," ",r]}),(0,s.jsx)("span",{style:{color:"var(--gray-1000)"},children:i?.logo})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"Edge"}),(0,s.jsx)("span",{children:(0,s.jsx)(nc,{color:"gray-100",size:16})})]})})})}function nF(e){let{items:t,totalCount:n}=e,[a,o]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!0),u=(0,i.useRef)(null),[m,p]=(0,i.useState)([]);(0,i.useEffect)(()=>{u.current?.scrollToIndex({index:0})},[t]);let h=26.5*t.length,g=Math.min(530,h),x=(0,t5.isISRFunction)(t[0]),f=(0,i.useMemo)(()=>x&&0!==m.length?Math.min(20*t.filter(e=>{let t=`ISR-ISR-${e.path}`;return m.includes(t)}).reduce((e,t)=>e+t.staticRoutes.length,0)+26.5*t.length+12+6,530):g,[m,x,t,g]),y=n&&n>t.length;return(0,s.jsxs)(r.Root,{onValueChange:p,type:"multiple",value:m,children:[(0,s.jsx)("div",{className:(0,l.clsx)(nS.default.list,{[nS.default.virtualListAtTop]:!(h<530)&&!a,[nS.default.virtualListAtBottom]:!(h<530)&&!c}),children:(0,s.jsx)(ts.Virtuoso,{atBottomStateChange:e=>d(e),atTopStateChange:e=>o(e),data:t,itemContent:(e,t)=>(0,t5.isVariant)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nR,{asset:t},t.key)}):(0,t5.isCronJob)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nP,{asset:t})}):(0,t5.isMiddleware)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nA,{asset:t},t.matcher)}):(0,t5.isMicrofrontendRoute)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nM,{asset:t},t.path)}):(0,t5.isBulkRedirect)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nT,{asset:t},`${t.source}-${t.destination}`)}):(0,t5.isStaticAsset)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nE,{asset:t},t.path)}):(0,t5.isISRFunction)(t)?(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nB,{accordionValue:m,isrFunction:t,setAccordionValue:p},t.path)}):(0,s.jsx)("div",{className:nS.default.item,style:{paddingTop:3,paddingBottom:3},children:(0,s.jsx)(nW,{asset:t},t.path)}),ref:u,style:{height:f}})}),y?(0,s.jsxs)(nj.Note,{className:"flex items-center justify-center !border-transparent !text-gray-700",fill:!0,size:"small",children:["Showing the first ",t.length.toLocaleString()," results"]}):null]})}function nH(e){let{regions:t,passiveRegions:n}=e;if(!(t&&t.length>0))return(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:nS.default.regionBadge,children:"Global"})});let a=Array.isArray(t)?t:[t],r=void 0===n?void 0:n.length,i=void 0!==r&&r>0,l=i&&n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.Text,{weight:500,children:["Function Failover Region",`${1===r?"":"s"}`]}),(0,s.jsx)(p.Text,{children:`${(0,n_.toListSentence)(n.map(e=>e.toUpperCase()))}`})]}):void 0;return 1===a.length?(0,s.jsx)(k.Tooltip,{text:l,children:(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:nS.default.regionBadge,title:nC.FriendlyRegionNameMapping[a[0]],children:[a[0],i?` +${r}`:""]})})}):(0,s.jsx)(k.Tooltip,{text:`${(0,n_.toListSentence)(a.map(e=>e.toUpperCase()))}`,children:(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:nS.default.regionBadge,children:[a.length," Regions"]})})})}function nz(e){switch(e){case t5.ArtefactTypes.StaticAssets:return{name:"Static Assets",icon:(0,s.jsx)(t6.File,{})};case t5.ArtefactTypes.ServerlessFunctions:return{name:"Functions",icon:(0,s.jsx)(t8.FunctionSquare,{})};case t5.ArtefactTypes.IncrementalStaticRegeneration:return{name:"ISR Functions",icon:(0,s.jsx)(nO,{children:"ISR"})};case t5.ArtefactTypes.PartialPrerender:return{name:"Partial Prerender Functions",icon:(0,s.jsx)(nO,{children:"PPR"})};case t5.ArtefactTypes.EdgeMiddleware:return{name:"Edge Middleware",icon:(0,s.jsx)(t7.FunctionMiddleware,{})};case t5.ArtefactTypes.Variant:return{name:"Variants",icon:(0,s.jsx)(t9.ToggleOff,{})};case t5.ArtefactTypes.CronJobs:return{name:"Cron Jobs",icon:(0,s.jsx)(S.Clock,{})};case t5.ArtefactTypes.MicrofrontendRoutes:return{name:"Microfrontend Routes",icon:(0,s.jsx)(ne.Microfrontends,{})};case t5.ArtefactTypes.BulkRedirects:return{name:"Bulk Redirects",icon:(0,s.jsx)(nn.BulkRedirectsIcon,{})};default:return{name:"Unknown",icon:(0,s.jsx)(t6.File,{})}}}function nO(e){let{children:t}=e;return(0,s.jsx)(p.Text,{as:"span",className:t2.default.badge,color:"inherit",size:10,weight:700,children:t})}function nU(e){let{type:t,artefacts:n,count:a,isOpen:o,open:c,toggleOpen:d}=e,[u,m]=(0,i.useState)("all"),{name:h,icon:g}=nz(t),x=function(e,t,n){if(0===e.length)return[];if((0,t5.isMiddleware)(e[0]))return[{type:"Custom Matcher",count:`${e.length} Paths`}];if(t===t5.ArtefactTypes.MicrofrontendRoutes)return[...new Set(e.map(e=>(0,t5.isMicrofrontendRoute)(e)?e.appName:void 0))].filter(Boolean).toSorted().map(t=>({type:t,count:e.filter(e=>(0,t5.isMicrofrontendRoute)(e)&&e.appName===t).length}));if(t===t5.ArtefactTypes.BulkRedirects){let t=e.length>0&&(0,t5.isBulkRedirect)(e[0])?n??e.length:e.length,a=e.length;return[{type:"Redirects",count:t>a?`${a.toLocaleString()} of ${t.toLocaleString()}`:t.toLocaleString()}]}let a=e.reduce((e,t)=>((e[t.type]=e[t.type]||[]).push(t),e),{}),s=[],r=Object.keys(a);return t===t5.ArtefactTypes.StaticAssets&&(r=t5.STATIC_TYPES.filter(e=>e in a)),r.forEach((e,t)=>{s[t]={type:e,count:a[e].length}}),s}(n,t,a),f=(0,i.useMemo)(()=>{if("all"===u||t===t5.ArtefactTypes.EdgeMiddleware||t===t5.ArtefactTypes.BulkRedirects){if(n[0]&&(0,t5.isMiddleware)(n[0])){let e=new Set;for(let t of n)if(Array.isArray(t.rawMatchers)&&t.rawMatchers.length)for(let n of t.rawMatchers)e.add(n);else e.add(t.matcher);let t=Array.from(e).sort().map(e=>({matcher:e}));return 1===t.length&&nN.includes(t[0].matcher)?[{matcher:nI}]:t}return n}return t===t5.ArtefactTypes.MicrofrontendRoutes?n.filter(e=>"all"===u||(0,t5.isMicrofrontendRoute)(e)&&e.appName===u):n.filter(e=>e.type===u)},[u,n,t]);return(0,i.useEffect)(()=>{o||m("all")},[o]),(0,s.jsxs)(r.Item,{className:t2.default.wrapper,value:t,children:[(0,s.jsxs)(r.Header,{className:t2.default.header,children:[(0,s.jsx)(r.Trigger,{className:t2.default.radixTrigger}),(0,s.jsxs)("button",{className:t2.default.trigger,onClick:e=>{e.defaultPrevented||d()},type:"button",children:[(0,s.jsxs)(t$.default,{flex:"0 0 auto",row:!0,vcenter:!0,children:[(0,s.jsx)("div",{style:{transform:o?"rotate(90deg)":"none",transition:"transform 200ms",display:"flex",alignItems:"center",marginRight:3},children:(0,s.jsx)(t3.ChevronRight,{})}),(0,s.jsx)("div",{className:(0,l.clsx)(t2.default.iconWrapper,{[t2.default.isrIconWrapper]:t===t5.ArtefactTypes.PartialPrerender||t===t5.ArtefactTypes.PartialPrerenderDynamicContent}),children:g}),(0,s.jsx)(p.Text,{lineHeight:14,size:14,weight:500,children:h})]}),0===f.length?null:(0,s.jsx)(nt.Scroller,{gradient:"var(--ds-background-200) 0, transparent 20px",overlayClassName:t2.default.scroller,children:(0,s.jsxs)("div",{className:t2.default.badgesWrapper,children:[x.length>=1&&(0,s.jsxs)(ns,{active:"all"===u&&o,onClick:e=>{e.preventDefault(),m("all"),c(),e.target.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},children:["All (",a??n.length.toLocaleString(),")"]}),x.length>1&&x.map(e=>(0,s.jsxs)(ns,{active:e.type===u||1===x.length&&o,onClick:t=>{t.preventDefault(),m(e.type),c(),t.target.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})},children:[e.type," (",e.count.toLocaleString(),")"]},e.type))]})})]})]}),(0,s.jsx)(e2.AnimatePresence,{initial:!1,children:o?(0,s.jsx)(r.Content,{forceMount:!0,children:(0,s.jsx)(t4.m.div,{animate:{height:"auto",opacity:1},className:t2.default.content,exit:{height:0,opacity:0},initial:{height:0,opacity:0},transition:{duration:.2},children:(0,s.jsx)(nF,{items:f,totalCount:a})})}):null})]})}function n$(e){let{resolvedTheme:t}=(0,t0.useTheme)(),{selectedArtefacts:n,artefactGroups:a,filterArtefactsBy:i,setSelectedArtefacts:o,deployment:c,framework:d}=e;return(0,s.jsxs)(r.Root,{defaultValue:[],onValueChange:e=>{o(e)},type:"multiple",value:n,children:[i?null:(0,s.jsxs)("div",{className:(0,l.clsx)(t2.default.wrapper,t2.default.frameworkWrapper),style:{display:"flex",alignItems:"center",gap:5},children:[d?(0,s.jsxs)(s.Fragment,{children:[d.logo?(0,s.jsx)(t1.Avatar,{size:20,src:"dark"===t?d.darkModeLogo:d.logo,title:d.name}):null,(0,s.jsx)(p.Text,{lineHeight:14,size:14,weight:500,children:d.name}),d.version?(0,s.jsxs)(p.Text,{lineHeight:14,size:14,weight:500,children:["(",d.version,")"]}):null]}):(0,s.jsx)(p.Text,{lineHeight:14,size:14,weight:500,children:"No framework detected"}),(0,s.jsx)(k.Tooltip,{desktopOnly:!0,maxWidth:400,style:{marginLeft:"auto"},text:"Download Deployment Data",children:(0,s.jsx)(f.Button,{"aria-label":"Download Deployment Data",className:t2.default.downloadButton,onClick:()=>{var e;let t,n,s,r;e=`${c.host.replace("-","_").replace(/\./g,"_")}_logs`,t=a.map(e=>e.artefacts.map(e=>(0,t5.isVariant)(e)||(0,t5.isCronJob)(e)||(0,t5.isMiddleware)(e)||(0,t5.isMicrofrontendRoute)(e)||(0,t5.isBulkRedirect)(e)?null:(0,t5.isStaticAsset)(e)||(0,t5.isServerlessFunction)(e)?`${e.path},${e.size}`:`${e.path},${Array.isArray(e.regions)?e.regions.join(","):e.regions||""}`)),n=`path_name,size
`,s=encodeURI(`data:text/csv;charset=utf-8,${n}${t.flat().join("\n")}`),(r=document.createElement("a")).setAttribute("href",s),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},shape:"square",size:"small",svgOnly:!0,type:"tertiary",children:(0,s.jsx)(tX.Download,{})})})]}),a.map(e=>{let{type:t,artefacts:a,count:r}=e;return(0,s.jsx)(nU,{artefacts:a,count:r,isOpen:n.includes(t),open:()=>{n.includes(t)||o([...n,t])},toggleOpen:()=>{n.includes(t)?o(n.filter(e=>e!==t)):o([...n,t])},type:t},t)})]})}var nq=e.i(1475672);function nG(e){let{active:t,onChange:n,items:a,open:r}=e;return(0,s.jsx)("div",{className:(0,l.clsx)(tQ.default.collapsedBadgesWrapper,{[tQ.default.closed]:!r}),children:(0,s.jsx)(nq.default,{active:t,className:tQ.default.switcher,items:[...a.map(e=>{let{name:t,value:n,tooltip:a,buttonProps:r}=e;return{name:a?(0,s.jsx)(k.Tooltip,{className:tQ.default.tooltip,text:a,children:t}):t,value:n,buttonProps:r}})],onChange:(e,t)=>{n(e,t)},size:"small"})})}var nZ=e.i(1918911),nY=e.i(3277920),nJ=e.i(7432042),nK=e.i(1594052),nQ=e.i(6618181);function nX(e){let{title:t,metric:n}=e;return(0,s.jsxs)("div",{className:nQ.default.headerStatContainer,children:[(0,s.jsx)("div",{className:nQ.default.headerStatTitle,children:t}),(0,s.jsx)("div",{className:nQ.default.headerStatMetric,children:n})]})}function n0(e){let{cachedTasks:t,totalTasks:n,timeSaved:a,totalDuration:r}=e;return(0,s.jsxs)("header",{className:nQ.default.header,children:[(0,s.jsxs)("div",{className:nQ.default.headerTitle,children:[(0,s.jsx)(nK.LogoTurborepo,{size:44}),(0,s.jsx)("div",{className:nQ.default.headerTitleContainer,children:(0,s.jsx)("h1",{children:"Turborepo Run Summary"})})]}),(0,s.jsxs)("div",{className:nQ.default.headerStats,children:[void 0!==t&&void 0!==n&&(0,s.jsx)(nX,{metric:`${t}/${n}`,title:"Cached Tasks"}),void 0!==a&&a>0&&(0,s.jsx)(nX,{metric:(0,nJ.default)(a),title:"Time Saved"}),void 0!==r&&(0,s.jsx)(nX,{metric:(0,nJ.default)(r),title:"Duration"})]})]})}var n1=e.i(6912485);function n5(e){let{cached:t,total:n}=e;return void 0!==t&&void 0!==n?(0,s.jsx)(n1.Progress,{className:"m-0 border border-solid border-gray-700 !bg-background-100",max:n,value:t,colors:{0:"linear-gradient(to right, #0096ff, #ff1e56)"},width:"50%"}):null}var n2=e.i(6881349);function n4(e){let{isCached:t}=e,n=t?et.CheckCircleFill:T.MinusCircle;return(0,s.jsx)("span",{className:(0,l.clsx)({"text-turbo-blue":t,"text-turbo-red":!t}),children:(0,s.jsx)(n,{})})}function n9(e){let{taskId:t}=e,n=t.split("#");return 1===n.length?(0,s.jsx)("span",{children:t}):(0,s.jsxs)("span",{children:[n[0],(0,s.jsxs)("span",{className:"text-gray-900",children:["#",n[1]]})]})}function n3(e){let{taskId:t,isGlobal:n}=e;return n?'"globalCacheInputs": {':t?`"taskId": "${t}"`:void 0}function n7(e){let{onScrollToLine:t,taskId:n,taskStats:a}=e;return(0,s.jsx)(f.Button,{align:"flex-grow",className:"my-1 w-full px-0.5 py-3 font-mono text-sm font-normal disabled:border-transparent disabled:bg-transparent",onClick:()=>{t(n3({taskId:n})),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_TASK_CLICK)},prefix:(0,s.jsx)(n4,{isCached:a.isCached}),size:"small",title:`${n} - cache ${a.isCached?"hit":"miss"} ${a.cacheSource?`(${a.cacheSource.toLowerCase()})`:""}`,type:"tertiary",children:(0,s.jsxs)("span",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"w-3/4 overflow-hidden truncate text-left",children:(0,s.jsx)(n9,{taskId:n})}),void 0!==a.duration?(0,s.jsx)("span",{children:(0,nJ.default)(a.duration)}):void 0]})})}function n8(e){let{taskId:t,taskStats:n}=e;return(0,s.jsx)(n2.Combobox.Option,{prefix:(0,s.jsx)(n4,{isCached:n.isCached}),suffix:void 0!==n.duration?(0,s.jsx)("span",{children:(0,nJ.default)(n.duration)}):void 0,value:t,children:(0,s.jsx)(n9,{taskId:t})},t)}function n6(e){let{onScrollToLine:t}=e;return(0,s.jsx)(f.Button,{className:"my-1 w-full px-0.5 py-3 font-mono text-sm font-normal disabled:border-transparent disabled:bg-transparent",onClick:()=>{t(n3({isGlobal:!0})),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_TASK_CLICK)},size:"small",type:"tertiary",children:"Global Hash Summary"})}var ae=e.i(7935689);function at(e){let{onScrollToLine:t,stats:n}=e,{summary:a,tasks:r={}}=n||{};return(0,s.jsxs)("aside",{className:ae.default.sidebar,children:[(0,s.jsxs)("div",{className:(0,l.clsx)(ae.default.sidebarTitle,"mb-2"),children:["Cache Analysis"," ",a?.cachedTasks!==void 0&&void 0!==a.totalTasks?`(${a.cachedTasks}/${a.totalTasks})`:void 0,(0,s.jsx)(n5,{cached:a?.cachedTasks,total:a?.totalTasks})]}),(0,s.jsx)(n6,{onScrollToLine:t}),(0,s.jsx)("hr",{className:ae.default.sidebarDivider}),(0,s.jsx)("div",{className:ae.default.sidebarTaskContainer,children:Object.keys(r).map(e=>(0,s.jsx)(n7,{onScrollToLine:t,taskId:e,taskStats:r[e]},e))}),(0,s.jsx)("div",{className:ae.default.sidebarFooter,children:(0,s.jsx)(u.Link,{external:!0,href:"/docs/monorepos/turborepo#debug-turborepo-cache-misses",variant:"highlight",children:"Learn More"})})]})}let an=(0,X.withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5 4.25H11C11.4142 4.25 11.75 4.58579 11.75 5V11C11.75 11.4142 11.4142 11.75 11 11.75H5C4.58579 11.75 4.25 11.4142 4.25 11V5C4.25 4.58579 4.58579 4.25 5 4.25ZM3 5C3 3.89543 3.89543 3 5 3H11C12.1046 3 13 3.89543 13 5V11C13 12.1046 12.1046 13 11 13H5C3.89543 13 3 12.1046 3 11V5ZM7.375 10.375V9.75V8.625H6.25H5.625V7.375H6.25H7.375V6.25V5.625H8.625V6.25V7.375H9.75H10.375V8.625H9.75H8.625V9.75V10.375H7.375Z" fill="currentColor"/>');var aa=e.i(3500331);function as(e){var t,n;let{summary:a}=e,{isReady:r,team:i}=(0,tz.useTeam)();return(0,s.jsx)(f.Button,{Component:"a",disabled:!r,download:`turborepo_summary_${a.source.id}.json`,href:(t=a.source.id,(n=i?new URLSearchParams({teamId:i.id}):void 0)?`/api/v6/deployments/${t}/files/turborepo-summary?${n.toString()}`:`/api/v6/deployments/${t}/files/turborepo-summary`),onClick:()=>eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_DOWNLOAD),size:"small",suffix:(0,s.jsx)(tX.Download,{}),target:"_blank",type:"secondary",children:"Download"},"download")}function ar(e){let{summaryData:t,isComparing:n,onCompare:a,onScrollToLine:r,hasPreviousSummary:o,onComparePrevious:c,stats:d}=e,[u,m]=(0,i.useState)(null),{summary:p,tasks:h={}}=d||{};return(0,s.jsxs)("div",{className:(0,l.clsx)("flex shrink grow basis-1/2 flex-col gap-4 p-4 lg:px-6","bg-background-100"),children:[(0,s.jsxs)("div",{className:"flex flex-col lg:hidden",children:[(0,s.jsxs)("div",{className:"flex min-h-8 w-full items-center justify-between gap-4 text-sm leading-4 text-gray-900",children:[(0,s.jsx)("span",{children:"Cache Analysis"}),(0,s.jsx)(n5,{cached:p?.cachedTasks,total:p?.totalTasks})]}),(0,s.jsxs)(n2.Combobox,{clearable:!1,onChange:e=>{e&&(m(e),r(n3({taskId:e})),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_TASK_CLICK))},placeholder:"Jump to task",value:u,children:[(0,s.jsx)(n2.Combobox.Input,{}),(0,s.jsx)(n2.Combobox.List,{children:Object.keys(h).map(e=>(0,s.jsx)(n8,{taskId:e,taskStats:h[e]},e))})]})]}),(0,s.jsx)("div",{className:"flex min-h-8 w-full items-center justify-between gap-4 text-sm leading-4 text-gray-900",children:(0,s.jsx)("span",{children:"Cache Inputs"})}),(0,s.jsxs)("div",{className:"flex flex-row items-center justify-between gap-4 max-md:flex-wrap",children:[(0,s.jsx)("div",{className:"grow",children:(0,s.jsx)(aa.Input,{"aria-labelledby":"Label",disabled:!0,prefix:"This deployment",value:t.source.id})}),n?void 0:(0,s.jsx)(f.Button,{className:"max-md:w-full",onClick:o?c:a,suffix:(0,s.jsx)(an,{}),children:o?"Compare to Previous":"Compare"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between max-lg:hidden",children:[(0,s.jsxs)("div",{className:"font-mono text-sm font-normal leading-4",children:["turbo@",t.summary.turboVersion]}),(0,s.jsx)(as,{summary:t})]})]})}var ai=e.i(6318858),al=e.i(7749291),ao=e.i(7218483),ac=e.i(6625227),ad=e.i(8216525);function au(e){let{item:t,isMainDeployment:n,isPrevDeployment:a,isComparisonDeployment:r,status:i,createdAt:l}=e,o=(0,ao.useAgo)(l,{justNowLabel:"just now"});return n?o="CURRENT":a&&(o="PREVIOUS"),(0,s.jsx)(n2.Combobox.Option,{className:"font-mono",disabled:n||r,prefix:(0,s.jsx)(ad.DeploymentStatus,{deployment:{readyState:i??"INITIALIZING",createdAt:l??0}}),suffix:(0,s.jsx)("span",{className:"text-xs text-gray-900",children:o}),value:t.source.id,children:(0,s.jsxs)("span",{className:"flex gap-1 text-xs text-foreground",children:[t.source.id,r?(0,s.jsx)(ai.Check,{}):void 0]})},t.source.id)}function am(e){let{comparisons:t,comparisonsLoading:n,searchLoading:a,summaryData:r,deployment:i,onSelectCompare:o,onRemoveCompare:c,onSearch:d,prevDeploymentId:u}=e,{data:m}=(0,ac.default)(r?.source.id);return(0,s.jsxs)("div",{className:(0,l.clsx)("flex shrink grow basis-1/2 flex-col gap-4 p-4 lg:px-6","border-0 border-l border-solid border-gray-200 bg-background-200","max-lg:border-l-0 max-lg:border-t","max-sm:w-screen"),children:[(0,s.jsxs)("div",{className:"flex min-h-8 w-full items-center justify-between gap-4 text-sm leading-4 text-gray-900",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-mono text-sm text-red-500",children:"-"}),(0,s.jsx)("span",{className:"ml-1 mr-2 font-mono text-sm text-green-500",children:"+"}),"Comparing with:"]}),(0,s.jsx)(f.Button,{"aria-label":"Remove Comparison",onClick:c,size:"small",svgOnly:!0,type:"tertiary",children:(0,s.jsx)(tT.Cross,{})})]}),(0,s.jsxs)(n2.Combobox,{clearable:!1,disabled:n,onChange:o,placeholder:r?r.source.id:"Select a deployment",value:r?.source.id,children:[(0,s.jsx)(n2.Combobox.Input,{loading:n||a,onChange:e=>{""===e.target.value?d(void 0):d(e.target.value)}}),(0,s.jsx)(n2.Combobox.List,{emptyMessage:a?"Searching":"No previous deployments found",children:t.map((e,t)=>(0,s.jsx)(au,{createdAt:e.source.meta.createdAt,isComparisonDeployment:e.source.id===r?.source.id,isMainDeployment:e.source.id===i.id,isPrevDeployment:e.source.id===u,item:e,status:e.source.meta.status},a?e.source.id:`${e.source.id}-${t}`))})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between max-lg:hidden",children:[(0,s.jsx)("div",{className:"font-mono text-sm font-normal leading-4",children:r?`turbo@${r.summary.turboVersion}`:void 0}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[m?.inspectorUrl?(0,s.jsx)(f.Button,{Component:"a","aria-label":`Open deployment with ID ${m.id} in a new tab`,href:m.inspectorUrl,onClick:()=>eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_VIEW_DEPLOYMENT),size:"small",svgOnly:!0,target:"_blank",type:"secondary",children:(0,s.jsx)(al.ExternalSmall,{})}):void 0,r?(0,s.jsx)(as,{summary:r}):void 0]})]})]})}function ap(e){let{deployment:t,showCompareHeader:n,hasPreviousSummary:a,isComparing:r,stats:i,onScrollToLine:l,onCompareRemove:o,onComparePrevious:c,onCompare:d,onCompareSelect:u,onCompareSearch:m,baseline:p,comparison:h,comparisons:g,comparisonsLoading:x,searchLoading:f,prevDeploymentId:y}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ar,{hasPreviousSummary:a,isComparing:r,onCompare:d,onComparePrevious:c,onScrollToLine:l,stats:i,summaryData:p}),n?(0,s.jsx)(am,{comparisons:g,comparisonsLoading:x,deployment:t,onRemoveCompare:o,onSearch:m,onSelectCompare:u,prevDeploymentId:y,searchLoading:f,summaryData:h}):null]})}var ah=e.i(3218771),ag=e.i(6440337);function ax(e){let{className:t="",isEnabled:n,onClick:a,mobileBreakpoint:r=600}=e,i=(0,tt.useMediaQuery)(r);return n?(0,s.jsx)(f.Button,{"aria-label":"Turborepo Run Summary",className:t,onClick:a,prefix:i?void 0:(0,s.jsx)(nK.LogoTurborepo,{size:20}),shape:i?"square":void 0,size:"small",svgOnly:i||void 0,type:"secondary",children:i?(0,s.jsx)(nK.LogoTurborepo,{size:20}):(0,s.jsx)("span",{children:"Run Summary"})}):null}function af(e){return(0,s.jsxs)("span",{className:ah.default.codeFoldMessage,children:[(0,s.jsx)(nZ.ChevronUpDown,{className:"text-sm"}),"Expand ",e," Lines"]})}function ay(e){let{size:t}=e;return(0,s.jsxs)("svg",{height:t,style:{color:"currentcolor",stroke:"currentcolor"},viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("title",{children:"Reset Folding"}),(0,s.jsx)("path",{d:"M17 3L12 8.517L9.5 5.7585L7 3M7 20.997L12 15.48L17 20.997",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]})}function aj(e){let{onView:t}=e;return(0,s.jsxs)("div",{className:ah.default.noDifference,children:[(0,s.jsx)(et.CheckCircleFill,{size:54}),(0,s.jsx)("span",{children:"No Difference"}),(0,s.jsx)(f.Button,{onClick:t,size:"small",type:"secondary",children:"View"})]})}function av(e){let t,{active:n,deployment:a,baseline:r,comparison:l,previous:o,initialLine:d,onClose:u}=e,[m,p]=(0,c.useQueryState)("line"),[g,x]=(0,c.useQueryState)("comparisonId",c.queryTypes.string.withDefault(l?.source.id??"")),{expandedBlocks:y,resetCodeBlocks:j,virtualizer:v,getIndex:C,items:_}=(0,h.useCodeCompare)(),b=(0,tt.useMediaQuery)(1024),k=(0,nY.useMounted)(),w=(0,i.useRef)(null),[S,N]=(0,i.useState)([]),[I,A]=(0,i.useState)(!d),[T,R]=(0,i.useState)(void 0),P=(0,tw.useDebouncedValue)(T,400),[E,L]=(0,i.useState)(l),[W,M]=(0,i.useState)(!0),[B,D]=(0,i.useState)(!1),[V,F]=(0,i.useState)(!1),[H,z]=(0,i.useState)(!!d),[O,U]=(0,i.useState)(),{resolvedTheme:$}=(0,t0.useTheme)(),{data:q,isLoading:G}=function(e){let{since:t,projectId:n,deploymentId:a,refType:s,refValue:r}=e,i=(0,eK.useTeamSlug)();return(0,eJ.default)(()=>i&&a&&n?`/api/turborepo/run-summary/comparisons${(0,eC.encode)({deploymentId:a,projectId:n,since:t,teamId:i,refType:s,refValue:r})}`:null,e=>(0,ev.fetchAPI)(e,{throwOnHTTPError:!0}),{refreshInterval:0,revalidateOnFocus:!1})}({since:a.createdAt,projectId:a.projectId,deploymentId:a.id,...eQ(a)}),{data:Z,isLoading:Y}=function(e){let{search:t}=e,n=(0,eK.useTeamSlug)();return(0,eJ.default)(()=>n&&t?`/api/turborepo/run-summary/query${(0,eC.encode)({search:t,teamId:n})}`:null,e=>(0,ev.fetchAPI)(e,{throwOnHTTPError:!0}),{revalidateOnFocus:!1,revalidateIfStale:!1,revalidateOnReconnect:!1})}({search:P}),J=async()=>{await u(),await p(null),await x(null)},K=e=>{if(e){let t=S.find(t=>t.source.id===e);t&&(L(t),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_SELECT_COMPARISON,{comparisonId:t.source.id,comparisonType:t.source.type}))}},Q=()=>{D(!1),L(void 0),M(!1),z(!1),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_REMOVE_COMPARISON)},X=(0,i.useCallback)(e=>{e>=0&&(v?.scrollToIndex(e,{align:"center"}),U(void 0))},[U,v]),ee=()=>{o?.source.id!==E?.source.id&&(L(o),M(!0),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_COMPARE_PREVIOUS))},et=e=>{if(e){let t=C(e);t<0?(F(!1),U(e)):X(t)}};(0,i.useEffect)(()=>{if(k&&!I&&d&&E?.summary){let[e,t]=d.split("-"),n=_.find(n=>"skipped"!==n.type&&n.data.line["L"===e?"left":"right"]?.lineNumber===Number(t));if(void 0!==n&&"skipped"!==n.type){let{index:e}=n.data;X(e),A(!0)}}},[I,d,k,E,_,X]),(0,i.useEffect)(()=>{!G&&q?.length&&N(q)},[G]),(0,i.useEffect)(()=>{if(!Y&&Z?.result!==void 0){let e=Z.result;S.find(t=>t.source.id===e.source.id)||N(t=>[e,...t])}},[Y,S]),(0,i.useEffect)(()=>{x(E?.source.id?E.source.id:null),E?.summary&&!d?F(!0):F(!1)},[E,x,d]),(0,i.useEffect)(()=>{!V&&O&&X(C(O))},[O,V,X,C]),(0,i.useEffect)(()=>{E?.summary&&!b?M(!0):M(!1)},[b,E]),(0,i.useEffect)(()=>{E?.summary&&z(!1)},[E]);let en=!!o,{totalTasks:ea,cachedTasks:es,totalDuration:er,timeSaved:ei}=r.stats.summary,el=JSON.stringify(E?.summary)===JSON.stringify(r.summary),eo=el&&!H;return(0,s.jsxs)(eq.Modal,{active:!!n,drawerClassname:ah.default.drawerStyles,drawerHeight:"max",drawerVerticalScroll:!1,onClickOutside:J,style:{width:E?.summary||B||b?"90vw":"80vw",maxWidth:"1600px",height:"80vh"},children:[(0,s.jsx)(n0,{cachedTasks:es,timeSaved:ei,totalDuration:er,totalTasks:ea}),(0,s.jsxs)("div",{className:ah.default.body,children:[(0,s.jsx)(at,{onScrollToLine:et,stats:r.stats}),(0,s.jsxs)("div",{className:ah.default.content,children:[(0,s.jsx)("div",{className:ah.default.contentHeader,children:(0,s.jsx)(ap,{baseline:r,comparison:E,comparisons:S,comparisonsLoading:G,deployment:a,hasPreviousSummary:en,isComparing:!!E?.summary||B,onCompare:()=>D(!0),onComparePrevious:ee,onCompareRemove:Q,onCompareSearch:R,onCompareSelect:K,onScrollToLine:et,prevDeploymentId:o?.source.id,searchLoading:Y,showCompareHeader:!!(E?.summary||B),stats:r.stats})}),(0,s.jsxs)("div",{className:ah.default.diffViewer,id:"DiffViewer",ref:w,children:[(0,s.jsx)("div",{className:ah.default.contentHeaderMobile,children:(0,s.jsx)(ap,{baseline:r,comparison:E,comparisons:S,comparisonsLoading:G,deployment:a,hasPreviousSummary:en,isComparing:!!E?.summary||B,onCompare:()=>D(!0),onComparePrevious:ee,onCompareRemove:Q,onCompareSearch:R,onCompareSelect:K,onScrollToLine:et,prevDeploymentId:o?.source.id,searchLoading:Y,showCompareHeader:!!(E?.summary||B),stats:r.stats})}),eo?(0,s.jsx)(aj,{onView:()=>{F(!1),z(!0)}}):void 0,k&&!eo?(0,s.jsx)(h.ComparisonView,{codeFoldMessageRenderer:af,compareMethod:h.DiffMethod.WORDS_WITH_SPACE,hideLineNumbers:!E?.summary,highlightLines:m?[m]:[],newValue:JSON.stringify(E?.summary?E.summary:r.summary,null,2),oldValue:JSON.stringify(r.summary,null,2),onLineNumberClick:(e,t)=>{m===e?p(null):p(e)},parentRef:w,renderContent:e=>(0,ag.SyntaxHighlighter)(e,r.stats.tasks),showDiffOnly:V,splitView:W,styles:(t="dark"===$?"dark":"light",E?.summary?W?(0,ag.splitViewStyles)({theme:t}):(0,ag.unifiedViewStyles)({theme:t}):(0,ag.noComparisonStyles)()),useDarkTheme:"dark"===$,useVirtual:!0,virtualizerOptions:{estimateSize:()=>20,overscan:15,scrollPaddingStart:b?-300:0},xSpacer:!0}):void 0,(0,s.jsx)(ag.SyntaxHighlightingStyles,{})]}),E?.summary&&!eo?(0,s.jsxs)("div",{className:ah.default.diffViewerBackground,children:[(0,s.jsx)("div",{className:ah.default.diffViewerBackgroundLeft}),(0,s.jsx)("div",{className:ah.default.diffViewerBackgroundRight})]}):null]}),!el&&y.length>0&&E?.summary||!el&&!V&&E?.summary?(0,s.jsx)(f.Button,{className:ah.default.resetFoldingButton,onClick:()=>{j(),F(!0),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_COLLAPSE_LINES)},size:"small",type:"secondary",children:(0,s.jsxs)("span",{className:ah.default.resetCodeFold,children:[(0,s.jsx)(ay,{size:14}),"Collapse Lines"]})}):void 0]})]})}function aC(e){let{shimmer:t=!1}=e;return(0,s.jsx)(s.Fragment,{children:Q.map(e=>{let n=e,a=e;return(e!==J||t||(a="Assigning Domains",n="Assigning Custom Domains"),t)?(0,s.jsx)(ex,{id:a,name:n},a):(0,s.jsx)(ef,{disabled:!0,id:a,name:n,status:eh.Pending},a)})})}e.s(["DeployStepsSkeleton",()=>aC],1367170);var a_=e.i(5779481),ab=e.i(4011256);function ak(e){let{resource:t,team:n}=e,{data:a}=(0,a_.useResourceItem)({resourceId:t.resourceId,skipMetadata:!0}),r=a?.store,i=r?(0,ab.getResourceDashboardLink)(r,{teamSlug:n.slug}):"";return(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:4,children:[(0,s.jsx)(u.Link,{external:!0,href:i,children:(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:1,children:[t.icon?(0,s.jsx)(t1.Avatar,{hash:t.icon,size:20}):null,t.name]})}),(0,s.jsx)(aw,{status:t.status})]})}function aw(e){let{status:t}=e;return(0,s.jsx)(k.Tooltip,{text:function(e){if(!e)return"Resource status is unknown";switch(e){case"ready":case"resumed":return"Resource is ready";case"pending":return"Resource is initializing";case"error":return"Resource has errors";case"skipped":return"Resource has been skipped or not configured";case"suspended":return"Resource has been suspended";case"uninstalled":return"Resource has been uninstalled";case"timeout":return"Resource provisioning timed out"}return null}(t),children:(0,s.jsx)("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:function(e){if(!e)return"var(--geist-secondary)";switch(e){case"ready":case"resumed":return"var(--geist-success)";case"pending":return"var(--geist-warning)";case"timeout":case"error":return"var(--geist-error)";default:return"var(--geist-secondary)"}}(t)}})})}function aS(e){let{action:t,deployment:n,team:a}=e;return(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:4,children:[t.resource?(0,s.jsx)(aN,{action:t,deployment:n,resource:t.resource,team:a}):(0,s.jsx)(aI,{action:t,deployment:n,team:a}),t.startedAt?(0,s.jsx)(aA,{action:t}):null,(0,s.jsx)(aT,{status:t.status}),(0,s.jsx)(p.Text,{children:t.statusText})]})}function aN(e){let{action:t,resource:n,deployment:a,team:r}=e,{data:i}=(0,a_.useResourceItem)({resourceId:n.resourceId,skipMetadata:!0}),l=i?.store,o=t.statusUrl?(0,H.getIntegrationAbsoluteOrSsoLink)(t.statusUrl,{teamIdOrSlug:r.id,integrationConfigurationId:t.integrationConfigurationId,externalResourceId:n.externalResourceId,projectId:a.projectId,action:t.slug}):l?(0,ab.getResourceDashboardLink)(l,{teamSlug:r.slug,path:"projects"}):"";return(0,s.jsx)(u.Link,{external:!0,href:o,children:(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:1,children:[t.icon?(0,s.jsx)(t1.Avatar,{hash:t.icon,size:20}):null,n.name,": ",t.name]})})}function aI(e){let{action:t,deployment:n,team:a}=e,r=t.statusUrl?(0,H.getIntegrationAbsoluteOrSsoLink)(t.statusUrl,{teamIdOrSlug:a.id,integrationConfigurationId:t.integrationConfigurationId,projectId:n.projectId,action:t.slug}):`/${a.slug}/~/integrations/${t.integrationConfigurationId}`;return(0,s.jsx)(u.Link,{external:!0,href:r,children:(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:1,children:[t.icon?(0,s.jsx)(t1.Avatar,{hash:t.icon,size:20}):null,t.name]})})}function aA(e){let{action:t}=e,{startedAt:n,completedAt:a}=t,[r,l]=(0,i.useState)(null);return((0,ec.useInterval)(()=>{n&&l(Date.now()-n)},a?null:1e3,!0),(0,i.useEffect)(()=>{null===r&&n&&a&&l(a-n)},[r,a,n]),r)?(0,s.jsx)(p.Text,{as:"span",color:"gray-900",weight:400,children:(0,ed.age)(r||0,{includeSeconds:!0})}):null}function aT(e){let{status:t}=e;return(0,s.jsx)(k.Tooltip,{text:function(e){if(!e)return"Action has not started yet";switch(e){case"succeeded":return"Action has completed";case"running":return"Action is running";case"failed":return"Action has completed with errors";case"skipped":return"Action has been skipped or not configured";case"uninstalled":return"Action or resource have been uninstalled";case"timeout":return"Action has timed out"}return null}(t),children:(0,s.jsx)("div",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:function(e){if(!e)return"var(--geist-warning)";switch(e){case"succeeded":return"var(--geist-success)";case"running":return"var(--geist-warning)";case"timeout":case"failed":return"var(--geist-error)";default:return"var(--geist-secondary)"}}(t)}})})}function aR(e){let{deployment:t}=e,{team:n}=(0,tz.useTeam)(),a=t.integrations;return n&&a?(0,s.jsx)(ef,{action:(0,s.jsx)(aE,{deployment:t}),finishedAt:a.completedAt,id:"Integrations",name:"Provisioning Integrations",paddingType:"vertical",showDurationWhenSkipped:!0,startedAt:a.startedAt,status:function(e){if(!e)return eh.NoData;switch(e){case"pending":return eh.InProgress;case"ready":return eh.Complete;case"error":case"timeout":return eh.Error;case"skipped":return eh.Skipped}return eh.NoData}(a.status),children:(0,s.jsx)(aP,{deployment:t,team:n})}):null}function aP(e){let{team:t,deployment:n}=e,{data:a}=(0,eJ.default)(`/api/v13/deployments/${n.id}/integrations?teamId=${n.ownerId}`,ev.fetchAPI);return(0,s.jsx)(_.Stack,{direction:"column",gap:4,paddingX:6,children:a?(0,s.jsxs)(s.Fragment,{children:[a.resources?.map(e=>(0,s.jsx)(ak,{resource:e,team:t},e.resourceId)),a.actions?.map(e=>(0,s.jsx)(aS,{action:e,deployment:n,team:t},`${e.integrationConfigurationId}:${e.slug}`))]}):(0,s.jsx)(p.Text,{children:"Loading…"})})}function aE(e){let{deployment:t}=e,n=t.integrations;return n?.status!=="pending"?null:(0,s.jsx)(f.Button,{onClick:()=>{(0,ev.fetchAPI)(`/api/v13/deployments/${t.id}/integrations/skip`,{method:"POST",throwOnHTTPError:!0,body:{}})},size:"small",type:"secondary",children:"Skip"})}var aL=e.i(1288475),aW=e.i(1000921);function aM(e){let{check:t}=e;return t?.status==="running"?(0,s.jsx)(aL.Status,{size:16,color:"amber-700"}):t?.status==="completed"&&"succeeded"===t.conclusion?(0,s.jsx)(ai.Check,{size:16,color:"green-700"}):t?.status==="completed"&&"failed"===t.conclusion?(0,s.jsx)(tT.Cross,{size:16,color:"red-700"}):t?.status==="completed"&&"neutral"===t.conclusion?(0,s.jsx)(E.Warning,{size:16,color:"amber-700"}):t?.status==="completed"&&"canceled"===t.conclusion?(0,s.jsxs)("svg",{fill:"none",height:"16",viewBox:"0 0 20 20",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsxs)("g",{clipPath:"url(#clip0_3889:22791)",children:[(0,s.jsx)("path",{d:"M9.99984 18.3338C14.6022 18.3338 18.3332 14.6028 18.3332 10.0004C18.3332 5.39807 14.6022 1.66711 9.99984 1.66711C5.39746 1.66711 1.6665 5.39807 1.6665 10.0004C1.6665 14.6028 5.39746 18.3338 9.99984 18.3338Z",stroke:"#999999",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"}),(0,s.jsx)("path",{d:"M12.5 7.50049H7.5V12.5005H12.5V7.50049Z",fill:"#999999",stroke:"#999999",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})]}),(0,s.jsx)("defs",{children:(0,s.jsx)("clipPath",{id:"clip0_3889:22791",children:(0,s.jsx)("rect",{fill:"white",height:"20",transform:"translate(0 0.000488281)",width:"20"})})})]}):t?.status==="completed"&&"skipped"===t.conclusion?(0,s.jsx)(aW.ArrowCircleRight,{color:"gray-500",size:20}):t?.status==="completed"&&"stale"===t.conclusion?(0,s.jsx)(T.MinusCircle,{color:"gray-500",size:20}):(0,s.jsx)(N.CrossCircle,{color:"gray-500",size:20})}function aB(e){let{checks:t,isExpanded:n,filterChecksBy:a,onChange:r}=e,i=t.filter(e=>"succeeded"===e.conclusion).length,o=t.filter(e=>"running"===e.status).length,c=t.filter(e=>"failed"===e.conclusion).length,d=[{name:(0,s.jsx)(p.Text,{as:"span",color:"gray-900",weight:500,children:"All"}),value:"all"},i?{name:(0,s.jsx)(aD,{count:i,type:"succeeded"}),value:"succeeded"}:void 0,o?{name:(0,s.jsx)(aD,{count:o,type:"running"}),value:"running"}:void 0,c?{name:(0,s.jsx)(aD,{count:c,type:"failed"}),value:"failed"}:void 0].filter(Boolean);return d.length>2?(0,s.jsx)(b.Switch,{name:"ci-checks-filter",onClick:e=>{n&&e.stopPropagation()},size:"small",children:d.map(e=>(0,s.jsx)(b.Switch.Control,{checked:a===e.value,className:(0,l.clsx)({"[&>div]:px-0":"all"!==e.value},{"[&>div]:px-2":"all"===e.value}),label:e.name,onChange:()=>{r(e.value)},value:e.value},e.value))}):(0,s.jsxs)("span",{children:[i?(0,s.jsx)(aD,{count:i,suffix:"completed",type:"succeeded"}):null,o?(0,s.jsx)(aD,{count:o,suffix:"running",type:"neutral"}):null,c?(0,s.jsx)(aD,{count:c,suffix:"failed",type:"failed"}):null]})}function aD(e){let{count:t,suffix:n,type:a}=e;return(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:1,justify:"center",style:{padding:"0 6px"},children:[(0,s.jsx)(aM,{check:{conclusion:a,status:"running"===a?"running":"completed"}}),(0,s.jsxs)(p.Text,{as:"span",color:"gray-900",weight:500,children:[t,n?` ${n}`:""]})]})}var aV=e.i(8159863);function aF(e){let{checks:t,filterChecksBy:n,teamSlug:a,mutate:r}=e,{data:i}=(0,aV.useCurrentDashboardDeploymentInterval)(),{can:l,isLoading:o}=(0,g.default)(),c=!o&&l(x.Action.Update,null===i.target?x.Resource.DeploymentCheckPreview:x.Resource.DeploymentCheck),d=t.filter(e=>"failed"===e.conclusion),u=t.filter(e=>"succeeded"===e.conclusion),m=t.filter(e=>"running"===e.status);return(0,s.jsxs)(s.Fragment,{children:[("all"===n||"failed"===n)&&d.length>0?(0,s.jsx)(az,{checks:d,expanded:"failed"===n,type:"failed",canUpdateDeploymentCheck:c,teamSlug:a,onRerunSuccess:async()=>{await r()}}):null,("all"===n||"running"===n)&&m.length>0?(0,s.jsx)(az,{checks:m,expanded:"running"===n,type:"running"}):null,("all"===n||"succeeded"===n)&&u.length>0?(0,s.jsx)(az,{checks:u,expanded:"succeeded"===n,type:"succeeded"}):null]})}function aH(e){let{children:t,className:n,onClick:a,size:r="lg"}=e;return(0,s.jsx)(_.Stack,{className:(0,l.clsx)("hsla(var(--ds-gray-200-value),1) px-[var(--geist-space-gap)] [&:not(:last-child)]:border-b",{"py-[var(--geist-space-4x)]":"lg"===r},{"py-[var(--geist-space-gap-half)]":"sm"===r},n),direction:"row",gap:2,justify:"space-between",onClick:a,children:t})}function az(e){let{checks:t,type:n,expanded:a,canUpdateDeploymentCheck:r,teamSlug:o,onRerunSuccess:c}=e,[d,u]=(0,i.useState)(a);return(0,s.jsxs)(_.Stack,{className:(0,l.clsx)({"[&:not(:last-child)]:border-b ":d}),direction:"column",children:[(0,s.jsx)(aH,{className:(0,l.clsx)("cursor-pointer",{"border-b":!d},{"border-none":d}),onClick:()=>u(e=>!e),children:(0,s.jsxs)(_.Stack,{align:"center",direction:"row",gap:2,className:"pl-2",children:[(0,s.jsx)(t3.ChevronRight,{color:"gray-700",size:20,style:{transition:"transform 200ms ease",transform:d?"rotate(90deg)":"rotate(0deg)"}}),(0,s.jsx)(aM,{check:{conclusion:n,status:"running"===n?"running":"completed"}}),"failed"===n?(0,s.jsxs)(p.Text,{as:"span",weight:500,children:[t.length," Failing"]}):null,"running"===n?(0,s.jsxs)(p.Text,{as:"span",weight:500,children:[t.length," Running"]}):null,"succeeded"===n?(0,s.jsxs)(p.Text,{as:"span",weight:500,children:[t.length," Successful"]}):null]})}),(0,s.jsx)(_.Stack,{className:(0,l.clsx)("max-h-0 overflow-hidden transition-all duration-300",{"overflow-y-scroll max-h-96":d}),direction:"column",gap:0,children:t.map(e=>(0,s.jsx)(aO,{...e,canUpdateDeploymentCheck:r,teamSlug:o,onRerunSuccess:c},e.id))})]})}function aO(e){let{name:t,status:n,conclusion:a,detailsUrl:r,externalUrl:i,integrationId:l,canUpdateDeploymentCheck:o,teamSlug:c,onRerunSuccess:d,id:m}=e,{data:h,isLoading:g}=(0,O.useIntegration)(l),{data:x}=(0,aV.useCurrentDashboardDeploymentInterval)(),f=i||r;return(0,s.jsxs)(aH,{className:"hover:bg-[var(--ds-gray-100)]",size:"sm",children:[(0,s.jsxs)(_.Stack,{align:"center",className:"pl-5 ml-4",direction:"row",gap:2,children:[(0,s.jsx)(aM,{check:{conclusion:a,status:n}}),h?.icon?(0,s.jsx)(t1.Avatar,{hash:h.icon,size:18}):g?(0,s.jsx)("div",{className:"size-[16px]"}):(0,s.jsx)(L.LogoGithub,{}),(0,s.jsx)(p.Text,{as:"span",variant:"label-14",weight:500,children:t})]}),(0,s.jsxs)(_.Stack,{direction:"row",gap:4,children:[h&&"failed"===a&&o?(0,s.jsx)(e_,{checkId:m,deploymentId:x.id,teamSlug:c,onSuccess:d,checksConclusion:x.checksConclusion}):null,f?(0,s.jsx)(u.Link,{className:"flex flex-row items-center gap-2 text-gray-900",external:!0,href:f,children:(0,s.jsx)(p.Text,{className:"text-gray-900",children:"View details"})}):null]})]})}function aU(e){let{expandedSteps:t,deployment:n,checks:a,mutateDeployment:r,teamSlug:l,mutate:o}=e,[c,u]=(0,i.useState)("all"),m=(0,d.useServerFlag)("enable-deployment-checks-empty-state",!1),p=eh.Pending;0===a.length?eh.Pending:a.some(e=>"failed"===e.conclusion)?p=eh.Error:a.some(e=>"running"===e.status)?p=eh.InProgress:a.every(e=>"succeeded"===e.conclusion)&&(p=eh.Complete);let h=t.includes("CI Checks"),{areChecksRunning:f}=(0,V.getDeploymentStatus)(n),{can:y,isLoading:j}=(0,g.default)(),[v,C]=(0,i.useState)(!1),_=!j&&y(x.Action.Update,null===n.target?x.Resource.DeploymentCheckPreview:x.Resource.DeploymentCheck),b="failed"===n.checksConclusion||f,k="READY"!==n.readyState,w=!!n.checksState,{checksFinishedAt:S,checksStartedAt:N}=(0,tP.getChecksTimes)(a,n);return w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a$,{canSkipChecks:b,canUpdateDeploymentCheck:_,onSkip:()=>{b&&C(!0)},filterChecksBy:c,isExpanded:h,handleChecksFilterChange:e=>{u(e)},checksStartedAt:N,checksFinishedAt:S,isChecksDisabled:k,combinedStatus:p,checks:a,teamSlug:l,mutate:o}),b?(0,s.jsx)(eY,{active:v,deployment:n,mutateDeployment:r,onClose:()=>C(!1)}):null]}):m?(0,s.jsx)(ef,{id:Z,name:Z,status:eh.Pending,children:(0,s.jsx)(ej.EmptyChecksCard,{})}):null}function a$(e){let{canSkipChecks:t,canUpdateDeploymentCheck:n,onSkip:a,filterChecksBy:r,isExpanded:i,handleChecksFilterChange:l,checksStartedAt:o,checksFinishedAt:c,isChecksDisabled:d,combinedStatus:u,checks:m,teamSlug:p,mutate:h}=e;return(0,s.jsx)(ef,{action:(0,s.jsxs)(s.Fragment,{children:[t?(0,s.jsx)(k.Tooltip,{forceHide:n,text:n?null:"Missing required permission to skip checks",children:(0,s.jsx)(f.Button,{disabled:!n,onClick:a,size:"small",type:"secondary",children:"Skip"})}):null,(0,s.jsx)(aB,{checks:m,filterChecksBy:r,isExpanded:i,onChange:l})]}),id:Z,startedAt:o,finishedAt:c,disabled:d,name:Z,paddingType:"none",status:u,children:(0,s.jsx)(aF,{checks:m,filterChecksBy:r,teamSlug:p,mutate:h})})}var aq=e.i(3850869);let aG=e=>e===em.Building?"Build Logs":"Unknown",aZ=(e,t)=>{let n="finishedAt"in e?e.finishedAt:null,a=t.errorStep??null,s="CANCELED"===t.readyState,r="READY"===t.readyState,i="ERROR"===t.readyState;return"placeholder"in e&&!(s||r||i)?eh.Pending:n&&r?eh.Complete:n&&i||e.name===a?eh.Error:s?eh.Canceled:eh.InProgress},aY=[em.Building],aJ=[em.Building,G,K,J,Y];function aK(e){let{creationFlow:t,deployment:n,teamSlug:a,mutateDeployment:f,onComplete:y,onExpandedStepsChange:j,expandedSteps:v,enableLineHighlighting:C,context:_}=e,{can:b,isLoading:k,accessInfo:w}=(0,g.default)(),S=(0,W.useSearchParams)(),[N,I]=(0,c.useQueryState)("turboRunSummary",c.queryTypes.boolean),[A,T]=(0,i.useState)({}),[R,P]=(0,i.useState)([]),E=(0,eM.useFeedbackVariantsDeployStep)(),L=(0,eM.useShowCronJobsSummary)(),B=(0,ey.useChecksPrivateBetaFlag)(),D=(0,ey.useCiChecksAndPoliciesFlagV2)(),F=(0,d.useServerFlag)("enable-deployment-resources-page",!1),H=(0,e6.getGitInfoFromDeployment)(n),{steps:z,loading:U}=function(e){let[t,n]=(0,i.useState)([]),[a,s]=(0,i.useState)(!0),r=(0,i.useRef)(void 0),l=(0,i.useRef)([]),o=(0,i.useRef)(void 0),c=(0,i.useRef)(void 0);c.current=e;let d=e?.createdAt,u=e?.id,m=(0,i.useCallback)(e=>{let t=[...l.current,e];1e4===t.length&&(t[0].level="warning",t[0].text="Warning: You're seeing the last 10000 lines of logs. Any lines before that were automatically truncated."),l.current=t,n(l.current)},[]),p=u?(0,eH.API_DEPLOYMENT_EVENTS)(u):"";return(0,i.useEffect)(()=>{if(!u){n([]),l.current=[];return}s(!0),d!==r.current&&(r.current=d,n([]),l.current=[]);let e=new AbortController,t=e.signal;return o.current&&(o.current.abort(),n([]),l.current=[]),o.current=e,eU({url:p,onLog:m,onResponse:()=>s(!1),signal:t,deploymentRef:c}).catch(e=>{s(!1),e instanceof Error&&"AbortError"===e.name||(0,eF.captureError)(e,{attributes:{"extras.type":"Log Stream"}})}),()=>e.abort()},[m,d,u,p]),{steps:(0,i.useMemo)(()=>{let n=[];for(let a of t)if(!eO(a)){n[0]||n.push({finishedAt:null,logs:[],name:em.Building,startedAt:e?.buildingAt??a.created});let t=n[0];switch(t.logs.push(a),e?.readyState){case"READY":case"ERROR":t.finishedAt=("readyStateAt"in e?e.readyStateAt:e.ready)??null;break;default:t.finishedAt=null}}return n},[e?.buildingAt,t,e,e?.ready,e?.readyStateAt,e?.readyState]),loading:a}}(n),[$,Z]=(0,i.useState)(!1),[Y,Q]=(0,i.useState)(""),{data:X}=function(e,t){let{since:n,projectId:a,deploymentId:s,comparisonId:r,refType:i,refValue:l}=e,o=(0,eK.useTeamSlug)();return(0,eJ.default)(()=>o&&s&&a?`/api/turborepo/run-summary${(0,eC.encode)({deploymentId:s,projectId:a,comparisonId:r,since:n,teamId:o,refType:i,refValue:l})}`:null,e=>(0,ev.fetchAPI)(e,{throwOnHTTPError:!0}),t)}({since:n?.createdAt,projectId:n?.projectId,deploymentId:n?.id,comparisonId:A.comparisonId,...eQ(n)},{keepPreviousData:!0});(0,i.useEffect)(()=>{S&&T({comparisonId:S.get("comparisonId")??void 0,selectedLine:S.get("line")??void 0})},[S]);let{data:ee,isLoading:et}=(0,eX.useDeployLogs)({deployment:n,throwOnHTTPError:!n?.public}),{data:en}=(0,e1.useMicrofrontendsConfig)({deploymentId:n?.microfrontends?n?.id:void 0}),{data:ea}=(0,e0.useFrameworks)(),es=function(e,t){if(!t?.framework)return;let n=e?.find(e=>e.slug===t.framework),a=n?.name||t.framework,s=n?.slug||void 0,r=n?.logo,i=n?.darkModeLogo;return{name:a,slug:s,logo:r||i,darkModeLogo:i||r,version:t.frameworkVersion}}(ea,ee||null),er=z.length>=1;(0,i.useEffect)(()=>{f&&n?.readyState==="QUEUED"&&er&&f({...n,readyState:"BUILDING"})},[f,n,er]);let{areChecksRunning:ei}=(0,V.getDeploymentStatus)(n),{checks:el,mutate:eo}=(0,q.default)({deploymentId:n?.id,teamId:a},{refreshInterval:2e3*!!ei}),ec=el.length>0,ed=((e,t)=>{if(t&&"running"===t.checksState||t?.checksState==="registered"&&t?.readyState==="READY")return eh.InProgress;if(t&&"checksConclusion"in t)switch(t.checksConclusion){case"succeeded":case"skipped":return eh.Complete;case"failed":return eh.Error;default:return eh.Pending}return t?.readyState==="READY"?e?eh.Complete:eh.Skipped:eh.Pending})(ec,n),eu=(e=>{if(!e)return eh.Pending;if(e.aliasError)return eh.Error;if(e.aliasWarning)return eh.Warning;if("READY"!==e.readyState||"running"===e.checksState||"registered"===e.checksState)return eh.Pending;if(0===e.alias.filter(t=>!(e.automaticAliases||[]).includes(t)).length)return eh.Skipped;if(e&&"checksConclusion"in e)switch(e.checksConclusion){case"succeeded":case"skipped":return eh.Complete;default:return eh.Pending}return e?.aliasAssigned?eh.Complete:eh.InProgress})(n),{checksFinishedAt:ep}=(0,tP.getChecksTimes)(el,n),eg=n?.readyState==="QUEUED",ex=n?.readyState==="READY",ej=(0,e$.getFinishedState)(n),e_=!!n?.buildSkipped,eb=!ex,ew=ed!==eh.Pending&&ed!==eh.Skipped&&ed!==eh.Complete||n?.readyState!=="READY"||ei,eS=n&&("failed"===n.checksConclusion||ei),eN=!n||eg,eI=b(x.Action.Read,x.Resource.Logs),eA=n?.flags,eT=n?.crons;(0,i.useEffect)(()=>{0===el.length||Promise.all([...new Set(el.map(e=>e.integrationId))].map(O.prefetchIntegration)).catch(console.error)},[el,n?.id]);let eR=(0,i.useMemo)(()=>en?.config&&"applications"in en.config?en.config.applications:{},[en]),eP=Object.values(eR).find(e=>e.projectId===n?.projectId),eV=(0,i.useMemo)(()=>ee?(0,tP.mapTechnicalPrimitivesToPlatformPrimitives)(Object.entries(ee).filter(e=>{let[t,n]=e;return Array.isArray(n)&&n.length>0}).map(e=>{let[t,n]=e;return{type:t,artefacts:n}}),E?eA:void 0,L?eT:void 0,eP,eR,ee.bulkRedirectsMetadata):[],[ee,eA,E,eT,L,eP,eR]),ez=(0,i.useMemo)(()=>{let e=eV;return Y&&(e=[eV.find(e=>{let{type:t}=e;return t===Y})]),e.map(e=>({...e,artefacts:e.artefacts.sort((e,t)=>{if((0,t5.isMicrofrontendRoute)(e)&&(0,t5.isMicrofrontendRoute)(t))return e.appName===t.appName?e.path.localeCompare(t.path):e.appName?t.appName?e.appName.localeCompare(t.appName):1:-1;let n=(0,t5.isVariant)(e)?e.key:(0,t5.isMiddleware)(e)?e.rawMatchers?.[0]||e.matcher:(0,t5.isBulkRedirect)(e)?e.source:e.path,a=(0,t5.isVariant)(t)?t.key:(0,t5.isMiddleware)(t)?t.rawMatchers?.[0]||t.matcher:(0,t5.isBulkRedirect)(t)?t.source:t.path;return!n.includes("_next")&&a.includes("_next")?-1:n.includes("_next")&&!a.includes("_next")?1:n.localeCompare(a)})}))},[Y,eV]);(0,i.useEffect)(()=>{if(!v.includes(K)){let e=setTimeout(()=>{Q("")},100);return()=>clearTimeout(e)}},[v]);let eq=z.find(e=>e.name===em.Building),eG=void 0!==ee&&ez.length>0;(0,i.useEffect)(()=>{(async()=>{await eo()})().catch(e=>console.error(e))},[n?.readyState,eo]);let eZ=(0,i.useMemo)(()=>aQ({hasDeployData:eG,hasFinished:ej,logs:ee||null,deployment:n,deployStep:eq,isLoading:et}),[eG,eq,n,ee,ej,et]),{hash:e2}=(0,m.useHash)();e5(()=>{C&&tu.test(e2)&&!v.includes(aJ[0])&&j([aJ[0],...v])});let e4=(0,i.useCallback)(()=>{j([aJ[0],...v])},[v,j]),e9=()=>{I(!0),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_OPEN)},e3=async()=>{await I(null),eL.analytics.track(eW.AnalyticsEvent.TURBOREPO_RUN_SUMMARY_CLOSE)},e7=!ej||eZ===eh.Pending,te=(0,i.useMemo)(()=>v.filter(e=>e===K?!e7:e===G?!eb:e!==J||!ew),[ew,v,eb,e7]),{track:tt}=(0,eB.useTrackActivity)(),tn=!k&&!eI;return(0,s.jsxs)(r.Root,{className:tH.default.accordion,defaultValue:[],disabled:e_,onValueChange:e=>{(0,eE.awaitPaint)().then(()=>{e.includes(G)&&!v.includes(G)&&eL.analytics.track(eW.AnalyticsEvent.DEPLOYMENT_CHECK_STEP_CLICKED,{source:t?"project creation flow":"deployment view"}),!e.includes(K)&&v.includes(K)&&P([]),e.includes(K)&&!v.includes(K)&&tt(eD.VercelActivityAction.DeploymentOverviewSummaryClick,{}),j(e)})},type:"multiple",value:te,children:[eN?(0,s.jsx)(aC,{shimmer:!t}):(0,s.jsxs)(s.Fragment,{children:[n.integrations?(0,s.jsx)(aR,{deployment:n}):null,z.map(e=>{let a=aZ(e,n),r=e.logs,i=a===eh.InProgress?r.at(-1):void 0;return(0,s.jsx)(ef,{action:(0,s.jsxs)(s.Fragment,{children:[v.includes(e.name)?null:(0,s.jsx)(tj,{logs:r,className:"pr-2",onClick:e4}),(0,s.jsx)(ax,{className:"flex-none",isEnabled:!!X?.baseline,onClick:e9})]}),finishedAt:ee?.deployStepStart||!et?((e,t)=>{if(e.finishedAt)return e.finishedAt;let n="CANCELED"===t.readyState||"ERROR"===t.readyState;if(e.logs.length&&n)return e.logs[e.logs.length-1].created})(e,n):void 0,id:e.name,name:e.name===em.Building?(0,s.jsx)(e8,{creationFlow:t,label:aG(e.name),latestLog:i}):aG(e.name),paddingType:"none",startedAt:et?void 0:e.startedAt,status:a,children:tn?(0,s.jsx)(aq.AdditionalPermissionsRequired,{team:w?.team??null,resource:"build logs"}):(0,s.jsx)(tB,{context:_,enableLineHighlighting:C,isLoading:U,logs:r,startedAt:Math.min(r.at(0)?.created||n.buildingAt,n.buildingAt),status:a})},e.name)}),aY.slice(z.length).map(e=>{let t=aZ({name:e,placeholder:!0},n);return(0,s.jsx)(ef,{id:e,name:aG(e),paddingType:"none",status:tn?eh.MissingPermissions:t,disabled:tn,children:tn?(0,s.jsx)(aq.AdditionalPermissionsRequired,{team:w?.team??null,resource:"build logs"}):(0,s.jsx)(tB,{context:_,isLoading:!0,logs:[],startedAt:n.createdAt,status:t})},e)}),(0,s.jsx)(ef,{action:eG&&eZ===eh.Complete?F?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.DashboardButtonLink,{className:"md:hidden",route:"/[teamSlug]/[project]/[id]/resources",shape:"square",size:"small",svgOnly:!0,type:"secondary",children:(0,s.jsx)(o.ListFilter,{color:"gray-900"})}),(0,s.jsx)(M.DashboardButtonLink,{className:"hidden md:flex",prefix:(0,s.jsx)(o.ListFilter,{color:"gray-900"}),route:"/[teamSlug]/[project]/[id]/resources",size:"small",type:"secondary",children:"Resources"})]}):(0,s.jsx)(nG,{active:Y,items:[{name:(0,s.jsx)("span",{className:(0,l.clsx)(tQ.default.tooltip,{[tQ.default.closedAll]:!open}),children:"All"}),value:"",buttonProps:{"aria-label":"All"}},...eV.map(e=>{let{type:t,artefacts:n,count:a}=e,{icon:r,name:i}=nz(t),l=[i,[t===t5.ArtefactTypes.IncrementalStaticRegeneration?"ISR":void 0,t===t5.ArtefactTypes.PartialPrerender?"PPR":void 0,t===t5.ArtefactTypes.EdgeMiddleware?void 0:t===t5.ArtefactTypes.BulkRedirects&&n.length>0&&(0,t5.isBulkRedirect)(n[0])?a?.toLocaleString():void 0].filter(Boolean).join("")].filter(Boolean).join(" ");return{name:(0,s.jsxs)("span",{className:tQ.default.iconLabel,children:[r,t!==t5.ArtefactTypes.EdgeMiddleware&&(t===t5.ArtefactTypes.BulkRedirects&&n.length>0&&(0,t5.isBulkRedirect)(n[0])?a?.toLocaleString():void 0)]}),value:t,tooltip:i,buttonProps:{"aria-label":l}}})],onChange:(e,t)=>{v.includes(K)&&t.stopPropagation(),Q(e),P([e])},open:v.includes(K)}):void 0,customDuration:ee?.deployStepTime,disabled:e7,id:K,name:K,paddingType:"none",status:eZ,children:eG?(0,s.jsx)(n$,{artefactGroups:ez,deployment:n,filterArtefactsBy:Y,framework:es,selectedArtefacts:R,setSelectedArtefacts:P}):(0,s.jsx)("div",{className:tH.default.noData,children:(0,s.jsx)(p.Text,{color:"gray-900",children:(0,s.jsxs)(s.Fragment,{children:["This deployment does not have a deployment summary."," ",(0,s.jsx)(u.Link,{external:!0,href:"https://vercel.com/docs/deployments#deployment-summary",target:"_blank",type:"highlight",children:"Learn more"})]})})})}),H&&n?B||D?(0,s.jsx)(ek,{expandedSteps:v,deployment:n,teamSlug:a,onExpandedStepsChange:j}):(0,s.jsx)(aU,{expandedSteps:v,checks:el,deployment:n,mutateDeployment:f,mutate:eo,teamSlug:a}):null,(0,s.jsx)(tK,{deployment:n,disabled:ew,finishedAt:ew?void 0:n.aliasAssignedAt,id:J,name:"Assigning Custom Domains",onComplete:y,startedAt:ew?void 0:ec&&ep?ep:eq?.finishedAt||void 0,status:eu})]}),n&&eS?(0,s.jsx)(eY,{active:$,deployment:n,mutateDeployment:f,onClose:()=>Z(!1)}):null,X&&n&&N?(0,s.jsx)(h.CodeCompareProvider,{children:(0,s.jsx)(av,{active:N,baseline:X.baseline,comparison:X.other||X.previous,deployment:n,initialLine:A.selectedLine,onClose:e3,previous:X.previous})}):void 0]},n?.id)}let aQ=e=>{let{deployStep:t,deployment:n,hasDeployData:a,hasFinished:s,logs:r,isLoading:i}=e;return n?.buildSkipped?eh.Canceled:n?.readyState==="READY"?eh.Complete:i?eh.InProgress:t?n&&(!r||"error"in r)&&s&&aZ(t,n)===eh.Complete?eh.NoData:n&&!a?aZ(t,n)===eh.Complete?(0,e$.getFinishedState)(n)?eh.Complete:eh.InProgress:eh.Pending:eh.Complete:eh.Pending};function aX(e){let[t,n]=(0,i.useState)([]),a=e?.readyState==="ERROR",s=!!e?.buildSkipped;return(0,i.useEffect)(()=>{!s&&a&&(0,i.startTransition)(()=>{n([aJ[0]])})},[a,s]),{expandedSteps:t,setExpandedSteps:n}}e.s(["DeploySteps",()=>aK,"STEPS",0,aJ],7442785),e.s([],5224197),e.s(["useExpandedSteps",()=>aX],855127)}]);

//# sourceMappingURL=a00a3d6f8bd9a915.js.map
//# debugId=c426b570-d72e-55a2-83c3-0f43f94515f8
