
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="eb1ae202-2af4-5037-bf60-cdae2cff7196")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7710812,e=>{"use strict";function t(e){return!!e.tagIds?.includes("tag_ai")}function i(e,i){return e.filter(e=>i.find(i=>i.id===e.integrationId&&t(i)))}e.i(2704354),e.s(["filterConfigurationsByIntegrations",()=>i,"isAiIntegration",()=>t])},8061233,e=>{"use strict";var t=e.i(6468255),i=e.i(9100551),r=e.i(2504781),a=e.i(9508212),n=e.i(1344973),s=e.i(6696646),l=e.i(9889563);e.i(5628754);var o=e.i(9203481);e.i(5463680);var c=e.i(15312);e.i(6887680);var u=e.i(6810699),d=e.i(1017032),g=e.i(1909206);e.i(3182268);var m=e.i(7849855),h=e.i(1647234),p=e.i(7710812),x=e.i(4585051),f=e.i(8232741),j=e.i(1000921),y=e.i(57106),b=e.i(5338940),v=e.i(640716),S=e.i(6060673),w=e.i(7516116),C=e.i(4439612),k=(0,C.createServerReference)("400f48b9d2fe49d10c0a15e25a9d7f008b37c3f66e",C.callServer,void 0,C.findSourceMapURL,"updateAccess"),T=e.i(1492947);function I(e){let{connectedProjects:i,teamSlug:l}=e,o=(0,s.useRef)(null),[c,u]=(0,s.useState)(!1),d=i.length;return(0,t.jsxs)("div",{className:"flex w-full md:hidden",ref:o,children:[(0,t.jsxs)(r.Button,{className:"flex-1 md:flex-none",onClick:()=>u(!0),size:"small",type:"secondary",children:["Show ",d," Connected Projects"]}),(0,t.jsx)(T.Drawer,{className:"pb-7",container:o.current||void 0,fixed:!0,onDismiss:()=>u(!1),show:c,children:(0,t.jsxs)(a.Stack,{gap:4,padding:4,children:[(0,t.jsxs)(n.Text,{color:"gray-900",weight:500,children:["Connected to ",d," projects"]}),(0,t.jsx)(a.Stack,{gap:4,children:i.map(e=>(0,t.jsx)(y.Link,{href:`/${l}/${e.name}`,children:(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:1.5,children:[(0,t.jsx)(v.FaviconOrFramework,{project:e,size:20,style:{flexShrink:0}}),(0,t.jsx)(n.Text,{weight:500,children:e.name})]})},e.id))})]})})]})}function D(e){let i,{provider:r,configuration:s,teamSlug:l}=e;return r&&s.integration?(0,t.jsxs)("div",{children:[(0,t.jsx)(y.Link,{href:`/${l}/~/ai/${r.slug}`,children:(0,t.jsx)(f.Entity,{className:"rounded-t-md border border-gray-alpha-400 bg-background-100 transition-colors hover:bg-background-200",left:(0,t.jsx)(x.Avatar,{hash:s.integration.icon,size:36}),children:(0,t.jsxs)(a.Stack,{gap:.5,children:[(0,t.jsx)(n.Text,{size:14,weight:500,children:s.integration.name}),(0,t.jsx)(n.Text,{color:"gray-900",children:(i=r.models.length)?`${i} Model${1===i?"":"s"} Available`:r.description})]})})}),(0,t.jsxs)(a.Stack,{align:"center",className:"w-full rounded-b-md border border-t-0 border-gray-alpha-400 bg-background-200 p-4",direction:"row",justify:"space-between",children:[(0,t.jsx)(M,{configuration:s,projectIds:s.projects,teamSlug:l}),(0,t.jsx)(y.Link,{className:"hidden md:block",href:`/${l}/~/ai/${r.slug}`,underline:!1,children:(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:1,children:[(0,t.jsx)(n.Text,{color:"blue-900",weight:500,children:"View Integration"}),(0,t.jsx)(j.ArrowCircleRight,{color:"green-700"})]})})]})]}):null}function M(e){let{configuration:i,projectIds:r,teamSlug:s}=e,{data:l}=(0,S.useProjects)(r),{team:o}=(0,b.useTeam)(),{hasProject:c}=(0,m.useProjectSlug)();if(!r||0===r.length||c)return(0,t.jsx)(w.ManageProjectConnectionModalClient,{configuration:i,configurationUrl:i.url,projects:(l??[]).filter(Boolean),size:"small",teamId:o?.id,updateAccess:k});if(!l)return(0,t.jsx)("div",{});let[u,...d]=l;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.Stack,{align:"center",className:"hidden md:flex",direction:"row",gap:1.5,children:[(0,t.jsx)(n.Text,{color:"gray-900",size:13,weight:500,children:"Connected to"}),(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:1.5,children:[(0,t.jsx)(v.FaviconOrFramework,{project:u,size:20,style:{flexShrink:0}}),(0,t.jsx)(y.Link,{className:"no-underline visited:text-inherit",href:`/${s}/${u.name}`,children:(0,t.jsx)(n.Text,{weight:500,children:u.name})}),d.length>0?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsxs)(n.Text,{as:"span",color:"gray-900",children:["and ",d.length," ",1===d.length?"other":"others"]})]}):null]})]}),(0,t.jsx)(I,{connectedProjects:[u,...d],teamSlug:s})]})}var N=e.i(8835183),R=e.i(8161149),A=e.i(8042625);function P(e){let{params:a,onClick:n}=e,s=(0,i.useRouter)(),l=(0,i.usePathname)(),o=(0,i.useSearchParams)();return(0,t.jsx)(r.Button,{onClick:()=>{if(o&&l){let e=new URLSearchParams(o);a.forEach(t=>e.delete(t)),s.replace(`${l}?${e.toString()}`)}n&&n()},type:"secondary",children:"Clear Search"})}function $(e){let{showEmptyState:r,teamSlug:n}=e,l=(0,i.useSearchParams)(),o=(0,s.useRef)(null),c=e=>{window.history.pushState(null,"",function(e){let{teamSlug:t,projectSlug:i,p:r}=e,a=(0,A.encode)({p:r},{questionMark:!0});return i?`/${t}/${i}/ai${a}`:`/${t}/~/ai${a}`}({teamSlug:n,p:e}))};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Stack,{align:"center",direction:"row",gap:3,children:(0,t.jsx)(N.SearchInput,{defaultValue:l?.get("browse")?"":l?.get("p")??void 0,name:"p",onChange:e=>c(e.target.value.trim()),placeholder:"Search connected providers…",suffixContainer:!1,suffixStyling:!1,width:"100%"})}),r?(0,t.jsx)(R.EmptyState.Root,{description:"No providers match your search.",secondary:!0,title:"No results found",children:(0,t.jsx)(P,{onClick:()=>{o.current?.reset(),c(null)},params:["p","filter"]})}):null]})}var L=e.i(5223937),F=e.i(5468328),O=e.i(2988836),B=e.i(5463009);function U(e){let{providers:i,canInstall:r,onSuccess:a}=e,n=(0,s.useRef)(null);return(0,t.jsx)("ul",{className:"grid grid-flow-row auto-rows-auto grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",ref:n,children:i.map(e=>(0,t.jsx)(z,{canInstallIntegration:r,installed:e.installed,integration:e.integration,onSuccess:a,provider:e.provider},e.integration.id))})}function z(e){let{canInstallIntegration:i,provider:s,nativeProduct:l,integration:o,installed:c,onSuccess:u}=e,d=s?.models.map(e=>e.displayName);return(0,t.jsx)("li",{children:(0,t.jsxs)(L.Material,{className:"flex size-full flex-col gap-y-1 p-4",gap:4,type:"small",children:[(0,t.jsxs)("div",{className:"flex w-full items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,t.jsx)(x.Avatar,{hash:o.icon,size:40}),(0,t.jsx)(n.Text,{as:"h3",className:"text-heading-16",weight:500,children:s?.name??o.name})]}),c?(0,t.jsx)(r.Button,{disabled:!0,size:"small",type:"secondary",children:"Installed"}):(0,t.jsx)(B.AddProviderButton,{canInstallIntegration:i,handleSuccess:u,integration:o,product:l,provider:s})]}),(0,t.jsxs)(a.Stack,{className:"h-full",gap:1,justify:"space-between",children:[(0,t.jsx)(n.Text,{className:"text-copy-14 ml-14",color:"gray-900",children:s?.description??o.shortDescription}),d?.length?(0,t.jsxs)(a.Stack,{className:"ml-14 truncate",direction:"row",gap:1.5,children:[(0,t.jsx)(n.Text,{weight:500,children:"Models:"}),(0,t.jsx)(n.Text,{className:"truncate",color:"gray-900",children:d.join(", ")}),(0,t.jsx)(F.Tooltip,{text:d.join(", "),children:(0,t.jsx)(O.InformationFillSmall,{color:"gray-900"})})]}):null]})]})})}var H=(0,C.createServerReference)("403309dc8b11ebb05194f1d5b48f96aadeb68f2a50",C.callServer,void 0,C.findSourceMapURL,"revalidateAiList");function E(e){let{canInstallIntegration:i,teamSlug:r,providersWithIntegration:a}=e;return(0,t.jsxs)(t.Fragment,{children:[a.nativeIntegrations.length>0?(0,t.jsxs)("section",{className:"flex flex-col gap-y-6",children:[(0,t.jsxs)("header",{className:"space-y-1",children:[(0,t.jsx)(n.Text,{as:"h2",size:24,weight:600,children:"Native Integration Providers"}),(0,t.jsx)(n.Text,{color:"gray-900",children:"Adding a provider gets you access to the AI provider dashboard and enables billing via Vercel."})]}),(0,t.jsx)(U,{canInstall:i,onSuccess:()=>H(r),providers:a.nativeIntegrations})]}):null,a.connectableIntegrations.length>0?(0,t.jsxs)("section",{className:"flex flex-col gap-y-6",children:[(0,t.jsxs)("header",{className:"space-y-1",children:[(0,t.jsx)(n.Text,{as:"h2",size:24,weight:600,children:"Connectable Providers Accounts"}),(0,t.jsx)(n.Text,{color:"gray-900",children:"Connect to third-party AI services."})]}),(0,t.jsx)(U,{canInstall:i,onSuccess:()=>H(r),providers:a.connectableIntegrations})]}):null]})}var Q=e.i(9739627),q=e.i(1438473);let W={src:e.i(7231787).default,width:66,height:53,blurWidth:0,blurHeight:0},G={src:e.i(5988448).default,width:66,height:53,blurWidth:0,blurHeight:0},V={src:e.i(9185550).default,width:97,height:60,blurWidth:0,blurHeight:0},_={src:e.i(8448868).default,width:97,height:60,blurWidth:0,blurHeight:0},K={src:e.i(8013276).default,width:70,height:56,blurWidth:0,blurHeight:0},Y={src:e.i(8570052).default,width:70,height:56,blurWidth:0,blurHeight:0},Z={src:e.i(4273711).default,width:170,height:56,blurWidth:0,blurHeight:0},X={src:e.i(3905296).default,width:170,height:56,blurWidth:0,blurHeight:0},J={src:e.i(9175625).default,width:73,height:52,blurWidth:0,blurHeight:0},ee={src:e.i(7946527).default,width:73,height:52,blurWidth:0,blurHeight:0},et={src:e.i(8671752).default,width:121,height:60,blurWidth:0,blurHeight:0},ei={src:e.i(3202286).default,width:121,height:60,blurWidth:0,blurHeight:0};function er(){let e=(0,i.useParams)(),r=String(e?.teamSlug);return(0,t.jsxs)("section",{className:"flex flex-col gap-y-6",children:[(0,t.jsxs)("header",{className:"space-y-1",children:[(0,t.jsx)(n.Text,{as:"h2",size:24,weight:600,children:"Use Cases"}),(0,t.jsx)(n.Text,{color:"gray-900",children:"Choose from a variety of use cases to get started with AI."})]}),(0,t.jsxs)("ul",{className:"flex gap-6",children:[(0,t.jsx)(ea,{image:(0,t.jsx)(Q.Image,{alt:"",srcDark:X,srcLight:Z}),imageDesktop:(0,t.jsx)(Q.Image,{alt:"",srcDark:Y,srcLight:K}),link:`/${r}/~/ai/models/sonar-pro`,text:"Build a chatbot with access to the internet using Perplexity",title:"Build an AI Chatbot"}),(0,t.jsx)(ea,{image:(0,t.jsx)(Q.Image,{alt:"",srcDark:_,srcLight:V}),imageDesktop:(0,t.jsx)(Q.Image,{alt:"",srcDark:G,srcLight:W}),link:`/${r}/~/ai/models/sdxl`,text:"Use Stable Diffusion XL to generate images with AI",title:"Generate images with AI"}),(0,t.jsx)(ea,{image:(0,t.jsx)(Q.Image,{alt:"",srcDark:ei,srcLight:et}),imageDesktop:(0,t.jsx)(Q.Image,{alt:"",srcDark:ee,srcLight:J}),link:`/${r}/~/ai/models/eleven-turbo-v2`,text:"Convert text into audio with ElevenLabs",title:"Convert text to speech"})]})]})}function ea(e){let{title:i,text:r,image:s,imageDesktop:l,link:o}=e;return(0,t.jsx)("li",{className:"flex-[250px_1_0] md:basis-[340px]",children:(0,t.jsx)(y.Link,{className:"group no-underline",href:o,children:(0,t.jsxs)(L.Material,{className:"overflow-hidden divide-y divide-gray-400 md:h-[100px] md:flex-row md:divide-x md:divide-y-0",type:"small",children:[(0,t.jsxs)("figure",{className:"flex h-[100px] shrink-0 items-center justify-center bg-background-200 md:aspect-square md:h-full",children:[(0,t.jsx)("div",{className:"md:hidden",children:s}),(0,t.jsx)("div",{className:"hidden md:block",children:l})]}),(0,t.jsxs)("article",{className:"p-4 space-y-1.5",children:[(0,t.jsxs)(a.Stack,{align:"center",className:"text-gray-1000",direction:"row",gap:2,children:[(0,t.jsx)(n.Text,{as:"h3",size:16,weight:500,children:i}),(0,t.jsx)("span",{className:"block transition-transform group-hover:translate-x-1",children:(0,t.jsx)(q.ArrowRight,{size:14})})]}),(0,t.jsx)(n.Text,{color:"gray-900",children:r})]})]})})})}var en=e.i(7274338),es=e.i(4011256);function el(e){let{searchParams:t,configurations:i,resources:r,providersWithIntegration:a,projectId:n,viewAll:s}=e,l=(0,p.filterConfigurationsByIntegrations)(i,a.connectableIntegrations.map(e=>e.integration)),o=t?.get("browse")?"":t?.get("p")?.toLowerCase(),c=l.filter(e=>!n||!e.projects||e.projects.includes(n)),u=o?c.filter(e=>e.integration?.name.toLowerCase().includes(o)&&(!n||!e.projects||e.projects.includes(n))):c,d=r.stores.filter(e=>!n||e.projectsMetadata.some(e=>e.projectId===n)),g=o?d.filter(e=>e.name.toLowerCase().includes(o)||e.product.name.toLowerCase().includes(o)||e.product.integration.name.toLowerCase().includes(o)):d,m=l.filter(e=>!c.includes(e)),h=r.stores.filter(e=>!d.includes(e)),x=h.length>0||m.length>0,f=l.length-m.length>0||r.stores.length-h.length>0,j=!!o&&0===u.length&&0===g.length,y=g.length+u.length+h.length+m.length;return{hasResourcesOrConfigurations:f,showEmptyState:j,filteredResources:s?g:g.slice(0,4),filteredConfigurations:s?u:u.slice(0,Math.max(4-g.length,0)),disconnectedResources:s?h:h.slice(0,Math.max(4-g.length-u.length,0)),disconnectedConfigurations:s?m:m.slice(0,Math.max(4-g.length-u.length-h.length,0)),hasDisconnectedResourcesOrConfigurations:x,totalItems:y}}function eo(e){let{teamSlug:p,configurationUrls:x,providersWithIntegration:f,preloadedResources:j,preloadedConfigurations:y,children:b,canInstallIntegration:v,templates:S,projectId:w}=e,{projectSlug:C}=(0,m.useProjectSlug)(),{data:k}=(0,u.useResourceList)({teamSlug:p,protocolType:"ai",fallbackData:j}),{data:T}=(0,d.useConfigurations)({skipBillingData:!0,fallbackData:y,type:"external"}),I=(0,i.useSearchParams)(),[M,N]=(0,s.useState)(!1),{hasResourcesOrConfigurations:R,filteredConfigurations:A,filteredResources:P,showEmptyState:L,hasDisconnectedResourcesOrConfigurations:F,disconnectedResources:O,disconnectedConfigurations:B,totalItems:U}=el({searchParams:I,configurations:T??y,resources:k??j,providersWithIntegration:f,projectId:w,viewAll:M});return(0,t.jsx)(g.InstallMarketplaceProductProvider,{protocolType:"ai",teamSlugOrPublic:{teamSlug:p},displayModalsInline:!1,children:R||F?(0,t.jsxs)(a.Stack,{gap:10,children:[(0,t.jsxs)(a.Stack,{gap:4,children:[R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($,{showEmptyState:L,teamSlug:p}),(0,t.jsxs)(a.Stack,{gap:4,children:[(0,t.jsx)(c.ResourceModalsProvider,{protocolType:"ai",children:P.map(e=>(0,t.jsx)(o.ResourceItem,{Badge:"ab-12-aws"!==e.product.integration.slug?(0,t.jsx)("span",{className:"pl-2",children:(0,t.jsx)(h.BadgeOrIcon,{Icon:(0,t.jsx)(l.Dollar,{}),label:"Billed via Vercel",tooltip:"This integration is billed through Vercel",variant:"green-subtle"})}):void 0,item:e,resourceLinkFunc:()=>C?(0,es.getProjectResourceDashboardLink)(e,{teamSlug:p,projectSlug:C}):(0,es.getResourceDashboardLink)(e,{teamSlug:p})},e.id))}),A.map(e=>(0,t.jsx)(D,{configuration:{...e,url:x[e.id]},provider:f.connectableIntegrations.find(t=>t.integration.id===e.integrationId)?.provider,teamSlug:p},e.id))]})]}):null,F?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Text,{size:16,children:"Connect existing AI Providers"}),(0,t.jsxs)(a.Stack,{gap:4,children:[(0,t.jsx)(c.ResourceModalsProvider,{protocolType:"ai",children:O.map(e=>(0,t.jsx)(o.ResourceItem,{alwaysShowConnectButton:!0,item:e,resourceLinkFunc:()=>(0,es.getResourceDashboardLink)(e,{teamSlug:p})},e.id))}),B.map(e=>(0,t.jsx)(D,{configuration:{...e,url:x[e.id]},provider:f.connectableIntegrations.find(t=>t.integration.id===e.integrationId)?.provider,teamSlug:p},e.id))]})]}):null,U>4&&!M?(0,t.jsx)(r.Button,{onClick:()=>N(!0),type:"secondary",typeName:"button",children:"View All"}):null]}),S.length>0?(0,t.jsx)(en.TemplateList,{templates:S}):null,b]}):(0,t.jsxs)(a.Stack,{gap:10,children:[(0,t.jsx)(E,{canInstallIntegration:v,providersWithIntegration:f,teamSlug:p}),S.length>0?(0,t.jsx)(en.TemplateList,{templates:S}):(0,t.jsx)(er,{}),b]})})}e.s(["InstallationAndResourceList",()=>eo,"filterResourcesAndConfigurations",()=>el],8061233)},1555869,e=>{"use strict";var t=e.i(6468255),i=e.i(9179929),r=e.i(5481907),a=e.i(8151845),n=e.i(5338940),s=e.i(5182595),l=e.i(3351543);function o(e){let{title:i,href:r,data:a}=e;return(0,t.jsxs)(l.ChartCard,{children:[(0,t.jsx)(l.CardHeader,{href:r,title:i}),(0,t.jsx)("div",{className:"-mt-0.5 h-[190px]",children:(0,t.jsx)(s.LineChart,{...a})})]})}var c=e.i(2749380);function u(e,t){let i=(0,c.getTimeRangePresets)(!1),r=d(e),a=d(t);for(let e of Object.values(i)){let t=e.end??new Date;if(d(e.start)===r&&d(t)===a)return!0}return!1}function d(e){return Math.floor(e.getTime()/6e4)}function g(){let{team:e}=(0,n.useTeam)(),{start:s,end:l}=(0,a.useRangeFromQueryState)(),{data:c,isLoading:d,builderQuery:g}=(0,r.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"cost",aggregation:"sum"}},tailRollup:"others",summaryOnly:!1}),m=(0,i.useTimeseriesData)(c,{singleCategoryName:"Spend",rollupName:"value"});return(0,t.jsx)(o,{title:"Spend",href:`/${e?.slug}/~/observability/ai`,data:{builderQuery:g?.value,sonarQueryResults:c,getColor:()=>"var(--ds-green-700)",data:m??[],disableLegend:!0,isLoading:d,isRelativeTime:u(s,l),lineType:"linear",formatValue:e=>`$${e.toFixed(2)}`,yAxisWidth:50,marginLeft:7}})}function m(){let{team:e}=(0,n.useTeam)(),{start:s,end:l}=(0,a.useRangeFromQueryState)(),{data:c,isLoading:d,builderQuery:g}=(0,r.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"count",aggregation:"sum"}},groupBy:["aiModel","costCurrency"],limitRanking:"top_by_summary",limit:5,tailRollup:"others",summaryOnly:!1}),m=(0,i.useTimeseriesData)(c,{category:"aiModel"});return(0,t.jsx)(o,{title:"Requests",href:`/${e?.slug}/~/observability/ai`,data:{builderQuery:g?.value,sonarQueryResults:c,data:m??[],disableLegend:!0,isLoading:d,isRelativeTime:u(s,l),lineType:"linear"}})}function h(){let{team:e}=(0,n.useTeam)(),{start:s,end:l}=(0,a.useRangeFromQueryState)(),{data:c,isLoading:d,builderQuery:g}=(0,r.useSonarQuery)({event:"aiGatewayRequest",rollups:{inputTokens:{measure:"inputTokens",aggregation:"sum"},outputTokens:{measure:"outputTokens",aggregation:"sum"},cachedInputTokens:{measure:"cachedInputTokens",aggregation:"sum"},reasoningTokens:{measure:"reasoningTokens",aggregation:"sum"}},summaryOnly:!1}),m=(0,i.useTimeseriesData)(c,{rollupCategories:{inputTokens:"Input Tokens",outputTokens:"Output Tokens",reasoningTokens:"Output Tokens",cachedInputTokens:"Cached Input Tokens"}})??[];return(0,t.jsx)(o,{title:"Tokens",href:`/${e?.slug}/~/observability/ai`,data:{builderQuery:g?.value,sonarQueryResults:c,data:m,lineType:"step",isLoading:d,isRelativeTime:u(s,l),rollupConfig:{method:"sum",showTrend:!1},showRollup:!0,yAxisDomain:[0,500]}})}function p(){let{team:e}=(0,n.useTeam)(),{start:s,end:l}=(0,a.useRangeFromQueryState)(),{data:c,isLoading:d,builderQuery:g}=(0,r.useSonarQuery)({event:"aiGatewayRequest",rollups:{value:{measure:"timeToFirstTokenMs",aggregation:"avg"}},tailRollup:"others",summaryOnly:!1}),m=(0,i.useTimeseriesData)(c,{singleCategoryName:"Average TTFT",rollupName:"value"});return(0,t.jsx)(o,{title:"Average TTFT",href:`/${e?.slug}/~/observability/ai`,data:{builderQuery:g?.value,sonarQueryResults:c,data:m??[],formatValue:e=>`${(e/1e3).toFixed(2)}s`,disableLegend:!0,isLoading:d,isRelativeTime:u(s,l),lineType:"linear"}})}function x(){return(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,t.jsx)(g,{}),(0,t.jsx)(p,{}),(0,t.jsx)(m,{}),(0,t.jsx)(h,{})]})}e.s(["ActivityGrid",()=>x],1555869)},2734076,e=>{"use strict";var t=e.i(6468255),i=e.i(1794286),r=e.i(1174741),a=e.i(3738416),n=e.i(8119470),s=e.i(8151845),l=e.i(6696646),o=e.i(2749380),c=e.i(1683927),u=e.i(7917902),d=e.i(5338940),g=e.i(4597921),m=e.i(2126130),h=e.i(7622186);function p(){let[e,p]=(0,s.useSonarQueryState)(),{start:x,end:f,isRelativeTime:j}=(0,s.useRangeFromQueryState)(),{data:y}=(0,c.useBillingCycles)(),{team:b,user:v}=(0,u.useAccount)(),S=!!(b||v)?.billing?.period,{team:w}=(0,d.useTeam)(),{hasObservabilityPlusAccessOnCurrentProject:C}=(0,m.useHasObservabilityPlus)(),k=(0,g.useServerFlag)("observability-maximum-lookback","inherit"),T=(0,l.useMemo)(()=>{if(!w)return(0,n.subDays)(new Date,1);let e=(0,h.getMaximumLookback)({team:w,hasObservabilityPlusAccess:C,observabilityMaximumLookbackFlag:k});return new Date(Date.now()-e)},[w,C,k]),I=(0,l.useMemo)(()=>j?void 0:{start:x,end:f},[j,x,f]),D=(0,l.useMemo)(()=>{let e=(0,o.getTimeRangePresets)(!1),t={};if(S&&y?.current?.start){let e=(0,a.startOfDay)(new Date(y.current.start)),i=(0,r.endOfDay)(new Date(y.current.end)),n=(0,r.endOfDay)(new Date),s=i.getTime()>n.getTime()?n:i;e.getTime()>=T.getTime()&&(t["current-billing-cycle"]={text:"Current Billing Cycle",start:e,end:s})}for(let i of["1h","6h","12h","1d","3d","7d","14d","30d"]){let r=e[i];r&&(r.start<T||(t[String(i)]={text:r.text,start:r.start,end:r.end??new Date}))}return t},[y,S,T]),M=(0,l.useMemo)(()=>[{presets:Object.entries(D).map(e=>{let[t,i]=e;return{key:t,...i}})}],[D]),N=(0,l.useMemo)(()=>{if(!e.from&&!e.to&&e.period&&D[e.period])return e.period;if(S&&y?.current?.start&&e.from&&e.to){let t=(0,a.startOfDay)(new Date(y.current.start)),i=(0,r.endOfDay)(new Date(y.current.end)),n=(0,r.endOfDay)(new Date),s=i.getTime()>n.getTime()?n:i;if((0,a.startOfDay)(e.from).getTime()===t.getTime()&&(0,a.startOfDay)(e.to).getTime()===(0,a.startOfDay)(s).getTime())return"current-billing-cycle"}},[y,S,e.from,e.to,e.period,D]);return(0,l.useEffect)(()=>{if(w&&x<T){let e=Object.entries(D).map(e=>{let[t,i]=e;return{key:t,start:i.start}}).filter(e=>{let{start:t}=e;return t.getTime()>=T.getTime()}).sort((e,t)=>e.start.getTime()-t.start.getTime());p({period:e[0]?.key??"1d"})}},[w,x,T,D,p]),(0,t.jsx)("div",{className:"w-[210px]",children:(0,t.jsx)(i.Calendar,{maxDuration:{months:3},minValue:T,maxValue:(0,r.endOfDay)(new Date),onChange:(e,t)=>{if(t&&t in D){if("current-billing-cycle"===t){let e=D[t];p({from:(0,a.startOfDay)(new Date(e.start)),to:(0,r.endOfDay)(new Date(e.end??new Date))});return}p({period:t});return}p({from:new Date(e.start),to:new Date(e.end)})},presets:M,presetKey:N,value:I,width:"210px"})})}e.s(["AIGatewayCalendar",()=>p])},2969611,e=>{"use strict";var t=e.i(6468255),i=e.i(9100551),r=e.i(2504781),a=e.i(9508212),n=e.i(5468328),s=e.i(1344973),l=e.i(6891161),o=e.i(6696646),c=e.i(5338940),u=e.i(57106),d=e.i(4011256),g=e.i(9668517);e.i(8703064);var m=e.i(6798946),h=e.i(5765731),p=e.i(7594446),x=e.i(4065455),f=e.i(1017032),j=e.i(8711152),y=e.i(5074599);e.i(7037808);var b=e.i(7137779);e.i(3182268);var v=e.i(7849855),S=e.i(8525850);e.i(6887680);var w=e.i(1414602),C=e.i(4325157);e.i(5463680);var k=e.i(6356390);e.i(553769);var T=e.i(3758860),I=e.i(7710812),D=e.i(3584802);function M(e){let{active:r,onClose:a,teamSlug:n}=e,{team:s}=(0,c.useTeam)(),{hasProject:u,projectSlug:g}=(0,v.useProjectSlug)(),m=(0,i.useRouter)(),[p,y]=(0,o.useState)(null),[w,D]=(0,o.useState)(null),[M,R]=(0,o.useState)("select"),{data:A}=(0,C.useMarketplaceIntegrations)({protocolType:"ai"}),P=A?.flatMap(e=>e.products.map(t=>({product:t,integration:e}))),{data:$}=(0,f.useConfigurations)({skipBillingData:!0}),{data:L}=(0,h.useConnectableIntegrations)(),F=Array.isArray(L)?L.filter(e=>(0,I.isAiIntegration)(e)&&!$?.some(t=>"external"===t.installationType&&t.integrationId===e.id)):[],O=()=>{R("select"),D(null),a()};return P&&F?"create"===M&&w?.type==="integration"?(0,t.jsx)(x.InstallExternalIntegrationModal,{account:s,integration:w.value,onAnimationDone:O,teamSlugOrPublic:{teamSlug:n}}):"connect"===M&&p&&s?(0,t.jsx)(b.CreateResourceConnectionModal,{active:!0,onAnimationDone:()=>y(null),onClickOutside:O,onConnectionCreated:()=>{O();let e=(0,S.getResourceDetailsPath)(p,s.slug,g);m.push(e)},resourceId:p.id,store:p}):(0,t.jsxs)(l.Modal.Modal,{active:r,onClickOutside:O,children:["select"===M?(0,t.jsx)(N,{connectableIntegrations:F,nativeProducts:P,onClose:a,onNext:()=>{R("create")},onSelectionChange:e=>D(e),selectedOption:w,teamSlug:n}):null,"create"===M&&w?.type==="product"?(0,t.jsx)(k.CreateResourceModal,{cancelLabel:"Back",initialConfigurationStatus:(0,j.getConfigurationStatusByIntegrationId)($?.filter(e=>"marketplace"===e.installationType),w.value.integration.id),integration:w.value.integration,neonIntegrationStatus:{isNeonDisabled:!1,isLoading:!1},onBack:()=>R("select"),onIntegrationResourceCreate:e=>{if(n){if(u){y(e),R("connect");return}m.push((0,d.getResourceDashboardLink)(e,{teamSlug:n}))}},product:(0,T.getProductWithSupportedProtocols)(w.value.product),teamSlug:n}):null]}):null}function N(e){let{connectableIntegrations:r,nativeProducts:n,onClose:o,onNext:c,onSelectionChange:g,selectedOption:h,teamSlug:x}=e,{canCreateIntegrationConfiguration:f,isLoading:j}=(0,p.useIntegrationPermissions)(),b=(0,i.useRouter)(),{permissions:v}=(0,w.useResourcePermissions)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Modal.Body,{children:(0,t.jsxs)(a.Stack,{gap:6,children:[(0,t.jsx)(a.Stack,{gap:2,children:(0,t.jsx)(l.Modal.Title,{center:!0,children:"Install AI Provider"})}),(0,t.jsx)(a.Stack,{gap:4,children:(0,t.jsxs)(a.Stack,{gap:2,children:[n.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.Stack,{direction:"row",justify:"space-between",children:[(0,t.jsx)(s.Text,{size:16,weight:600,children:(0,y.browseProductsTitle)("ai")}),(0,t.jsx)(u.Link,{external:!0,href:`${d.MARKETPLACE_DOC_PAGE}/integrations/install-an-integration/product-integration`,target:"_blank",children:(0,t.jsx)(s.Text,{children:"Learn more"})})]}),n.map(e=>{let{product:i,integration:r}=e;return(0,t.jsx)(m.CreateResourceCard,{description:i.shortDescription,icon:{url:r.icon},isDisabled:!v.create,isSelected:h?.type==="product"&&h.value.product.id===i.id,name:i.name,onClick:()=>{g({value:{product:i,integration:r},type:"product"})},showCreateButton:!1,tooltip:{isEnabled:!v.create,text:(0,y.missingPermissionLabel)("create","ai")}},i.id)})]}):null,n.length>0&&r.length>0?(0,t.jsx)(a.Stack,{align:"center",direction:"row",justify:"center",padding:2,children:(0,t.jsx)(s.Text,{color:"gray-800",size:14,children:"or Connect Existing Account"})}):null,r.map(e=>(0,t.jsx)(m.CreateResourceCard,{description:e.shortDescription,icon:{url:e.icon},isDisabled:!f||j,isSelected:h?.type==="integration"&&h.value.id===e.id,name:e.name,onClick:()=>{g({type:"integration",value:e})},showCreateButton:!1,tooltip:{isEnabled:!f,text:(0,y.missingPermissionLabel)("create","ai")}},e.id))]})})]})}),(0,t.jsxs)(l.Modal.Actions,{children:[(0,t.jsx)(l.Modal.Action,{onClick:o,type:"secondary",children:"Cancel"}),(0,t.jsx)(l.Modal.Action,{buttonType:"button",disabled:!h,onClick:()=>{h&&("product"===h.type?b.push((0,D.getIntegrationCheckoutUrl)({params:{teamSlug:x??"",integrationSlug:h.value.integration.slug},searchParams:{productSlug:h.value.product.slug,cancelUrl:x?`/${x}/~/integrations/${h.value.integration.slug}`:`/marketplace/${h.value.integration.slug}`}})):c())},type:"secondary",children:"Continue"})]})]})}function R(){let[e,i]=(0,o.useState)(!1),a=(0,g.useTeamSlug)(),{permissions:s,isLoading:l}=(0,w.useResourcePermissions)(),{canCreateIntegrationConfiguration:c}=(0,p.useIntegrationPermissions)(),u=s.create||c;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Tooltip,{disableTriggers:u||l,text:(0,y.missingPermissionLabel)("create","ai"),children:(0,t.jsx)(r.Button,{disabled:!u,onClick:()=>i(!0),type:"default",typeName:"button",children:`Install ${y.resourceTitle.ai}`})}),a?(0,t.jsx)(M,{active:e,onClose:()=>i(!1),teamSlug:a}):null]})}e.s(["CreateAIResourceButton",()=>R])},9381025,e=>{"use strict";var t=e.i(6468255),i=e.i(3911483),r=e.i(6696646),a=e.i(5758851),n=e.i(5338940),s=e.i(8151845),l=e.i(1233856),o=e.i(1230902),c=e.i(7467654),u=e.i(2936702),d=e.i(3646124),g=e.i(7797615),m=e.i(8521184),h=e.i(2504781),p=e.i(3993360);function x(e){var i;let{cell:r}=e,a=r.value,n=new Date(a.endsWith("Z")?a:`${a}Z`);return Number.isNaN(n.getTime())?(0,t.jsx)("div",{className:"py-2 text-gray-900 whitespace-nowrap",children:"-"}):(0,t.jsx)("div",{className:"py-2 text-gray-900 whitespace-nowrap",children:(i=n,(0,o.format)(i,"MMM dd HH:mm:ss").toUpperCase())})}function f(e){let{cell:i}=e,r=(0,c.getOrganizationDisplayName)(i.value);return(0,t.jsx)("div",{className:"overflow-hidden text-ellipsis text-nowrap py-2 text-gray-900",children:r})}function j(e){let{data:i,customPagination:a,defaultPageSize:n,onSearchChange:s,exportBaseUrl:l,onSortChange:o,externalPageIndex:j}=e,b=void 0===i,[v,S]=(0,r.useState)(!1),w=(0,r.useMemo)(()=>b?Array(10).fill(null):Array.isArray(i)?i:[],[b,i]),C=(0,r.useMemo)(()=>[{Header:"Time",accessor:"timestamp",Cell:x,disableGlobalFilter:!0,columnClassName:"w-[160px] min-w-[120px] max-w-[180px]"},{Header:"Model",accessor:"aiModel",columnClassName:"pr-5",sortDescFirst:!1,Cell:d.ColoredDotCell,disableGlobalFilter:!1},{Header:"Provider",accessor:"aiProvider",Cell:f,disableGlobalFilter:!1},{Header:"Cost",accessor:"cost",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:g.formatNumberUsdPrecise},{Header:"Input tokens",accessor:"inputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:g.formatNumberCompact},{Header:"Output tokens",accessor:"outputTokens",columnAlignment:"right",columnClassName:"w-28 max-w-32 min-w-28",Cell:d.NumericCell,cellFormatter:g.formatNumberCompact},{Header:"Duration",accessor:"aiRequestDurationMs",columnAlignment:"right",Cell:d.NumericCell,cellFormatter:y}],[]),k=(0,r.useCallback)((e,t,i)=>{let r=(i||"").toLowerCase().trim();return r?e.filter(e=>{let t=String(e.original.aiModel??"").toLowerCase(),i=(0,c.getOrganizationDisplayName)(String(e.original.aiProvider??"")).toLowerCase();return t.includes(r)||i.includes(r)}):e},[]),T=(0,r.useCallback)(async()=>{try{S(!0),await new Promise(e=>setTimeout(e,0));let e=[];if(l){let t=0;for(;;){let i=`${l}&limit=1000&offset=${t}`,r=await fetch(i,{cache:"no-store"});if(!r.ok)break;let a=await r.json(),n=Array.isArray(a.data)?a.data:[];if(e=e.concat(n),(a.pageInfo?.returned??n.length)<1e3||e.length>=1e6)break;t+=1e3}}else e=Array.isArray(i)?i:[];let t=e.map(e=>[String(e.timestamp??""),String(e.aiModel??""),String(e.aiProvider??""),Number.isFinite(e.cost)?String(e.cost):"",Number.isFinite(e.inputTokens)?String(e.inputTokens):"",Number.isFinite(e.outputTokens)?String(e.outputTokens):"",Number.isFinite(e.aiRequestDurationMs)?String(e.aiRequestDurationMs):""]),r=["Time,Model/creator,Provider,Cost,Input tokens,Output tokens,Duration (ms)",...t.map(e=>e.map((e,t)=>{let i,r;return t<=2?(i=/[",\n\r]/.test(e),r=e.replace(/"/g,'""'),i?`"${r}"`:r):e}).join(","))].join("\r\n"),a=new Blob([`\uFEFF${r}`],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(a),s=document.createElement("a");s.href=n,s.download="gateway-inference-requests.csv",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}finally{S(!1)}},[i,l]);return(0,t.jsx)(u.SonarTable,{columns:C,data:w,isLoading:b,defaultPageSize:n,defaultSort:[{id:"timestamp",desc:!0}],plugins:[m.useGlobalFilter,m.useSortBy,m.usePagination],globalFilter:k,onGlobalFilterChange:s,customPagination:a,externalPageIndex:j,manualSortBy:!0,onSortChange:o,renderCustomActions:()=>(0,t.jsx)(h.Button,{prefix:(0,t.jsx)(p.Download,{}),type:"secondary",loading:v,disabled:b||v||!i||0===i.length,onClick:T,children:v?"Exporting…":"Export CSV"})})}function y(e){if(!Number.isFinite(e))return"-";let t=e/1e3;if(t<60){let e=t.toFixed(2).replace(/\.?0+$/,"");return`${e}s`}if(t<3600){let e=Math.floor(t/60),i=Math.floor(t%60);return 0===i?`${e}m`:`${e}m${i}s`}let i=Math.floor(t/3600),r=Math.floor(t%3600/60);return 0===r?`${i}h`:`${i}h${r}m`}function b(e){let t=e.getUTCFullYear(),i=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),a=String(e.getUTCHours()).padStart(2,"0"),n=String(e.getUTCMinutes()).padStart(2,"0"),s=String(e.getUTCSeconds()).padStart(2,"0");return`${t}-${i}-${r} ${a}:${n}:${s}`}function v(){let{team:e}=(0,n.useTeam)(),{start:o,end:c,isRelativeTime:u}=(0,s.useRangeFromQueryState)(),d=u?(0,l.startOfDuration)(o,{minutes:1}):o,g=u?(0,l.endOfDuration)(c,{minutes:1}):c,[m,h]=(0,r.useState)(10),[p,x]=(0,r.useState)(0),[f,y]=(0,r.useState)(void 0),[v,S]=(0,r.useState)("timestamp"),[w,C]=(0,r.useState)(!0),k=(0,r.useMemo)(()=>{if(!e)return null;let t=b(d),i=b(g),r=new URLSearchParams({ownerId:e.id,startTime:t,endTime:i});return f&&f.trim().length>0&&r.set("q",f.trim()),`/api/ai/gateway-inference-requests?${r.toString()}`},[e,d,g,f]),T=(0,r.useMemo)(()=>{if(!k)return null;let e=Math.max(100,Math.min(500,5*m)),t=Math.floor(p*m/e)*e,i=w?"DESC":"ASC";return`${k}&limit=${e}&offset=${t}&sortBy=${encodeURIComponent(v)}&sortDir=${i}`},[k,p,m,v,w]),{data:I,isValidating:D,error:M,mutate:N}=(0,i.default)(T,async e=>{let t=new AbortController,i=await fetch(e,{cache:"no-store",signal:t.signal});if(!i.ok){let e=Error(`Failed to fetch inference requests: ${i.status} ${i.statusText}`);e.status=i.status;try{e.info=await i.json()}catch{}throw e}let r=await i.json();return r&&Array.isArray(r.data)?r:{data:[]}},{revalidateIfStale:!1,refreshInterval:0,revalidateOnFocus:!1,revalidateOnReconnect:!1,keepPreviousData:!0,dedupingInterval:6e4,errorRetryCount:1,errorRetryInterval:1e4}),R=(0,r.useMemo)(()=>{if(D)return;let e=I?.data??[],t=Math.max(100,Math.min(500,5*m)),i=p*m,r=Math.floor(i/t)*t,a=i-r;return e.slice(a,a+m)},[I?.data,D,p,m]),A=(0,r.useMemo)(()=>{let e=I?.pageInfo?.total;if("number"==typeof e&&Number.isFinite(e))return p+1<Math.max(1,Math.ceil(e/m));let t=I?.pageInfo?.returned??0,i=Math.max(100,Math.min(500,5*m)),r=p*m,a=Math.floor(r/i)*i;return t>r-a+m||t===i},[I?.pageInfo?.total,I?.pageInfo?.returned,p,m]),P=(0,r.useCallback)(()=>{A&&x(e=>e+1)},[A]),$=(0,r.useCallback)(()=>{x(e=>Math.max(0,e-1))},[]),L=(0,r.useCallback)(e=>{h(e),x(0)},[]),F=(0,r.useMemo)(()=>{let e=I?.pageInfo?.total;return"number"==typeof e&&Number.isFinite(e)?Math.max(1,Math.ceil(e/m)):p+(A?2:1)},[I?.pageInfo?.total,m,p,A]),O=(0,r.useMemo)(()=>({onNextPage:P,onPrevPage:$,onSetPageSize:L,pageCount:F}),[P,$,L,F]),B=(0,r.useMemo)(()=>{if(!k)return;let e=w?"DESC":"ASC";return`${k}&sortBy=${encodeURIComponent(v)}&sortDir=${e}`},[k,v,w]);if(M&&!I){let e=401===M.status||403===M.status?"You do not have permission to view inference requests":"Failed to load inference requests";return(0,t.jsx)("div",{className:"rounded-md border border-red-200 bg-red-50 p-4",children:(0,t.jsx)(a.ErrorCard,{title:e,error:M,reset:()=>void N()})})}return(0,t.jsx)(j,{data:R,customPagination:O,defaultPageSize:m,exportBaseUrl:B,externalPageIndex:p,onSortChange:e=>{e?(S(e.id),C(e.desc)):(S("timestamp"),C(!0)),x(0)},onSearchChange:e=>{y(e?.trim()?e:void 0),x(0)}})}e.s(["InferenceRequestsData",()=>v],9381025)},9494594,e=>{"use strict";var t=e.i(6468255);e.i(5335102);var i=e.i(6764151),r=e.i(2831393),a=e.i(2504781),n=e.i(8522580),s=e.i(6696646),l=e.i(3089600);function o(){let{hasVerifiedPaymentMethod:e,loading:o,mutate:c}=(0,r.useAiCreditsBalance)(),[u,d]=(0,s.useState)(!1);return(0,l.default)("modal",e=>{"add-credit-card"===e&&d(!0)}),o||e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Note,{fill:!0,action:(0,t.jsx)(a.Button,{size:"small",onClick:()=>{d(!0)},children:"Add a Card"}),children:"Verify your identity by adding a credit card and unlock $5 in free credits."}),(0,t.jsx)(i.CreditCardModal,{isActive:u,paying:!1,onAbort:()=>{d(!1)},onContinue:()=>{c(),d(!1)}})]})}e.s(["AddPaymentMethodModal",()=>o])},5502332,e=>{"use strict";var t=e.i(6468255),i=e.i(2504781),r=e.i(8522580),a=e.i(3911483),n=e.i(8042625),s=e.i(5338940),l=e.i(2471070),o=e.i(2936765),c=e.i(7432286);function u(){let{topups:e}=(0,l.useAiGatewayCreditTopups)(),{total:u,loading:d}=function(){let{start:e,end:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{team:i}=(0,s.useTeam)(),r="string"==typeof e?e:e?.toISOString(),l="string"==typeof t?t:t?.toISOString(),{data:o,error:c,isLoading:u,mutate:d}=(0,a.default)(i?.id&&r&&l?`/api/purchase-intents/aggregate${(0,n.encode)({teamId:i.id,start:r,end:l,property:"subtotal"})}`:null,async e=>{let t=await fetch(e);if(!t.ok)throw Error(t.statusText);return t.json()});return{count:o?.count,total:o?.total,loading:u,error:c,mutate:d}}({start:(0,c.startOfMonth)(new Date),end:(0,o.endOfMonth)(new Date)}),g=e?.[0]?.maximumMonthlySpend,m=null!=u&&null!=g&&Number(g)<=u,{mutate:h}=(0,a.default)("modal:ai-credits");return!d&&m?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.Note,{fill:!0,action:(0,t.jsx)(i.Button,{size:"small",onClick:()=>{h("auto_recharge")},children:"Update Monthly Spend Limit"}),children:"You have exceeded the monthly spend limit you've set for auto recharges. Auto recharges will be paused until you increase your monthly spend limit."})}):null}e.s(["IncreaseMonthlySpendLimitModal",()=>u],5502332)}]);

//# sourceMappingURL=dd37b83db8f891aa.js.map
//# debugId=eb1ae202-2af4-5037-bf60-cdae2cff7196
