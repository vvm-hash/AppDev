
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="86e37368-e564-58b8-83df-9586d11d1e38")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,6671454,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(5169576),n=e.i(9508212),r=e.i(2504781),l=e.i(8161149),s=e.i(119294),o=e.i(6352514),c=e.i(5338940),d=e.i(57106),u=e.i(4011256),h=e.i(1017032),g=e.i(7594446),p=e.i(8087728),m=e.i(5669250),x=e.i(7759431),f=e.i(8573953),j=e.i(2486836),y=e.i(3748432);function b(e){let{teamSlug:i,configurations:r}=e,{team:s}=(0,c.useTeam)(),{data:o}=(0,h.useConfigurations)({skipBillingData:!0}),g=(0,p.useInstalledIntegrationsFilters)({integrationInstallations:o??r});return 0===r.length?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Stack,{flex:1,gap:5,style:{width:"100%"},children:(0,t.jsx)(l.EmptyState.Root,{className:x.default.emptyState,description:"You don't have any integration installed.",icon:(0,t.jsx)(l.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Integrations Installed",children:(0,t.jsx)(d.ButtonLink,{href:(0,u.getBrowseMarketplaceLink)({teamSlugOrPublic:{teamSlug:i}}),type:"secondary",children:"Browse Marketplace"})})})}):(0,t.jsx)(v,{installationsWithFilters:g,team:s,teamSlug:i})}function k(e){let{externalCounter:i}=e;return(0,t.jsx)(n.Stack,{flex:1,gap:20,style:{width:"100%"},children:(0,t.jsxs)(n.Stack,{gap:5,children:[(0,t.jsx)(p.InstalledIntegrationsFiltersPlaceholder,{}),(0,t.jsx)("div",{className:x.default.integrationList,children:Array.from({length:i??3}).map((e,i)=>(0,t.jsx)(m.MarketplaceInstallationCardPlaceholder,{},`marketplace${i}`))})]})})}function v(e){let{teamSlug:c,team:d,installationsWithFilters:h}=e,{installationsByIntegration:b,legacyInstallations:k,search:v,onSearchChanged:C,onCategoryChanged:w,category:T,categories:I,onLoadNextPage:S,hasMorePages:N,installationType:A,onInstallationTypeChanged:P}=h,{isLoading:M,canCreateIntegrationConfiguration:L}=(0,g.useIntegrationPermissions)(),[_,R]=(0,i.useState)({active:!1,team:null}),E=e=>{let{id:t,slug:i}=e;s.analytics.track(o.AnalyticsEvent.INTEGRATION_OVERVIEW_MANAGE_CLICKED,{integration:{id:t,slug:i}})},D=(0,i.useCallback)(e=>R({active:!0,...e}),[]),O=(0,i.useCallback)(()=>R({..._,active:!1}),[_]);return(0,t.jsxs)(n.Stack,{flex:1,gap:20,style:{width:"100%"},children:[(0,t.jsxs)(n.Stack,{gap:5,children:[(0,t.jsx)(p.InstalledIntegrationsFilters,{categories:I,category:T,installationType:A,onCategoryChanged:w,onInstallationTypeChanged:P,onSearchChanged:C,search:v}),b.length>0?(0,t.jsxs)("div",{className:x.default.integrationList,children:[(0,t.jsx)(f.ReinstallationModal,{onCancel:O,state:_}),b.map((e,i)=>{let a=function(e,t,i,a){if(a&&!i&&1===e.installations.length){let i=e.installations[0].id;return"scopes-review"===e.requiredAction?(0,u.getPermissionsLink)({teamSlug:t,configurationId:i}):(0,u.getInstallationDetailsLink)({teamSlug:t,configurationId:i,integrationSlug:e.slug,isMarketplace:e.isMarketplace})}return(0,u.getIntegrationDetailsLink)({integrationSlug:e.slug,teamSlugOrPublic:{teamSlug:t},installationHash:!0})}(e,c,M,L);return(0,t.jsx)(y.ConditionalNavigationMarker,{enabled:0===i,phase:"content",label:"MarketplaceInstalledIntegrationsContent",children:(0,t.jsx)(m.InstallationCard,{integrationWithInstallations:e,link:a,onClick:()=>{switch(e.requiredAction){case"reinstall-log-drain":case"reinstall-log-drain-admin":D({configuration:{integrationId:e.integrationId,name:e.name,slug:e.slug,id:e.installations[0].id},team:d});break;default:E({id:e.integrationId,slug:e.slug})}}})},e.integrationId)})]}):(0,t.jsx)(l.EmptyState.Root,{className:x.default.emptyState,description:v?`Your search for "${v}" did not return any results.`:void 0,icon:(0,t.jsx)(l.EmptyState.Icon,{icon:(0,t.jsx)(a.Information,{size:32})}),secondary:!0,title:"No Results Found"}),N?(0,t.jsx)(r.Button,{onClick:S,type:"secondary",children:"Show More"}):null]}),k.length>0?(0,t.jsx)(j.LegacyIntegrations,{legacyInstallations:k,onCardClicked:E,teamSlug:c}):null]})}e.s(["InstalledIntegrations",()=>b,"MarketplaceInstalledIntegrationsPlaceholder",()=>k])},3999030,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(9508212),n=e.i(1344973),r=e.i(5255926),l=e.i(2504781),s=e.i(9100551),o=e.i(8544664);e.i(5628754);var c=e.i(9203481);e.i(5463680);var d=e.i(15312);e.i(553769);var u=e.i(3758860);e.i(6887680);var h=e.i(6810699),g=e.i(1909206),p=e.i(2483928),m=e.i(6315360),x=e.i(8525850),f=e.i(7594446),j=e.i(2704354);function y(e){let[r,l]=(0,i.useState)(4),s=e.integration,o=("products"in s?s.products:void 0)||[],{data:g}=(0,h.useResourceList)({integrationIdOrSlug:s.slug,integrationConfigurationId:e.configuration.id,skipMetadata:!0,fallbackData:e.resourcesData?{stores:e.resourcesData}:void 0}),p=(g?.stores?.length??0)>r,{isLoading:y,canCreateIntegrationConfiguration:k}=(0,f.useIntegrationPermissions)(),C=y||!k,T="single-product"===s.layout,I=g?.stores?.filter(t=>t.product.integrationConfigurationId===e.configuration?.id),S=I?.slice(0,r);return(I?.length===0||e.teamSlugOrPublic.isPublic)&&e.renderAllIntegrationProducts&&"products"in s&&(0,j.isMarketplaceIntegration)(s)?(0,t.jsx)(w,{title:`Products by ${s.createdBy}`,integration:s,products:o,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!C,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1}):T?null:(0,t.jsxs)(a.Stack,{gap:10,children:[I?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsx)(n.Text,{lineHeight:24,size:20,weight:600,children:e.label}),(0,t.jsxs)(a.Stack,{gap:4,children:[(0,t.jsx)("div",{className:m.default.marketplaceDetailsProductsGrid,children:S?.map(i=>(0,t.jsx)(d.ResourceModalsProvider,{protocolType:(0,u.getPrimaryProtocolByProduct)(i.product),children:(0,t.jsx)(c.ResourceItem,{item:i,resourceLinkFunc:()=>(0,x.getResourceDetailsPath)(i,e.teamSlugOrPublic.teamSlug??""),showCreatedAt:!1})},i.id))}),p?(0,t.jsx)(b,{onClick:function(){l(r+4)}}):null]})]})}):(0,t.jsx)(v,{}),e.renderAllIntegrationProducts&&"products"in s&&(0,j.isMarketplaceIntegration)(s)?(0,t.jsx)(w,{title:"More Products",integration:s,products:o,teamSlugOrPublic:e.teamSlugOrPublic,disabled:e.disabled||!!e.configuration?.deleteRequestedAt,allowInstallation:!C,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout||!1}):null]})}function b(e){return(0,t.jsx)(l.Button,{onClick:()=>{window.requestAnimationFrame(e.onClick)},type:"secondary",children:"Load More"})}function k(){let e=(0,s.useParams)();return(0,o.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0)?(0,t.jsxs)(a.Stack,{gap:10,children:[(0,t.jsx)(v,{}),(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsx)(n.Text,{lineHeight:24,size:20,weight:600,children:"More Products"}),(0,t.jsx)(C,{count:1,hasAvatar:!1,hasTitle:!0})]})]}):(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsx)(n.Text,{lineHeight:24,size:20,weight:600,children:(0,t.jsx)(r.Skeleton,{width:200})}),(0,t.jsx)(C,{count:4,hasAvatar:!1,hasTitle:!1}),(0,t.jsx)("div",{className:"h-[200px]"})]})}function v(){let e=(0,s.useParams)(),i=(0,o.usePlaceholderCount)(`installed-products:${e?.teamSlug}-${e?.slug}`,void 0);return i?(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsx)(n.Text,{lineHeight:24,size:20,weight:600,children:"Installed Products"}),(0,t.jsx)(C,{count:Math.min(i,4),hasAvatar:!0,hasTitle:!0}),i&&i>4?(0,t.jsx)("div",{className:"h-[40px]"}):null]}):null}function C(e){return(0,t.jsx)("div",{className:m.default.marketplaceDetailsProductsGrid,children:Array.from({length:e.count}).map((i,a)=>(0,t.jsx)(p.MarketplaceProductDetailsCardPlaceholder,{hasAvatar:e.hasAvatar,hasTitle:e.hasTitle},`product${a}`))})}function w(e){return(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsx)(n.Text,{lineHeight:24,size:20,weight:600,children:e.title}),(0,t.jsx)(g.InstallMarketplaceProductProvider,{teamSlugOrPublic:e.teamSlugOrPublic,displayModalsInline:!1,children:(0,t.jsx)("div",{className:m.default.marketplaceDetailsProductsGrid,children:e.products.map(i=>(0,t.jsx)(p.MarketplaceProductDetailsCard,{disabled:!e.allowInstallation||e.disabled,hasAvatar:!0,integration:e.integration,product:i,teamSlugOrPublic:e.teamSlugOrPublic,enableMarketplaceNewCheckout:e.enableMarketplaceNewCheckout,tooltip:e.allowInstallation?void 0:"You don't have permission to install this product"},i.id))})})]})}e.s(["MarketplaceDetailsProducts",()=>y,"ProductsOrResourcesPlaceholder",()=>k])},3690352,e=>{e.v({button:"integration-video-player-module__Gy_CcG__button",loading:"integration-video-player-module__Gy_CcG__loading",play:"integration-video-player-module__Gy_CcG__play","play-icon":"integration-video-player-module__Gy_CcG__play-icon",player:"integration-video-player-module__Gy_CcG__player"})},8447345,e=>{e.v({gallery:"details-gallery-module__uxYlVW__gallery",grayscale:"details-gallery-module__uxYlVW__grayscale",image:"details-gallery-module__uxYlVW__image","image-skeleton":"details-gallery-module__uxYlVW__image-skeleton","image-wrapper":"details-gallery-module__uxYlVW__image-wrapper",wrapper:"details-gallery-module__uxYlVW__wrapper"})},2434652,e=>{"use strict";var t=e.i(6468255),i=e.i(5255926),a=e.i(9739627),n=e.i(9508212),r=e.i(6696646);let l=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M13.4549 7.22745L13.3229 7.16146L2.5 1.74999L2.4583 1.72914L1.80902 1.4045L1.3618 1.18089C1.19558 1.09778 1 1.21865 1 1.4045L1 1.9045L1 2.63041L1 2.67704L1 13.3229L1 13.3696L1 14.0955L1 14.5955C1 14.7813 1.19558 14.9022 1.3618 14.8191L1.80902 14.5955L2.4583 14.2708L2.5 14.25L13.3229 8.83852L13.4549 8.77253L14.2546 8.37267L14.5528 8.2236C14.737 8.13147 14.737 7.86851 14.5528 7.77638L14.2546 7.62731L13.4549 7.22745ZM11.6459 7.99999L2.5 3.42704L2.5 12.5729L11.6459 7.99999Z" fill="currentColor"/>');var s=e.i(8735244),o=e.i(6891161),c=e.i(3690352);function d(e){let{videoId:i}=e,[a,n,d]=(()=>{let[e,t]=(0,r.useState)(!1);return[e,(0,r.useCallback)(()=>t(!0),[]),(0,r.useCallback)(()=>t(!1),[])]})(),[u,h]=(0,r.useState)(!0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:c.default.button,onClick:n,type:"button",children:(0,t.jsx)("div",{className:c.default.play,children:(0,t.jsx)("div",{className:c.default["play-icon"],children:(0,t.jsx)(l,{})})})}),(0,t.jsx)(o.Modal.Modal,{active:a,drawer:!1,onClickOutside:d,width:"80vw",children:(0,t.jsxs)("div",{className:c.default.player,children:[u?(0,t.jsx)("div",{className:c.default.loading,children:(0,t.jsx)(s.Spinner,{size:64})}):null,(0,t.jsx)("iframe",{allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,frameBorder:"0",height:"100%",onLoad:()=>h(!1),referrerPolicy:"no-referrer",src:`https://www.youtube.com/embed/${i}`,title:"Integration video player",width:"100%"})]})})]})}function u(e){let{src:i}=e,a=i.startsWith("https://img.youtube.com/vi/")?(i.split("https://img.youtube.com/vi/").pop()||"").split("/0.jpg").shift():null;return a?(0,t.jsx)(d,{videoId:a}):null}var h=e.i(8447345);function g(e){let{images:r,grayscale:l}=e;return(0,t.jsx)("div",{className:h.default.gallery,children:(0,t.jsx)(n.Stack,{className:h.default.wrapper,direction:"row",gap:4,style:{"--width":`${504*(r.length||1)}px`},children:0===r.length?(0,t.jsx)("div",{className:h.default["image-wrapper"],children:(0,t.jsx)("div",{className:h.default.image,children:(0,t.jsx)(i.Skeleton,{className:h.default["image-skeleton"],height:"var(--skeleton-height)",width:"var(--skeleton-width)"})})}):r.map((e,i)=>{let n="string"==typeof e?e:`https:${e.fields.file.url}`,r="string"==typeof e?"":e.fields.description,s={srcDark:n,srcLight:n,layout:"fill",objectFit:"cover",priority:i<=2};return(0,t.jsx)("div",{className:h.default["image-wrapper"],children:(0,t.jsx)("div",{className:h.default.image,children:"string"==typeof e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u,{src:n}),(0,t.jsx)(a.Image,{...s,alt:r})]}):(0,t.jsx)(a.Image,{...s,alt:r,className:l?h.default.grayscale:void 0})})},n)})})})}e.s(["DetailsGallery",()=>g],2434652)},943709,e=>{"use strict";var t=e.i(6468255),i=e.i(5328446),a=e.i(4138437),n=e.i(1344973),r=e.i(2504781),l=e.i(6891161),s=e.i(455575),o=e.i(6696646),c=e.i(5338940),d=e.i(8797711),u=e.i(6111613),h=e.i(2333337),g=e.i(9508212),p=e.i(1914640),m=e.i(2452025);function x(e){let{configuration:i,billingPlan:a,header:r,onNext:s,onBack:o,cancelLabel:c}=e;return(0,t.jsx)(m.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{onClick:s,children:"Confirm"}),cancelLabel:c,header:r,onBack:o,children:(0,t.jsxs)(g.Stack,{gap:4,children:[(0,t.jsx)(n.Text,{size:16,weight:500,children:"Billing Plan"}),(0,t.jsx)(p.ReadOnlyPanel,{title:"Selected Billing Plan",children:(0,t.jsx)(p.ReadOnlyBillingPlan,{billingPlan:a})})]})})}var f=e.i(5255926),j=e.i(9544652),y=e.i(8843717),b=e.i(4987761),k=e.i(7743427),v=e.i(9471356),C=e.i(9588822),w=e.i(57106);function T(e){let{integration:i,onAccept:a,onBack:r,cancelLabel:s}=e;return(0,t.jsx)(m.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",onClick:()=>{let e=new Date().toISOString(),t={};i.eulaDocUri&&(t.eula=e),i.privacyDocUri&&(t.privacy=e),a(t)},children:"Accept and Continue"}),cancelLabel:s,header:(0,t.jsx)(m.ModalWrapperHeader,{title:"Accept Terms & Conditions",subtitle:"Please review the following policies."}),onBack:r,children:(0,t.jsx)(g.Stack,{gap:4,children:(0,t.jsxs)(g.Stack,{gap:1,children:[(0,t.jsx)("p",{children:'By clicking "Accept and Continue", you agree to:'}),(0,t.jsxs)(n.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsx)(w.Link,{external:!0,href:"/legal/integration-marketplace-end-users-addendum",type:"primary",children:"Vercel Integration Marketplace End User Addendum"})]}),i.eulaDocUri?(0,t.jsxs)(n.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(w.Link,{external:!0,href:i.eulaDocUri,type:"primary",children:[i.name," EULA"]})]}):null,i.privacyDocUri?(0,t.jsxs)(n.Text,{children:[(0,t.jsx)("span",{className:"pr-1",children:"• "}),(0,t.jsxs)(w.Link,{external:!0,href:i.privacyDocUri,type:"primary",children:[i.name," Privacy Policy"]})]}):null]})})})}function I(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:r}=e,l=(0,c.useTeam)(),{data:s,isLoading:d}=(0,k.useIntegration)(i.integrationId),u=l.team,h=l.isLoading||d,[g,p]=(0,o.useTransition)(),m=u&&s;return(0,t.jsx)(j.DisabledContext.Provider,{value:h||g,children:m?(0,t.jsx)(N,{configuration:i,transferRequest:a,team:u,integration:s,onCancel:n,onDone:r,isTransitioning:g,startTransition:p}):(0,t.jsx)(S,{cancelLabel:"Cancel",onBack:n})})}function S(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(m.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(m.ModalWrapperHeader,{subtitle:(0,t.jsx)(f.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account to Vercel"}),onBack:i,children:(0,t.jsx)(f.Skeleton,{height:"40px",width:400})})}let N=(0,C.withStripe)(function(e){let{configuration:i,transferRequest:a,team:n,integration:r,onCancel:l,onDone:s,isTransitioning:c,startTransition:p}=e,[f,j]=(0,o.useState)("policies"),[k,C]=(0,o.useState)({}),w=a.billingPlan,I=i.id,{data:S}=(0,y.useInstallationPaymentMethodState)({integrationConfigurationId:I}),{createAuthorization:N}=(0,b.useMarketplaceBillingAuthorizationApi)(),A=(0,b.useAwaitAuthorization)(),[P,M]=(0,o.useState)(null),[L,_]=(0,o.useState)(!1),[R,E]=(0,o.useState)(void 0),[D,O]=(0,o.useState)(!1),B=(0,t.jsx)(m.ModalWrapperHeader,{subtitle:(0,t.jsx)(g.Stack,{align:"center",as:"span",direction:"row",gap:1,children:i.name||i.slug}),title:"Transfer Your Account to Vercel"}),F=()=>{j("provisioning"),_(!1),E(void 0);let e=async()=>{try{let e=await N(n.id,{integrationIdOrSlug:i.integrationId,integrationConfigurationId:i.id,transferRequestId:a.requestId,billingPlanId:a.billingPlan.id,metadata:{}});if(M(e?.id??null),!e)throw Error("Authorization creation failed");let t=await A(n.id,e.id);if("succeeded"!==t.status)return;await (0,v.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/to-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId,authorizationId:e.id,acceptedPolicies:k}),_(!0)}catch(e){E("Failed to transfer account")}};p(()=>{e()})};switch(f){case"policies":return(0,t.jsx)(T,{integration:r,onAccept:e=>{C(e),j("confirm")},onBack:l,cancelLabel:"Cancel"});case"confirm":return(0,t.jsx)(x,{configuration:i,billingPlan:w,header:B,onNext:()=>{!S||(0,u.getIsPaymentMethodStepNeeded)(n,S,w)||D?j("payment-method"):F()},onBack:l,cancelLabel:"Cancel"});case"payment-method":return S?(0,t.jsx)(d.PaymentMethodStep,{header:B,installationId:I,onBack:()=>j("confirm"),onNext:()=>{O(!1),F()},paymentMethodState:S,requireNew:D,team:n}):null;case"provisioning":return(0,t.jsx)(h.ProvisioningStep,{authorizationId:P,complete:L,error:R,header:B,isTransitioning:!L||c,onBack:()=>j("payment-method"),onChangePaymentMethod:()=>{O(!0),j("payment-method")},onNext:()=>{p(()=>{s()})},successMessage:"Your account has been transferred successfully",teamId:n.id});default:return null}});var A=e.i(9100551),P=e.i(1509709),M=e.i(4011256);function L(e){let{integration:d,configurationId:u}=e,[h,g]=(0,o.useState)(!1),[p,m]=(0,o.useTransition)(),{data:x,mutate:f}=(0,i.default)(u),j=(0,s.useToasts)(),y=(0,A.useRouter)(),b=(0,c.useTeam)().team,k=x?.transferRequest;if(!x||k?.kind!=="transfer-to-marketplace")return null;let C=()=>{g(!1)},w=async()=>{try{await (0,v.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:b?.id,integrationConfigurationId:x.id},{requestId:k.requestId}),await f()}catch(e){(0,P.captureException)(e),j.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsx)(n.Text,{size:24,children:"Transfer your account from ACME to Vercel"}),(0,t.jsx)(n.Text,{children:"All your resources will be transferred to Vercel. After the transfer is complete, your billing will be handled by Vercel and you’ll use their platform to manage your resources."}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(r.Button,{onClick:()=>{w()},disabled:p,type:"secondary",children:"Discard"}),(0,t.jsx)(r.Button,{onClick:()=>{m(()=>{g(!0)})},loading:p,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(l.Modal,{active:h,onClickOutside:C,children:(0,t.jsx)(I,{configuration:x,transferRequest:k,onDone:()=>{C(),y.replace((0,M.getIntegrationInstallationLink)(b?.slug||"",d.slug,x.id))},onCancel:C})})]})}e.s(["RequestTransferToVercelNotification",()=>L],943709)},417098,e=>{"use strict";var t=e.i(6468255),i=e.i(5328446),a=e.i(4138437),n=e.i(1344973),r=e.i(2504781),l=e.i(6891161),s=e.i(455575),o=e.i(6696646),c=e.i(9100551),d=e.i(5338940),u=e.i(9471356),h=e.i(1509709),g=e.i(9508212),p=e.i(2452025);function m(e){let{configuration:i,header:a,onNext:r,onBack:s,cancelLabel:o}=e;return(0,t.jsx)(p.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{onClick:r,children:"Confirm"}),cancelLabel:o,header:a,onBack:s,children:(0,t.jsx)(g.Stack,{gap:4,children:(0,t.jsx)(n.Text,{size:16,weight:500,children:"some information on the transfer"})})})}var x=e.i(5255926),f=e.i(9544652),j=e.i(8735244);function y(e){let{header:i,isTransitioning:a,onNext:r,onBack:s,complete:o,error:c}=e;return(0,t.jsx)(p.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{disabled:!o,loading:!o||a,onClick:r,children:o?"Done":"Processing"}),cancelLabel:"Back",disableCancel:!o,header:i,onBack:s,children:(0,t.jsxs)(g.Stack,{gap:4,children:[o?(0,t.jsx)(n.Text,{weight:500,children:"Provisioning complete."}):(0,t.jsxs)(g.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(j.Spinner,{size:16}),(0,t.jsx)(n.Text,{size:16,weight:500,children:"Processing"})]}),c?(0,t.jsx)(n.Text,{size:14,children:c}):null]})})}function b(e){let{configuration:i,transferRequest:a,onCancel:n,onDone:r}=e,l=(0,d.useTeam)(),s=l.team,c=l.isLoading,[u,h]=(0,o.useTransition)();return(0,t.jsx)(f.DisabledContext.Provider,{value:c||u,children:s?(0,t.jsx)(k,{configuration:i,transferRequest:a,team:s,onCancel:n,onDone:r,isTransitioning:u,startTransition:h}):(0,t.jsx)(v,{cancelLabel:"Cancel",onBack:n})})}function k(e){let{configuration:i,transferRequest:a,team:n,onCancel:r,onDone:l,isTransitioning:s,startTransition:c}=e,[d,h]=(0,o.useState)("confirm"),[x,f]=(0,o.useState)(!1),[j,b]=(0,o.useState)(void 0),k=(0,t.jsx)(p.ModalWrapperHeader,{subtitle:(0,t.jsx)(g.Stack,{align:"center",as:"span",direction:"row",gap:1,children:i.name||i.slug}),title:"Transfer Your Account from Vercel"});switch(d){case"confirm":return(0,t.jsx)(m,{configuration:i,header:k,onNext:()=>{h("processing"),f(!1),b(void 0);let e=async()=>{try{await (0,u.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/from-marketplace","post",{teamId:n.id,integrationConfigurationId:i.id},{requestId:a.requestId}),f(!0)}catch(e){b("Failed to transfer account")}};c(()=>{e()})},onBack:r,cancelLabel:"Cancel"});case"processing":return(0,t.jsx)(y,{header:k,isTransitioning:s,onNext:()=>{c(()=>{l()})},onBack:r,complete:x,error:j});default:return null}}function v(e){let{onBack:i,cancelLabel:a}=e;return(0,t.jsx)(p.ModalWrapper,{SuccessAction:(0,t.jsx)(l.Modal.Action,{buttonType:"submit",disabled:!0,loading:!0,children:"..."}),cancelLabel:a,header:(0,t.jsx)(p.ModalWrapperHeader,{subtitle:(0,t.jsx)(x.Skeleton,{height:"20px",width:80}),title:"Transfer Your Account from Vercel"}),onBack:i,children:(0,t.jsx)(x.Skeleton,{height:"40px",width:400})})}function C(e){let{integration:g,configurationId:p}=e,[m,x]=(0,o.useState)(!1),[f,j]=(0,o.useTransition)(),{data:y,mutate:k}=(0,i.default)(p),v=(0,s.useToasts)(),C=(0,c.useRouter)(),w=(0,d.useTeam)().team,T=y?.transferRequest;if(!y||T?.kind!=="transfer-from-marketplace")return null;let I=()=>{x(!1)},S=async()=>{try{await (0,u.clientTypedFetchData)("/v1/integrations/installations/{integrationConfigurationId}/transfers/discard","post",{teamId:w?.id,integrationConfigurationId:y.id},{requestId:T.requestId}),await k()}catch(e){(0,h.captureException)(e),v.error("Failed to discard transfer request. Please try again.")}};return(0,t.jsxs)("section",{className:"mx-auto my-0 max-w-[520px] rounded-lg p-4",children:[(0,t.jsxs)(a.Card,{border:!0,shadow:!0,className:"max-w-[600px] p-4",children:[(0,t.jsxs)(n.Text,{size:24,children:["Transfer your account from ",g.name," to Vercel"]}),(0,t.jsxs)(n.Text,{children:["All your resources will be transferred to ",g.name,". After the transfer is complete, your billing will be handled by"," ",g.name," and you’ll use their platform to manage your resources."]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(r.Button,{onClick:()=>{S()},disabled:f,type:"secondary",children:"Discard"}),(0,t.jsx)(r.Button,{onClick:()=>{j(()=>{x(!0)})},loading:f,className:"ml-auto",children:"Proceed with transfer"})]})]}),(0,t.jsx)(l.Modal,{active:m,onClickOutside:I,children:(0,t.jsx)(b,{configuration:y,transferRequest:T,onDone:()=>{I(),C.replace(`/${w?.slug}/~/integrations/${g.slug}/${p}`)},onCancel:I})})]})}e.s(["RequestTransferFromVercelNotification",()=>C],417098)},3942353,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(2504781),n=e.i(6318858),r=e.i(5366204),l=e.i(9844152),s=e.i(4201247);function o(e){let{integrationSlug:o}=e,[c,d]=(0,i.useState)(!1);async function u(){let e=`https://vercel.com/marketplace/${o}`;try{await navigator.clipboard.writeText(e),d(!0),setTimeout(()=>{d(!1)},2e3)}catch(e){}}return o?(0,t.jsx)(l.AnimatePresence,{mode:"wait",children:c?(0,t.jsxs)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"top-px flex h-4 items-center gap-1 p-1",children:[(0,t.jsx)(n.Check,{color:"green-700",size:12}),(0,t.jsx)("span",{className:"text-xs leading-none text-green-700",children:"URL copied"})]},"success"):(0,t.jsx)(s.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},className:"flex h-4 items-center",children:(0,t.jsx)(a.Button,{variant:"unstyled",className:"top-px flex items-center rounded p-1 text-[var(--accents-3)] transition-all duration-300 hover:bg-gray-200 disabled:hover:cursor-default disabled:hover:bg-transparent [&>span]:inline-flex [&>span]:h-fit [&>span]:items-center [&>span]:justify-center [&>span]:p-0",size:"tiny",onClick:()=>{u()},children:(0,t.jsx)(r.Link,{size:12})})},"normal")}):null}e.s(["IntegrationPublicUrlShareButton",()=>o])},3646190,e=>{"use strict";var t=e.i(6468255),i=e.i(5328446),a=e.i(7426968);function n(e){let{configurationId:n}=e,{data:r}=(0,i.default)(n);return(0,t.jsx)(a.NotificationCallout,{notification:r?.notification,ssoParams:{integrationConfigurationId:r?.id,teamIdOrSlug:r?.teamId}})}e.s(["InstallationStatus",()=>n])},2007186,e=>{e.v({detailsSection:"details-sidebar-module__IOjKpW__detailsSection",detailsWrapper:"details-sidebar-module__IOjKpW__detailsWrapper"})},2171370,e=>{"use strict";var t=e.i(6468255),i=e.i(9508212),a=e.i(1344973),n=e.i(5255926),r=e.i(5468328),l=e.i(4011256),s=e.i(57106);e.i(6887680);var o=e.i(9219571),c=e.i(6810699),d=e.i(2007186);function u(e){let{integration:n,Support:r}=e;if(!n)return(0,t.jsxs)(i.Stack,{gap:2,children:[(0,t.jsx)(m,{}),(0,t.jsx)(m,{}),(0,t.jsx)(m,{}),(0,t.jsx)(m,{})]});let l="object"==typeof n&&"products"in n,o="single-product"===n.layout,c=[];if(l&&o){let e=n.products?.[0];c=e?.resourceLinks??[]}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p,{title:"Developer",value:n.createdBy}),(0,t.jsx)(p,{title:"Website",truncate:!0,value:n.website?(0,t.jsx)(s.Link,{href:n.website,type:"highlight",children:n.website.replace(/https?:\/\//,"").replace(/\/$/,"")}):null}),(0,t.jsx)(p,{title:"Documentation",value:n.documentationUri?(0,t.jsx)(s.Link,{external:!0,href:n.documentationUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(p,{title:"EULA",value:n.eulaDocUri?(0,t.jsx)(s.Link,{external:!0,href:n.eulaDocUri,type:"highlight",children:"Read"}):null}),(0,t.jsx)(p,{title:"Privacy Policy",value:n.privacyDocUri?(0,t.jsx)(s.Link,{external:!0,href:n.privacyDocUri,type:"highlight",children:"Read"}):null}),r??(0,t.jsx)(p,{title:"Support",tooltip:"Need help? Reach out to your integration partner for support.",truncate:!0,value:n.supportUri?(0,t.jsxs)(s.Link,{external:!0,href:n.supportUri,prefetch:!1,type:"highlight",children:["Open in ",n.name]}):n.supportContactEmail?(0,t.jsx)(s.Link,{external:!0,href:n.supportContactEmail.includes("@")?`mailto:${n.supportContactEmail}`:n.supportContactEmail,type:"highlight",children:n.supportContactEmail}):null,wrapTitle:!0}),c.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(a.Text,{lineHeight:24,size:20,weight:600,className:"mt-6",children:"Resources"}),(0,t.jsx)("div",{children:c.map(e=>(0,t.jsx)(p,{title:e.title,value:(0,t.jsx)(s.Link,{href:e.href,type:"highlight",external:!0,children:"Read"})},e.title))})]})]})}function h(e){let{configuration:i}=e,{data:a}=(0,o.useMarketplaceBillingBalance)(i.id),n=a?.balance?.currencyValueInCents??i.billingData?.credit?.balanceTotalCent;return void 0===n?null:(0,t.jsx)(p,{title:"Prepaid Balance",value:(0,l.formatMarketplaceBillingTotal)(n/100)})}function g(e){let{integrationIdOrSlug:i,integrationConfigurationId:a,teamSlug:r}=e,{data:l}=(0,c.useResourceList)({teamSlug:r,integrationIdOrSlug:i,integrationConfigurationId:a});return(0,t.jsx)(p,{title:"Installed products",value:l?.stores.length??(0,t.jsx)(n.Skeleton,{height:20,width:10})})}function p(e){let{title:n,value:l,truncate:s,wrapTitle:o,tooltip:c}=e;return l?(0,t.jsx)("div",{className:d.default.detailsSection,children:(0,t.jsxs)(i.Stack,{direction:"row",gap:4,justify:"space-between",children:[(0,t.jsx)(r.Tooltip,{text:c,children:(0,t.jsx)(a.Text,{wrap:o,children:n})}),(0,t.jsx)(a.Text,{truncate:s,children:l})]})}):null}function m(){return(0,t.jsx)("div",{className:d.default.detailsSection,children:(0,t.jsxs)(i.Stack,{direction:"row",gap:4,justify:"space-between",children:[(0,t.jsx)(n.Skeleton,{height:18,width:"40%"}),(0,t.jsx)(n.Skeleton,{height:18,width:"40%"})]})})}e.s(["DetailSidebar",()=>u,"MarketplaceSidebarBalance",()=>h,"MarketplaceSidebarDetailSection",()=>p,"MarketplaceSidebarResourceCount",()=>g])},3967785,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(8248823),n=e.i(8761240),r=e.i(2504781),l=e.i(455575),s=e.i(5140444),o=e.i(1857939),c=e.i(57106),d=e.i(1119178),u=e.i(2704354);function h(e){let{integration:i}=e,{isLoggedOut:a}=(0,o.useIsLoggedIn)();return(0,u.isCodeRepository)(i)?(0,t.jsxs)(c.ButtonLink,{href:a?"/signup":"/new",children:["Continue with ",i.name]}):null}function g(e){let{integration:i}=e;return(0,u.hasCustomCta)(i)&&i.ctaUrl?(0,t.jsx)(c.ButtonLink,{href:i.ctaUrl,children:i.ctaText}):null}function p(e){let{integration:o}=e,{user:h}=(0,s.useUser)(),g=(0,l.useToasts)(),[p,m]=(0,i.useState)(!1),[x,f]=(0,i.useState)(!1),j=async()=>{if(h?.email&&h.uid){f(!0);try{await (0,u.requestIntegration)({userId:h.uid,email:h.email,slug:o.slug}),g.success("Request submitted successfully."),m(!0)}catch(e){g.error((0,a.errorToString)(e))}finally{f(!1)}}};return h?(0,t.jsx)(r.Button,{disabled:x||p,loading:x,onClick:(0,d.promiseToCallback)(j),prefix:p?(0,t.jsx)(n.CheckCircleFill,{color:"green-700"}):void 0,children:p?"Requested":"Request Integration"}):(0,t.jsx)(c.ButtonLink,{href:"#request",children:"Request Integration"})}function m(e){let{integration:i}=e;return(0,u.isCodeRepository)(i)||(0,u.hasCustomCta)(i)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h,{integration:i}),(0,t.jsx)(g,{integration:i})]}):(0,t.jsx)(p,{integration:i})}e.s(["ContentfulIntegrationButton",()=>m])},9811698,e=>{e.v({button:"request-form-module__8eWAma__button",label:"request-form-module__8eWAma__label",wrapper:"request-form-module__8eWAma__wrapper"})},3252593,e=>{e.v({content:"contentful-integration-details-module__10dLUa__content","mdx-container":"contentful-integration-details-module__10dLUa__mdx-container"})},5267109,e=>{"use strict";var t=e.i(6468255),i=e.i(9508212),a=e.i(1344973),n=e.i(1857939),r=e.i(7775029),l=e.i(2704354),s=e.i(6696646),o=e.i(8248823),c=e.i(2504781),d=e.i(3500331),u=e.i(9318197),h=e.i(455575),g=e.i(9811698);function p(e){let{children:i}=e;return(0,t.jsx)("span",{className:g.default.label,children:i})}let m={background:"var(--input-background)"};function x(e){let{slug:a}=e,[n,r]=(0,s.useState)(""),[x,f]=(0,s.useState)(""),[j,y]=(0,s.useState)(""),[b,k]=(0,s.useState)(!1),v=(0,h.useToasts)(),C=async e=>{e.preventDefault(),k(!0);try{await (0,l.requestIntegration)({firstName:n,lastName:x,email:j,slug:a}),r(""),f(""),y(""),v.success("Request submitted successfully.")}catch(e){v.error((0,o.errorToString)(e))}finally{k(!1)}};return(0,t.jsx)("div",{className:g.default.wrapper,children:(0,t.jsxs)("form",{onSubmit:C,children:[(0,t.jsxs)(i.Stack,{direction:"column",gap:6,children:[(0,t.jsxs)(i.Stack,{direction:{sm:"column",md:"row",lg:"row"},gap:6,children:[(0,t.jsx)(d.Input,{disabled:b,id:"integrations-first-name",label:(0,t.jsx)(p,{children:"First Name"}),maxLength:40,name:"firstName",onChange:e=>r(e.target.value),pattern:".*\\S+.*",placeholder:"Jane",required:!0,style:m,title:"This field cannot be blank.",value:n,width:"100%"}),(0,t.jsx)(d.Input,{disabled:b,id:"integrations-last-name",label:(0,t.jsx)(p,{children:"Last Name"}),maxLength:40,name:"lastName",onChange:e=>f(e.target.value),pattern:".*\\S+.*",placeholder:"Doe",required:!0,style:m,title:"This field cannot be blank.",value:x,width:"100%"})]}),(0,t.jsx)(i.Stack,{children:(0,t.jsx)(d.Input,{disabled:b,id:"integrations-email",label:(0,t.jsx)(p,{children:"Email"}),maxLength:40,name:"email",onChange:e=>y(e.target.value),placeholder:"janedoe@example.com",required:!0,style:m,title:"This field cannot be blank.",typeName:"email",value:j,width:"100%"})})]}),(0,t.jsx)(u.Spacer,{y:2}),(0,t.jsx)("div",{className:g.default.button,children:(0,t.jsx)(c.Button,{loading:b,size:"large",children:"Request Integration"})})]})})}var f=e.i(3252593);function j(e){let{integration:s}=e,{isLoading:o,isLoggedOut:c}=(0,n.useIsLoggedIn)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Stack,{direction:"column",gap:4,children:[(0,t.jsx)(a.Text,{lineHeight:24,size:20,weight:600,children:"Overview"}),(0,t.jsx)("div",{className:f.default["mdx-container"],children:(0,r.renderContentfulDocument)(s.overview)})]}),o||!c||(0,l.isCodeRepository)(s)?null:(0,t.jsxs)(i.Stack,{direction:"column",gap:4,children:[(0,t.jsx)("div",{id:"request",children:(0,t.jsx)(a.Text,{lineHeight:24,size:20,weight:600,children:"Request Integration"})}),(0,t.jsx)(x,{slug:s.slug})]})]})}e.s(["RequestContentfulIntegration",()=>j],5267109)},1003898,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(5338940),n=e.i(7275883),r=e.i(9508212),l=e.i(1344973),s=e.i(6881349),o=e.i(8161149);e.i(2815631);var c=e.i(5225151),d=e.i(2800132),u=e.i(266062),h=e.i(1091997),g=e.i(3911483),p=e.i(277234),m=e.i(4244280);e.i(3092247);var x=e.i(397510),f=e.i(4011256);function j(e){var f;let{integration:j,stores:k,teamSlug:v,integrationConfigurationId:C,integrationSlug:w,resourceId:T}=e,[I,S]=(0,i.useState)("week"),{team:N}=(0,a.useTeam)(),A=(f=N?{integrationConfigurationId:C,teamId:N.id,period:I}:null,(0,g.default)(()=>{if(!f)return null;let{integrationConfigurationId:e,teamId:t,period:i}=f,a=new URLSearchParams;return a.append("teamId",t),a.append("period",i),`${m.API_INTEGRATION_CONTROLLER_V2}/installations/${e}/billing/data/series?${a.toString()}`},p.fetchAPI)),P=(0,i.useMemo)(()=>{let e,t,i;if(!A.data?.byResource||!A.data.installation)return null;if(A.data.installation.credit?.balanceTotalCent.length){let t=new Map;A.data.installation.credit.balanceTotalCent.forEach(e=>{let i=new Date(e.timestamp).getTime();t.has(i)||t.set(i,{date:i,records:{}});let a=t.get(i);a&&(a.records.Total=e.value/100)}),A.data.byResource.forEach(e=>{let i=e.externalResourceId;i&&e.credit?.balanceTotalCent.length&&e.credit.balanceTotalCent.forEach(e=>{let a=new Date(e.timestamp).getTime();t.has(a)||t.set(a,{date:a,records:{}});let n=t.get(a),r=k.find(e=>e.externalResourceId===i)?.name;n&&r&&(n.records[r]=e.value/100)})}),e=t.size>0?Array.from(t.values()):void 0}if(A.data.installation.spending?.totalCent.length){let e=new Map;A.data.installation.spending.totalCent.forEach(t=>{let i=new Date(t.timestamp).getTime();e.has(i)||e.set(i,{date:i,records:{}});let a=e.get(i);a&&(a.records.Total=t.value/100)}),A.data.byResource.forEach(t=>{let i=t.externalResourceId;i&&t.spending?.totalCent.length&&t.spending.totalCent.forEach(t=>{let a=new Date(t.timestamp).getTime();e.has(a)||e.set(a,{date:a,records:{}});let n=e.get(a),r=k.find(e=>e.externalResourceId===i)?.name;n&&r&&(n.records[r]=t.value/100)})}),t=e.size>0?Array.from(e.values()):void 0}if(A.data.installation.usage?.byMetrics.length){let e=new Map;A.data.installation.usage.byMetrics.forEach(t=>{t.usageItems.forEach(i=>{let a=e.get(t.name)?.map;a||(a=new Map,e.set(t.name,{type:t.type,units:t.units,map:a}));let n=new Date(i.timestamp).getTime();a.has(n)||a.set(n,{date:n,records:{}});let r=a.get(n);r&&(r.records.Total=i.value)})}),i=Array.from(e.entries()).map(e=>{let[t,{type:i,units:a,map:n}]=e;return{metric:{name:t,type:i,units:a},data:Array.from(n.values())}})}return{noData:!e&&!t&&!i,prepayment:e,subscription:t,usageByMetric:i}},[A.data,k]);return A.isLoading?(0,t.jsx)(b,{dimensions:k.length}):!P||P.noData?(0,t.jsx)(o.EmptyState.Root,{description:"edgedb"===w?"There are no data available yet for this period.":"Usage tracking is not yet available for this service.",icon:(0,t.jsx)(o.EmptyState.Icon,{icon:(0,t.jsx)(n.ChartBarPeak,{}),size:32}),paddingY:200,secondary:!0,title:"No data available",children:(0,t.jsx)(x.OpenInPartnerDashboardButton,{componentType:"button",buttonVariant:"secondary",integrationConfigurationId:C,label:`See usage in ${j.name}`,teamIdOrSlug:N?.id,path:"usage"})}):(0,t.jsxs)(r.Stack,{gap:5,children:[T?(0,t.jsx)(d.ResourceUsageCharts,{resourceId:T}):(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsx)(l.Text,{lineHeight:24,size:20,weight:600,children:"Usage Report"}),(0,t.jsxs)(s.Combobox,{clearable:!1,noInputPrefix:!0,onChange:e=>{e&&S(e)},value:I,width:140,children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsxs)(s.Combobox.List,{children:[(0,t.jsx)(s.Combobox.Option,{value:"week",children:"Last 7 days"}),(0,t.jsx)(s.Combobox.Option,{value:"month",children:"Last month"}),(0,t.jsx)(s.Combobox.Option,{value:"year",children:"Last year"})]})]})]}),P.prepayment?(0,t.jsx)(h.MarketplaceLineChart,{chartData:P.prepayment,description:"This chart shows the balance over time.",formatter:(0,u.formatUsageValueByUnit)("$"),legendSuffix:"Balance",linkMapper:e=>y(k,e,v),title:"Balance"}):null,P.subscription?(0,t.jsx)(h.MarketplaceLineChart,{chartData:P.subscription,description:"This chart shows the cost per product over time.",formatter:(0,u.formatUsageValueByUnit)("$"),legendSuffix:"Total Cost",linkMapper:e=>y(k,e,v),title:"Cost per Product"}):null,P.usageByMetric?.map(e=>"total"===e.metric.type?(0,t.jsx)(h.MarketplaceLineChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,u.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name):(0,t.jsx)(c.MarketplaceBarChart,{chartData:e.data,description:`This chart shows the ${e.metric.name} over time.`,formatter:(0,u.formatUsageValueByUnit)(e.metric.units),legendSuffix:`Total ${e.metric.name}`,title:e.metric.name},e.metric.name))]})}function y(e,t,i){let a=e.find(e=>e.name===t);return a?(0,f.getResourceDashboardLink)(a,{teamSlug:i,path:"usage"}):""}function b(e){let{dimensions:i=4}=e;return(0,t.jsxs)(r.Stack,{gap:5,children:[(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",children:[(0,t.jsx)(l.Text,{lineHeight:24,size:20,weight:600,children:"Usage Report"}),(0,t.jsxs)(s.Combobox,{clearable:!1,noInputPrefix:!0,value:"week",width:140,children:[(0,t.jsx)(s.Combobox.Input,{}),(0,t.jsx)(s.Combobox.List,{children:(0,t.jsx)(s.Combobox.Option,{value:"week",children:"Last 7 days"})})]})]}),(0,t.jsx)(c.MarketplaceChartPlaceholder,{description:"This chart shows the cost per product over time.",dimensions:i,title:"Cost per Product"})]})}e.s(["MarketplaceBillingChart",()=>j,"MarketplaceBillingChartPlaceholder",()=>b],1003898)},773959,e=>{"use strict";var t=e.i(6468255),i=e.i(2504781),a=e.i(3869281),n=e.i(7137884),r=e.i(8517043),l=e.i(1232681),s=e.i(3500331),o=e.i(9508212),c=e.i(3895030),d=e.i(1344973),u=e.i(9792418),h=e.i(5468328),g=e.i(455575),p=e.i(4585051),m=e.i(8735244),x=e.i(8522580),f=e.i(5806401),j=e.i(762945),y=e.i(5169576),b=e.i(2560270),k=e.i(7807066),v=e.i(7399351),C=e.i(923772),w=e.i(6942035),T=e.i(5761705),I=e.i(6143247),S=e.i(9992248),N=e.i(9598279),A=e.i(6696646),P=e.i(9100551),M=e.i(119294),L=e.i(6352514),_=e.i(8042625),R=e.i(277234),E=e.i(4244280),D=e.i(1119178),O=e.i(4004502),B=e.i(4011256),F=e.i(57106);e.i(6887680);var U=e.i(6810699);e.i(553769);var z=e.i(3758860),q=e.i(9349058),$=e.i(8525850),V=e.i(9243747);e.i(7037808);var G=e.i(5098510),W=e.i(1574218),H=e.i(5074599),Y=e.i(9186321);function K(e){let{integration:a,configuration:s,team:o,canDelete:m,singleResource:x}=e,{data:f}=(0,U.useResourceList)({skip:"marketplace"!==s.installationType,integrationIdOrSlug:a.slug,integrationConfigurationId:s.id}),{deleteResource:j}=(0,q.useMutateResource)(),b=!!s.deleteRequestedAt,k=f?.stores.length??0,v=k>0,C=!m,w=(0,g.useToasts)(),T=(0,P.useRouter)(),[I,G]=(0,A.useState)(!1),[W,H]=(0,A.useState)(!1),[K,Q]=(0,A.useState)(!1),[X,ee]=(0,A.useState)(!1),[et,ei]=(0,A.useState)(""),ea=(0,A.useCallback)(()=>{let e=(0,B.getMarketplaceInstallationsLink)({teamSlug:o.slug});T.push(e)},[T,o.slug]),en=(0,A.useCallback)(()=>{G(!1),ee(!1),Q(!1),ei("")},[]),er=(0,A.useCallback)(()=>{en(),ea()},[en,ea]),el=(0,A.useCallback)(()=>{ee(!1),ei("")},[]),es=(0,A.useCallback)(()=>G(!0),[]),eo=(0,A.useCallback)(async()=>{if(C||W)return;H(!0);let e=(0,_.encode)({teamId:o.id});try{if("marketplace"===s.installationType&&f?.stores){let e=f.stores.map(async e=>{try{await j(e.id)}catch(t){console.warn(`Failed to delete resource ${e.id}:`,t)}});await Promise.allSettled(e)}"marketplace"===s.installationType?await (0,R.fetchAPI)(`${E.API_INTEGRATION_CONTROLLER_V2}/installations/${s.id}/uninstall${e}`,{method:"POST",body:{},throwOnHTTPError:!0}):await (0,R.fetchAPI)(`${E.API_INTEGRATION_CONTROLLER}/configuration/${s.id}${e}`,{method:"DELETE"}),M.analytics.track(L.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_SUCCEEDED),M.analytics.track(L.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:a.id,integration_slug:a.slug,source:"installation view",target:"team"}),Q(!0)}catch(t){let e=(0,z.showRenderIntegrationError)(t)?t.message:"Failed to uninstall integration";ei(e),ee(!0),w.error(e)}finally{H(!1)}},[s,a.id,a.slug,o,w,en,ea,f?.stores,j,C,W]);(0,A.useEffect)(()=>{I&&M.analytics.track(L.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[I]);let ec="marketplace"===s.installationType?s.billingPlan?.type:void 0,ed="marketplace"===s.installationType&&a.flags?.includes(Y.LaunchDarklyIntegrationFlags.MarketplaceInstallationDeletePendingAt)&&s.billingData?.spending?.periodEnd?Z(new Date(s.billingData.spending.periodEnd)):void 0,eu=s.deleteRequestedAt&&s.deleteRequestedAt>Date.now()?Z((0,N.addDays)(s.deleteRequestedAt,1)):void 0,eh="marketplace"===s.installationType&&(0,V.getIntegrationOps)({integration:a}).isSingleProductLayout();return(0,t.jsxs)(r.Fieldset,{children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(u.FieldsetTitle,{children:"Uninstall Integration"}),!eh&&v?(0,t.jsxs)(c.FieldsetSubtitle,{color:"gray-900",children:["This integration has"," ",(0,t.jsxs)(S.Root,{children:[(0,t.jsx)(S.Trigger,{asChild:!0,children:(0,t.jsxs)(F.Link,{className:"inline-flex items-center gap-1 underline-offset-4 hover:underline bg-transparent border-none cursor-pointer p-0 font-inherit",children:[(0,t.jsxs)("span",{children:[k," connected product",1!==k?"s":""]}),(0,t.jsx)(y.Information,{className:"w-3 h-3"})]})}),(0,t.jsx)(S.Portal,{children:(0,t.jsxs)(S.Content,{className:"bg-white rounded-[8px] shadow-[0_8px_30px_rgb(0,0,0,0.12)] p-4 max-w-[280px] z-50",sideOffset:8,children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"font-medium text-[14px] text-[var(--geist-foreground)]",children:"Connected Products"}),f?.stores.length?(0,t.jsx)("div",{className:"space-y-2 max-h-[320px] overflow-y-auto",children:f.stores.map(e=>(0,t.jsxs)(F.Link,{href:(0,$.getResourceDetailsPath)(e,o.slug),className:"flex items-center gap-2 p-1 hover:bg-gray-50 rounded transition-colors",target:"_blank",rel:"noopener noreferrer",children:[(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(p.Avatar,{hash:e.product.iconUrl,size:24})}),(0,t.jsx)("span",{className:"text-[14px] text-[var(--geist-foreground)] truncate flex-1",children:e.name})]},e.id))}):(0,t.jsx)("div",{className:"text-[14px] text-[var(--geist-gray)]",children:"No products found"})]}),(0,t.jsx)(S.Arrow,{className:"fill-white"})]})})]})," ","that will be automatically removed when you uninstall."]}):null,b?(0,t.jsxs)(d.Text,{children:["This integration is scheduled to be uninstalled",eu?` on ${eu}`:" within 24 hours","."]}):null]}),(0,t.jsx)(l.FieldsetFooter,{children:(0,t.jsx)(l.FieldsetFooter.Actions,{children:(0,t.jsxs)(h.Tooltip,{disableTriggers:!C,text:function(e){let{isDeleteRequested:t}=e;return t?"This integration is scheduled to be uninstalled.":"You need additional permissions to uninstall integration."}({isDeleteRequested:b}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,O.tid)("integration","uninstall"),disabled:C,onClick:es,children:"Uninstall Integration"}),(0,t.jsx)(J,{open:I,onOpenChange:G,billingType:ec,eulaLink:a.eulaDocUri,integrationSlug:a.slug,loading:W,onCancel:()=>{M.analytics.track(L.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),en()},onConfirm:(0,D.promiseToCallback)(eo),singleResource:f?.stores.find(e=>e.id===x?.id)??x,subscriptionEndDate:ed,team:o,resourceStores:f?.stores,showSuccess:K,onDone:er,showError:X,errorMessage:et,onRetry:el,onClose:en})]})})})]})}function Z(e){return e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function J(e){let{loading:n,integrationSlug:r,open:l,onOpenChange:c,onCancel:u,onConfirm:h,billingType:g,eulaLink:p,singleResource:x,subscriptionEndDate:y,team:b,resourceStores:k,showSuccess:v,onDone:C,showError:I,errorMessage:S,onRetry:N,onClose:P}=e,M=(0,A.useRef)(null),[L,_]=(0,A.useState)(!1);(0,A.useEffect)(()=>{l&&requestAnimationFrame(()=>{let e=Array.from(M.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[l]);let R=(0,A.useCallback)(e=>{e.preventDefault(),!n&&M.current?.checkValidity()&&L&&h()},[h,L,n]);return(0,t.jsx)(f.Sheet,{onOpenChange:c,open:l,children:(0,t.jsxs)(f.SheetContent,{className:"m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-visible rounded-[1rem] bg-white p-0 lg:w-[600px] xl:w-[640px] sm:max-w-[auto]",side:"right",children:[(0,t.jsx)(f.SheetClose,{asChild:!0,children:(0,t.jsx)(i.Button,{"aria-label":"Close",shape:"square",size:"medium",svgOnly:!0,type:"tertiary",className:"absolute top-4 right-4 z-20",children:(0,t.jsx)(w.Cross,{})})}),(0,t.jsxs)("div",{className:"flex h-full flex-col overflow-hidden rounded-[1rem]",children:[(0,t.jsx)(f.SheetHeader,{className:"sticky top-0 z-10 bg-white p-6 border-b",children:(0,t.jsx)(f.SheetTitle,{children:"Uninstall Integration"})}),v?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(T.CheckCircle,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),(0,t.jsx)(d.Text,{size:20,weight:600,className:"mb-2",children:"Integration Uninstalled"}),(0,t.jsx)(d.Text,{color:"gray-700",className:"mb-6 max-w-md",children:"The integration and all associated resources have been successfully removed from your account."}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(i.Button,{onClick:C,children:"Done"})})]})}):I?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(j.Warning,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),(0,t.jsx)(d.Text,{size:20,weight:600,className:"mb-2",children:"Uninstall Failed"}),(0,t.jsx)(d.Text,{color:"gray-700",className:"mb-6 max-w-md",children:S||"An unexpected error occurred while uninstalling the integration. Please try again."}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.Button,{onClick:N,type:"default",children:"Try Again"}),(0,t.jsx)(i.Button,{onClick:P,type:"secondary",children:"Close"})]})]})}):n?(0,t.jsx)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"flex justify-center mb-4",children:(0,t.jsx)(m.Spinner,{})}),(0,t.jsx)(d.Text,{size:18,weight:600,className:"mb-2",children:"Uninstalling Integration"}),(0,t.jsx)(d.Text,{color:"gray-700",children:"Removing resources and cleaning up your account..."})]})}):(0,t.jsx)("form",{onSubmit:R,ref:M,className:"flex flex-1 min-h-0 flex-col",children:(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsxs)(o.Stack,{gap:6,children:[(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsx)(d.Text,{children:"This integration will be uninstalled and all associated products will be automatically removed. Any projects connected to these products will lose access to their resources."}),(0,t.jsxs)(d.Text,{children:["By clicking to uninstall, I acknowledge that I have read the"," ",(0,t.jsx)(F.Link,{external:!0,href:p,prefetch:!1,type:"primary",children:"EULA"}),"and understand my rights upon termination.","prepayment"===g?" Unused or prepaid credits may not be refunded in accordance with this provider's terms and policies.":"",y?` Your active subscription ends on ${y}. The provider may terminate it at any time in accordance with their terms and policies. The remaining period may not be refunded.`:""]}),k&&k.length>0&&(0,t.jsx)(et,{resourceStores:k,teamSlug:b.slug})]}),x?(0,t.jsxs)(o.Stack,{gap:6,children:[(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsxs)(d.Text,{children:[W.PRODUCT," will"," ",(0,t.jsxs)("b",{children:["delete your"," ",(0,H.getProductNameAndResourceTitle)(x.product)]}),", along with all of its items. Any projects connected to this"," ",(0,H.getResourceTitleByProductForDeletion)(x.product)," ","will no longer be able to read its contents."]}),(0,t.jsxs)(d.Text,{children:[W.PRODUCT," recommends that you ensure this"," ",(0,H.getResourceTitleByProductForDeletion)(x.product)," ","is no longer used by any projects before continuing."]})]}),x.projectsMetadata.length?(0,t.jsxs)(o.Stack,{gap:3,children:[(0,t.jsx)(d.Text,{color:"gray-900",children:"Deleting the database will cause the deletion of connections to the following projects"}),(0,t.jsx)(G.ProjectConnectionsListInModal,{connections:x.projectsMetadata})]}):null]}):null,(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg border",children:(0,t.jsx)(o.Stack,{gap:6,children:(0,t.jsx)("label",{children:(0,t.jsxs)(o.Stack,{gap:2,children:[(0,t.jsxs)(d.Text,{color:"gray-900",size:14,weight:400,children:["Enter the integration name"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:r})," ","to continue:"]}),(0,t.jsx)(s.Input,{"aria-label":"Resource Name",name:"resourceName",pattern:`\\s*${r}\\s*`,required:!0})]})})})}),(0,t.jsx)(X,{children:(0,t.jsx)(a.Checkbox,{checked:L,onChange:e=>_(e.target.checked),labelClassName:"font-medium text-sm",children:"I understand that this action is not reversible and will permanently remove this integration and all associated resources."})}),(0,t.jsxs)("div",{className:"border-t bg-white pt-4 flex justify-end gap-2",children:[(0,t.jsx)(i.Button,{disabled:n,onClick:n?void 0:u,type:"secondary",typeName:"button",className:n?"opacity-50 cursor-not-allowed":"",children:"Cancel"}),(0,t.jsx)(i.Button,{typeName:"submit",disabled:n||!L,className:`inline-flex items-center justify-center rounded-md bg-red-600 px-4 py-2 text-sm font-medium text-white shadow ${n||!L?"opacity-50 cursor-not-allowed":"hover:bg-red-700"}`,children:n?"Uninstalling...":"Uninstall"})]})]})})})]})]})})}let Q={"--note-border-color":"var(--geist-warning)",borderRadius:"12px",lineHeight:"normal",padding:"1rem"};function X(e){let{children:i}=e;return(0,t.jsx)(x.Note,{fill:!0,style:Q,type:"warning",children:i})}function ee(e){let{expanded:i,onClick:a,loading:n}=e;return(0,t.jsx)("div",{className:"flex -my-4 items-center",children:(0,t.jsx)("div",{className:"bg-background",children:(0,t.jsx)("button",{type:"button",onClick:a,disabled:n,className:"flex size-8 items-center justify-center rounded-full border border-solid border-gray-alpha-400 bg-white shadow-sm hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:(0,t.jsx)("span",{className:(0,I.cn)("flex items-center justify-center transition-transform duration-200 ease-in-out",i&&"rotate-180"),children:(0,t.jsx)(b.ChevronDown,{color:"gray-900",size:16})})})})})}function et(e){let{resourceStores:i,teamSlug:a}=e,[n,r]=(0,A.useState)(new Set),[l,s]=(0,A.useState)(!1),c=(0,A.useCallback)(e=>{r(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})},[]);if(0===i.length)return(0,t.jsx)(t.Fragment,{});let u=l?i:i.slice(0,3),h=i.length>3;return(0,t.jsxs)(o.Stack,{gap:3,children:[(0,t.jsx)(d.Text,{size:14,weight:500,children:"Installed Products"}),(0,t.jsx)(X,{children:(0,t.jsx)("p",{className:"font-medium",children:"The following products will be automatically deleted when you uninstall this integration"})}),(0,t.jsxs)(o.Stack,{gap:2,children:[u.map(e=>{let i=e.projectsMetadata&&e.projectsMetadata.length>0,r=n.has(e.id);return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-md",children:[(0,t.jsxs)("div",{className:"w-full flex items-center justify-between text-left bg-white relative",children:[(0,t.jsxs)(F.Link,{href:(0,$.getResourceDetailsPath)(e,a),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 min-w-0 flex-1 p-3 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(C.Trash,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),(0,t.jsx)("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(p.Avatar,{hash:e.product.integration.icon,size:24})}),(0,t.jsx)(d.Text,{size:14,weight:400,truncate:!0,title:e.name,className:"flex-1 min-w-0",children:e.name})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0 p-3 relative z-10",children:[(0,t.jsxs)(d.Text,{size:12,color:"gray-700",children:["(",e.projectsMetadata?.length||0," project",e.projectsMetadata?.length!==1?"s":"",")"]}),i&&(0,t.jsx)("button",{type:"button","aria-label":r?"Collapse project list":"Expand project list",onClick:()=>c(e.id),className:"p-0.5 w-6 h-6 flex items-center justify-center rounded border border-gray-300 bg-white hover:bg-gray-50 transition-colors",children:r?(0,t.jsx)(v.ChevronUp,{className:"w-3 h-3"}):(0,t.jsx)(b.ChevronDown,{className:"w-3 h-3"})})]})]}),i&&r&&(0,t.jsx)("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:(0,t.jsx)(o.Stack,{gap:2,children:e.projectsMetadata?.map(e=>(0,t.jsxs)(F.Link,{href:`https://vercel.com/${a}/${e.name}`,className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 text-sm",children:[(0,t.jsx)(d.Text,{truncate:!0,title:e.name,children:e.name}),(0,t.jsx)(k.ChevronRight,{className:"w-4 h-4"})]},e.id))})})]},e.id)}),h&&(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(ee,{expanded:l,onClick:()=>s(!l)})})]})]})}function ei(){return(0,t.jsxs)(r.Fieldset,{type:"error",children:[(0,t.jsxs)(n.FieldsetContent,{children:[(0,t.jsx)(u.FieldsetTitle,{children:"Uninstall Integration"}),(0,t.jsx)(c.FieldsetSubtitle,{color:"gray-900",children:"Uninstalling your integration deletes all products linked to it."})]}),(0,t.jsx)(l.FieldsetFooter,{children:(0,t.jsx)(l.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,type:"error",children:"Uninstall Integration"})})})]})}e.s(["MarketplaceUninstallIntegration",()=>K,"MarketplaceUninstallIntegrationPlaceholder",()=>ei])},1452390,e=>{"use strict";var t=e.i(6468255),i=e.i(2504781),a=e.i(7137884),n=e.i(8517043),r=e.i(1232681),l=e.i(3500331),s=e.i(6891161),o=e.i(8522580),c=e.i(9508212),d=e.i(3895030),u=e.i(1344973),h=e.i(9792418),g=e.i(5468328),p=e.i(455575),m=e.i(6696646),x=e.i(9100551),f=e.i(119294),j=e.i(6352514),y=e.i(8042625),b=e.i(277234),k=e.i(4244280),v=e.i(1119178),C=e.i(4004502),w=e.i(4011256),T=e.i(588428),I=e.i(134877),S=e.i(8843717),N=e.i(7164486),A=e.i(5561425),P=e.i(2704354),M=e.i(4987761),L=e.i(2333337);function _(){return(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(h.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(d.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please disconnect all the projects linked to this this integration's resources."})]}),(0,t.jsx)(r.FieldsetFooter,{children:(0,t.jsx)(r.FieldsetFooter.Actions,{children:(0,t.jsx)(i.Button,{disabled:!0,children:"Transfer Integration"})})})]})}function R(e){let{loading:i,originatingTeam:a,configuration:n,resources:r,active:l,complete:o,error:c,onCancel:d,transferInstallation:u,onCompleted:h}=e,[g,p]=(0,m.useState)(null),[x,f]=(0,m.useState)(),[j,y]=(0,m.useState)("Team"),[b,k]=(0,m.useState)(),{data:C}=(0,S.useInstallationPaymentMethodState)({integrationConfigurationId:n.id}),{createAuthorization:w}=(0,M.useMarketplaceBillingAuthorizationApi)(),T=(0,M.useAwaitAuthorization)(),I=(0,m.useCallback)(async()=>{if(!x)throw Error("Invalid state, no team selected");y("Provision");let e=function(e,t){let i,a,n,r,l=e.billingPlan?.scope||"resource",s=e.billingPlan?.id??e.lastAuthorization?.billingPlanId,o=e.billingPlan?.type==="prepayment"?0:void 0;if("resource"===l){for(let e of t){if(!r){r=e,a=e.metadata;continue}e.billingPlan?.preauthorizationAmount&&e.billingPlan.preauthorizationAmount>(r.billingPlan?.preauthorizationAmount??0)&&(r=e,a=e.metadata)}r&&(r.billingPlan?.type==="prepayment"&&(o=0),s=r.billingPlan?.id,i=r.id,a=r.metadata,n=r.product.id)}return{billingPlanId:s??"",metadata:a??{},resourceId:i,productId:n,integrationIdOrSlug:e.integrationId,integrationConfigurationId:e.id,prepaymentAmountCents:o}}(n,r),t=await w(a.id,{...e,overrideTeamForInstallationTransfer:x.id,paymentMethodId:b,overwritePreviousAuthorization:!0});if(p(t?.id??null),t){if("succeeded"!==(await T(x.id,t.id)).status)return;await u(x.id,t.id,b)}},[u,n,r,a,x,b,w,T]);return(0,t.jsxs)(s.Modal.Modal,{active:l,onClickOutside:function(){f(void 0),k(void 0),y("Team"),d()},width:500,children:["Team"!==j&&x?null:(0,t.jsx)(D,{integrationId:n.integrationId,loading:i,onCancel:d,onContinue:function(){k(void 0),C?.required?y("Card"):y("Confirm")},setTargetTeam:f,targetTeam:x,sourceTeamId:a.id}),"Card"===j&&x?(0,t.jsx)(O,{onBack:function(){y("Team")},onContinue:function(e){k(e),y("Confirm")},targetTeam:x}):null,"Confirm"===j&&x?(0,t.jsx)(B,{integrationSlug:n.slug,loading:i,onBack:function(){y("Card")},onConfirm:(0,v.promiseToCallback)(I)}):null,"Provision"===j&&x?(0,t.jsx)(L.ProvisioningStep,{authorizationId:g,complete:o,error:c,header:(0,t.jsx)(E,{}),isTransitioning:!1,onBack:()=>y("Confirm"),onChangePaymentMethod:function(){y("Card")},onNext:h,successMessage:"Funds have been added",teamId:x.id}):null]})}function E(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Modal.Title,{children:"Transfer Integration"}),(0,t.jsx)(s.Modal.Subtitle,{children:"This integration will be transferred to the selected team."}),(0,t.jsx)(o.Note,{center:!0,fill:!0,label:"Warning",type:"error",variant:"contrast",children:"This action is only reversible from the selected team."})]})}function D(e){let{loading:i,integrationId:a,targetTeam:n,setTargetTeam:r,onCancel:l,onContinue:o,sourceTeamId:d}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Modal.Body,{children:(0,t.jsxs)(c.Stack,{gap:6,children:[(0,t.jsx)(E,{}),(0,t.jsx)(s.Modal.Inset,{last:!0,children:(0,t.jsx)(c.Stack,{gap:6,children:(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsx)(u.Text,{color:"gray-900",children:"Select a Vercel team to transfer the integration to:"}),(0,t.jsx)(A.TeamSelect,{account:n??void 0,integrationId:a,onChange:e=>{r(e)},type:"marketplace",excludeTeamId:d})]})})})})]})}),(0,t.jsxs)(s.Modal.Actions,{children:[(0,t.jsx)(s.Modal.Action,{disabled:i,onClick:l,type:"secondary",children:"Cancel"}),(0,t.jsx)(s.Modal.Action,{disabled:i||!n,loading:i,onClick:o,type:"default",children:"Continue"})]})]})}function O(e){let{targetTeam:i,onBack:a,onContinue:n}=e;return(0,t.jsx)(N.SelectPaymentMethodActionForTeam,{cancelLabel:"Back",continueLabel:"Continue",onAbort:a,onContinue:n,team:i})}function B(e){let{active:i,integrationSlug:a,loading:n,onBack:r,onConfirm:o}=e,d=(0,m.useRef)(null),h="transfer my integration";(0,m.useEffect)(()=>{i&&requestAnimationFrame(()=>{let e=Array.from(d.current?.elements??[]);e.find(e=>"INPUT"===e.tagName)?.focus()})},[i]);let g=(0,m.useCallback)(e=>{e.preventDefault(),d.current?.checkValidity()&&o()},[o]);return(0,t.jsxs)("form",{onSubmit:g,ref:d,children:[(0,t.jsx)(s.Modal.Body,{children:(0,t.jsxs)(c.Stack,{gap:6,children:[(0,t.jsx)(E,{}),(0,t.jsx)(s.Modal.Inset,{last:!0,children:(0,t.jsxs)(c.Stack,{gap:6,children:[(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["Enter the integration slug"," ",(0,t.jsx)("b",{style:{overflowWrap:"anywhere"},children:a})," ","to continue:"]}),(0,t.jsx)(l.Input,{"aria-label":"Integration Slug",name:"integrationSlug",pattern:`\\s*${a}\\s*`,required:!0})]})}),(0,t.jsx)("label",{children:(0,t.jsxs)(c.Stack,{gap:2,children:[(0,t.jsxs)(u.Text,{color:"gray-900",size:14,weight:400,children:["To verify, type ",(0,t.jsx)("b",{children:h})," below:"]}),(0,t.jsx)(l.Input,{"aria-label":"Verification Code",name:"verificationText",pattern:`\\s*${h}\\s*`,required:!0})]})})]})})]})}),(0,t.jsxs)(s.Modal.Actions,{children:[(0,t.jsx)(s.Modal.Action,{disabled:n,onClick:r,type:"secondary",children:"Back"}),(0,t.jsx)(s.Modal.Action,{buttonType:"submit",disabled:n,loading:n,children:"Continue"})]})]})}let F=(0,e.i(9588822).withStripe)(function(e){let{integration:l,configuration:s,resources:o,team:c,canTransfer:u}=e,v="marketplace"===s.installationType,S=!u||!v,N=(0,p.useToasts)(),A=(0,x.useRouter)(),[M,L]=(0,m.useState)(!1),[_,E]=(0,m.useState)(!1),[D,O]=(0,m.useState)(!1),B=(0,m.useCallback)(()=>L(!0),[]),F=(0,m.useCallback)(()=>L(!1),[]),[U,z]=(0,m.useState)(void 0),{value:q,isReady:$}=(0,T.useMarketplaceIntegrationConfigurationTransferToTeam)(),V=(0,m.useCallback)(()=>{let e=(0,w.getMarketplaceInstallationsLink)({teamSlug:c.slug});A.push(e)},[A,c.slug]),G=(0,m.useCallback)(async(e,t,i)=>{E(!0);let a=(0,y.encode)({teamId:c.id});try{if("marketplace"!==s.installationType)throw Error("Integration is not from the marketplace");await (0,b.fetchAPI)(`${k.API_INTEGRATION_CONTROLLER_V2}/installations/${s.id}/transfer${a}`,{method:"POST",body:{toTeamId:e,authorizationId:t,newInstallationPaymentMethodId:i},throwOnHTTPError:!0}),f.analytics.track(j.AnalyticsEvent.INTEGRATION_CONFIGURATION_TEAM_TRANSFER_SUCCEEDED),f.analytics.track(j.AnalyticsEvent.INTEGRATION_UNINSTALLED,{integration_id:l.id,integration_slug:l.slug,source:"installation view",target:"team"}),O(!0),V()}catch(t){let e="Failed to transfer integration";(0,I.isAPIError)(t)&&(e=t.message),N.error(e),z(e),E(!1)}},[s,l.id,l.slug,c,N,V]);return((0,m.useEffect)(()=>{M&&f.analytics.track(j.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_MODAL_OPENED)},[M]),(0,P.isMarketplaceInstallation)(s)&&$&&q)?(0,t.jsxs)(n.Fieldset,{children:[(0,t.jsxs)(a.FieldsetContent,{children:[(0,t.jsx)(h.FieldsetTitle,{children:"Transfer Integration"}),(0,t.jsx)(d.FieldsetSubtitle,{color:"gray-900",children:"To transfer this integration please delete all the projects linked to this integration's resources."})]}),(0,t.jsx)(r.FieldsetFooter,{children:(0,t.jsx)(r.FieldsetFooter.Actions,{children:(0,t.jsxs)(g.Tooltip,{disableTriggers:!S,text:function(e){let{canTransferIntegration:t}=e;return t?"You need additional permissions to transfer integrations.":"Delete all the project connections before transferring the integration"}({canTransferIntegration:v}),children:[(0,t.jsx)(i.Button,{"data-testid":(0,C.tid)("integration","transfer"),disabled:S,onClick:B,children:"Transfer Integration"}),(0,t.jsx)(R,{active:M,originatingTeam:c,configuration:s,resources:o,loading:_,onCancel:()=>{f.analytics.track(j.AnalyticsEvent.INTEGRATION_CONFIGURATION_REMOVE_CANCELED),F()},transferInstallation:G,onCompleted:V,complete:D,error:U})]})})})]}):null});e.s(["MarketplaceTransferIntegration",0,F,"MarketplaceTransferIntegrationPlaceholder",()=>_])}]);

//# sourceMappingURL=0c5bba34d2915ca8.js.map
//# debugId=86e37368-e564-58b8-83df-9586d11d1e38
