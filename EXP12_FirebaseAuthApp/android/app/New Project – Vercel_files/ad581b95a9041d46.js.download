
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d509dd8c-e00c-5e1f-af0b-6529da5e2791")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,156530,e=>{"use strict";var t=e.i(6696646);function n(e){let[n,r]=(0,t.useState)(!1),i=(0,t.useCallback)(()=>{r(!1)},[]),o=(0,t.useCallback)(()=>{r(!0)},[]),[s,a]=(0,t.useState)(0),l=(0,t.useCallback)(()=>{a(e=>e+1)},[a]);return[o,{active:n,onClickOutside:i,key:`${e}${String(s)}`,onAnimationDone:l}]}e.s(["useModalState",()=>n])},8020240,e=>{"use strict";var t=e.i(6468255),n=e.i(6607601),r=e.i(9508212),i=e.i(1344973),o=e.i(5744676),s=e.i(1919132);function a(e){let{connection:o,inlineCode:a,wrap:c}=e,d=(0,s.getLogDrainProtocolSettings)(o);if(!d)return null;let u=`Sampling ${100*d.samplingRate}%`,p=`${d.sources.map(l).join(", ")}, ${u}`;return a||c?(0,t.jsx)(r.Stack,{className:"w-full flex-wrap",direction:"row",gap:1,justify:"end",children:a?(0,t.jsxs)(t.Fragment,{children:[d.sources.map(e=>(0,t.jsx)("div",{children:(0,t.jsx)(n.InlineCode,{children:l(e)})},e)),(0,t.jsx)("div",{children:(0,t.jsx)(n.InlineCode,{children:u})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.Text,{className:"text-end",color:"gray-900",children:d.sources.map(l).join(", ")}),",",(0,t.jsx)(i.Text,{className:"text-end",color:"gray-900",children:u})]})}):(0,t.jsx)(i.Text,{className:"whitespace-nowrap rounded-[var(--geist-radius)] bg-[var(--accents-2)] px-[4px]",color:"gray-900",monospace:!0,size:13,title:p,truncate:!0,children:p})}function l(e){return o.LogSourcesWithDescription.find(t=>t.value===e)?.label??e}e.s(["LogDrainConnection",()=>a])},397510,e=>{"use strict";var t=e.i(6468255),n=e.i(57106),r=e.i(2504781),i=e.i(5255926),o=e.i(9508212),s=e.i(2713868),a=e.i(7749291),l=e.i(3758860);function c(e){let{className:c,integrationConfigurationId:d,teamIdOrSlug:u,productId:p,externalResourceId:g,connectedProjects:x,projectId:m,checkId:h,label:j,componentType:f,buttonVariant:v,path:b,size:y,onClick:k}=e;if(!j||!d||!u)return(0,t.jsx)(r.Button,{className:c,size:y,type:v,children:(0,t.jsx)(i.Skeleton,{height:16,width:100})});let S=(0,l.getIntegrationDeepLink)({productId:p,externalResourceId:g,teamIdOrSlug:u,projectId:m,checkId:h,integrationConfigurationId:d},{path:b}),C=async()=>{await new Promise(e=>{setTimeout(()=>{e(k?.())})})};if("anchor"===f)return(0,t.jsx)(n.Link,{className:c,href:S,prefetch:!1,target:"_blank",children:(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,children:[j,(0,t.jsx)(a.ExternalSmall,{})]})});if(x&&x.length>0){let e={className:c,href:S,onClick:C,prefetch:!1,rel:"noopener noreferrer",size:y,suffix:(0,t.jsx)(a.ExternalSmall,{}),target:"_blank",type:"secondary"===v?"secondary":"default",tab:!0};return(0,t.jsx)(s.SplitButton,{Component:n.ButtonLink,buttonProps:e,menuAlignment:"bottom-end",menuButtonLabel:"Open in Partner Dashboard",menuProps:{width:"fit-content"},menuItems:(0,t.jsx)(t.Fragment,{children:x.map(e=>(0,t.jsx)(s.SplitButtonMenuItem,{title:`${e.name}`,menuItemProps:{isLink:!0,prefetch:!1,rel:"noopener noreferrer",target:"_blank",href:(0,l.getIntegrationDeepLink)({productId:p,externalResourceId:g,teamIdOrSlug:u,projectId:e.projectId,integrationConfigurationId:d},{path:b}),suffix:(0,t.jsx)(a.ExternalSmall,{}),tab:!0}},e.id))}),children:j})}return(0,t.jsx)(n.ButtonLink,{className:c,href:S,onClick:C,prefetch:!1,rel:"noopener noreferrer",size:y,suffix:(0,t.jsx)(a.ExternalSmall,{}),target:"_blank",type:v,tab:!0,children:j})}e.s(["OpenInPartnerDashboardButton",()=>c])},9186321,e=>{"use strict";var t,n=((t={}).MarketplaceStrictAdmin="marketplace-strict-admin",t.MarketplaceDeploymentActions="marketplace-deployment-actions",t.MarketplaceInstallationOnlyPlan="marketplace-installation-only-plan",t.MarketplaceInstallationDeletePendingAt="marketplace-installation-delete-pending-at",t.MarketplaceIntegrationSupportsResourceClaim="marketplace-integration-supports-resource-claim",t.MarketplaceSsoV2="marketplace-sso-v2",t.MarketplaceMcp="marketplace-mcp",t);e.s(["LaunchDarklyIntegrationFlags",()=>n])},5098510,7195573,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(2560270),i=e.i(7399351),o=e.i(9508212),s=e.i(1344973),a=e.i(6048771),l=e.i(1919132),c=e.i(5927860);function d(e){return e===c.EnvTarget.Production?"Production":e===c.EnvTarget.Preview?"Preview":"Development"}e.s(["stringifyTarget",()=>d],7195573);var u=e.i(8020240),p=e.i(9722978);function g(e){let{connections:s,className:a}=e,[l,c]=(0,n.useState)(!1);if(1===s.length)return(0,t.jsx)(x,{connection:s[0],index:0});let d=l?s:s.slice(0,2);return(0,t.jsxs)(o.Stack,{className:(0,p.clsx)("border-1 relative rounded-md border-gray-alpha-400 bg-[var(--geist-background)] shadow-border",a),padding:2,children:[s.length>2?(0,t.jsx)(o.Stack,{align:"center",className:"absolute -bottom-3 right-[calc(50%-12px)] size-6 rounded-full border border-solid border-gray-400 bg-background-100",justify:"center",onClick:()=>c(!l),children:l?(0,t.jsx)(i.ChevronUp,{}):(0,t.jsx)(r.ChevronDown,{})}):null,d.map((e,n)=>(0,t.jsx)(x,{connection:e,index:n,padding:2},e.id))]})}function x(e){let{connection:n,padding:r,index:i}=e,c=3===n.environments.length?"All Environments":n.environments.map(d).join(", ");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Stack,{align:"center",className:(0,p.clsx)(i%2==1&&"bg-[var(--accents-1)]","rounded-md"),direction:"row",gap:2,justify:"space-between",padding:r,children:[(0,t.jsxs)(o.Stack,{direction:"row",gap:2,children:[(0,t.jsx)(a.ProjectLogo,{deploymentId:n.latestDeployment,framework:n.framework,project:n,size:20}),(0,t.jsx)(s.Text,{children:n.name})]}),(0,t.jsx)(o.Stack,{color:"gray-900",direction:"row",gap:2,children:(0,t.jsx)(s.Text,{color:"gray-900",children:c})})]},n.id),(0,l.isLogDrainInConnection)(n)?(0,t.jsxs)(o.Stack,{align:"center",direction:"row",gap:2,justify:"space-between",padding:r,children:[(0,t.jsx)(s.Text,{className:"shrink-0",weight:500,children:"Log Drain"}),(0,t.jsx)(u.LogDrainConnection,{connection:n,wrap:!0})]},n.id):null]})}e.s(["ProjectConnectionsListInModal",()=>g],5098510)},1288475,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path d="M13 8C13 10.7614 10.7614 13 8 13C5.23858 13 3 10.7614 3 8C3 5.23858 5.23858 3 8 3C10.7614 3 13 5.23858 13 8Z" fill="currentColor"/>');e.s(["Status",0,t])},1627296,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(8735244),i=e.i(9508212);function o(e){let{swr:o}=e,s=(0,n.useRef)(null),[a,l]=(0,n.useState)(!1),{loadMore:c,isReachingEnd:d,isLoadingMore:u,initialDataLoaded:p}=o;return((0,n.useEffect)(()=>{p&&!d&&!u&&a&&c()},[p,a,u,d,c]),(0,n.useEffect)(()=>{let e=s.current;if(!e)return;let t=new IntersectionObserver(e=>{l(e[0].isIntersecting)});return t.observe(e),()=>{t.disconnect()}},[l]),!p||d)?null:(0,t.jsxs)(i.Stack,{direction:"row",justify:"center",paddingY:2,style:{position:"relative"},children:[(0,t.jsx)("div",{ref:s,style:{position:"absolute",top:"-150px"}}),u?(0,t.jsx)(r.Spinner,{}):null]})}e.s(["LoadMore",()=>o])},4177530,4404233,e=>{"use strict";var t=e.i(4439612),n=(0,t.createServerReference)("408770a966612405a11ea1bea0754055abee6390c3",t.callServer,void 0,t.findSourceMapURL,"blockConnectionUntilResourceIsAvailable");function r(e){if(!e)return!1;if("protocols"in e)return e.protocols.storage?.status==="enabled";if("product"in e){let t=e.product;if("supportedProtocols"in t)return t.supportedProtocols.includes("storage")}return!1}e.s(["blockConnectionUntilResourceIsAvailable",()=>n],4177530),e.s(["areResourceDeploymentsEnabled",()=>r],4404233)},5393630,e=>{"use strict";var t=e.i(6468255),n=e.i(1288475),r=e.i(9508212),i=e.i(5255926),o=e.i(1344973),s=e.i(3306538),a=e.i(5468328);function l(e){let{label:i,type:s}=e,a="teal-600";return"error"===s?a="red-700":"init"===s?a="gray-500":"warning"===s&&(a="amber-600"),(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(n.Status,{color:a}),(0,t.jsx)(o.Text,{lineHeight:16,children:i})]})}function c(e){let{label:n}=e;return(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(s.Badge,{variant:"red",children:n})})}function d(e){let{resource:n}=e;switch(n?.status){case"suspended":return(0,t.jsx)(c,{label:"Suspended"});case"limits-exceeded-suspended":return(0,t.jsx)(c,{label:"Limits Exceeded"});case"limits-exceeded-suspended-store-count":return(0,t.jsx)(c,{label:"Store Count Limit Reached"});case"available":return(0,t.jsx)(l,{label:"Available",type:"ok"});case"error":return(0,t.jsx)(l,{label:"Error",type:"error"});case"initializing":return(0,t.jsx)(l,{label:"Initializing",type:"init"});case"onboarding":return(0,t.jsx)(a.Tooltip,{text:"Additional onboarding is required to enable all features. Please complete the setup in the partner dashboard.",children:(0,t.jsx)(l,{label:"Onboarding",type:"warning"})});case"uninstalled":return(0,t.jsx)(l,{label:"Uninstalled",type:"error"});default:return(0,t.jsx)(i.Skeleton,{boxHeight:20,height:16,vcenter:!0,width:114})}}e.s(["ResourceStatus",()=>d])},8824424,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(1360174),i=e.i(9508212),o=e.i(1344973),s=e.i(3306538),a=e.i(6881349),l=e.i(8522580),c=e.i(5169576),d=e.i(2107254),u=e.i(4004502),p=e.i(6048771),g=e.i(1627296);function x(e){let{allowSelectConnectedProjects:x,selectedProject:m,account:h,onProjectSelected:j,resource:f,resourceTitle:v,...b}=e,[y,k]=(0,n.useState)(""),S=(0,n.useMemo)(()=>(0,r.default)(k,500),[]),[,C]=(0,d.useProjectListInfinite)({limit:20,search:y,latestDeployments:0,slug:h},{},!1,!0),w=C.initialDataLoaded,P=e=>!!e&&("connectedProjectIds"in b?b.connectedProjectIds.includes(e.id):b.includedInConnectedProjects(e)),T=P(m),N=(0,n.useCallback)(e=>{let t=f?.projectFilter;if(!t||0===Object.keys(t).length)return!1;if(t.git){let{git:n}=t,r=function(e){if(!e)return null;switch(e.type){case"github":return{provider:"github",id:e.repoOwnerId?String(e.repoOwnerId):e.org,slug:e.org};case"gitlab":return{provider:"gitlab",id:e.projectNamespace,slug:e.projectNamespace};case"bitbucket":return{provider:"bitbucket",id:e.workspaceUuid,slug:e.owner};default:return null}}(e.link);if(!r)return"No Git";if("*"!==n.providers&&!n.providers.includes(r.provider)||n.owners&&!n.owners.includes(r.id)&&!n.owners.includes(r.slug))return"Git Mismatch"}return!1},[f]);return(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsxs)(a.Combobox,{"data-testid":(0,u.tid)("connect-project","select-project-combobox"),filter:e=>e,onChange:e=>{let t=C.projects.find(t=>t.id===e)??null;(!P(t)||x)&&j(t)},onClear:()=>k(""),placeholder:"Search Projects…",prefixIcon:m?.latestDeployments&&m.latestDeployments.length>0?(0,t.jsx)(p.ProjectLogo,{deploymentId:m.latestDeployments[0]?.id??"",framework:m.framework,project:m,size:20}):null,value:m?.name??null,children:[(0,t.jsx)(a.Combobox.Input,{onChange:e=>S(e.target.value)}),(0,t.jsx)(a.Combobox.List,{emptyMessage:w?y?`No project found with the name "${y}".`:"No project under this account.":"Loading…",ListFooterComponent:(0,t.jsx)(g.LoadMore,{swr:C}),children:C.projects.map(e=>{let n=P(e),r=N(e);return(0,t.jsxs)(a.Combobox.Option,{className:"w-full flex-row items-center justify-between gap-2","data-testid":(0,u.tid)("connect-project","select-project",e.id),disabled:n&&!x||!1!==r,value:e.id,children:[(0,t.jsxs)(i.Stack,{align:"center",direction:"row",gap:2,children:[(0,t.jsx)(p.ProjectLogo,{deploymentId:e.latestDeployments?.[e.latestDeployments.length-1]?.id,framework:e.framework,project:e,size:20}),(0,t.jsx)(o.Text,{children:e.name})]}),n?(0,t.jsx)(s.Badge,{variant:"gray",children:"connected"}):null,r?(0,t.jsx)(s.Badge,{variant:"gray",children:r}):null]},e.id)})})]}),T&&x?(0,t.jsx)(l.Note,{fill:!0,label:!1,type:"secondary",variant:"contrast",children:(0,t.jsxs)(i.Stack,{direction:"column",children:[(0,t.jsxs)(i.Stack,{direction:"row",gap:2,children:[(0,t.jsx)(c.Information,{className:"stroke-gray-900",size:20}),(0,t.jsxs)(o.Text,{color:"gray-1000",lineHeight:24,weight:500,children:["This project has already been connected to this ",v]})]}),(0,t.jsx)(o.Text,{color:"gray-900",children:"To connect it again, use a different Environment Variable Name."})]})}):null]})}e.s(["ResourceProjectSelector",()=>x])},783806,8346890,e=>{"use strict";var t=e.i(6468255),n=e.i(3869281),r=e.i(9508212),i=e.i(1344973),o=e.i(4004502),s=e.i(588428),a=e.i(2098824);function l(e){let{disabled:l,onSourcesChanged:c,sources:d,selectedSourceValues:u}=e,{value:p}=(0,s.useFirewallLogDrains)();return(0,t.jsxs)(r.Stack,{className:"tailwind-preflight",gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(a.FormTitleDescription,{description:"Logs from the selected sources will be forwarded to your log drain. At least one must be selected.",title:"Sources"})}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:d.map(e=>{let{label:r,value:s,description:a}=e;if("firewall"!==s||p)return(0,t.jsxs)("div",{className:"flex-col gap-0.5",children:[(0,t.jsx)("div",{className:"inline-flex items-center gap-2",children:(0,t.jsx)(n.Checkbox,{checked:u.includes(s),"data-testid":(0,o.tid)("log-drain-source",s),disabled:l,onChange:()=>{u.includes(s)?c(u.filter(e=>e!==s)):c([...u,s])},children:(0,t.jsx)(i.Text,{color:"inherit",children:r})})}),(0,t.jsx)(i.Text,{className:"flex-1",color:l?"inherit":"gray-900",size:12,children:a})]},s)})})]})}e.s(["FormLogSources",()=>l],783806);var c=e.i(7048904);function d(e){let{disabled:n,onSamplingRateChanged:i,samplingRate:o}=e;return(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsx)(a.FormTitleDescription,{description:"A percentage of logs matching the sampling rate will be sent to your log drain.",title:"Sampling Rate"})}),(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsxs)("span",{style:{minWidth:35},children:[o,"%"]}),(0,t.jsx)(c.Slider,{disabled:n,max:100,min:1,onValueChange:i,value:o})]})]})}e.s(["FormSamplingRate",()=>d],8346890)},2014455,e=>{"use strict";var t=e.i(6468255),n=e.i(3869281),r=e.i(4030453),i=e.i(5927860);function o(e){let{environments:o,error:s,onChange:a,resourceTitle:l}=e,c={[i.EnvTarget.Development]:"Development",[i.EnvTarget.Preview]:"Preview",[i.EnvTarget.Production]:"Production"},[d,u]=Object.entries(o).reduce((e,t)=>(e[t[0]in c?0:1].push(t),e),[[],[]]);return(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Environments"}),(0,t.jsxs)("div",{className:"text-gray-900 text-[13px] leading-4",children:["Choose which environments of the project to make this"," ",l.toLowerCase()," available to."]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"flex flex-row gap-2",children:d.map(e=>{let[r,i]=e;return(0,t.jsx)(n.Checkbox,{checked:i,onChange:()=>{a({...o,[r]:!i})},children:(0,t.jsx)("span",{className:`font-medium ${!i?"text-gray-900":""}`,children:c[r]})},`environment-${r}`)})}),u.length>0&&(0,t.jsx)("div",{className:"flex flex-row gap-4",children:u.map(e=>{let[r,i]=e;return(0,t.jsx)(n.Checkbox,{checked:i,onChange:()=>{a({...o,[r]:!i})},children:r},`environment-${r}`)})})]}),s?(0,t.jsx)(r.Error,{children:s}):null]})}e.s(["ResourceEnvironmentSelector",()=>o])},7137779,2483721,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(9508212),i=e.i(6891161),o=e.i(455575),s=e.i(4030453),a=e.i(1344973),l=e.i(4004502),c=e.i(57106),d=e.i(5927860),u=e.i(7917902),p=e.i(4422059),g=e.i(4597921),x=e.i(134877),m=e.i(3911483),h=e.i(4177530),j=e.i(6060673),f=e.i(8794163),v=e.i(5074599),b=e.i(9584471),y=e.i(3758860),k=e.i(1887803),S=e.i(3183079),C=e.i(648779),w=e.i(39509);e.i(3182268);var P=e.i(7849855),T=e.i(1919132),N=e.i(4404233),I=e.i(5779481),D=e.i(5393630),R=e.i(397510),L=e.i(8824424),E=e.i(3869281),M=e.i(3500331),O=e.i(1906681),A=e.i(8522580),B=e.i(9889563),F=e.i(5338940),z=e.i(9186321),$=e.i(588428),q=e.i(1717203),U=e.i(7557283),V=e.i(5744676),_=e.i(9722978),W=e.i(7743427),G=e.i(783806),H=e.i(8346890),Z=e.i(2014455);function K(e){let{isLoading:n,store:r,advancedOptions:i,onChangeAdvancedOptions:o,prefixPlaceholder:s,sampleEnvVarName:a,logDrainEnabled:l,connection:c}=e,d=(0,v.getResourceTitleByResource)(r),u=(0,g.useServerFlag)("enable-marketplace-drains",!1),p=!1;return u||(p=r?.type==="integration"&&(0,y.isProtocolSupported)(r.product,"logDrain")),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(Z.ResourceEnvironmentSelector,{environments:i.environments,error:i.error?.environments,onChange:e=>o({...i,environments:e,error:{...i.error,environments:void 0}}),resourceTitle:d}),r?.type==="integration"&&(0,N.areResourceDeploymentsEnabled)(r)?(0,t.jsx)(J,{advancedOptions:i,onChangeAdvancedOptions:o,store:r,title:d,connection:c}):null,p?(0,t.jsx)(Y,{advancedOptions:i,logDrainEnabled:l,onChangeAdvancedOptions:o}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Custom Prefix"}),(0,t.jsxs)("div",{className:"text-gray-900 text-[13px] leading-4",children:["This prefix will be applied to the environment variables that are automatically created for the ",d,"."]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4",children:(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsx)(M.Input,{"aria-label":"Environment Variables Prefix",disabled:n,error:i.error?.envPrefix,onChange:e=>o({...i,envPrefix:e.currentTarget.value,error:{...i.error,envPrefix:void 0}}),placeholder:s,suffix:a,value:i.envPrefix,width:"100%"})})})]})]})}function Y(e){let{advancedOptions:r,onChangeAdvancedOptions:i,logDrainEnabled:o}=e,{can:a,isLoading:l}=(0,q.default)(),{team:d}=(0,F.useTeam)(),u=(0,y.hasFreeBillingPlan)(d),p=!d||u||l||!a(U.Action.Create,U.Resource.LogDrains),[g,x]=(0,n.useState)(o??!!(0,T.getLogDrainProtocolSettings)(r)),m=(0,T.getLogDrainProtocolSettings)(r)??{sources:[],samplingRate:1};return(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:"Log Drain Configuration"}),(0,t.jsxs)(A.Note,{icon:(0,t.jsx)(B.Dollar,{color:"gray-900"}),children:[(0,t.jsx)("b",{children:"Log Drains"})," are billed $0.50 per 1GB processed."," ",(0,t.jsx)(c.Link,{href:"/docs/drains#usage-and-pricing",target:"_blank",underline:!0,children:"Learn more"})]}),(0,t.jsxs)("div",{className:"rounded border border-solid border-gray-200",children:[r.error?.protocolSettings?(0,t.jsx)("div",{className:"px-4 py-3",children:(0,t.jsx)(s.Error,{error:r.error.protocolSettings})}):null,u?(0,t.jsx)("div",{className:"px-4 py-3",children:(0,t.jsxs)(A.Note,{fill:!0,type:"warning",children:["Log Drains are not available for the current plan.",(0,t.jsx)("br",{}),(0,t.jsx)(c.Link,{href:"/dashboard?upgradeTeam=log-drains-cta",target:"_blank",variant:"highlight",children:"Upgrade to Pro"})," ","to continue."]})}):null,(0,t.jsx)("div",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"flex flex-row",children:(0,t.jsx)(O.Toggle,{checked:g,direction:"switch-first",disabled:p,onChange:e=>{x(e),e?i({...r,protocolSettings:{logDrain:m}}):i({...r,protocolSettings:{logDrain:void 0}})},size:"large",children:(0,t.jsx)("div",{children:"Enable LogDrain"})})})}),(0,t.jsxs)("div",{className:(0,_.clsx)("flex flex-col items-center gap-3 border-0 border-t border-solid border-gray-200 px-4 py-3",{"opacity-50":!g}),children:[(0,t.jsx)(G.FormLogSources,{disabled:p||!g,onSourcesChanged:e=>{i({...r,protocolSettings:{logDrain:{...m,sources:e}}})},selectedSourceValues:m.sources,sources:V.LogSourcesWithDescription}),(0,t.jsx)(H.FormSamplingRate,{disabled:p||!g,onSamplingRateChanged:e=>{i({...r,protocolSettings:{logDrain:{...m,samplingRate:e[0]/100}}})},samplingRate:[100*m.samplingRate]})]})]})]})}function J(e){let{store:r,advancedOptions:i,onChangeAdvancedOptions:o,connection:s}=e,{data:a}=(0,W.useIntegration)(r.product.integration.id),l=a?.flags?.includes(z.LaunchDarklyIntegrationFlags.MarketplaceDeploymentActions),{value:u}=(0,$.useLaunchDarklyTeamFeatureFlag)("deployment-integrations"),{product:p}=(0,W.useIntegrationAndProduct)({integrationIdOrSlug:r.product.integration.id,productIdOrSlug:r.product.id,teamIdOrSlug:r.ownerId}),g=p?.actions??[],x=(0,n.useMemo)(()=>[{target:d.EnvTarget.Preview,name:"Preview"},{target:d.EnvTarget.Production,name:"Production"}],[]);if(!l||!u)return null;let m=i.deployments,h=g.length>0&&(s||m?.required);return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[s?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Resource is Required To Be In An Active State Before Deployment"})}),(0,t.jsx)(O.Toggle,{className:"w-fit",checked:m?.required??!1,direction:"switch-first",onChange:e=>{o({...i,deployments:{...m,required:e,actions:e?m?.actions:{}}})},size:"large",children:(0,t.jsx)("div",{className:"text-[13px] whitespace-normal",children:m?.required?"Required":"Not Required"})})]}):null,h?(0,t.jsx)("div",{className:(0,_.clsx)("flex flex-col gap-6",{"opacity-50":!m?.required}),children:g.map(e=>(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("div",{className:"text-sm font-semibold capitalize",children:e.name}),e.description?(0,t.jsxs)("div",{className:"text-gray-900 text-[13px]",children:[e.description,e.link?(0,t.jsx)(c.Link,{external:!0,href:e.link}):null]}):null]}),(0,t.jsx)("div",{className:"flex flex-row gap-4",children:x.map(n=>(0,t.jsx)(E.Checkbox,{checked:m?.actions?.[e.slug]?.[n.target]??!1,disabled:!m?.required||!i.environments[n.target],onChange:t=>{o({...i,deployments:{...m,actions:{...m?.actions,[e.slug]:{...m?.actions?.[e.slug],[n.target]:t.target.checked}}}})},children:(0,t.jsxs)("span",{className:`font-medium ${!m?.actions?.[e.slug]?.[n.target]?"text-gray-900":""}`,children:[" ",n.name," "]})},n.target))})]},e.slug))}):null]})}var Q=e.i(808558),X=e.i(5530726);function ee(e){let{resource:n}=e;if(!n||"integration"!==n.type)return null;let i=n.product.projectConnectionScopes;if(!i||0===i.length)return null;let o=i.map(e=>(0,X.scopeFormatter)(e)??null).filter(et).reduce((e,t)=>{let{permission:n}=t;return e[n].push(t),e},{Read:[],"Read and Write":[]});return(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(a.Text,{children:"This integration requires the following permissions"}),(0,t.jsx)(r.Stack,{as:"ul",className:"m-0 list-none p-0","data-testid":(0,l.tid)("connect-project","scopes"),gap:4,children:Object.entries(o).map(e=>{let[n,i]=e;return 0===i.length?null:(0,t.jsxs)(r.Stack,{align:"center",as:"li",direction:"row",gap:3,children:[(0,t.jsx)("div",{className:"flex-basis",children:(0,t.jsx)(Q.IconDefault,{size:24})}),(0,t.jsxs)(r.Stack,{gap:1,children:[(0,t.jsx)(r.Stack,{align:"center",direction:"row",gap:2,children:(0,t.jsx)(a.Text,{className:"whitespace-nowrap",weight:600,children:n})}),(0,t.jsx)("ul",{className:"m-0 list-none p-0",children:i.map((e,n)=>{let{resource:r}=e;return(0,t.jsx)("li",{style:{display:"inline"},children:(0,t.jsxs)(a.Text,{as:"span",className:"tailwind-preflight",children:[r,n===i.length-1?null:", "]})},r)})})]})]},n)})})]})}function et(e){return null!=e}function en(e){let{resource:t,blockData:n}=e,r=t?.status;return n&&!n.blockConnection||t&&"integration"!==t.type||"available"===r}function er(e){let{backOrCancelLabel:u,project:g,store:j,connection:S,title:C,subtitle:w,onBack:P,onClickOutside:L,onConnectionCreated:E,ProjectSelector:M,initialEnvPrefix:O,resourceId:A,logDrainEnabled:B}=e,{mutateResourceListAndProject:F}=(0,b.useMutateResourceCache)(),{mutate:z}=(0,I.useResourceItem)({resourceId:A,includeGuides:!0}),{createConnection:$,updateConnection:q}=(0,k.useResourceConnection)(),{token:U}=(0,f.useV0Marketplace)()||{},[V,_]=(0,n.useState)(!1),[W,G]=(0,n.useState)({envPrefix:O??S?.envVarPrefix??void 0,environments:{[d.EnvTarget.Development]:S?.environments.includes(d.EnvTarget.Development)??!0,[d.EnvTarget.Preview]:S?.environments.includes(d.EnvTarget.Preview)??!0,[d.EnvTarget.Production]:S?.environments.includes(d.EnvTarget.Production)??!0,...g?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}},deployments:S?.deployments?{required:S.deployments.required,actions:S.deployments.actions.reduce((e,t)=>{let{slug:n,environments:r}=t;return e[n]=r.reduce((e,t)=>(e[t]=!0,e),{}),e},{})}:!S&&(0,N.areResourceDeploymentsEnabled)(j)?{required:!0,actions:{}}:void 0,protocolSettings:S?.protocolSettings??void 0,error:null}),[H,Z]=(0,n.useState)(!1),[Y,J]=(0,n.useState)(null),Q=(0,p.usePrevious)(g),[X,et]=(0,n.useState)(!1);(0,n.useEffect)(()=>{X||g&&(!Q||g.id===Q.id)||(et(!0),G({...W,error:null,environments:{[d.EnvTarget.Development]:!0,[d.EnvTarget.Preview]:!0,[d.EnvTarget.Production]:!0,...g?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}}))},[W,X,Q,g]);let er=(0,n.useCallback)(async()=>{if(g)try{var e,t;let n,r=[d.EnvTarget.Production,d.EnvTarget.Preview,d.EnvTarget.Development,...g.customEnvironments?.map(e=>e.slug)??[]].filter(e=>W.environments[e]),i=W.deployments?{required:W.deployments.required??!1,actions:W.deployments.required?Object.entries(W.deployments.actions??{}).map(e=>{let[t,n]=e;return{slug:t,environments:Object.entries(n).reduce((e,t)=>{let[n,i]=t;return i&&r.includes(n)&&e.push(n),e},[])}}).filter(e=>{let{environments:t}=e;return t.length>0}):[]}:void 0;if(Z(!0),J(null),G({...W,error:null}),0===r.length){G({...W,error:{environments:"Select at least one Environment for your Environment Variable"}}),Z(!1);return}if(W.envPrefix&&!/^[a-zA-Z][a-zA-Z0-9_]*$/.test(W.envPrefix)){G({...W,error:{envPrefix:"The prefix contains invalid characters. It must start with a letter and be made of letters, digits, and underscores only."}}),Z(!1);return}let s=(e=j,t=W.protocolSettings,n=(0,T.getLogDrainProtocolSettings)({protocolSettings:t}),e?.type==="integration"&&(0,y.isProtocolSupported)(e.product,"logDrain")&&n&&!n.sources.length?"Select at least one source to enable log draining":null);if(s){G({...W,error:{protocolSettings:s}}),Z(!1);return}S?await q({resourceId:A,connectionId:S.id,envVarPrefix:W.envPrefix,envVarEnvironments:r,deployments:i,protocolSettings:W.protocolSettings}):await $({projectId:g.id,envVarPrefix:W.envPrefix,envVarEnvironments:r,deployments:i,resourceId:A,protocolSettings:W.protocolSettings,v0token:U}),o.toasts.success({text:`Connected Project ${g.name} to ${(0,v.getResourceTitleByResource)(j)}`,key:g.id}),await F(g.name,j?.type==="integration"?j.product.supportedProtocols[0]:"storage"),await z(),j?.type==="integration"&&j.product.showSSOLinkOnProjectConnection?_(!0):(E&&await E(),L())}catch(e){if((0,x.isAPIError)(e))e.code===k.ResourceConnectionsErrorCodes.ProjectEnvVarNotUnique?G({...W,error:{envPrefix:e.message}}):J(e.message);else throw e}finally{Z(!1)}},[g,W,j,S,F,z,q,A,$,U,E,L]),{isWaitingForAvailableResource:eo,onSubmit:es,resourceStatus:ea,isSubmitDisabled:el}=function(e){let{initialResource:t,resourceId:r,handleSubmit:i}=e,{data:o}=(0,I.useResourceItem)({resourceId:r,revalidateStatus:!0}),[s,a]=(0,n.useState)(!1),l=o?.store.status,c=(0,n.useRef)(!1),d=o?.store??t,u=d?.type==="integration"?d.product.slug:null,{data:p}=(0,m.default)(u?"marketplace-product-block-connection-until-available":null,()=>(0,h.blockConnectionUntilResourceIsAvailable)(u));return(0,n.useEffect)(()=>{!c.current&&s&&en({blockData:p,resource:d})&&(c.current=!0,i())},[i,p,s,d]),{isWaitingForAvailableResource:!!(s&&"available"!==l&&p?.blockConnection),onSubmit:()=>{en({blockData:p,resource:d})?i():a(!0)},resourceStatus:l,isSubmitDisabled:!d||!!("integration"===d.type&&!p)}}({resourceId:A,handleSubmit:er});return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),es()},children:[(0,t.jsx)(i.Modal.Body,{children:(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(i.Modal.Title,{center:!0,children:C}),w?(0,t.jsx)(i.Modal.Subtitle,{children:w}):null]}),(0,t.jsx)(i.Modal.Inset,{last:!0,children:ei(j)&&V?(0,t.jsxs)(r.Stack,{gap:4,children:[(0,t.jsxs)(a.Text,{children:["Project ",g?.name," successfully connected to"," ",(0,v.getResourceTitleByResource)(j)]}),(0,t.jsxs)(a.Text,{children:["Complete the project configuration in the"," ",j.product.integration.name," Dashboard"]})]}):(0,t.jsxs)(r.Stack,{className:eo?"geist-disabled pointer-events-none":void 0,gap:6,children:[(0,t.jsx)(c.Link,{href:"#",style:{position:"absolute"},children:""}),M,(0,t.jsx)(ee,{resource:j}),(0,t.jsx)(K,{advancedOptions:W,isLoading:H,logDrainEnabled:B,onChangeAdvancedOptions:G,prefixPlaceholder:(0,y.getEnvPrefixByResource)(j),sampleEnvVarName:(0,y.getSampleEnvVarNameByResource)(j),store:j,connection:S}),Y?(0,t.jsx)(s.Error,{children:Y}):null]})})]})}),(0,t.jsxs)(i.Modal.Actions,{children:[(0,t.jsx)(i.Modal.Action,{onClick:V?()=>{E&&E(),L()}:P,type:"secondary",children:V?"Later":u}),ei(j)&&V?(0,t.jsx)(R.OpenInPartnerDashboardButton,{buttonVariant:"default",componentType:"button",integrationConfigurationId:j.product.integrationConfigurationId,label:`Open in ${j.product.integration.name}`,onClick:()=>{E&&E(),L()},productId:j.product.id,externalResourceId:j.externalResourceId,teamIdOrSlug:j.ownerId,projectId:g?.id,path:"onboarding"}):(0,t.jsx)(i.Modal.Action,{buttonType:"submit","data-testid":(0,l.tid)("connect-project","store-modal-connect-project"),disabled:!g||el,loading:H||eo,type:eo?"secondary":"default",children:eo?(0,t.jsx)(D.ResourceStatus,{resource:ea?{status:ea}:null}):S?"Update":"Connect"})]})]})}function ei(e){return!!(e?.type==="integration"&&e.product.showSSOLinkOnProjectConnection)}function eo(e){let{active:r,store:o,onClickOutside:s,onAnimationDone:a,onConnectionCreated:l,resourceId:c}=e,[d,p]=(0,n.useState)(null),{team:x,user:m}=(0,u.useAccount)(),h=x?x.slug:m?.username,j=(0,g.useServerFlag)("enable-marketplace-drains",!1);return(0,t.jsx)(i.Modal.Modal,{active:r,allowOverflow:!0,onAnimationDone:a,onClickOutside:s,width:540,children:(0,t.jsx)(er,{ProjectSelector:(0,t.jsx)(L.ResourceProjectSelector,{account:h,allowSelectConnectedProjects:o?.type==="integration"&&(0,y.isProtocolSupported)(o.product,"logDrain"),connectedProjectIds:o?.projectsMetadata.map(e=>e.projectId)??[],onProjectSelected:e=>{p(e)},resource:o??void 0,resourceTitle:(0,v.getResourceTitleByResource)(o),selectedProject:d}),backOrCancelLabel:"Cancel",onBack:s,onClickOutside:s,onConnectionCreated:l,project:d,resourceId:c,store:o,title:(0,T.getConnectProjectOrLogDrainLabel)(o,j)})})}function es(e){let{resource:i}=e,{onClose:o,onBack:s,state:l,onResourceUpdated:c}=(0,S.useResourceModalsContext)(),{type:d}=i,{projectSlug:u}=(0,P.useProjectSlug)(),p=(0,j.useProject)(u),g=(0,n.useCallback)(()=>{c({resource:i,isConnected:!0})},[c,i]);return l.type!==w.ResourceModalsActionTypes.CreateEnvs||"integration"!==d?null:(0,t.jsx)(er,{backOrCancelLabel:l.backOrCancelLabel,onBack:s,onClickOutside:o,onConnectionCreated:g,project:p.data,resourceId:i.id,store:i,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(C.ProductIcon,{icon:i.product.iconUrl,size:"small"}),(0,t.jsx)(a.Text,{color:"gray-1000",weight:500,children:i.name})]}),title:`Configure ${p.data?.name??""}`})}function ea(e){let{active:n,store:o,connection:s,resourceId:l,onClickOutside:c,onAnimationDone:d,onConnectionCreated:u}=e,p=(0,j.useProject)(s.projectId);return"integration"!==o.type?null:(0,t.jsx)(i.Modal.Modal,{active:n,allowOverflow:!0,onAnimationDone:d,onClickOutside:c,width:540,children:(0,t.jsx)(er,{backOrCancelLabel:"Cancel",connection:s,onBack:c,onClickOutside:c,onConnectionCreated:u,project:p.data,resourceId:l,store:o,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(C.ProductIcon,{icon:o.product.iconUrl,size:"small"}),(0,t.jsx)(a.Text,{color:"gray-1000",weight:500,children:o.name})]}),title:`Configure ${p.data?.name??""}`})})}e.s(["ConnectResourceForCurrentProjectStep",()=>es,"CreateResourceConnectionModal",()=>eo,"CreateResourceConnectionModalStep",()=>er,"UpdateResourceConnectionModal",()=>ea],7137779);var el=e.i(7722264),ec=e.i(3703009),ed=e.i(5098510);function eu(e){let{active:l,onClickOutside:c,connections:d,onAnimationDone:u,resourceId:p,resource:g}=e,{removeConnections:x}=(0,k.useResourceConnection)(),[m,h]=(0,n.useState)(!1),[j,f]=(0,n.useState)(null),v=(0,o.useToasts)(),b=(0,n.useCallback)(async e=>{e.preventDefault(),f(null),h(!0);try{await x({connectionIds:d.map(e=>e.id),resourceId:p}),h(!1),c()}catch(e){h(!1),(0,el.isError)(e)?f(e):v.error(`Unexpected error while removing the ${g?.name||"resource"} connection`)}},[x,d,p,c,v,g]),y=d.some(e=>(0,T.isLogDrainInConnection)(e));return(0,t.jsx)(i.Modal.Modal,{active:l,onAnimationDone:u,onClickOutside:c,children:(0,t.jsxs)("form",{onSubmit:e=>void b(e),children:[(0,t.jsx)(i.Modal.Body,{children:(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(i.Modal.Title,{center:!1,children:["Remove"," ",y?"Project Connection & Log Drain":"Project Connection"]}),(0,t.jsxs)(r.Stack,{gap:6,children:[(0,t.jsxs)(r.Stack,{gap:2,children:[(0,t.jsx)(a.Text,{children:"Are you sure you want to remove this project connection?"}),(0,t.jsxs)(a.Text,{children:["Removing the connection will delete the associated environment variables from the project and future deployments will not be able to access"," ",g?.name?(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"inline-block align-bottom",children:(0,t.jsx)(ec.StoreIconOrAvatar,{icon:"integration"===g.type?g.product.integration.icon:void 0,size:"small",type:g.type})})," ",(0,t.jsx)("span",{className:"align-bottom font-semibold",children:g.name})]}):"this resource","."]})]}),(0,t.jsxs)(r.Stack,{gap:3,children:[(0,t.jsx)(a.Text,{color:"gray-900",children:"Projects"}),(0,t.jsx)(ed.ProjectConnectionsListInModal,{connections:d})]}),j?(0,t.jsx)(s.Error,{children:j.message}):null]})]})}),(0,t.jsxs)(i.Modal.Actions,{children:[(0,t.jsx)(i.Modal.Action,{disabled:m,onClick:c,type:"secondary",children:"Cancel"}),(0,t.jsx)(i.Modal.Action,{buttonType:"submit",disabled:m,loading:m,children:1===d.length?"Remove Connection":`Remove ${d.length} Connections`})]})]})})}e.s(["DeleteStoreConnectionModal",()=>eu],2483721)}]);

//# sourceMappingURL=7053a6a193f50877.js.map
//# debugId=d509dd8c-e00c-5e1f-af0b-6529da5e2791
