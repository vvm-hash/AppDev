
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2aa33b1b-1472-5b8f-930c-1dd07c2467e7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5463680,6769352,e=>{"use strict";e.i(6356390),e.i(15312);var t=e.i(7897830);e.i(39509);var n=e.i(6468255),r=e.i(2504781),i=e.i(5468328);e.i(3182268);var a=e.i(7849855);e.i(6887680);var o=e.i(6810699),s=e.i(1414602),l=e.i(5074599);function d(e){let{onSuccess:d,protocolType:u,label:g,hideIfHasNoStores:m=!0,buttonType:h="default"}=e,{projectSlug:f}=(0,a.useProjectAndTeamSlug)(),{data:p}=(0,o.useResourceList)({projectSlug:f,protocolType:u}),{openBrowseProducts:v}=(0,t.useResourceModals)({onSuccess:d}),{permissions:E,isLoading:x}=(0,s.useResourcePermissions)();if(x)return(0,n.jsx)(c,{});let C=!!(p&&p.stores.length>0);return m&&!C?(0,n.jsx)(c,{}):(0,n.jsx)(i.Tooltip,{disableTriggers:E.create,text:(0,l.missingPermissionLabel)("create",u),children:(0,n.jsx)(r.Button,{disabled:!E.create,onClick:()=>v("browse-new"),type:h,typeName:"button",children:g??(0,l.createResourceButtonLabel)(u)})})}function c(){return(0,n.jsx)("div",{style:{height:40}})}e.s(["CreateResourceButton",()=>d],6769352),e.s([],5463680)},7037808,e=>{"use strict";e.i(2014455),e.i(8824424),e.i(7137779),e.i(5098510),e.i(2483721),e.s([])},5377189,e=>{"use strict";var t=e.i(4614946),n=e.i(1717203);e.i(717172);var r=e.i(5993275);function i(e){let{storeType:i,teamSlug:a}=e,{fallback:o}=(0,t.useSWRConfig)(),{can:s,isLoading:l}=(0,n.default)(),d=a?o[i?`store:preload-data:${a}`:`store:list-preload-data:${a}`]:null;return{permissions:d?.permissions??(0,r.getStoreItemPermissions)({storeType:i,can:s,isLoading:l})}}e.s(["useStorePermissions",()=>i],5377189)},1000921,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.25 7.25H4.5V8.75H5.25H9.43934L7.96967 10.2197L7.43934 10.75L8.5 11.8107L9.03033 11.2803L11.7803 8.53033C12.0732 8.23744 12.0732 7.76256 11.7803 7.46967L9.03033 4.71967L8.5 4.18934L7.43934 5.25L7.96967 5.78033L9.43934 7.25H5.25ZM8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5ZM0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8Z" fill="currentColor"/>');e.s(["ArrowCircleRight",0,t])},8587921,7873387,e=>{"use strict";var t=e.i(6696646),n=e.i(3911483),r=e.i(8815282),i=e.i(8042625),a=e.i(277234),o=e.i(4244280),s=e.i(9668517),l=e.i(5338940),d=e.i(1717203),c=e.i(7557283);let u=e=>(n,r,i)=>{let a=(0,t.useRef)(void 0),o=e(n,r,i);(0,t.useEffect)(()=>{void 0!==o.data&&(a.current=o.data)},[o.data]);let s=(0,t.useCallback)(()=>{a.current=void 0},[]);return{...o,data:void 0===o.data?a.current:o.data,isLagging:void 0===o.data&&void 0!==a.current,resetLaggy:s}};function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{search:g,limit:m,role:h,eligibleMembersForProjectId:f,sort:p="date_desc",filterByUserIds:v,includeEntitlements:E,mfaStateFilter:x,includePermissionRequests:C}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},T=arguments.length>2&&void 0!==arguments[2]&&arguments[2],j=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{isReady:b,team:S}=(0,l.useTeam)(),{isLoading:y,can:P}=(0,d.default)(),I=!y&&P(c.Action.List,c.Resource.TeamFellowMembership),R=(0,s.useTeamSlug)(),A=m||20,M=(0,r.default)((e,t)=>{if(!b||!S||!I)return null;if(0===e)return`${o.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,i.encode)({sort:p,limit:A,search:g,role:h,eligibleMembersForProjectId:f,filterByUserIds:v,includeEntitlements:!!E||void 0,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:C})}`;let n=t?.pagination.nextPageCursor;return n?`${o.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,i.encode)({sort:p,limit:A,nextPageCursor:n,search:g,role:h,eligibleMembersForProjectId:f,includeEntitlements:!!E||void 0,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:C})}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),{...e,use:T?[u]:[]});(0,t.useEffect)(()=>{T&&M.resetLaggy()},[R,T]);let k=(0,t.useMemo)(()=>M.data?.flatMap(e=>e.members.slice(0,A))||[],[M.data,A]),w=(0,t.useMemo)(()=>M.data?.flatMap(e=>e.permissionRequests||[])||[],[M.data]),_=!!M.data,$=_&&0===k.length,L=!!(_&&M.data&&M.size>M.data.length),O=!!(_&&M.data&&!M.data[M.data.length-1]?.pagination?.nextPageCursor);return(0,n.default)(()=>{if(!j||!M.data||O||!b||!S)return null;let e=M.data[M.data.length-1].pagination.nextPageCursor;return`${o.API_TEAMS_MEMBERS_V3}/${S.id}/members${(0,i.encode)({sort:p,limit:A,nextPageCursor:e,search:g,role:h,eligibleMembersForProjectId:f,includeEntitlements:E,filterByMfaState:"all"!==x?x:void 0,includePermissionRequests:C})}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0})),[M,{members:k,permissionRequests:w.filter(e=>null!=e),initialDataLoaded:_,isEmpty:$,loadMore:()=>M.setSize(M.size+1),isLoadingMore:L,isReachingEnd:O,isLagging:M.isLagging}]}function m(){let{sort:e="date_desc",limit:t=20,filterByUserIds:r,until:s,role:u,includeEntitlements:g,includePermissionRequests:m}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{isReady:f,team:p}=(0,l.useTeam)(),{isLoading:v,can:E}=(0,d.default)(),x=!v&&E(c.Action.List,c.Resource.TeamFellowMembership);return(0,n.default)(()=>f&&p&&x?`${o.API_TEAMS_MEMBERS_V3}/${p.id}/members${(0,i.encode)({sort:e,until:s,limit:t,role:u,filterByUserIds:r,includeEntitlements:g,includePermissionRequests:m})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),h)}function h(e){let{limit:t=20,until:r,role:s,sort:l="date_desc"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,n.default)(()=>e?`${o.API_TEAMS_MEMBERS_V3}/${e.id}/members${(0,i.encode)({until:r,limit:t,role:s,sort:l})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),d)}function f(){let{limit:e=25,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{can:o,isLoading:u}=(0,d.default)(),g=!u&&o(c.Action.Create,c.Resource.TeamFellowMembership),{isReady:m,team:h}=(0,l.useTeam)(),f=(0,s.useTeamSlug)(),p=(0,r.default)((t,n)=>{if(!m||!h||!g)return null;if(!t)return`/api/teams/${f}/members/suggested${(0,i.encode)({limit:e})}`;let r=n?.members,a=r?.length===e?r[r.length-1].email:null;return a?`/api/teams/${f}/members/suggested${(0,i.encode)({limit:e,from:a})}`:null},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n),v=(0,t.useMemo)(()=>p.data?.flatMap(t=>t.members.slice(0,e))||[],[p.data,e]),E=!!p.data,x=E&&0===v.length,C=!!(E&&p.data&&p.size>p.data.length),T=!!(E&&p.data&&p.data[p.data.length-1]?.members.length<e);return[p,{members:v,initialDataLoaded:E,isEmpty:x,loadMore:()=>p.setSize(p.size+1),isLoadingMore:C,isReachingEnd:T}]}e.s(["default",0,u],7873387),e.s(["MEMBERS_LIMIT",0,20,"default",()=>m,"useMembersForTeam",()=>h,"useMembersInfinite",()=>g,"useSuggestedMembersInfinite",()=>f],8587921)},4723202,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(2504781),i=e.i(5255926),a=e.i(455575),o=e.i(5468328),s=e.i(277234),l=e.i(5338940),d=e.i(8587921),c=e.i(5140444),u=e.i(8248823),g=e.i(57106);function m(e){let{teamRole:s,variant:m="card"}=e,{team:f,isLoading:p}=(0,l.useTeam)(),{hasRequestedRole:v,mutate:E,isLoading:x}=function(e){let{user:t,isLoading:n}=(0,c.useUser)(),{data:r,mutate:i,isLoading:a}=(0,d.default)({includePermissionRequests:!0}),o=r?.permissionRequests;return{hasRequestedRole:o?.some(n=>n.uid===t?.uid&&n.requestedTeamRole.includes(e))??!1,mutate:i,isLoading:n||a}}(s),[C,T]=(0,n.useState)(!1),[j,b]=(0,n.useState)(!1);if(f?.membership?.role!=="VIEWER_FOR_PLUS")return null;let S=v||j;return(0,t.jsx)(i.Skeleton,{show:x||p,children:(0,t.jsx)(o.Tooltip,{disableTriggers:!S,text:(0,t.jsxs)(t.Fragment,{children:["An Owner of the team can accept your request. Requests are managed in the"," ",(0,t.jsx)(g.Link,{href:`/${f?.slug}/~/settings/members`,type:"highlight",children:"team members page"}),"."]}),children:(0,t.jsx)(r.Button,{disabled:S,loading:C,className:"card"===m?"text-label-14 font-medium":void 0,onClick:async()=>{if(f?.id){T(!0);try{await h(f.id,s),E(),b(!0),a.toasts.success("Request for the Member role has been sent")}catch(e){a.toasts.error((0,u.errorToString)(e,"Failed to send request"))}finally{T(!1)}}},size:"card"===m?"small":void 0,type:"card"===m?"tertiary":void 0,children:S?"Access Requested":"Request Access"})})})}async function h(e,t){await (0,s.fetchAPI)(`/api/teams/${e}/role-requests?teamId=${e}`,{method:"POST",body:JSON.stringify({teamRoles:[t]}),throwOnHTTPError:!0})}e.s(["RequestRoleButton",()=>m])},8556491,e=>{"use strict";var t=e.i(6468255),n=e.i(4723202),r=e.i(57106),i=e.i(1235157),a=e.i(119294),o=e.i(6352514);function s(e){let{role:s,team:l,actionLabel:d,dataTestId:c}=e;return(0,t.jsx)("div",{className:"absolute inset-0 z-[100] flex items-center justify-center bg-[rgba(255,255,255,0.5)] dark:bg-[rgba(0,0,0,0.5)]",children:(0,t.jsx)("div",{className:"absolute top-0 md:top-[80px] left-1/2 -translate-x-1/2 z-[101] w-full max-w-[560px] animate-[fadeIn_300ms_ease-in-out_forwards] pointer-events-auto","data-testid":c,children:(0,t.jsxs)("div",{className:"shadow-lg md:rounded-lg max-w-full bg-white overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,t.jsx)("span",{className:"text-heading-24",children:"Additional Permissions Required"}),(0,t.jsxs)("div",{children:["As a ",(0,t.jsx)("strong",{children:s?(0,i.getRoleName)(s):"Viewer"})," user on the ",(0,t.jsx)("strong",{children:l?.name})," team, you do not have permission to ",d,"."]}),(0,t.jsxs)("div",{className:"text-center break-words pt-2 text-gray-900",children:["Learn more about"," ",(0,t.jsx)(r.Link,{external:!0,href:"/docs/rbac/access-roles",onClick:()=>{a.analytics.track(o.AnalyticsEvent.PERMISSIONS_CLICKED_LEARN_MORE)},type:"highlight",children:"Roles and Permissions"})]})]}),"VIEWER_FOR_PLUS"===s?(0,t.jsx)("div",{className:"flex justify-end items-center bg-background-200 p-4 border-t mt-2",children:(0,t.jsx)(n.RequestRoleButton,{teamRole:"MEMBER",variant:"modal"})}):null]})})})}e.s(["AdditionalPermissionsRequiredModal",()=>s])},1068837,e=>{"use strict";var t=e.i(6468255),n=e.i(1717203),r=e.i(8556491);function i(e){let{actionLabel:i,permissionChecks:a}=e,{can:o,isLoading:s,accessInfo:l}=(0,n.default)(),d=a.every(e=>{let[t,n]=e;return o(t,n)});return s||d?null:(0,t.jsx)(r.AdditionalPermissionsRequiredModal,{role:l?.role,team:l?.team??void 0,actionLabel:i})}e.s(["AdditionalPermissionsRequiredModalClient",()=>i])},5919007,e=>{"use strict";function t(e){if("number"==typeof e.resourceConfig?.edgeConfigSize)return 1e3*e.resourceConfig.edgeConfigSize;switch(e.billing?.plan){case"enterprise":return 512e3;case"pro":return 64e3;default:return 8e3}}function n(e){if("number"==typeof e.resourceConfig?.edgeConfigs)return e.resourceConfig.edgeConfigs;switch(e.billing?.plan){case"enterprise":return 10;case"pro":return"trialing"===e.billing.status?1:3;default:return 1}}e.s(["EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH",0,52,"getMaxEdgeConfigs",()=>n,"getSizeLimitInBytes",()=>t])},2843591,e=>{"use strict";var t=e.i(3911483),n=e.i(6696646),r=e.i(8815282),i=e.i(8042625),a=e.i(277234),o=e.i(4244280),s=e.i(5338940);e.i(6887680);var l=e.i(6810699);function d(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}/schema${(0,i.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function c(){let e=(0,l.useResourceList)({protocolType:"storage"});return{data:(0,n.useMemo)(()=>e.data?.stores.filter(e=>"edge-config"===e.type),[e.data?.stores])}}function u(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}${(0,i.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function g(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}/items${(0,i.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function m(e,n){let{isReady:r,team:l}=(0,s.useTeam)();return(0,t.default)(()=>e&&r?`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}/tokens${(0,i.encode)({teamId:l?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),n)}function h(e,t,n){let{isReady:l,team:d}=(0,s.useTeam)();return(0,r.default)((t,r)=>{if(!e||!l||r&&!r.pagination.hasNext)return null;let a={teamId:d?.id,metadata:n?.metadata?"true":void 0,limit:n?.limit||25,next:r?.pagination.next};0===t&&(a.limit+=1);let s=`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}/backups`;return`${s}${(0,i.encode)(a)}`},e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),{revalidateFirstPage:!1,revalidateOnFocus:!1,...t})}function f(e,n,r){let{isReady:l,team:d}=(0,s.useTeam)();return(0,t.default)(()=>e&&n&&"current"!==n&&l?`${o.API_EDGE_CONFIG}/${encodeURIComponent(e)}/backups/${encodeURIComponent(n)}${(0,i.encode)({teamId:d?.id})}`:null,e=>(0,a.fetchAPI)(e,{throwOnHTTPError:!0}),r)}function p(e){let{edgeConfig:t,project:n}=e;return{...t,type:"edge-config",projectsMetadata:n?[{projectId:n.id,name:n.name,framework:n.framework,id:"",environments:[],environmentVariables:[],envVarPrefix:null}]:[],name:t.slug,status:"available",totalConnectedProjects:+!!n}}e.s(["mapEdgeConfigToStoreType",()=>p,"useEdgeConfig",()=>u,"useEdgeConfigBackup",()=>f,"useEdgeConfigBackupsInfinite",()=>h,"useEdgeConfigItems",()=>g,"useEdgeConfigSchema",()=>d,"useEdgeConfigTokens",()=>m,"useEdgeConfigs",()=>c])},8564753,e=>{"use strict";e.i(9584471),e.s([])},4348614,e=>{e.v({expanderWrapper:"store-advanced-options-expander-module__QIqk3G__expanderWrapper",expanderWrapperExpanded:"store-advanced-options-expander-module__QIqk3G__expanderWrapperExpanded"})},1261558,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(1344973),i=e.i(9722978);e.i(8703064);var a=e.i(7507521),o=e.i(4348614);function s(e){let{children:s,isExpandedDefault:l}=e;return(0,t.jsx)(a.Expander,{className:(0,i.clsx)(o.default.expanderWrapper),expandedClassName:o.default.expanderWrapperExpanded,isExpandedDefault:l,title:(0,t.jsxs)(n.Stack,{direction:"row",gap:1,paddingX:3,paddingY:2,children:[(0,t.jsx)(a.ExpanderTrigger,{}),(0,t.jsx)(r.Text,{color:"gray-900",size:13,weight:500,children:"Advanced Options"})]}),children:(0,t.jsx)(n.Stack,{paddingX:3,paddingY:2,children:s})})}e.s(["StoreAdvancedOptionsExpander",()=>s])},8206804,e=>{"use strict";var t=e.i(6468255);e.s(["default",0,function(e){let{margin:n=50,className:r}=e;return(0,t.jsx)("hr",{className:r,style:{border:"0",borderTop:"1px solid var(--accents-2)",margin:"number"==typeof n?`${n}px 0`:`${n} 0`}})}])},9512272,e=>{"use strict";var t=e.i(8042625),n=e.i(277234),r=e.i(4244280),i=e.i(5927860);function a(e){return e.startsWith("VERCEL_")}function o(e){return e.map(e=>{let t,n=e.type;return void 0===n&&(n=a(e.name)?i.EnvType.System:i.EnvType.Encrypted),e.target&&(t=Array.isArray(e.target)?e.target:[e.target]),{type:n,key:e.name,value:n===i.EnvType.System?e.name:e.value,target:t??[i.EnvTarget.Production,i.EnvTarget.Preview,i.EnvTarget.Development],gitBranch:e.gitBranch,comment:e.comment,customEnvironmentIds:e.customEnvironmentIds}})}async function s(e,i,a){let s=o(i);return(0,n.fetchAPI)(`${(0,r.API_PROJECTS_VERSION)("v10")}/${e}/env${(0,t.encode)({teamId:a})}`,{method:"POST",body:JSON.stringify(s),throwOnHTTPError:!0})}async function l(e,i,a){await (0,n.fetchAPI)(`${(0,r.API_PROJECTS_VERSION)("v4")}/${e}/env/${i.key}${(0,t.encode)({teamId:a,target:i.target})}`,{method:"DELETE",throwOnHTTPError:!0})}e.s(["addEncryptedEnvs",()=>o,"addEnvs",()=>s,"isSystemEnv",()=>a,"legacyRemoveEnv",()=>l])},4429570,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(6891161),i=e.i(455575),a=e.i(4030453),o=e.i(6696646),s=e.i(8042625),l=e.i(277234),d=e.i(4244280),c=e.i(5927860),u=e.i(7917902),g=e.i(4422059),m=e.i(4004502),h=e.i(5919007),f=e.i(9512272);e.i(7037808);var p=e.i(8824424);e.i(8564753);var v=e.i(9584471),E=e.i(3500331),x=e.i(8206804),C=e.i(2014455),T=e.i(1261558);function j(e){let{advancedOptions:r,tokenLabelPlaceholder:i,onAdvancedOptionsChange:a,isLoading:o}=e;return(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsx)(C.ResourceEnvironmentSelector,{environments:r.environments,error:r.error?.environments,onChange:e=>a({...r,environments:e,error:{...r.error,environments:void 0}}),resourceTitle:"store"}),(0,t.jsx)(T.StoreAdvancedOptionsExpander,{isExpandedDefault:!!r.error,children:(0,t.jsxs)(n.Stack,{gap:3,children:[(0,t.jsx)(n.Stack,{gap:3,children:(0,t.jsx)(E.Input,{"aria-label":"Environment Variable",disabled:o,error:r.error?.envVarName,label:"Environment Variable",onChange:e=>a({...r,envVarName:e.currentTarget.value,error:{...r.error,envVarName:void 0}}),placeholder:"EDGE_CONFIG",value:r.envVarName,width:"100%"})}),(0,t.jsx)(x.default,{margin:0}),(0,t.jsx)(n.Stack,{gap:3,children:(0,t.jsx)(E.Input,{"aria-label":"Token label",disabled:o,label:"Token label",maxLength:h.EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH,onChange:e=>a({...r,tokenName:e.currentTarget.value}),placeholder:i,value:r.tokenName,width:"100%"})})]})})]})}function b(e){let{backOrCancelLabel:p,edgeConfig:E,title:x,subtitle:C,ProjectSelector:T,onClickOutside:b,onConnectionCreated:S,onBack:y,project:P}=e,{mutateByProtocol:I}=(0,v.useMutateResourceCache)(),[R,A]=(0,o.useState)({envVarName:"",tokenName:"",environments:{[c.EnvTarget.Development]:!0,[c.EnvTarget.Preview]:!0,[c.EnvTarget.Production]:!0,...P?.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}}),[M,k]=(0,o.useState)(!1),[w,_]=(0,o.useState)(null),{team:$}=(0,u.useAccount)(),L=(0,g.usePrevious)(P);(0,o.useEffect)(()=>{null!==R.error&&(!P||L&&P.id!==L.id)&&A({...R,error:null}),P&&(null===L||L&&P.id!==L.id)&&A({...R,environments:{[c.EnvTarget.Development]:!0,[c.EnvTarget.Preview]:!0,[c.EnvTarget.Production]:!0,...P.customEnvironments?.reduce((e,t)=>(e[t.slug]=!0,e),{})??{}}})},[R,L,P]);let O=(0,o.useMemo)(()=>{if(!P)return"";let e=P.name.slice(0,h.EDGE_CONFIG_TOKEN_LABEL_MAX_LENGTH-6);return`${e.replace(/-*$/g,"")}-token`},[P]),N=R.tokenName||O,B=R.envVarName||"EDGE_CONFIG",D=(0,o.useCallback)(async e=>{if(e.preventDefault(),!E||M||!P)return;let t=[c.EnvTarget.Production,c.EnvTarget.Preview,c.EnvTarget.Development,...P.customEnvironments?.map(e=>e.slug)||[]].filter(e=>R.environments[e]);try{if(_(null),k(!0),A({...R,error:null}),0===t.length){A({...R,error:{environments:"Select at least one Environment for your Environment Variable"}}),k(!1);return}if(P.env&&P.env.some(e=>e.key===B&&("string"==typeof e.target?t.includes(e.target):e.target.some(e=>t.includes(e))))){A({...R,error:{envVarName:1===t.length?`This project already has an environment variable called ${B} in the chosen environment.`:`This project already has an environment variable called ${B} in one of the chosen environments.`}}),k(!1);return}let e=await (0,l.fetchAPI)(`${d.API_EDGE_CONFIG}/${E.id}/token${(0,s.encode)({teamId:$?.id})}`,{method:"POST",throwOnHTTPError:!0,body:{label:N}});await (0,f.addEnvs)(P.id,[{name:B,value:`https://edge-config.vercel.com/${E.id}?token=${e.token}`,type:c.EnvType.Encrypted,target:t.filter(e=>(0,c.isSystemEnvTarget)(e)),customEnvironmentIds:t.filter(e=>!(0,c.isSystemEnvTarget)(e)).map(e=>{let t=P.customEnvironments?.find(t=>t.slug===e);return t?.id}).filter(e=>void 0!==e)}],$?.id),await S(),b(),i.toasts.success({text:`Connected Project ${P.name} to Edge Config ${E.slug}`,key:E.slug}),await I("storage")}catch(e){if(e instanceof Error)_(e);else throw e}finally{k(!1)}},[E,M,P,R,$?.id,N,B,S,b,I]);return(0,t.jsxs)("form",{onSubmit:e=>void D(e),children:[(0,t.jsx)(r.Modal.Body,{children:(0,t.jsxs)(n.Stack,{gap:6,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[(0,t.jsx)(r.Modal.Title,{center:!0,children:x}),C?(0,t.jsx)(r.Modal.Subtitle,{children:C}):null]}),(0,t.jsx)(r.Modal.Inset,{last:!0,children:(0,t.jsxs)(n.Stack,{gap:6,children:[T,(0,t.jsx)(j,{advancedOptions:R,isLoading:M,onAdvancedOptionsChange:A,tokenLabelPlaceholder:P?O:""}),w?(0,t.jsx)(a.Error,{children:w.message}):null]})})]})}),(0,t.jsxs)(r.Modal.Actions,{children:[(0,t.jsx)(r.Modal.Action,{onClick:y,type:"secondary",children:p}),(0,t.jsx)(r.Modal.Action,{buttonType:"submit","data-testid":(0,m.tid)("connect-edge-config-modal","connect-button"),disabled:!P||""===B.trim()||""===N.trim(),loading:M,children:"Connect"})]})]})}function S(e){let{active:n,edgeConfig:i,onClickOutside:a,onConnectionCreated:s,onAnimationDone:l}=e,[d,c]=(0,o.useState)(null),{team:g,user:m}=(0,u.useAccount)(),h=g?g.slug:m?.username;return(0,t.jsx)(r.Modal.Modal,{active:n,allowOverflow:!0,onAnimationDone:l,onClickOutside:a,width:540,children:(0,t.jsx)(b,{ProjectSelector:(0,t.jsx)(p.ResourceProjectSelector,{account:h,allowSelectConnectedProjects:!0,includedInConnectedProjects:e=>e?.env?.some(e=>e.edgeConfigId===i?.id)??!1,onProjectSelected:e=>{c(e)},resourceTitle:"store",selectedProject:d}),backOrCancelLabel:"Cancel",edgeConfig:i,onBack:a,onClickOutside:a,onConnectionCreated:s,project:d,title:"Connect Project"})})}e.s(["ConnectEdgeConfigModal",()=>S,"CreateEdgeConfigConnectionModalStep",()=>b],4429570)},1758334,e=>{"use strict";var t=e.i(6696646);e.i(6887680);var n=e.i(6810699),r=e.i(3798983);function i(e){return"edge-config"===e?64:32}e.s(["MAX_STORE_NAME_LENGTH",0,32,"getStoreNameLengthByType",()=>i,"useStoreName",0,e=>{let{storeType:a,storeId:o,...s}=e,l=(0,t.useMemo)(()=>{if("projectName"in s&&s.projectName){let e=r.storeDefaultNameSuffix[a];return[s.projectName.replaceAll("_","-").slice(0,i(a)-e.length),e].join("")}return"storeName"in s?s.storeName??"":""},[s,a]),[d,c]=(0,t.useState)(),[u,g]=(0,t.useState)(),{isNameTaken:m}=(0,n.useResourceList)({protocolType:"storage"});return{storeNameError:d,name:u??l,setName:(0,t.useCallback)(e=>{let t=e.trim(),n=i(a),r="edge-config"===a?1:5;c(void 0),g(t),t.length<r?c(`The name must be at least ${r} characters.`):t.length>n?c(`The name must be at most ${n} characters.`):/^[a-zA-Z0-9_-\s]*$/.test(t)?m({name:t,storeType:a,storeId:o})&&c("This name is already in use by another store"):c("The name can only contain letters, numbers, and the following characters: _ - ")},[m,a,o]),touched:!!u&&u!==l}}])},2886798,e=>{"use strict";e.i(9691190),e.i(1055938),e.i(680627),e.i(3183079),e.i(7512194),e.i(3788585),e.s([])},562291,e=>{"use strict";var t=e.i(6468255),n=e.i(9508212),r=e.i(8522580),i=e.i(1717203),a=e.i(7557283),o=e.i(57106);e.i(8703064);var s=e.i(6798946),l=e.i(4981413),d=e.i(3798983),c=e.i(3703009);function u(e){let{onClickStore:u,storeTypeWithProduct:g,showCreateButton:m=!1}=e,{can:h,isLoading:f}=(0,i.default)(),p={"edge-config":h(a.Action.Create,a.Resource.EdgeConfig),blob:h(a.Action.Create,a.Resource.Blob),integration:h(a.Action.Create,a.Resource.Integration)};return(0,t.jsxs)(n.Stack,{gap:4,children:[(0,t.jsxs)(n.Stack,{gap:2,children:[["edge-config","blob"].map(e=>(0,t.jsx)(s.CreateResourceCard,{Icon:(0,t.jsx)(c.StoreIcon,{size:"large",type:e,useColor:!0}),description:d.storeDescription[e],isDisabled:f||!p[e],isSelected:g?.type===e,name:d.storeTitle[e],onClick:()=>{u({type:e})},showCreateButton:m,tooltip:{text:`You need additional permission to create a ${d.storeTitleFull[e]}.`,isEnabled:!p[e]}},e)),(0,t.jsxs)(r.Note,{fill:!0,type:"secondary",children:["KV and Postgres are now available through the Marketplace."," ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/storage",target:"_blank",children:"Learn more"})]})]}),(0,t.jsx)(l.BrowseProducts,{onClickProduct:u,protocolType:"storage",selectedProduct:g,showCreateButton:m})]})}e.s(["BrowseStoresCards",()=>u],562291)},3322174,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(9508212),i=e.i(1344973),a=e.i(6060673);e.i(7037808);var o=e.i(7137779);e.i(5463680);var s=e.i(39509);e.i(3182268);var l=e.i(7849855);e.i(2886798);var d=e.i(3183079),c=e.i(4429570),u=e.i(3703009),g=e.i(2782729);function m(e){let{store:m}=e,{projectSlug:h}=(0,l.useProjectSlug)(),f=(0,a.useProject)(h),{onBack:p,onClose:v,state:E,onResourceUpdated:x}=(0,d.useResourceModalsContext)(),{type:C}=m,T=(0,n.useCallback)(()=>{x({resource:m,isConnected:!0})},[m,x]);if(E.type!==s.ResourceModalsActionTypes.CreateEnvs)return null;switch(C){case"edge-config":return(0,t.jsx)(c.CreateEdgeConfigConnectionModalStep,{backOrCancelLabel:E.backOrCancelLabel,edgeConfig:{id:m.id,slug:m.name},onBack:p,onClickOutside:v,onConnectionCreated:T,project:f.data,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(i.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(u.StoreIconOrAvatar,{icon:(0,g.getStoreIcon)(m),size:"small",type:m.type,useColor:!0}),(0,t.jsx)(i.Text,{color:"gray-1000",weight:500,children:m.name})]}),title:`Configure ${f.data?.name??""}`});case"blob":case"integration":return(0,t.jsx)(o.CreateResourceConnectionModalStep,{backOrCancelLabel:E.backOrCancelLabel,onBack:p,onClickOutside:v,onConnectionCreated:T,project:f.data,resourceId:m.id,store:m,subtitle:(0,t.jsxs)(r.Stack,{align:"center",direction:"row",gap:1.5,justify:"center",children:[(0,t.jsx)(i.Text,{color:"gray-900",children:"Connect to"}),(0,t.jsx)(u.StoreIconOrAvatar,{icon:(0,g.getStoreIcon)(m),size:"small",type:m.type,useColor:!0}),(0,t.jsx)(i.Text,{color:"gray-1000",weight:500,children:m.name})]}),title:`Configure ${f.data?.name??""}`});default:return null}}function h(e){let{active:n,store:r,key:i}=e,{onClose:a,onAnimationDone:s,onResourceUpdated:l}=(0,d.useResourceModalsContext)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.ConnectEdgeConfigModal,{active:"edge-config"===r.type&&n,edgeConfig:r,onAnimationDone:s,onClickOutside:a,onConnectionCreated:a},i),(0,t.jsx)(o.CreateResourceConnectionModal,{active:"edge-config"!==r.type&&n,onAnimationDone:s,onClickOutside:a,onConnectionCreated:()=>l({resource:r,isConnected:!0}),resourceId:r.id,store:r},i)]})}e.s(["ConnectStoreSwitch",()=>m,"ConnectStoreSwitchWithoutProject",()=>h])},4553963,e=>{"use strict";var t=e.i(6468255),n=e.i(2504781),r=e.i(6864621);function i(e){let{setShowCreateDatabaseModal:i}=(0,r.useCreateDatabaseModal)();return(0,t.jsx)(n.Button,{onClick:()=>i(!0),...e})}e.s(["CreateDatabaseModalTrigger",()=>i])},4174946,e=>{"use strict";var t=e.i(6468255),n=e.i(6696646),r=e.i(5155984),i=e.i(9508212),a=e.i(1344973),o=e.i(57106),s=e.i(1000921),l=e.i(2652226),d=e.i(3798983),c=e.i(5551580);e.i(2886798);var u=e.i(7512194),g=e.i(2782729),m=e.i(8922739),h=e.i(1068837),f=e.i(7557283);function p(e){let{teamSlug:i,project:a,children:o,createDatabaseButton:s}=e;return(0,t.jsx)(n.Suspense,{fallback:(0,t.jsx)(v,{buttons:null,projectSlug:a,teamSlug:i,children:(0,t.jsx)(c.ResourceListPlaceholder,{protocolType:"storage"})}),children:(0,t.jsx)(r.CompatRouterAllowedWithoutSuspense,{children:(0,t.jsx)(u.ResourceModalsProviderBase,{Modal:(0,t.jsx)(m.CreateStoreModal,{}),protocolType:"storage",children:(0,t.jsx)(v,{buttons:s,projectSlug:a,teamSlug:i,children:o})})})})}function v(e){let{teamSlug:n,projectSlug:r,children:c,buttons:u}=e,m=(0,g.hasProjectSlug)(r);return(0,t.jsx)(l.default,{buttons:u,title:(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsx)(i.Stack,{direction:"row",gap:3,children:(0,t.jsx)(a.Text,{as:"h1",size:32,weight:500,children:"Storage"})}),m?(0,t.jsxs)(a.Text,{color:"gray-900",children:["Read and write directly to databases and stores connected to this project."," ",(0,t.jsx)(o.Link,{href:n?`/${n}/~/stores`:"/dashboard/stores",type:"highlight",children:(0,t.jsxs)(i.Stack,{align:"center",as:"span",direction:"row",gap:1,style:{display:"inline-flex"},children:[(0,t.jsx)("span",{children:"View All Databases"}),(0,t.jsx)(s.ArrowCircleRight,{})]})})]}):(0,t.jsxs)(a.Text,{color:"gray-900",children:["Read and write directly to databases and stores from your projects."," ",(0,t.jsx)(o.Link,{external:!0,href:d.docs.createDatabase,type:"highlight",children:"Learn more"})]})]}),children:(0,t.jsxs)(i.Stack,{gap:4,children:[(0,t.jsx)(h.AdditionalPermissionsRequiredModalClient,{actionLabel:"view Storage",permissionChecks:[[f.Action.Read,f.Resource.EdgeConfig],[f.Action.Read,f.Resource.Blob]]}),c]})})}e.s(["StoreListLayout",()=>p],4174946)}]);

//# sourceMappingURL=dd7fb8a965eb01b4.js.map
//# debugId=2aa33b1b-1472-5b8f-930c-1dd07c2467e7
