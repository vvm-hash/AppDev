
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e6b71fed-765a-58d4-bd70-1c6a5c5d50bb")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7133058,e=>{"use strict";var t=e.i(6696646),r={};e.s(["default",0,function(e){for(var i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];var n=[],l=[],o=function(e){var i=(0,t.createContext)(r);n.push(i),l.push(function(){return(0,t.useContext)(i)})};return s.length?s.forEach(function(e){return o(e.name)}):o(e.name),[function(r){for(var i=r.children,a=e(function(e,t){if(null==e)return{};var r,i,s={},a=Object.keys(e);for(i=0;i<a.length;i++)t.indexOf(r=a[i])>=0||(s[r]=e[r]);return s}(r,["children"])),l=i,o=0;o<n.length;o+=1){var c=n[o],d=s[o]||function(e){return e};l=(0,t.createElement)(c.Provider,{value:d(a)},l)}return l}].concat(l)}])},4535059,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)(`<g stroke="currentColor" stroke-width="1.5" fill="none">
    <path d="M4.75 0.75H2.75C1.64543 0.75 0.75 1.64543 0.75 2.75V4.75" stroke-linecap="square"/>
    <path d="M11.25 15.25H13.25C14.3546 15.25 15.25 14.3546 15.25 13.25V11.25" stroke-linecap="square"/>
    <path d="M11.25 0.75H13.25C14.3546 0.75 15.25 1.64543 15.25 2.75V4.75" stroke-linecap="square"/>
    <path d="M4.75 15.25H2.75C1.64543 15.25 0.75 14.3546 0.75 13.25V11.25" stroke-linecap="square"/>
    <path d="M4.5 5H9.5" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M7.5 8L12.5 8" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M4.5 11H9.5" stroke-linecap="round" stroke-linejoin="round"/>
  </g>`);e.s(["Traces",0,t])},4819890,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill="#666" fill-rule="evenodd" d="M14.5 8a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0ZM16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0ZM6 11l5.5-3L6 5v6Z" clip-rule="evenodd" style="fill:currentColor;"/>');e.s(["PlayCircle",0,t])},4418317,e=>{"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise(e=>{requestAnimationFrame(()=>{e(window.open(...t))})})}class r{id;url;width;height;callbacks;prerenderHtml;popup;interval;constructor({id:e,url:t,width:r=800,height:i=600,callbacks:s={},prerenderHtml:a}){this.id=e,this.url=t,this.width=r,this.height=i,this.callbacks=s,this.prerenderHtml=a}async open(){var e,r;let i;if(this.popup&&!this.popup.closed)return void await t("",this.id).then(e=>e?.focus());let s="maxTouchPoints"in navigator&&navigator.maxTouchPoints>0,a=(e=this.width,r=this.height,{width:e,height:r,top:(i=window.top)?i.outerHeight/2+i.screenY-r/2:0,left:i?i.outerWidth/2+i.screenX-e/2:0});this.popup=await t(this.url,this.id,Object.entries(a).map(e=>{let[t,r]=e;return`${t}=${r}`}).join(",")),this.popup&&this.prerenderHtml&&!s&&(this.popup.document.write(this.prerenderHtml),this.popup.location.href=this.url),!this.popup||this.popup.closed||void 0===this.popup.closed?(this.callbacks.onBlocked?.(),this.cancelPolling(),this.popup=null):(this.callbacks.onOpen?.(this.popup),this.poll())}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cancelPolling(),this.popup&&!this.popup.closed&&(this.popup.close(),e||this.callbacks.onClose?.())}poll(){this.interval=setInterval(()=>{try{if(!this.popup||this.popup.closed){this.cancelPolling(),this.callbacks.onAbort?.();return}this.callbacks.onPoll?.(this.popup)}catch(e){}},1e3)}cancelPolling(){this.interval&&(clearInterval(this.interval),this.interval=null)}}e.s(["default",()=>r],4418317)},9861498,e=>{e.v({button:"custom-module__vVV9Vq__button"})},7668531,e=>{"use strict";var t=e.i(6468255),r=e.i(9722978),i=e.i(9861498),s=e.i(7602961);e.s(["CustomButtonLink",0,e=>{let{normal:a,active:n,hover:l,className:o,...c}=e;return(0,t.jsx)(s.ButtonLink,{...c,className:(0,r.clsx)(i.default.button,o),"data-custom-button":"",style:{"--button-custom-fg":`${a?.foreground||""}`,"--button-custom-bg":`${a?.background||""}`,"--button-custom-border":`${a?.border||""}`,"--button-custom-fg-active":`${n?.foreground||""}`,"--button-custom-bg-active":`${n?.background||""}`,"--button-custom-border-active":`${n?.border||""}`,"--button-custom-fg-hover":`${l?.foreground||""}`,"--button-custom-bg-hover":`${l?.background||""}`,"--button-custom-border-hover":`${l?.border||""}`},children:c.children})}])},6855136,e=>{e.v({avatar:"group-module__Dj5yHG__avatar",group:"group-module__Dj5yHG__group",note:"group-module__Dj5yHG__note",noteText:"group-module__Dj5yHG__noteText"})},7609806,e=>{"use strict";var t=e.i(6468255),r=e.i(9722978),i=e.i(6696646),s=e.i(1344973),a=e.i(4585051),n=e.i(6855136),l=e.i(3025777),o=e.i(3896588),c=e.i(6683690);let d=(0,i.memo)(e=>{let{member:r,size:i,showIcon:s,iconBackground:n,lazy:d=!1}=e;return"teamId"in r?(0,t.jsx)(a.Avatar,{lazy:d,size:i,teamId:r.teamId,title:r.teamName},r.teamId):r.githubUser?(0,t.jsx)("span",{title:r.name,children:(0,t.jsx)(l.GitHubAvatar,{iconBackground:n,lazy:d,showIcon:s,size:i,username:r.username})},r.username):r.gitlabUser?(0,t.jsx)("span",{title:r.name,children:(0,t.jsx)(o.GitLabAvatar,{iconBackground:n,lazy:d,showIcon:s,size:i,url:r.url})},r.username):r.bitbucketUser?(0,t.jsx)("span",{title:r.name,children:(0,t.jsx)(c.BitbucketAvatar,{iconBackground:n,lazy:d,showIcon:s,size:i,url:r.url})},r.username):r.username?(0,t.jsx)(a.Avatar,{size:i,username:r.username},r.username):r.url?(0,t.jsx)(a.Avatar,{size:i,url:r.url},r.url):(0,t.jsx)(a.Avatar,{size:i,uid:r.uid},r.uid)});d.displayName="GroupAvatar";let u=e=>{let{members:i,limit:a=3,extra:l=0,size:o=24,showIcon:c=!1,iconBackground:u=!0,ariaHidden:p,lazy:m=!1}=e;0===a&&(a=i.length),a-=1;let g=i.slice(0,a),h=i.slice(a),x=h.length+l,f=x>9?"9+":`+${x}`,j=`${x} more avatars in this group`;return(0,t.jsxs)("div",{"aria-hidden":p,className:n.default.group,children:[g.map(e=>(0,t.jsx)("span",{className:n.default.avatar,children:"component"in e?e.component:(0,t.jsx)(d,{member:e,size:o,showIcon:c,iconBackground:u,lazy:m})},"teamId"in e?e.teamId:e.uid||e.username||e.url)),h.length||l>0?(0,t.jsxs)("span",{"aria-label":j,className:(0,r.clsx)(n.default.note,{[n.default.avatar||""]:h.length}),title:j,children:[h.length?"component"in h[0]?h[0].component:(0,t.jsx)(d,{member:h[0],size:o,showIcon:c,iconBackground:u,lazy:m}):null,x>1?(0,t.jsx)(s.Text,{as:"span",className:(0,r.clsx)(n.default.noteText,"dark-theme"),color:"gray-1000",size:10,weight:600,children:f}):null]}):null]})};u.displayName="AvatarGroup";let p=(0,i.memo)(u);e.s(["AvatarGroup",0,p])},2470467,e=>{e.v({description:"description-module__J9KQsG__description",ellipsis:"description-module__J9KQsG__ellipsis",icon:"description-module__J9KQsG__icon",right:"description-module__J9KQsG__right"})},4245131,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(9722978),s=e.i(2988836),a=e.i(5468328),n=e.i(2470467);let l=(0,r.memo)(function(e){let{title:r,content:l,tooltip:o,right:c,className:d,ellipsis:u,"data-testid":p,tooltipProps:m}=e;return(0,t.jsxs)("dl",{className:(0,i.clsx)(n.default.description,{[String(n.default.right)]:c,[String(n.default.ellipsis)]:u},d),"data-testid":p,"data-version":"v1",children:[(0,t.jsxs)("dt",{"data-geist-description-title":"",children:[r,o?(0,t.jsx)("span",{className:n.default.icon,children:(0,t.jsx)(a.Tooltip,{text:o,...m,children:(0,t.jsx)(s.InformationFillSmall,{size:14})})}):null]}),(0,t.jsx)("dd",{"data-geist-description-content":"",children:l})]})});e.s(["Description",0,l])},4367648,e=>{e.v({checkbox:"choicebox-group-module__kLcSnq__checkbox",checked:"choicebox-group-module__kLcSnq__checked",choicebox:"choicebox-group-module__kLcSnq__choicebox","choicebox-group":"choicebox-group-module__kLcSnq__choicebox-group",content:"choicebox-group-module__kLcSnq__content",description:"choicebox-group-module__kLcSnq__description",disabled:"choicebox-group-module__kLcSnq__disabled",icon:"choicebox-group-module__kLcSnq__icon",input:"choicebox-group-module__kLcSnq__input",option:"choicebox-group-module__kLcSnq__option",radio:"choicebox-group-module__kLcSnq__radio",title:"choicebox-group-module__kLcSnq__title"})},9957872,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(9722978),s=e.i(9508212),a=e.i(9544652),n=e.i(692265),l=e.i(3671642),o=e.i(9992076),c=e.i(3869281),d=e.i(4367648);let u=(0,r.createContext)({disabled:!1,name:"",required:!1,selectedValue:"",setSelected:()=>{},type:"radio"});function p(e){let r,{children:o,className:c,direction:p="column",disabled:m,gap:g=3,label:h,name:x,onChange:f,required:j,showLabel:v,type:y,value:b}=e,k=(0,a.useDisabled)()||m,N=(0,n.useId)("choicebox-"),w=(0,n.useId)("choicebox-name-");return r={name:x??w,disabled:k,required:j??!1,type:y,setSelected:f,selectedValue:b},(0,t.jsx)(u.Provider,{value:r,children:(0,t.jsxs)("div",{"aria-label":v?void 0:h,"aria-labelledby":v?N:void 0,"aria-multiselectable":"checkbox"===y,"aria-required":j??!1,className:(0,i.clsx)(d.default["choicebox-group"],c),role:"radio"===y?"radiogroup":"group",children:[v?(0,t.jsx)(l.Label,{bypassCasing:!0,id:N,value:h}):null,(0,t.jsx)(s.Stack,{as:"ul",direction:p,gap:g,justify:"stretch",children:o})]})})}u.displayName="ChoiceboxContext",p.Item=function(e){let{children:a,className:n,contentClassName:l,description:p=null,disabled:m,title:g,value:h,"data-testid":x,optionClassName:f,titleDescriptionClassName:j,...v}=e,{type:y,selectedValue:b,setSelected:k,disabled:N,name:w}=(0,r.useContext)(u),S="radio"===y?b===h:b.includes(h),C=N||m,_=(0,r.useCallback)(e=>{"radio"===y?k(h):!e.target.checked&&b.includes(h)?k(b.filter(e=>e!==h)):e.target.checked&&k([...b,h])},[b,k,y,h]);return(0,t.jsxs)(s.Stack,{"aria-selected":S,as:"label",className:(0,i.clsx)(d.default.choicebox,C&&d.default.disabled,S&&d.default.checked,n),"data-testid":x,flex:1,children:[(0,t.jsxs)(s.Stack,{align:"center",className:(0,i.clsx)(d.default.option,f),direction:"row",gap:6,justify:"space-between",children:[(0,t.jsxs)(s.Stack,{as:"span",gap:1,className:j,children:[(0,t.jsx)("span",{className:d.default.title,children:g}),(0,t.jsx)("span",{className:d.default.description,children:p})]}),"radio"===y?(0,t.jsx)(o.Radio,{checked:S,className:d.default.radio,disabled:C,iconClassName:d.default.icon,inputClassName:d.default.input,name:w,onChange:_,value:h,...v}):(0,t.jsx)(c.Checkbox,{checked:S,className:d.default.checkbox,disabled:C,iconClassName:d.default.icon,name:w,onChange:_,value:h,...v})]}),S?(0,t.jsx)("span",{className:(0,i.clsx)(d.default.content,l),children:a}):null]})},e.s(["ChoiceboxGroup",()=>p])},3584802,e=>{"use strict";var t;let r=(t=e=>`/${e.params.teamSlug}/~/integrations/checkout/${e.params.integrationSlug}`,e=>{let r=Object.entries(e.searchParams||{}).reduce((e,t)=>{let[r,i]=t;return null!=i&&(e[r]=i),e},{}),i=t(e),s=i.startsWith("/")?i.substring(1):i;if(Object.entries(r).length>0){let e=new URLSearchParams(r).toString();return`/${s}?${e}`}return`/${s}`});e.s(["getIntegrationCheckoutUrl",0,r],3584802)},397094,e=>{"use strict";function t(e){return t=>{new URL(String(e.href),window.location.href).origin!==window.location.origin||0!==t.button||t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||(t.preventDefault(),e.router.push(String(e.href)))}}e.s(["buildOnMouseDown",()=>t])},2521731,e=>{"use strict";var t=e.i(2704354);function r(e){let t=e.toLowerCase().replace("-","").replace(" ","");return!!("logdrain".startsWith(t)||"logdrains".startsWith(t)||"logs".startsWith(t))}function i(e){return"scopes"in e&&e.scopes.includes("read-write:log-drain")}function s(e){return(0,t.isMarketplaceIntegration)(e)?e.products.some(e=>"published"===e.reviewStatus):!0===e.public&&void 0!==e.approvedAt}e.s(["integrationPubliclyVisible",()=>s,"integrationSupportsLogDrains",()=>i,"searchMatchesLogDrains",()=>r])},2454893,e=>{e.v({cardLink:"marketplace-integration-card-module__GWffEq__cardLink",descriptionWrapper:"marketplace-integration-card-module__GWffEq__descriptionWrapper",icon:"marketplace-integration-card-module__GWffEq__icon",integrationCard:"marketplace-integration-card-module__GWffEq__integrationCard"})},1282571,e=>{"use strict";var t=e.i(6468255),r=e.i(9722978),i=e.i(9739627),s=e.i(4585051),a=e.i(9508212),n=e.i(5255926),l=e.i(2504781),o=e.i(57106),c=e.i(2704354),d=e.i(2454893),u=e.i(9100551),p=e.i(397094);function m(e){let{Actions:i,children:s,href:n,title:l,icon:c,className:m,"data-testid":g,disabled:x}=e,f=(0,u.useRouter)();return(0,t.jsxs)("div",{className:(0,r.clsx)(m,d.default.integrationCard),children:[(0,t.jsxs)(a.Stack,{className:d.default.descriptionWrapper,direction:"row",gap:4,justify:"space-between",children:[(0,t.jsxs)(a.Stack,{align:"center",className:d.default.descriptionWrapper,direction:"row",gap:3,children:[(0,t.jsx)(h,{icon:c,name:l}),s]}),i]}),x?null:(0,t.jsx)(o.Link,{"aria-label":`Open ${l}`,className:d.default.cardLink,"data-testid":g,href:n,onMouseDown:(0,p.buildOnMouseDown)({href:n,router:f})})]})}function g(e){let{children:i,Action:s,className:o}=e;return(0,t.jsx)("div",{className:(0,r.clsx)(o,d.default.integrationCard),children:(0,t.jsxs)(a.Stack,{direction:"row",justify:"space-between",children:[(0,t.jsxs)(a.Stack,{align:"center",className:"w-full",direction:"row",gap:3,children:[(0,t.jsx)(n.Skeleton,{height:36,rounded:!0,width:36}),i]}),s??(0,t.jsx)(l.Button,{size:"small",type:"secondary",children:(0,t.jsx)(n.Skeleton,{height:16,width:30})})]})})}function h(e){let{icon:r,name:a,size:n=36}=e;return(0,c.isContentfulIcon)(r)?(0,t.jsx)("div",{className:d.default.icon,children:(0,t.jsx)(i.Image,{alt:a,height:n,srcDark:`https:${r.fields.file.url}`,srcLight:`https:${r.fields.file.url}`,width:n})}):(0,t.jsx)(s.Avatar,{className:d.default.icon,hash:r,size:n})}e.s(["MarketplaceIntegrationCard",()=>m,"MarketplaceIntegrationCardIcon",()=>h,"MarketplaceIntegrationCardPlaceholder",()=>g])},4325157,e=>{"use strict";var t=e.i(3911483),r=e.i(4439612),i=(0,r.createServerReference)("7f0e6263a91a8fe4daee16fd2bc4fa4e04961f76b7",r.callServer,void 0,r.findSourceMapURL,"findManyPrivateMarketplaceIntegrationsByProduct"),s=e.i(2704354),a=e.i(9668517);e.s(["useMarketplaceIntegrations",0,e=>{let{protocolType:r}=e,n=(0,a.useTeamSlug)();return(0,t.default)(()=>(0,s.getMarketplaceIntegrationsApiUrl)({teamIdOrSlug:n??null,protocolType:r}),async e=>e&&n?i({protocolType:r,teamIdOrSlug:n}):[])}],4325157)},4110479,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646);let i=(0,r.createContext)(null);e.s(["DrainModalProvider",0,e=>{let{children:s,initialResource:a}=e,[n,l]=(0,r.useState)(!1),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(a),p=(0,r.useCallback)((e,t)=>{c(e),u(t),l(!0)},[]),m=(0,r.useCallback)(()=>{c(null),u(a),l(!1)},[a]),g=(0,r.useMemo)(()=>({isOpen:n,setIsOpen:l,drain:o,resource:d,openDrain:p,closeModal:m}),[n,o,d,m,p]);return(0,t.jsx)(i.Provider,{value:g,children:s})},"useDrainModalContext",0,()=>{let e=(0,r.useContext)(i);if(null===e)throw Error("useDrainModal must be used within a DrainModalProvider");return e},"useOptionalDrainModalContext",0,()=>(0,r.useContext)(i)])},1971505,e=>{"use strict";var t=e.i(5486173),r=function(e,r,i){if(e&&"reportValidity"in e){var s=(0,t.get)(i,r);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},i=function(e,t){var i=function(i){var s=t.fields[i];s&&s.ref&&"reportValidity"in s.ref?r(s.ref,i,e):s.refs&&s.refs.forEach(function(t){return r(t,i,e)})};for(var s in t.fields)i(s)},s=function(e,r){r.shouldUseNativeValidation&&i(e,r);var s={};for(var a in e){var n=(0,t.get)(r.fields,a);(0,t.set)(s,a,Object.assign(e[a],{ref:n&&n.ref}))}return s},a=function(e,r){for(var i={};e.length;){var s=e[0],a=s.code,n=s.message,l=s.path.join(".");if(!i[l])if("unionErrors"in s){var o=s.unionErrors[0].errors[0];i[l]={message:o.message,type:o.code}}else i[l]={message:n,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),r){var c=i[l].types,d=c&&c[s.code];i[l]=(0,t.appendErrors)(l,r,i,a,d?[].concat(d,s.message):s.message)}e.shift()}return i},n=function(e,t,r){return void 0===r&&(r={}),function(n,l,o){try{return Promise.resolve(function(s,a){try{var l=Promise.resolve(e["sync"===r.mode?"parse":"parseAsync"](n,t)).then(function(e){return o.shouldUseNativeValidation&&i({},o),{errors:{},values:r.rawValues?n:e}})}catch(e){return a(e)}return l&&l.then?l.then(void 0,a):l}(0,function(e){return{values:{},errors:e.isEmpty?{}:s(a(e.errors,!o.shouldUseNativeValidation&&"all"===o.criteriaMode),o)}}))}catch(e){return Promise.reject(e)}}};e.s(["zodResolver",()=>n],1971505)},2199694,e=>{"use strict";function t(e){return"mode"in e&&"create"===e.mode}function r(e){return"mode"in e&&"update"===e.mode}e.s(["isCreateFlow",()=>t,"isUpdateFlow",()=>r])},5263903,(e,t,r)=>{"use strict";let i="[a-fA-F\\d:]",s=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${i})|(?<=${i})(?=\\s|$))`:"",a="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",l=`
(?:
(?:${n}:){7}(?:${n}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${n}:){6}(?:${a}|:${n}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${n}:){5}(?::${a}|(?::${n}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${n}:){4}(?:(?::${n}){0,1}:${a}|(?::${n}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${n}:){3}(?:(?::${n}){0,2}:${a}|(?::${n}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${n}:){2}(?:(?::${n}){0,3}:${a}|(?::${n}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${n}:){1}(?:(?::${n}){0,4}:${a}|(?::${n}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${n}){0,5}:${a}|(?::${n}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=RegExp(`(?:^${a}$)|(?:^${l}$)`),c=RegExp(`^${a}$`),d=RegExp(`^${l}$`),u=e=>e&&e.exact?o:RegExp(`(?:${s(e)}${a}${s(e)})|(?:${s(e)}${l}${s(e)})`,"g");u.v4=e=>e&&e.exact?c:RegExp(`${s(e)}${a}${s(e)}`,"g"),u.v6=e=>e&&e.exact?d:RegExp(`${s(e)}${l}${s(e)}`,"g"),t.exports=u},3775629,(e,t,r)=>{"use strict";let i=e.r(5263903),s=e.r(6881271);t.exports=e=>{e={strict:!0,...e};let t=`(?:(?:[a-z]+:)?//)${e.strict?"":"?"}`,r=i.v4().source,a=`(?:\\.${e.strict?"(?:[a-z\\u00a1-\\uffff]{2,})":`(?:${s.sort((e,t)=>t.length-e.length).join("|")})`})\\.?`,n=`(?:${t}|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${r}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*${a})(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;return e.exact?RegExp(`(?:^${n}$)`,"i"):RegExp(n,"ig")}},7662235,1094129,e=>{"use strict";var t=e.i(6468255),r=e.i(5486173),i=e.i(9957872),s=e.i(248550),a=e.i(4535059),n=e.i(4524395),l=e.i(2640326),o=e.i(6401841),c=e.i(6696646);e.i(553769);var d=e.i(3758860),u=e.i(4110479);let p=[{value:"logs",protocol:"logDrain",icon:s.Logs,title:"Logs",description:"Runtime, build and static logs"},{value:"traces",protocol:"traceDrain",icon:a.Traces,title:"Traces",description:"Distributed tracing data"},{value:"speed_insights",protocol:null,icon:n.StopwatchFast,title:"Speed Insights",description:"Performance metrics"},{value:"analytics",protocol:null,icon:l.Analytics,title:"Web Analytics",description:"Page views and custom events"}];e.s(["chooseDrainDataStep",0,{title:"Choose data to drain",component:function(){let{watch:e,setValue:s,resetField:a,register:n,clearErrors:l,formState:{errors:m}}=(0,r.useFormContext)(),g=(0,u.useOptionalDrainModalContext)(),h=g?.resource,x=e("drainType"),f=e("mode");return(0,c.useEffect)(()=>{n("drainType",{required:"required"})},[]),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ChoiceboxGroup,{className:"pt-4",direction:"column",label:"Choose data type",type:"radio",value:x??"",onChange:e=>{s("drainType",e),l("drainType"),"create"!==f||h?(a("delivery.type"),a("delivery.endpoint")):(s("delivery.type","traces"===e?"otlphttp":"http"),s("delivery.endpoint","traces"===e?{traces:""}:"")),a("delivery.encoding"),a("filter.source"),a("filter.environment")},children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:p.filter(e=>!h||e.protocol&&"integration"===h.type&&(0,d.isProtocolSupported)(h.product,e.protocol)).map(e=>{let r=e.icon;return(0,t.jsx)(i.ChoiceboxGroup.Item,{value:e.value,title:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(r,{size:16}),e.title]}),description:e.description},e.value)})})}),m.drainType?.message&&(0,t.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,t.jsx)(o.Stop,{size:14,color:"red-700"}),(0,t.jsx)("p",{className:"text-copy-14 text-red-900",children:m.drainType.message})]})]})},getFieldsToValidate:()=>["drainType"],getIsNextEnabled:()=>!0,getSuffix:function(e,r){if(r)return null;let i=(()=>{switch(e){case"traces":return"Traces";case"logs":return"Logs";case"analytics":return"Web Analytics";case"speed_insights":return"Speed Insights"}})();return(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:i})}}],7662235),e.i(3512434);var m=e.i(9835407),g=e.i(3775629);let h=m.z.object({type:m.z.literal("head_sampling"),env:m.z.union([m.z.enum(["production","preview"]),m.z.literal("all")]).transform(e=>"all"===e?void 0:e).optional(),rate:m.z.number().min(0,"Sampling rate must be between 0 and 100%").max(1,"Sampling rate must be between 0 and 100%"),requestPath:m.z.string().optional().transform(e=>""===e?void 0:e)}),x=m.z.string().refine(e=>e.startsWith("https://"),{message:"URL must start with https://"}).refine(e=>(0,g.default)({exact:!0}).test(e),{message:"Must be a valid URL"}),f=m.z.object({type:m.z.literal("http"),endpoint:x,encoding:m.z.enum(["json","ndjson"]),headers:m.z.record(m.z.string()),secret:m.z.string().optional(),compression:m.z.enum(["gzip","none"]).optional()}),j=m.z.object({type:m.z.literal("otlphttp"),endpoint:m.z.object({traces:x}),encoding:m.z.enum(["proto","json"]),headers:m.z.record(m.z.string()),secret:m.z.string().optional()}),v=m.z.discriminatedUnion("type",[f,j]),y=m.z.enum(["lambda","edge","static","external","build","firewall","redirect"]),b=m.z.enum(["logs","traces","analytics","speed_insights"]),k=m.z.union([m.z.object({kind:m.z.literal("integration"),resourceId:m.z.string().optional(),integrationId:m.z.string().optional(),integrationConfigurationId:m.z.string().optional()}),m.z.object({kind:m.z.literal("self-served")})]),N=m.z.object({name:m.z.string().trim().min(1,"Drain name is required"),projects:m.z.enum(["all","some"]),drainType:b,delivery:v.optional(),sampling:m.z.array(h).max(5,"You can configure up to 5 sampling rules").optional(),projectIds:m.z.array(m.z.string()).optional(),filter:m.z.object({source:m.z.array(y),environment:m.z.array(m.z.string())}),source:k.optional(),mode:m.z.literal("create")}),w=m.z.object({name:m.z.string().trim().min(1,"Drain name is required").optional(),projects:m.z.enum(["all","some"]).optional(),drainType:b,delivery:v.optional(),sampling:m.z.array(h).optional(),projectIds:m.z.array(m.z.string()).optional(),status:m.z.enum(["enabled","disabled"]).optional(),filter:m.z.object({source:m.z.array(y),environment:m.z.array(m.z.string())}).optional(),source:k.optional(),mode:m.z.literal("update")}),S=m.z.discriminatedUnion("mode",[N,w]).refine(e=>"some"!==e.projects||e.projectIds&&e.projectIds.length>0,{message:"At least one project must be selected when choosing specific projects",path:["projectIds"]}).refine(e=>"logs"!==e.drainType||Number(e.filter?.environment.length)>0,{message:"At least one environment must be selected when draining logs",path:["filter.environment"]}).refine(e=>"logs"!==e.drainType||Number(e.filter?.source.length)>0,{message:"At least one source must be selected when draining logs",path:["filter.source"]});e.s(["DrainFormSchema",0,S,"httpUrl",0,x,"sourceLabelMap",0,{lambda:"Functions",edge:"Edge Functions",static:"Static Files",external:"Rewrites",build:"Builds",firewall:"Firewall",redirect:"Redirects"}],1094129)},1733572,e=>{"use strict";let t={logs:"Logs",traces:"Traces",analytics:"Web Analytics",speed_insights:"Speed Insights"};function r(e){return e.schemas?.trace?"traces":e.schemas?.analytics?"analytics":e.schemas?.speed_insights?"speed_insights":"logs"}function i(e){return t[e]}e.s(["getDrainType",()=>r,"getDrainTypeLabel",()=>i])},3614887,9572009,8249103,3456281,4789955,5664328,e=>{"use strict";let t;var r=e.i(6468255),i=e.i(3500331),s=e.i(3869281),a=e.i(7048904),n=e.i(6401841),l=e.i(2565125),o=e.i(2098824),c=e.i(1094129),d=e.i(1733572),u=e.i(5486173),p=e.i(6696646),m=e.i(6060673);let g=(0,p.createContext)(null),h=()=>(0,p.useContext)(g);e.s(["SheetContainerContext",0,g,"useSheetContainer",0,h],9572009);var x=e.i(5323212),f=e.i(3169345),j=e.i(8161149),v=e.i(2504781),y=e.i(5468328),b=e.i(923772),k=e.i(5169576);function N(){let{register:e,watch:t,setValue:s,formState:{errors:a}}=(0,u.useFormContext)(),l=Array.isArray(a.sampling)?a.sampling[0]?.rate?.message:void 0,{fields:o,append:c,remove:d}=(0,u.useFieldArray)({name:"sampling"});return(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Sampling"}),0===o.length?(0,r.jsx)("div",{className:"flex flex-col items-center justify-start gap-4 flex-initial mt-1.5",children:(0,r.jsx)(j.EmptyState.Root,{secondary:!0,title:"No sampling rules configured",description:"Configure how the data should be sampled for different environments",children:(0,r.jsx)(v.Button,{onClick:()=>c({type:"head_sampling",env:void 0,rate:1}),type:"secondary",typeName:"button",children:"Add Sampling Rule"})})}):(0,r.jsxs)(f.Table,{className:"border-separate border-spacing-0 mt-1.5",children:[(0,r.jsx)(f.Table.Header,{removeSpacing:!0,children:(0,r.jsxs)(f.Table.Row,{children:[(0,r.jsx)(f.Table.Head,{className:"border-t border-l rounded-tl border-solid border-gray-200 text-xs pl-4",children:"Environment"}),(0,r.jsx)(f.Table.Head,{className:"border-t border-solid border-gray-200 text-xs",children:"Rate"}),(0,r.jsx)(f.Table.Head,{className:"border-t border-solid border-gray-200 text-xs",children:(0,r.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:["Request Path Prefix",(0,r.jsx)(y.Tooltip,{text:"The prefix of the request path to sample or the entire request path",children:(0,r.jsx)(k.Information,{size:12,color:"gray-700"})})]})}),(0,r.jsx)(f.Table.Head,{className:"border-t border-r rounded-tr border-solid border-gray-200 text-xs"})]})}),(0,r.jsxs)(f.Table.Body,{className:"[&_td:first-child]:rounded-l-none [&_td:last-child]:rounded-r-none",children:[o.map((n,l)=>{let o=e(`sampling.${l}.env`);e(`sampling.${l}.rate`,{valueAsNumber:!0});let c=t(`sampling.${l}.rate`),u=Array.isArray(a.sampling)?a.sampling[l]?.rate?.message:void 0;return(0,r.jsxs)(f.Table.Row,{children:[(0,r.jsx)(f.Table.Cell,{className:"border-l border-b border-solid border-gray-200 rounded-none py-4 pl-4",children:(0,r.jsxs)(x.Select,{size:"small",ref:o.ref,name:o.name,value:t(`sampling.${l}.env`)??"all",onChange:e=>{s(`sampling.${l}.env`,e.target.value)},children:[(0,r.jsx)("option",{value:"all",children:"All Environments"}),(0,r.jsx)("option",{value:"production",children:"Production"}),(0,r.jsx)("option",{value:"preview",children:"Preview"})]})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-solid border-gray-200 rounded-none max-w-20 py-4",children:(0,r.jsx)(i.Input,{error:u,showErrorMessage:!1,className:"[&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",suffix:"%","aria-labelledby":`sampling-rate-${l}`,typeName:"number",min:"0",max:"100",step:"1",size:"small",defaultValue:"100",style:{width:"100px"},value:"number"==typeof c?`${100*c}`:c,onChange:e=>{let t=e.target.valueAsNumber;"number"!=typeof t||Number.isNaN(t)?s(`sampling.${l}.rate`,t,{shouldDirty:!0}):s(`sampling.${l}.rate`,t/100,{shouldDirty:!0})}})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-solid border-gray-200 rounded-none py-4",children:(0,r.jsx)(i.Input,{"aria-labelledby":`request-path-${l}`,placeholder:`/api/example-${l+1}`,...e(`sampling.${l}.requestPath`),size:"small"})}),(0,r.jsx)(f.Table.Cell,{className:"border-b border-r border-solid border-gray-200 rounded-none py-4",children:(0,r.jsx)(v.Button,{size:"small",type:"tertiary",onClick:()=>d(l),"aria-label":"Remove sampling config",children:(0,r.jsx)(b.Trash,{color:"gray-700",size:16})})})]},n.id)}),(0,r.jsx)(f.Table.Row,{children:(0,r.jsx)(f.Table.Cell,{colSpan:4,className:"border-b border-l border-r border-solid border-gray-200 !rounded-bl !rounded-br py-4 pl-4",children:(0,r.jsx)("div",{className:"flex flex-row items-stretch justify-start gap-1 flex-initial",children:(0,r.jsx)(y.Tooltip,{text:"You can configure up to 5 sampling rules",disableTriggers:o.length<5,className:"",children:(0,r.jsx)(v.Button,{onClick:()=>c({type:"head_sampling",env:"all",rate:1}),size:"small",type:"tertiary",disabled:o.length>=5,typeName:"button",children:"Add Sampling Rule"})})})})})]})]}),l&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:l})]})]})}var w=e.i(4597921);let S=["lambda","edge","static","external","build","firewall","redirect"];function C(){let{watch:e,setValue:t,register:i,formState:{errors:a}}=(0,u.useFormContext)(),n=e("filter.source"),l=(0,p.useCallback)(e=>{n.includes(e)?t("filter.source",n.filter(t=>t!==e),{shouldDirty:!0}):t("filter.source",[...n,e],{shouldDirty:!0})},[n,t]);return(0,p.useEffect)(()=>{i("filter.source",{required:"required"})},[i]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(o.FormTitleDescription,{description:"Logs from the selected sources will be forwarded to your drain. At least one must be selected.",title:"Sources"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:S.map(e=>(0,r.jsx)(s.Checkbox,{className:"cursor-pointer rounded-md border border-gray-200 p-3 hover:border-gray-300",checked:n.includes(e),onChange:()=>l(e),children:c.sourceLabelMap[e]},e))}),(0,r.jsx)(T,{error:a.filter?.source?.message})]}),(0,r.jsx)(D,{})]})}function _(){return(0,r.jsx)(r.Fragment,{})}function I(){let{setValue:e,watch:t,register:i}=(0,u.useFormContext)(),s=t("sampling",[{type:"head_sampling",rate:1}]);return(0,p.useEffect)(()=>{i("sampling")},[]),(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:[(0,r.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:"Sampling"}),(0,r.jsxs)("span",{style:{minWidth:30,fontSize:"12px"},children:[Math.round((s?.[0]?.rate??1)*100),"%"]}),(0,r.jsx)("div",{style:{maxWidth:"200px",flex:1},children:(0,r.jsx)(a.Slider,{max:100,min:1,onValueChange:t=>{e("sampling",[{type:"head_sampling",rate:t[0]/100}],{shouldDirty:!0})},value:[Math.round((s?.[0]?.rate??1)*100)]})})]}),(0,r.jsx)("p",{className:"text-copy-14 text-gray-900",children:"A percentage of data matching the sampling rate will be sent to your drain from the selected environments."})]})}function D(){let{watch:e,setValue:t,formState:{errors:i}}=(0,u.useFormContext)(),a=e("filter.environment"),n=(e,r)=>{r?t("filter.environment",[...a,e],{shouldDirty:!0}):t("filter.environment",a.filter(t=>t!==e),{shouldDirty:!0})};return(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(o.FormTitleDescription,{description:"Select which environments to drain from.",title:"Environment"}),(0,r.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-6 flex-initial",children:[(0,r.jsx)(s.Checkbox,{checked:a.includes("production"),onChange:e=>{n("production",e.target.checked)},children:"Production"}),(0,r.jsx)(s.Checkbox,{checked:a.includes("preview"),onChange:e=>{n("preview",e.target.checked)},children:"Preview"})]}),(0,r.jsx)(T,{error:i.filter?.environment?.message})]})}function T(e){let{error:t}=e;return t?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:t})]}):null}e.s(["configureDrainStep",0,{title:"Configure the drain",component:function(){let{watch:e,setValue:t,register:s,clearErrors:a,formState:{errors:n}}=(0,u.useFormContext)(),o=e("drainType"),c="logs"===o||"traces"===o,g=(0,w.useServerFlag)("drains-advanced-sampling",!1)&&c,x=e("projects"),f=e("projectIds")||[],j=h();(0,p.useEffect)(()=>{s("projects",{required:"required"}),s("projectIds")},[]);let{data:v,isLoading:y}=(0,m.useProjects)(f.length>0?f:void 0),b=v||[],[k,S]=(0,p.useState)([]);return(0,r.jsx)("div",{className:"pt-4 max-w-2xl",children:(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,r.jsx)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial w-full",children:(0,r.jsx)(i.Input,{label:"Drain Name",id:"drain-name",placeholder:`My ${(0,d.getDrainTypeLabel)(o)} drain`,width:"100%",className:"flex-1",error:n.name?.message,...s("name")})}),(0,r.jsx)(l.ProjectSelector,{error:n.projects?.message||n.projectIds?.message,projects:b,projectType:"all"===x?l.ProjectTypes.ALL:l.ProjectTypes.SOME,onProjectsUpdated:e=>{t("projectIds",e.map(e=>e.id),{shouldDirty:!0}),a("projectIds"),S(e)},onProjectTypeUpdated:e=>{a("projectIds"),t("projects",e===l.ProjectTypes.ALL?"all":"some",{shouldDirty:!0}),e===l.ProjectTypes.ALL?(b.length>0&&S(b),t("projectIds",void 0,{shouldDirty:!0})):t("projectIds",(k.length>0?k:b).map(e=>e.id),{shouldDirty:!0})},title:"Projects",description:"Choose which projects should send data to the specified endpoint.",disabled:!1,isLoading:y&&0===b.length,loadingCount:f.length,comboboxListContainer:j}),"logs"===o&&(0,r.jsx)(C,{}),"traces"===o&&(0,r.jsx)(_,{}),g?(0,r.jsx)(N,{}):(0,r.jsx)(I,{})]})})},getFieldsToValidate:()=>["name","projects","projectIds","filter.source","filter.environment","sampling"],getIsNextEnabled:()=>!0}],3614887);var z=e.i(4201247),$=e.i(9844152),E=e.i(9334091),L=e.i(1906681),P=e.i(2455417),A=e.i(8735244),M=e.i(6607601),F=e.i(8225664),q=e.i(198667),O=e.i(6318858),R=e.i(4819890),B=e.i(1933683),V=e.i(3973638);let U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",H=(t=(e,t)=>{if(e<0||e>65536)throw RangeError('The value of "size" is out of range. It must be >= 0 && <= 65536. Received '+e);var r=new Uint8Array(e);return(globalThis.crypto.getRandomValues(r),t)?(setTimeout(()=>t(null,r),0),new Uint8Array):r},e=>new Promise(async(r,i)=>{Number.isInteger(e)?e<=0?i(Error("You must supply a length integer greater than zero")):t(e,(e,s)=>{let a;if(e)return i(e);let n=[];for(let e=0;e<s.length;e++){for(a=s[e];a>248;)try{a=t(1)[0]}catch(e){i(e)}n.push(U[a%U.length])}r(n.join(""))}):i(TypeError("You must supply a length integer to `uid-promise`."))}));async function G(e){return H(e)}e.s(["generateSecret",()=>G],8249103);var W=e.i(6461317),K=e.i(7133058),Y=e.i(277234),J=e.i(5338940);function Q(e){return e.schemas?.log?"logs":e.schemas?.trace?"traces":e.schemas?.analytics?"analytics":e.schemas?.speed_insights?"speed_insights":"logs"}function Z(e){if(!e)throw Error("Drain type is required");switch(e){case"logs":return{log:{version:"v1"}};case"traces":return{trace:{version:"v1"}};case"analytics":return{analytics:{version:"v1"}};case"speed_insights":return{speed_insights:{version:"v1"}}}}e.s(["getDrainTypeFromDrain",()=>Q,"getSchemaForDrainType",()=>Z],3456281);let[X,ee]=(0,K.default)(function(){let{team:e}=(0,J.useTeam)(),[t,r]=(0,p.useState)({status:"idle"});return{validationState:t,validateEndpoint:async t=>{r({status:"validating"});try{let{delivery:i,drainType:s}=t,a=Z(s),n={type:i?.type||"http",endpoint:i?.endpoint||"",encoding:i?.encoding||"json",headers:i?.headers||{},...i?.secret&&{secret:i.secret}},l=await (0,Y.fetchAPI)(`/v1/drains/test${e?.id?`?teamId=${e.id}`:""}`,{method:"POST",body:{schemas:a,delivery:n},returnStatus:!0,throwOnHTTPError:!1});if(l.status&&l.status>=200&&l.status<300&&l.body){let{status:e,statusCode:t}=l.body;if(e){if("success"===e)return r({status:"success",message:"Success: Your endpoint sent a 2xx status"}),!0;if("failure"===e){if(t)return r({status:"error",message:`Error: Your endpoint sent a ${t} status instead of 2xx, fix it and try again`}),!1;return r({status:"error",message:"Error: Your endpoint did not reply, fix it and try again"}),!1}}}return r({status:"error",message:"Unknown error, please contact support"}),!1}catch(e){return r({status:"error",message:"Unknown error, please contact support"}),!1}},resetValidation:()=>{r({status:"idle"})}}});function et(e){let{icon:t,onClick:i,successDuration:s=1e3,...a}=e,[n,l]=(0,p.useState)(!1),[o,c]=(0,p.useState)(!0),d=(0,p.useRef)(null),u=async()=>{c(!1),d.current&&clearTimeout(d.current),await i(),l(!0),d.current=setTimeout(()=>{l(!1)},s)};return(0,r.jsx)(v.Button,{...a,onClick:u,children:(0,r.jsxs)("div",{style:{position:"relative",height:16,width:16},children:[(0,r.jsx)("div",{className:`absolute inset-0 transition-all duration-150 ease-out ${o?"opacity-0 scale-50":!o&&n?"opacity-100 scale-100":"opacity-0 scale-50"}`,children:(0,r.jsx)(O.Check,{size:16})}),(0,r.jsx)("div",{className:`absolute inset-0 transition-all duration-150 ease-out ${o||!o&&!n?"opacity-100 scale-100":"opacity-0 scale-50"}`,children:t})]})})}function er(){let e,t,s,{watch:a,setValue:l,register:o,setError:d,clearErrors:m,formState:{errors:g}}=(0,u.useFormContext)(),{validationState:h,validateEndpoint:f,resetValidation:j}=ee();(0,p.useEffect)(()=>()=>{m(),j()},[]);let b=a("delivery.headers"),k=a("delivery.type"),N=a("delivery.endpoint"),w=a("drainType"),[S,C]=(0,p.useState)(es.input(b||{})),[_,I]=(0,p.useState)(S.length>0),[D,T]=(0,p.useState)(!1),U=a("delivery.secret");return"string"==typeof N?(e="https://your-endpoint.com/ingest",t="delivery.endpoint"):(e="https://your-otlp-endpoint.com/v1/traces",t="delivery.endpoint.traces"),(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial pt-4 max-w-2xl",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-[3fr_1fr] md:gap-2 md:items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)(i.Input,{id:"drain-url",label:"URL",prefix:"POST",placeholder:e,width:"100%",...o(t,{onChange:()=>{j(),m(t)}})}),(0,r.jsx)(y.Tooltip,{desktopOnly:!0,text:"Send an example payload to your endpoint for testing",children:(0,r.jsx)(v.Button,{"aria-label":"Test endpoint",type:"secondary",typeName:"button",disabled:!(s="string"==typeof N?N:N?.traces)||!c.httpUrl.safeParse(s).success||h?.status==="validating",svgOnly:!0,onClick:()=>{f(a())},prefix:h?.status==="validating"?(0,r.jsx)(A.Spinner,{size:16}):(0,r.jsx)(R.PlayCircle,{size:16}),children:"Test"})})]}),(0,W.default)(g,`${t}.message`)&&(0,r.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:"text-copy-14 text-red-900",children:(0,W.default)(g,`${t}.message`)})]}),h&&"idle"!==h.status&&(0,r.jsx)("div",{className:"mt-2 flex items-center gap-2",children:"validating"===h.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(P.LoadingDots,{}),(0,r.jsx)("p",{className:"text-copy-13 text-gray-900",children:"Validating endpoint"})]}):(0,r.jsxs)(r.Fragment,{children:["success"===h.status?(0,r.jsx)(O.Check,{size:14,color:"green-700"}):(0,r.jsx)(n.Stop,{size:14,color:"red-700"}),(0,r.jsx)("p",{className:`text-copy-13 ${"success"===h.status?"text-green-900":"text-red-900"}`,children:h.message})]})})]}),(0,r.jsx)(x.Select,{label:"Encoding",placeholder:"Select encoding",...o("delivery.encoding"),children:ei[k].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),w&&(0,r.jsxs)("div",{className:"text-xs text-gray-900 text-right md:text-right sm:text-left",children:["Need help with the data format?"," ",(0,r.jsxs)("a",{href:{logs:"/docs/drains/reference/logs",traces:"/docs/drains/reference/traces",speed_insights:"/docs/drains/reference/speed-insights",analytics:"/docs/drains/reference/analytics"}[w],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:["View"," ","speed_insights"===w?"Speed Insights":"analytics"===w?"Analytics":w.charAt(0).toUpperCase()+w.slice(1)," ","schema â†’"]})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"flex gap-2 items-end",children:[(0,r.jsx)(i.Input,{label:(0,r.jsxs)(r.Fragment,{children:["Signature verification secret"," ",(0,r.jsxs)("span",{className:"text-gray-900 normal-case",children:["(optional,"," ",(0,r.jsx)("a",{href:"/docs/drains/security",target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 hover:text-gray-700 underline",children:"How to use it"})]}),")"]}),id:"drain-secret",placeholder:"32-character secret",width:"100%",className:"font-mono tracking-wider",typeName:D?"text":"password",prefix:(0,r.jsx)(v.Button,{"aria-label":"Toggle password visibility",variant:"unstyled",svgOnly:!0,typeName:"button",onClick:()=>T(!D),className:"-ml-1",children:D?(0,r.jsx)(V.EyeOff,{size:16}):(0,r.jsx)(B.Eye,{size:16})}),prefixStyling:!1,suffix:(0,r.jsx)(F.CopyButton,{textToCopy:U||"",label:"Copy secret",title:"Copy secret to clipboard",disabled:!U,variant:"unstyled",className:"-mr-1"}),suffixStyling:!1,...o("delivery.secret")}),(0,r.jsx)(et,{"aria-label":"Generate new secret",shape:"square",svgOnly:!0,type:"secondary",typeName:"button",icon:(0,r.jsx)(q.RefreshClockwise,{size:16}),onClick:async()=>{l("delivery.secret",await G(32),{shouldDirty:!0})}})]})}),(0,r.jsx)("div",{className:"flex flex-row items-center justify-start gap-3 flex-initial",children:(0,r.jsx)(L.Toggle,{checked:_,id:"custom-headers",onChange:I,size:"medium",direction:"switch-first",children:(0,r.jsx)("p",{className:"text-copy-14",children:"Custom Headers"})})}),(0,r.jsx)($.AnimatePresence,{initial:!1,children:_&&(0,r.jsx)(z.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.25,ease:"easeInOut",opacity:{duration:.2}},children:(0,r.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-3 flex-initial",children:(0,r.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,r.jsx)(E.Textarea,{error:(0,W.default)(g,"delivery.headers.message"),"aria-labelledby":"Custom Headers (Optional)",className:"font-mono",onBlur:()=>{l("delivery.headers",es.output(S,d,m),{shouldDirty:!0})},onChange:e=>C(e.target.value),placeholder:"Authorization: Bearer token X-Custom-Header: value",rows:3,value:S}),(0,r.jsxs)("p",{className:"text-copy-13 text-gray-900",children:["Format: Header-Name: Header-Value (one per line). The"," ",(0,r.jsx)(M.InlineCode,{children:"content-type"})," header is automatically added."]})]})})})})]})}e.s(["EndpointValidationProvider",()=>X,"useEndpointValidationContext",()=>ee],4789955);let ei={http:[{value:"json",label:"JSON"},{value:"ndjson",label:"NDJSON"}],otlphttp:[{value:"json",label:"JSON"},{value:"proto",label:"Protobuf"}]},es={input:e=>e?Object.entries(e).map(e=>{let[t,r]=e;return`${t}: ${r}`}).join("\n"):"",output(e,t,r){if(!e)return{};let i=e.split("\n").filter(e=>e.trim()),s=[],a=i.reduce((e,t,r)=>{let[i,...a]=t.split(":"),n=a.join(":"),l=ea(i?.trim()||""),o=ea(n?.trim()||"");return l&&o?e[l]=o:s.push(`Line ${r+1}: "${t}"`),e},{});return s.length>0?t("delivery.headers",{message:`Invalid header format: ${s.join(", ")}. Expected format: "Header-Name: Header-Value"`}):r("delivery.headers"),a}};function ea(e){return e?e.replace(/""+/g,'"').replace(/''+/g,"'").replace(/^["']+|["']+$/g,""):e}e.s(["CustomEndpointEditor",()=>er],5664328)},4576858,3226981,4758962,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(4237893),s=e.i(6064230),a=e.i(762896),n=e.i(4597921),l=e.i(5486173),o=e.i(5664328);e.i(6887680);var c=e.i(6810699);e.i(553769);var d=e.i(3758860),u=e.i(9957872),p=e.i(4245131),m=e.i(8161149),g=e.i(5255926),h=e.i(5468328);e.i(8703064);var x=e.i(648779),f=e.i(4325157),j=e.i(1017032),v=e.i(9668517),y=e.i(3584802),b=e.i(109803),k=e.i(57106);function N(e){let{drainType:i}=e,s=(0,v.useTeamSlug)(),a="logs"===i?"logDrain":"traceDrain",{data:n,isLoading:l}=(0,f.useMarketplaceIntegrations)({protocolType:a}),{data:o,isLoading:u}=(0,c.useResourceList)({protocolType:a}),{data:m,isLoading:h}=(0,j.useConfigurations)({type:"marketplace",skipBillingData:!0,skip:!1}),N=(0,r.useMemo)(()=>{if(!n||!o||!m)return[];let e=[];for(let t of n)for(let r of t.products)(0,d.isProtocolSupported)(r,a)&&e.push({product:r,integration:t});return e},[n,o,m,a]);return l||u||h?(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Available products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[1,2].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border border-gray-alpha-400 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsx)(g.Skeleton,{width:36,height:36,rounded:!0}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(g.Skeleton,{width:"80%",height:14,className:"mb-2"}),(0,t.jsx)(g.Skeleton,{width:"60%",height:12})]})]}),(0,t.jsx)(g.Skeleton,{width:60,height:32})]},e))})}):0!==N.length&&s?(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Available products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:N.map(e=>{let{product:r,integration:i}=e,a=(0,y.getIntegrationCheckoutUrl)({params:{integrationSlug:i.slug,teamSlug:s},searchParams:{productSlug:r.slug,cancelUrl:`${window.location.pathname}${window.location.search}`}});return(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 p-4 border border-gray-alpha-400 rounded-lg hover:border-gray-600 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(x.ProductIcon,{icon:r.iconUrl,size:"large"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium truncate",title:r.name,children:r.name}),(0,t.jsx)("div",{className:"text-sm text-gray-600 truncate",title:i.name,children:i.name})]})]}),(0,t.jsx)(k.ButtonLink,{size:"small",type:"secondary",href:a,target:"_blank",rel:"noopener noreferrer",suffix:(0,t.jsx)(b.External,{}),children:"Install"})]},r.id)})})}):null}function w(){let{watch:e,setValue:i}=(0,l.useFormContext)(),s=e("source"),a=e("drainType"),n=s&&"resourceId"in s?s.resourceId??"":"",{data:o,isLoading:f}=(0,c.useResourceList)({protocolType:"traceDrain"}),{data:j,isLoading:v}=(0,c.useResourceList)({protocolType:"logDrain"}),y=(0,r.useMemo)(()=>{let e=[];return"traces"===a&&o?.stores?e.push(...o.stores.filter(e=>(0,d.isProtocolSupported)(e.product,"traceDrain"))):"logs"===a&&j?.stores&&e.push(...j.stores.filter(e=>(0,d.isProtocolSupported)(e.product,"logDrain"))),e},[o,j,a]);if(f||v)return(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Installed products"}),content:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 border border-gray-alpha-400 rounded-lg",children:[(0,t.jsx)(g.Skeleton,{width:40,height:40,rounded:!0}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(g.Skeleton,{width:"80%",height:14,className:"mb-2"}),(0,t.jsx)(g.Skeleton,{width:"60%",height:12})]})]},e))})});let b="logs"===a||"traces"===a;return 0===y.length?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.EmptyState.Root,{title:"No Integrations Installed",description:"Add an integration that supports drains to get started."}),b&&(0,t.jsx)("div",{className:"flex flex-col gap-6 mt-6",children:(0,t.jsx)(N,{drainType:a})})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)(p.Description,{title:(0,t.jsx)("h2",{className:"text-sm font-medium",children:"Installed products"}),content:(0,t.jsx)(u.ChoiceboxGroup,{type:"radio",label:"Select resource",direction:"row",value:n,onChange:e=>{i("source",{kind:"integration",resourceId:e})},className:"[&>ul]:grid [&>ul]:grid-cols-2 [&>ul]:gap-3 [&_label>div>span:first-child]:overflow-hidden [&_label>div>span:first-child>span]:overflow-hidden",children:y.map(e=>(0,t.jsx)(u.ChoiceboxGroup.Item,{value:e.id,title:(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)("div",{className:"shrink-0",children:(0,t.jsx)(x.ProductIcon,{icon:e.product.iconUrl,size:"large"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 overflow-hidden",children:[(0,t.jsx)(h.Tooltip,{text:e.name,className:"block truncate",children:(0,t.jsx)("span",{className:"truncate text-sm font-medium block",children:e.name})}),(0,t.jsxs)("div",{className:"truncate text-sm text-gray-600",title:`${e.product.name}${e.billingPlan?.name?` - ${e.billingPlan.name}`:""}`,children:[e.product.name,e.billingPlan?.name?` - ${e.billingPlan.name}`:""]})]})]})},e.id))})}),b&&(0,t.jsx)(N,{drainType:a})]})}var S=e.i(7609806),C=e.i(1282571);function _(e){let{protocolType:r,limit:i=3,size:s=20}=e,{data:a,isLoading:n,error:l}=(0,f.useMarketplaceIntegrations)({protocolType:r});if(n||l||!a||0===a.length)return null;let o=a.map(e=>({uid:e.id,component:(0,t.jsx)(C.MarketplaceIntegrationCardIcon,{icon:e.icon,name:e.name,size:s})}));return(0,t.jsx)(S.AvatarGroup,{members:o,size:s,limit:i})}function I(e,r){if(r)return null;let i="logs"===e?"logDrain":"traces"===e?"traceDrain":null;return i?(0,t.jsx)(_,{protocolType:i}):null}e.s(["configureDestinationStep",0,{title:"Configure the destination",component:function(){let e=(0,n.useServerFlag)("enable-marketplace-drains",!1),{watch:c,setValue:d}=(0,l.useFormContext)(),u=c("source"),p=c("mode"),m=c("drainType"),g=(0,r.useMemo)(()=>u?.kind==="integration"?"native-integrations":"custom",[u]),h=I(m,!1);return e&&("update"!==p||u?.kind==="integration")&&("logs"===m||"traces"===m)?(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial pt-4 max-w-2xl",children:[(0,t.jsx)(i.Tabs,{selected:g,setSelected:e=>{"native-integrations"===e?d("source",{...u,kind:"integration"}):d("source",{...u,kind:"self-served"})},tabs:[{title:"Custom Endpoint",value:"custom",icon:(0,t.jsx)(s.Terminal,{size:16})},{title:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:["Native Integrations",h]}),value:"native-integrations",icon:(0,t.jsx)(a.LogoVercelFill,{size:16})}]}),"custom"===g?(0,t.jsx)(o.CustomEndpointEditor,{}):(0,t.jsx)(w,{})]}):(0,t.jsx)(o.CustomEndpointEditor,{})},getFieldsToValidate:e=>e.source?.kind==="integration"?["source","source.resourceId"]:["delivery.endpoint","delivery.encoding","delivery.headers","source"],getIsNextEnabled:e=>e.source?.kind!=="integration"||!!("resourceId"in e.source&&e.source.resourceId),getSuffix:I}],4576858);var D=e.i(9722978),T=e.i(2504781),z=e.i(4030453);function $(e){let{children:r,onNext:i,onBack:s,isFirstStep:a=!1,isLastStep:n=!1,nextLabel:l="Next",isLoading:o=!1,isNextDisabled:c=!1,error:d}=e;return(0,t.jsxs)(t.Fragment,{children:[r,(0,t.jsxs)("div",{className:`flex flex-row items-stretch justify-start gap-2 flex-initial ${(0,D.default)(!n&&"pb-6")}`,children:[!a&&(0,t.jsx)(T.Button,{onClick:s,type:"secondary",typeName:"button",children:"Back"}),i&&(0,t.jsx)(T.Button,{loading:o,disabled:c,onClick:i,typeName:"button",children:l})]}),d&&n&&(0,t.jsx)(z.Error,{children:d})]})}e.s(["StepWrapper",()=>$],3226981);var E=e.i(6636464),L=e.i(9979783),P=e.i(5338940),A=e.i(1021293),M=e.i(6060673);function F(e,t){let{team:r}=(0,P.useTeam)(),{data:i}=(0,M.useProject)(t),s=(0,A.getDrainsKey)(e,t),{trigger:a,isMutating:n}=(0,E.default)(s,async(e,t)=>{let{arg:s}=t;if(!r?.id)throw Error("Team ID is required");let a={teamId:r.id,...i&&{projectId:i.id}};return(await (0,L.typedFetch)("/v1/drains","post",a,s,{throwOnHTTPError:!0})).body},{throwOnError:!0});return{createDrain:a,isCreating:n}}e.s(["useCreateDrain",()=>F],4758962)},8404074,e=>{"use strict";var t=e.i(6636464),r=e.i(9429645),i=e.i(9979783),s=e.i(5338940),a=e.i(1021293);function n(e,n){let{team:o}=(0,s.useTeam)(),c=(0,a.getDrainsKey)(e,n),{trigger:d,isMutating:u,error:p}=(0,t.default)(c,async(e,t)=>{let{arg:s}=t;if(!o?.id)throw Error("Team ID is required");let{id:a,...n}=s;(0,r.mutate)(c,e=>{if(e)return{...e,drains:e.drains.map(e=>e.id===a?{...e,...l(n)}:e)}},!1);try{let e=await (0,i.typedFetch)("/v1/drains/{id}","patch",{id:a,teamId:o.id},n,{throwOnHTTPError:!0});if((0,r.mutate)(c),200!==e.status)throw console.error("Failed to update drain:",e.body),Error("Failed to update drain");return e.body}catch(e){throw console.error("Failed to update drain:",e),(0,r.mutate)(c),e}},{throwOnError:!0});return{updateDrain:d,isUpdating:u,error:p}}let l=e=>{let t={};for(let[r,i]of Object.entries(e))t[r]=null===i?void 0:i;return t};e.s(["useUpdateDrain",()=>n])},223073,5905545,e=>{"use strict";var t=e.i(6696646),r=e.i(2199694),i=e.i(4758962),s=e.i(8404074),a=e.i(3456281),n=e.i(5744676),l=e.i(6092370);function o(e){let{drainType:t,filter:r}=e,i={};return r&&("logs"===t&&r.source&&r.source.length>0&&(i["log/source"]=r.source),r.environment&&r.environment.length>0&&(i["deployment/environment"]=r.environment)),(0,l.serializeObjectFilter)(i)}var c=e.i(8631221),d=e.i(3196486),u=e.i(7917902),p=e.i(9429645),m=e.i(1021293),g=e.i(3573347);function h(e){let{teamSlug:l,projectIdOrSlug:h,drainId:x,isLegacyDrain:f,onSuccess:j,onError:v,onDrainCreated:y}=e,{team:b,user:k}=(0,u.useAccount)(),{createDrain:N,isCreating:w}=(0,i.useCreateDrain)(l,h),{updateDrain:S,isUpdating:C}=(0,s.useUpdateDrain)(l,h),{updateLogDrain:_}=(0,g.useLogDrainsOperations)({teamSlug:l});return{handleSubmit:(0,t.useCallback)(async e=>{try{if((0,r.isCreateFlow)(e)){let t={name:e.name.trim(),projects:e.projects,projectIds:e.projectIds,...e.delivery&&{delivery:e.delivery},sampling:e.sampling,schemas:(0,a.getSchemaForDrainType)(e.drainType),filter:o({drainType:e.drainType,filter:e.filter}),...e.source&&{source:e.source}},r=await N(t);y?.(e,r)}else if((0,r.isUpdateFlow)(e)){if(!x)throw Error("Drain ID is required for update mode");if(f){let t,r,i=(t=e.filter?.source||[],r=e.filter?.environment||["production","preview"],{id:x,name:e.name?.trim()||"",sources:t,deliveryFormat:e.delivery?.encoding==="ndjson"?n.DeliveryFormats.NDJSON:n.DeliveryFormats.JSON,url:"string"==typeof e.delivery?.endpoint?e.delivery?.endpoint:"",headers:e.delivery?.headers||{},environments:r,projectIds:e.projectIds,samplingRate:e.sampling?.[0]?.rate});await _(i);let s=(0,m.getLegacyLogDrainsKey)(l,h);(0,p.mutate)(s)}else{let t={id:x,...void 0!==e.name&&{name:e.name.trim()},...void 0!==e.status&&{status:e.status},...void 0!==e.delivery&&{delivery:e.delivery},...void 0!==e.sampling&&{sampling:e.sampling},...void 0!==e.filter&&{filter:o({drainType:e.drainType,filter:e.filter})},...(void 0!==e.projectIds||void 0!==e.projects)&&{projectIds:e.projectIds,projects:e.projects}};await S(t)}e.status&&(0,d.sendToSnowflake)(c.Topic.VercelAppV0LogDrainToggle,{event_time:Date.now(),user_id:null!==k?k.uid:"",team_id:null!==b?b.id:"",log_drain_id:x,enabled:"enabled"===e.status},"vercel-app")}j?.()}catch(e){v?.(e)}},[N,S,_,x,f,l,h,j,v,b,k,y]),isLoading:w||C}}e.s(["useDrainSubmit",()=>h],223073);let x={"log/source":[],"deployment/environment":[]};function f(e,t){if(!e)return t.reduce((e,t)=>(e[t]=x[t],e),{});try{let r=(0,l.parseNormalFilter)(e);return t.reduce((e,t)=>(e[t]=function e(t,r){if(!t)return[];if("and"in t)return t.and.flatMap(t=>e(t,r));if("or"in t)return t.or.flatMap(t=>e(t,r));if(t.subject===r){if("in"===t.operator&&Array.isArray(t.values))return t.values.map(String);if("eq"===t.operator&&void 0!==t.value)return[String(t.value)]}return[]}(r,t)||x[t],e),{})}catch(e){console.error("Failed to parse filter:",e)}return t.reduce((e,t)=>(e[t]=x[t],e),{})}e.s(["parseDrainFilter",()=>f],5905545)},7983333,e=>{"use strict";function t(e){return e.id.startsWith("ld_")}e.s(["isLegacyLogDrain",()=>t])},3199886,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(2504781),s=e.i(455575),a=e.i(5806401),n=e.i(6942035),l=e.i(6318858),o=e.i(109803),c=e.i(5486173),d=e.i(1971505),u=e.i(6143247),p=e.i(4597921),m=e.i(2199694),g=e.i(7662235),h=e.i(3614887),x=e.i(4576858),f=e.i(3226981),j=e.i(223073),v=e.i(4789955),y=e.i(8249103),b=e.i(1094129),k=e.i(3456281),N=e.i(5905545),w=e.i(7983333),S=e.i(9572009),C=e.i(4110479);e.i(8703064);var _=e.i(648779);function I(e){let{drain:i,active:s,onClose:n,teamSlug:l,projectIdOrSlug:o,onDrainCreated:c,onDrainUpdated:d,onOpenExternalModal:p,drainType:m,defaultProjectId:g}=e,h=(0,r.useRef)(null);return(0,t.jsx)(a.Sheet,{open:s,onOpenChange:e=>!e&&n(),children:(0,t.jsx)(a.SheetContent,{ref:h,className:(0,u.cn)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-y-auto rounded-[1rem] bg-white p-0 pb-6 lg:w-3/4 sm:max-w-[800px]"),side:"right",children:(0,t.jsx)(S.SheetContainerContext.Provider,{value:h.current,children:(0,t.jsx)(v.EndpointValidationProvider,{children:(0,t.jsx)(D,{drain:i,onClose:n,teamSlug:l,projectIdOrSlug:o,onDrainCreated:c,onDrainUpdated:d,onOpenExternalModal:p,drainType:m,defaultProjectId:g})})})})})}function D(e){let{drain:l,onClose:S,teamSlug:I,projectIdOrSlug:D,onDrainCreated:z,onDrainUpdated:$,onOpenExternalModal:E,drainType:L,defaultProjectId:P}=e,A=l?"update":"create",M=(0,s.useToasts)(),F=L?2:1,[q,O]=(0,r.useState)(F),{validateEndpoint:R}=(0,v.useEndpointValidationContext)(),B=(0,p.useServerFlag)("enable-marketplace-drains",!1),V=(0,C.useOptionalDrainModalContext)(),U=V?.resource,H=(0,c.useForm)({resolver:(0,d.zodResolver)(b.DrainFormSchema),defaultValues:async()=>"update"===A&&l?((e,t)=>{if((0,w.isLegacyLogDrain)(e)){let r,i,s,a,n,l;return r={static:"static",lambda:"lambda",build:"build",edge:"edge",external:"external",firewall:"firewall"},i=(e.sources||[]).map(e=>r[e]||e),s=e.samplingRate?[{type:"head_sampling",rate:e.samplingRate}]:[],a=e.projectIds&&e.projectIds.length>0||!!e.projectId,n=e.projectIds?.length?e.projectIds:e.projectId&&null!==e.projectId?[e.projectId]:[],l={type:"http",endpoint:e.url,encoding:({json:"json",ndjson:"ndjson"})[e.deliveryFormat]||"json",headers:e.headers||{},...e.secret&&{secret:e.secret}},{mode:"update",name:e.name??"",projects:a?"some":"all",projectIds:n,drainType:"logs",filter:{source:i,environment:e.environments||["production","preview"]},delivery:l,sampling:s,source:t?{kind:"integration",resourceId:t}:{kind:"self-served"}}}let{"log/source":r,"deployment/environment":i}=(0,N.parseDrainFilter)(e.filter,["log/source","deployment/environment"]),s=(0,k.getDrainTypeFromDrain)(e);return{mode:"update",name:e.name??"",projects:e.projectIds?"some":"all",projectIds:e.projectIds,drainType:s,filter:{source:r,environment:i},delivery:e.delivery,sampling:e.sampling,...e.source&&{source:e.source}}})(l,U?.id):(e=>{let{secret:t,resourceId:r,drainType:i,projectId:s}=e;return{mode:"create",name:"",...s?{projectIds:[s],projects:"some"}:{projects:"all",projectIds:[]},drainType:i,filter:{source:[],environment:[]},delivery:r?void 0:{type:"http",endpoint:"",encoding:"json",secret:t,headers:{},compression:void 0},sampling:[],source:r?{kind:"integration",resourceId:r}:{kind:"self-served"}}})({secret:await (0,y.generateSecret)(32),resourceId:U?.id,drainType:L,projectId:P})}),G=(0,r.useCallback)(()=>{S(),H.reset(),O(F)},[S,H,F]),{handleSubmit:W,isLoading:K}=(0,j.useDrainSubmit)({teamSlug:I,projectIdOrSlug:D,drainId:l?.id,isLegacyDrain:!!l&&(0,w.isLegacyLogDrain)(l),onSuccess:async()=>{"update"===A&&await $?.(),G(),M.success({text:`Drain ${"create"===A?"created":"updated"} successfully.`,key:`${"create"===A?"add":"edit"}-drain`})},onError:e=>{console.error(e),H.setError("root.serverError",{message:e.message}),M.error({text:`Failed to ${A} drain`})},onDrainCreated:e=>{z?.({drainType:e.drainType,kind:e.source?.kind==="integration"?`integration${"externalResourceId"in e.source?"-external":""}`:e.source?.kind})}}),Y=(0,r.useCallback)(async e=>{if(H.clearErrors(),(0,m.isCreateFlow)(e))await W(e);else if(H.formState.isDirty&&Object.keys(H.formState.dirtyFields).length>0)if(l&&(0,w.isLegacyLogDrain)(l))await W({...e,mode:"update"});else{var t;let r,i=(t=H.formState.dirtyFields,r=Object.keys(t).reduce((r,i)=>t[i]?{...r,[i]:e[i]}:r,{}),("projectIds"in e||"projects"in e)&&(r.projectIds=e.projectIds,r.projects=e.projects),r);await W({...i,mode:"update",drainType:e.drainType})}else G(),M.success({text:"No changes to save.",key:"edit-drain"})},[W,H.formState.isDirty,H.formState.dirtyFields,M,G,H.clearErrors,z,l]),J=(0,r.useMemo)(()=>{let e=[g.chooseDrainDataStep,h.configureDrainStep,x.configureDestinationStep],t=[h.configureDrainStep,x.configureDestinationStep];return U&&(e=[g.chooseDrainDataStep,h.configureDrainStep],t=[h.configureDrainStep]),("update"===A?t:e).map((e,t)=>({...e,id:t+1,number:t+1,isComplete:t+1<q,isActive:q===t+1,disabled:t+1>q}))},[A,q,U]),Q=J.length,Z=J.find(e=>e.id===q),X=async()=>{let e=H.getValues(),t=Z?.getFieldsToValidate(e);if(!t)return;let r=await H.trigger(t),i=e.source?.kind==="self-served";if(r&&Z?.component===x.configureDestinationStep.component)if(i){if(H.setValue("source",{kind:"self-served"}),!await R(e)){let t="string"==typeof e.delivery?.endpoint?"delivery.endpoint":"delivery.endpoint.traces";H.setError(t,{message:""});return}}else H.setValue("delivery",void 0);r&&(q===Q?H.handleSubmit(Y,e=>{console.error("[DrainModal] RHF validation failed with errors:",e)})():q<Q&&O(q+1))},ee=()=>{q>1&&(H.clearErrors(),O(q-1))};return(0,t.jsxs)("main",{className:"flex h-full shrink-0 grow-0 flex-col",children:[(0,t.jsx)("header",{className:"sticky top-0 z-50 bg-background-100 pt-7",children:(0,t.jsxs)("section",{className:"flex items-center justify-start gap-4 px-8",children:[(0,t.jsxs)(a.SheetTitle,{className:"text-heading-24 flex items-center gap-4",children:[(0,t.jsxs)("span",{children:["create"===A?"Add":"Edit"," Drain"]}),U&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,t.jsx)(_.ProductIcon,{icon:U.product.iconUrl,size:"medium"}),(0,t.jsx)("span",{children:U.name})]})]}),(0,t.jsx)(a.SheetDescription,{className:"sr-only",children:"Configure a drain to send your data to external services"}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-3",children:["create"===A&&!U&&B&&E&&(0,t.jsx)(i.Button,{type:"tertiary",size:"small",onClick:E,suffix:(0,t.jsx)(o.External,{}),className:"!text-gray-600 hover:!text-gray-900",children:"External Integrations"}),(0,t.jsx)(i.Button,{svgOnly:!0,"aria-label":"close modal",shape:"circle",size:"tiny",onClick:G,className:"!border-0 !bg-transparent",children:(0,t.jsx)(n.Cross,{color:"gray-1000"})})]})]})}),(0,t.jsx)("div",{className:"px-8 pb-4 pt-6",children:(0,t.jsx)("div",{className:"space-y-1",children:(0,t.jsx)(c.FormProvider,{...H,children:(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault(),X()},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),X())},children:J.map(e=>{let r=e.getSuffix?.(H.watch("drainType"),e.isActive);return(0,t.jsxs)("div",{children:[(0,t.jsx)(T,{step:e,onClick:()=>{var t;(t=e.number)>q||(H.clearErrors(),O(t))},suffix:r}),e.isActive&&(0,t.jsx)("div",{className:`flex flex-col items-stretch justify-start gap-6 flex-initial ${(0,u.cn)("pl-6 ml-[1.6rem] -mt-1 -mb-1",e.number!==Q&&"border-gray-400 border-dashed border-l")}`,children:(()=>{var e,r,i;if(!Z)return null;let s=Z.component,a=Z.getIsNextEnabled(H.getValues());return(0,t.jsx)(f.StepWrapper,{error:H.formState.errors.root?.serverError?.message,isLoading:K,onNext:X,onBack:ee,isFirstStep:1===q,isLastStep:q===Q,nextLabel:(e=q,r=Q,i=A,e===r?"create"===i?"Create Drain":"Update Drain":"Next"),isNextDisabled:!a,children:(0,t.jsx)(s,{})})})()})]},e.number)})})})})})]})}function T(e){let{step:r,onClick:i,suffix:s}=e;return(0,t.jsxs)("div",{className:(0,u.cn)("flex items-center gap-3 px-3 py-3 cursor-pointer transition-colors",{"hover:bg-gray-50":!r.disabled&&!r.isActive,"opacity-80 cursor-not-allowed":r.disabled&&r.isNext,"opacity-50 cursor-not-allowed":r.disabled&&!r.isNext,"hover:bg-success-100":r.isComplete&&!r.isActive}),onClick:i,title:r.isComplete&&!r.isActive?"Click to return to this step":void 0,children:[(0,t.jsx)("div",{className:(0,u.cn)("flex size-7 items-center justify-center rounded-full text-sm font-medium border",{"bg-success text-black border-success":r.isComplete,"bg-black text-white border-black":!r.isComplete&&r.isActive,"bg-white text-gray-900 border-gray-500":!r.isComplete&&!r.isActive}),children:r.isComplete?(0,t.jsx)(l.Check,{size:14}):r.number}),(0,t.jsx)("p",{className:(0,u.cn)("text-[16px] leading-[24px]",r.isActive&&"font-medium"),children:r.title}),s]})}e.s(["DrainModal",()=>I],3199886)},5765731,e=>{"use strict";var t=e.i(2704354),r=e.i(9668517),i=e.i(3911483);function s(){let e=(0,r.useTeamSlug)();return(0,i.default)(e?(0,t.getMarketplaceIntegrationsApiUrl)({integrationType:"external",teamIdOrSlug:e}):null,e=>fetch(e).then(e=>e.json()))}e.s(["useConnectableIntegrations",()=>s])},6269556,e=>{"use strict";var t=e.i(9100551),r=e.i(6696646),i=e.i(4011256);function s(){let e=(0,t.useSearchParams)(),s=(0,t.useParams)(),a=e?.get("category")??null,n=e?.get("search")??null,l=!!e?.get("expanded"),o=!!e?.get("isPreview"),c=(0,r.useMemo)(()=>s?.teamSlug?{teamSlug:s.teamSlug.toString(),isPublic:!1}:{isPublic:!0,teamSlug:void 0},[s?.teamSlug]);return{categorySlug:a,isRootCategory:!a||!!l,searchQuery:n,expanded:l,teamSlugOrPublic:c,isPreview:!!o,getBrowseMarketplaceLink:e=>(0,i.getBrowseMarketplaceLink)({teamSlugOrPublic:c,...e})}}e.s(["useMarketplaceNavigation",()=>s])},6315360,e=>{e.v({bradcrumbsWrapper:"details-layout-module__xg7Djq__bradcrumbsWrapper",breadcrumbsText:"details-layout-module__xg7Djq__breadcrumbsText",cta:"details-layout-module__xg7Djq__cta",header:"details-layout-module__xg7Djq__header",marketplaceDetailsProductsGrid:"details-layout-module__xg7Djq__marketplaceDetailsProductsGrid",marketplaceProduct:"details-layout-module__xg7Djq__marketplaceProduct",message:"details-layout-module__xg7Djq__message",mobileHeaderButtons:"details-layout-module__xg7Djq__mobileHeaderButtons",wrapper:"details-layout-module__xg7Djq__wrapper"})},1033832,e=>{"use strict";var t=e.i(6468255),r=e.i(9508212),i=e.i(5468328),s=e.i(4991687),a=e.i(6694387),n=e.i(8459493),l=e.i(8674454),o=e.i(8876434),c=e.i(57106),d=e.i(6696646),u=e.i(5338940),p=e.i(1857939),m=e.i(2504781),g=e.i(3225905),h=e.i(7668531),x=e.i(2704354),f=e.i(4011256),j=e.i(1017032),v=e.i(8794163),y=e.i(4065455),b=e.i(6269556),k=e.i(7594446),N=e.i(6315360);let w={normal:{foreground:"#000",background:"#fff",border:"#fff"},hover:{foreground:"#fff",background:"#000",border:"#fff"},active:{foreground:"#fff",background:"#000",border:"#fff"}};function S(e){let{isCta:r,...i}=e;return r?(0,t.jsx)(h.CustomButtonLink,{...w,...i}):(0,t.jsx)(c.ButtonLink,{...i})}function C(e){let{isCta:r,...i}=e;return r?(0,t.jsx)(g.CustomButton,{...w,...i}):(0,t.jsx)(m.Button,{...i})}function _(e){let{integration:r,isCta:s,type:a,size:n,className:l,loginRedirect:o}=e,{isLoggedOut:c}=(0,p.useIsLoggedIn)(),{teamSlugOrPublic:m}=(0,b.useMarketplaceNavigation)(),{canCreateIntegrationConfiguration:g}=(0,k.useIntegrationPermissions)(),h=a??((0,x.isMarketplaceIntegration)(r)?"secondary":"default"),{isReady:N,team:w}=(0,u.useTeam)(),{hasConfigurations:_,data:I}=(0,j.useConfigurations)({integrationId:r.id,type:"external",skip:m.isPublic,skipBillingData:!0}),D=I?.[0],[T,z]=(0,d.useState)(!1),$=!!(w?.billing?.plan==="hobby"||w?.billing?.trial)&&r.proOnly,E=!g,L=$||E,P=!!(0,v.useV0Marketplace)()?.token;return(0,x.isMarketplaceOnlyIntegration)(r)?null:c?(0,t.jsx)(S,{className:l,disabled:(0,x.isLegacyIntegration)(r),href:o??`/login?next=${(0,f.getIntegrationDetailsLink)({integrationSlug:r.slug,teamSlugOrPublic:m,isFromV0:P})}`,isCta:s,type:h,size:n,rel:"nofollow",children:"Connect Account"}):D&&m.teamSlug?(0,t.jsx)(i.Tooltip,{disableTriggers:g,text:g?void 0:"You don't have permission to manage this integration.",children:(0,t.jsx)(S,{className:l,href:(0,f.getInstallationDetailsLink)({teamSlug:m.teamSlug,configurationId:D.id,integrationSlug:r.slug,isMarketplace:!1}),isCta:s,type:h,size:n,disabled:!g,children:"Manage"})}):(0,t.jsxs)(t.Fragment,{children:[_?null:(0,t.jsx)(i.Tooltip,{disableTriggers:!L,text:E?"You need additional permissions to install integrations.":"You need a paid account to install this integration",children:(0,t.jsx)(C,{className:l,disabled:L,isCta:s,onClick:()=>z(!0),type:h,size:n,children:"Connect Account"})}),T&&N?(0,t.jsx)(y.InstallExternalIntegrationModal,{account:w,integration:r,onAnimationDone:()=>z(!1),teamSlugOrPublic:m}):null]})}function I(){let{size:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsxs)(s.MenuContainer,{children:[(0,t.jsx)(a.MenuButton,{"aria-label":"More",shape:"square",svgOnly:!0,type:"secondary",size:e,children:(0,t.jsx)(o.MoreHorizontal,{})}),(0,t.jsx)(l.Menu,{children:(0,t.jsx)(n.MenuItem,{children:(0,t.jsx)(c.Link,{href:"#template",prefetch:!1,children:"Deploy Template"})})})]})}function D(e){let{integration:i}=e,{teamSlugOrPublic:s}=(0,b.useMarketplaceNavigation)(),{hasConfigurations:a}=(0,j.useConfigurations)({integrationId:i.id,type:"external",skip:s.isPublic,skipBillingData:!0});return a?null:(0,t.jsx)("div",{className:N.default.wrapper,children:(0,t.jsxs)(r.Stack,{className:N.default.cta,gap:3,children:[(0,t.jsxs)("div",{className:N.default.message,children:["Get started with Vercel and ",i.name,"."]}),(0,t.jsx)(_,{integration:i,isCta:!0})]})})}e.s(["ConnectAndTemplateMenu",()=>I,"ConnectExternalIntegrationButton",()=>_,"ConnectExternalIntegrationCTA",()=>D])},7589392,e=>{"use strict";var t=e.i(6468255),r=e.i(6696646),i=e.i(3199886),s=e.i(6891161),a=e.i(57106),n=e.i(109803),l=e.i(1017032),o=e.i(5765731),c=e.i(2521731),d=e.i(2704354),u=e.i(1282571),p=e.i(1033832),m=e.i(7743427);function g(e){let{config:r,teamSlug:i}=e,{data:s,isLoading:l}=(0,m.useIntegration)(r.integrationId,{teamId:i});return l||!s?null:(0,t.jsx)(u.MarketplaceIntegrationCard,{Actions:(0,t.jsx)(a.ButtonLink,{size:"small",type:"secondary",prefix:(0,t.jsx)(n.External,{size:14}),href:(0,d.getConfigureUrl)(s,r.id),target:"_blank",children:"Configure"}),className:"p-3 px-4",disabled:!0,href:"#",icon:s.icon,title:s.name,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-1000",children:s.name}),(0,t.jsxs)("div",{className:"text-xs text-gray-900",children:["Connected ",new Date(r.createdAt).toLocaleDateString()]})]})})}function h(e){let{teamSlug:r,onClose:i}=e,{data:a}=(0,l.useConfigurations)({skipBillingData:!0}),{data:n}=(0,o.useConnectableIntegrations)(),d=a?.filter(e=>"external"===e.installationType&&e.scopes.includes("read-write:log-drain"))||[],m=Array.isArray(n)?n.filter(e=>!!(0,c.integrationSupportsLogDrains)(e)&&!a?.some(t=>"external"===t.installationType&&t.integrationId===e.id)):[];return(0,t.jsxs)(s.Modal.Modal,{active:!0,onClickOutside:i,children:[(0,t.jsxs)(s.Modal.Body,{children:[(0,t.jsx)(s.Modal.Header,{children:(0,t.jsx)(s.Modal.Title,{center:!0,children:"External Integration Log Drains"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-6 mt-4",children:[d.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-1000 mb-3",children:"Installed Integrations"}),(0,t.jsx)("div",{className:"rounded-md border border-accents-2 shadow-[0px_1px_2px_0px_rgba(0,0,0,0.04)]",children:d.map(e=>(0,t.jsx)(g,{config:e,teamSlug:r},e.id))})]}),m.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-1000 mb-3",children:"Available Integrations"}),(0,t.jsx)("div",{className:"rounded-md border border-accents-2 shadow-[0px_1px_2px_0px_rgba(0,0,0,0.04)]",children:m.map(e=>(0,t.jsx)(u.MarketplaceIntegrationCard,{Actions:(0,t.jsx)(p.ConnectExternalIntegrationButton,{integration:e,size:"small"}),className:"p-3 px-4",disabled:!0,href:"#",icon:e.icon,title:e.name,children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-gray-1000",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-900",children:e.shortDescription})]})},e.id))})]}),0===d.length&&0===m.length&&(0,t.jsx)("p",{className:"text-center py-8 text-gray-700",children:"No external integrations available for log drains."})]})]}),(0,t.jsxs)(s.Modal.Actions,{children:[(0,t.jsx)("div",{}),(0,t.jsx)(s.Modal.Action,{type:"secondary",onClick:i,children:"Close"})]})]})}var x=e.i(8633387);function f(e){let{isOpen:s,closeModal:a,teamSlug:n,projectIdOrSlug:l,onDrainCreated:o,drain:c,drainType:d,enableMarketplaceDrains:u}=e,[p,m]=(0,r.useState)(!1),{data:g}=(0,x.useDashboardProject)({projectSlug:l,teamSlug:n});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.DrainModal,{drain:c,active:s,onClose:()=>{a()},teamSlug:n,projectIdOrSlug:l,onDrainCreated:o,onOpenExternalModal:()=>{a(),m(!0)},drainType:d,defaultProjectId:g?.id},c?.id),u&&p&&(0,t.jsx)(h,{teamSlug:n,onClose:()=>m(!1)})]})}e.s(["DrainModals",()=>f],7589392)}]);

//# sourceMappingURL=acf0c327996428a2.js.map
//# debugId=e6b71fed-765a-58d4-bd70-1c6a5c5d50bb
