
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="9709848b-c3af-5a36-9a88-c976e354f701")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4093282,e=>{e.v({continueWithText:"index-module__gQ5Ota__continueWithText",emptyResult:"index-module__gQ5Ota__emptyResult",entityName:"index-module__gQ5Ota__entityName",entityStack:"index-module__gQ5Ota__entityStack",gitPill:"index-module__gQ5Ota__gitPill",loadingResult:"index-module__gQ5Ota__loadingResult",providerBtn:"index-module__gQ5Ota__providerBtn",providerBtnMobile:"index-module__gQ5Ota__providerBtnMobile",repoDescription:"index-module__gQ5Ota__repoDescription",repoList:"index-module__gQ5Ota__repoList",repoTitle:"index-module__gQ5Ota__repoTitle",selectProvider:"index-module__gQ5Ota__selectProvider",small:"index-module__gQ5Ota__small",suggestionBox:"index-module__gQ5Ota__suggestionBox",suggestionDescription:"index-module__gQ5Ota__suggestionDescription",suggestionHighlight:"index-module__gQ5Ota__suggestionHighlight",suggestionList:"index-module__gQ5Ota__suggestionList",suggestionListBorder:"index-module__gQ5Ota__suggestionListBorder",turborepoBadgeContainer:"index-module__gQ5Ota__turborepoBadgeContainer",turborepoLogoContainer:"index-module__gQ5Ota__turborepoLogoContainer"})},7591419,2867523,e=>{"use strict";var t,i=e.i(6468255),r=e.i(6696646),a=e.i(9722978),s=e.i(6198010),n=e.i(9550268),o=e.i(6881349),l=e.i(5255926),d=e.i(9318197),u=e.i(9508212),c=e.i(57106),p=e.i(4004502),h=e.i(277234),g=e.i(4244280),m=e.i(5140444),f=e.i(5338940),x=e.i(4597921),b=e.i(9716741),j=e.i(4450569),y=e.i(8835183),v=e.i(5614970),_=e.i(1792778),S=e.i(1565534),w=e.i(7628870),A=e.i(7249340),T=e.i(8210056),C=e.i(5591369),I=e.i(4586231),k=e.i(2160483),G=e.i(4093282),N=e.i(4633952),E=e.i(5756088),R=e.i(8735244),L=e.i(3306538),M=e.i(7218483),P=e.i(5819220),O=e.i(979715),B=e.i(4712634),U=e.i(7045101),D=e.i(4147070),H=e.i(6509836);function F(e){let{framework:t}=e,r=(0,D.useFrameworkLogo)({logo:t.logo,darkModeLogo:t.darkModeLogo});return(0,i.jsx)(N.default,{alt:"Framework logo",height:20,src:r,width:20})}function q(e){let{repo:t,gitType:s,search:n,renderButton:o,repoSkeletonWidthPercentage:d=100,currentNamespace:c}=e,{data:h,error:g,isLoading:m}=(0,U.useDetectEligibleProjects)(t?.url),x=(0,M.useAgo)(t?.updatedAt),b=(0,r.useMemo)(()=>t?n?t.name.split(n).reduce((e,t,r)=>(0!==r&&e.push((0,i.jsx)("mark",{className:G.default.suggestionHighlight,children:n},e.length)),t&&e.push((0,i.jsx)("span",{children:t},e.length)),e),[]):[(0,i.jsx)("span",{children:t.name},t.id)]:null,[t,n]),j=!t||m,{team:y}=(0,f.useTeam)(),v=y?`${y.slug}/`:"",_=(0,r.useMemo)(()=>o(t,s,v,c,h?.projects[0],h?.projects.length,!y||y.billing?.plan==="hobby"),[t,s,v,h]);return(0,i.jsx)(P.Entity,{actions:(0,i.jsx)(u.Stack,{direction:"row",children:_}),"data-testid":(0,p.tid)("import-flow-layout","suggestion-card","suggestion"),placeholder:j,thumbnail:(0,i.jsx)(B.EntityThumbnail,{size:24,children:m?(0,i.jsx)(R.Spinner,{size:24}):(0,i.jsx)(H.FrameworkIconGroup,{error:g,gitType:s,projects:h?.projects})}),children:(0,i.jsx)(O.EntityField,{children:t?(0,i.jsxs)(u.Stack,{align:"center",className:G.default.entityStack,direction:"row",gap:1,children:[(0,i.jsx)(u.Stack,{className:G.default.entityName,flex:"0 1 auto",children:(0,i.jsx)("span",{className:(0,a.clsx)(G.default.repoTitle,"geist-ellipsis"),title:t.name,children:b})}),h?.monorepoManager?.slug==="turbo"?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:G.default.turborepoBadgeContainer,children:(0,i.jsx)(L.Badge,{variant:"turbo",children:"Turbo"})}),(0,i.jsx)("div",{className:G.default.turborepoLogoContainer,children:(0,i.jsx)(F,{framework:h.monorepoManager})})]}):null,t?.private?(0,i.jsx)(u.Stack,{as:"span",flex:"0 0 auto",title:"Private Git Repository",children:(0,i.jsx)(E.LockClosed,{color:"gray-700"})}):null,(0,i.jsx)(u.Stack,{className:"geist-hide-on-mobile",flex:"0 0 auto",children:(0,i.jsx)("span",{className:G.default.repoDescription,children:"·"})}),(0,i.jsx)(u.Stack,{className:"geist-hide-on-mobile",flex:"0 0 auto",children:(0,i.jsx)("span",{className:G.default.repoDescription,children:x})})]}):(0,i.jsx)(l.Skeleton,{height:20,width:`${d}%`})})})}var Q=e.i(1344973),z=e.i(2504781),$=e.i(4030453),V=e.i(3500331),W=e.i(6891161);async function K(e){let t=`/v1/integrations/github-does-ghes-app-exist?host=${e}`;return(await (0,h.fetchAPI)(t,{throwOnHTTPError:!0})).exists}var Y=((t=Y||{}).Default="Default",t.NeedsInstallation="NeedsInstallation",t);function J(e){let{teamSlug:t,webhookUrl:a,open:s,onClose:n,onSetHostname:o,flowKind:l}=e,d=(0,r.useRef)(null),[c,p]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[m,f]=(0,r.useState)(!1),[x,b]=(0,r.useState)(""),[j,y]=(0,r.useState)("Default"),v={name:"Vercel",url:"https://vercel.com/github",redirect_url:(e=>{let{domain:t,organization:i,teamSlug:r,flowKind:a}=e;try{let e=new URL(t).host,s=new URL("https://vercel.com/api/v1/integrations/github-create-ghes-callback");return s.searchParams.set("host",e),s.searchParams.set("organization",i),s.searchParams.set("team",r),a&&s.searchParams.set("flowKind",a),s.toString()}catch{return""}})({domain:c,organization:h,teamSlug:t,flowKind:l}),callback_urls:["https://vercel.com/api/now/registration/github-custom-host/callback"],default_permissions:{actions:"write",administration:"write",checks:"write",contents:"write",deployments:"write",emails:"read",issues:"write",members:"read",metadata:"read",pull_requests:"write",repository_hooks:"write",statuses:"write"},hook_attributes:{active:!0,url:a},default_events:["branch_protection_rule","check_run","deployment","membership","pull_request","pull_request_review","push","repository","status","team"],public:!0},_=(0,r.useCallback)(()=>{p(""),g(""),y("Default"),n()},[n]),S=(0,r.useCallback)(async function(){let e;if(b(""),d.current?.reportValidity()){try{e=new URL(c).hostname}catch{b("The provided domain is not valid");return}f(!0);try{if(await K(e)){if("NeedsInstallation"===j)return void b("There is already a Spaces GitHub App installed for this GitHub Enterprise Server domain.");f(!1),o(e),_();return}if("NeedsInstallation"===j)return void d.current?.submit();y("NeedsInstallation"),f(!1)}catch{b("There was an unexpected error from the server.")}}},[c,j,_,o]);return(0,r.useEffect)(()=>{let e=e=>{s&&"Enter"===e.key&&(e.preventDefault(),S())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[S,s]),(0,i.jsx)(W.Modal.Modal,{active:s,onClickOutside:_,children:(0,i.jsxs)("form",{action:function(e,t){try{let i=new URL(e).origin;return`${i}/organizations/${t}/settings/apps/new`}catch{return""}}(c,h),method:"post",ref:d,children:[(0,i.jsxs)(W.Modal.Body,{children:[(0,i.jsxs)(W.Modal.Header,{children:[(0,i.jsx)(W.Modal.Title,{children:"GitHub Enterprise Server"}),(0,i.jsx)(W.Modal.Subtitle,{children:"Enter your GitHub Enterprise Server domain to connect a Git Repository from your GitHub Enterprise Server."})]}),(0,i.jsxs)(u.Stack,{gap:4,children:[(0,i.jsx)(V.Input,{id:"domain",label:"GitHub Enterprise Server Domain",name:"domain",onChange:e=>p(e.target.value),placeholder:"https://github.acme.com",required:!0,value:c}),"NeedsInstallation"===j?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(V.Input,{id:"organization",label:"GitHub Enterprise Server Organization Name",name:"organization",onChange:e=>g(e.target.value),placeholder:"organization-name",required:!0,value:h}),(0,i.jsx)(u.Stack,{className:"geist-sr-only",children:(0,i.jsx)(V.Input,{id:"manifest",label:"Manifest",name:"manifest",readOnly:!0,value:JSON.stringify(v)})})]}):null,(0,i.jsx)(u.Stack,{children:x?(0,i.jsx)($.Error,{error:x}):null})]})]}),(0,i.jsxs)(W.Modal.Actions,{children:[(0,i.jsx)(W.Modal.Action,{onClick:_,type:"secondary",children:"Cancel"}),(0,i.jsx)(W.Modal.Action,{buttonType:"submit",loading:m,passthroughOnClick:e=>{e.preventDefault(),s&&S()},children:"Continue"})]})]})})}function X(e){let{teamSlug:t,webhookUrl:a,dispatch:s,flowKind:n}=e,[o,l]=(0,r.useState)(!1),{user:d}=(0,m.useUser)(),[u,c]=(0,r.useState)(""),{account:p,mutate:h,isLoading:g}=(0,I.default)({account:d??null,type:"github-custom-host",customHost:u}),[f,x]=(0,r.useState)(!1),b=(0,r.useCallback)(()=>{s({type:"SET_GIT_ACCOUNT",gitAccount:{provider:"github-custom-host",host:u}})},[s,u]),j=(0,A.useConnectPopup)({onOpen:()=>{l(!0)},onAbort:()=>{l(!1),c("")},onSuccess:()=>{b(),h(),l(!1)}}),y=(0,r.useCallback)(e=>{c(e),x(!1)},[]);return(0,r.useEffect)(()=>{if(p&&u&&!g){if(!p["github-custom-host"])return void h();p["github-custom-host"].verified?b():j.open("github-custom-host",{host:u})}},[p,g,u,j,h,b]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(z.Button,{loading:o,onClick:()=>x(!0),type:"tertiary",children:(0,i.jsxs)("span",{style:{display:"flex"},children:[(0,i.jsx)(v.default,{fill:"currentColor",gitType:"github",height:20,style:{marginRight:"var(--geist-gap-quarter)",transform:"translateY(-1px)"},width:20}),(0,i.jsx)(Q.Text,{as:"span",color:"inherit",weight:500,children:"Continue with GitHub Enterprise"})]})}),(0,i.jsx)(J,{onClose:()=>x(!1),onSetHostname:y,open:f,teamSlug:t,webhookUrl:a,flowKind:n})]})}e.s(["GithubEnterpriseButton",()=>X],2867523);var Z=e.i(7722264),ee=e.i(4422059);function et(e){let{"data-testid":t,gitType:a,dispatch:s,shouldUpdatePreferredGitAccount:n,size:o,requireReauth:l,namespaceId:d}=e,[u,c]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1),{user:g}=(0,m.useUser)(),{account:f,mutate:x}=(0,I.default)({account:g??null});(0,r.useEffect)(()=>{f&&p&&(h(!1),y())},[f]);let b=(0,r.useCallback)(async()=>{c(!0);let e=await (0,k.mutateGitNamespaces)(a);c(!1);let t=e?.find(e=>String(e.id)===String(d))??e?.[0];s({type:"SET_GIT_ACCOUNT",gitAccount:{provider:a,namespaceId:t?.id,requireReauth:t?.requireReauth}}),n&&ed({provider:a,namespaceId:t?.id})},[s,a,d,n]),j=(0,A.useConnectPopup)({onOpen:()=>{c(!0)},onAbort:()=>{c(!1)},onSuccess:()=>{b(),x(),c(!1)}}),y=(0,r.useCallback)(()=>{if(!f){h(!0),c(!0);return}!l&&f[a]?.verified?b():j.open(a)},[f,l,a,b,j]);return(0,i.jsxs)(_.default,{align:"grow","data-testid":t,gitType:a,loading:u,onClick:y,size:o,width:"100%",children:[(0,i.jsx)("span",{className:G.default.continueWithText,children:"Continue with "}),w.ORIGINS[a]]})}function ei(e){let{search:t,gitAccount:s,configureGithubInstallation:n}=e,o=s?.provider,{data:l}=(0,k.default)({provider:o}),u=(0,r.useMemo)(()=>s&&l?l.find(e=>e.id===s?.namespaceId)?.name:null,[l,s]);return(0,i.jsx)(j.default,{center:!0,className:(0,a.clsx)(G.default.selectProvider,G.default.emptyResult),children:(0,i.jsxs)(j.default,{flex:"0 0 auto",gap:0,children:[(0,i.jsxs)(b.default,{center:!0,"data-testid":(0,p.tid)("import-flow-layout","no-results-found-text"),noMargin:!0,preset:"body-2",weight:500,children:["No ",t?"Results":"Git Repositories"," Found"]}),(0,i.jsx)(d.Spacer,{y:.25}),t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.default,{center:!0,noMargin:!0,preset:"body-2",style:{color:"var(--accents-6)",wordBreak:"break-word"},children:(0,i.jsxs)(j.default,{center:!0,row:!0,children:["Your search ",t?`for "${t}"`:null," ",s&&u?(0,i.jsxs)(i.Fragment,{children:["in"," ",(0,i.jsxs)(j.default,{center:!0,flex:"0 0 auto",noWrap:!0,row:!0,children:[(0,i.jsx)(d.Spacer,{x:.2}),(0,i.jsx)(j.default,{flex:"0 0 auto",children:(0,i.jsx)(v.default,{gitType:s.provider})}),(0,i.jsx)(d.Spacer,{x:.2}),(0,i.jsx)(b.default,{className:"geist-ellipsis",span:!0,weight:500,children:u}),(0,i.jsx)(d.Spacer,{x:.2})]})]}):null," ","did not return any results."]})}),(0,i.jsx)(d.Spacer,{y:.25})]}):null,n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.default,{center:!0,noMargin:!0,preset:"body-2",style:{color:"var(--accents-6)"},children:"Make sure to grant Vercel access to the Git repositories you’d like to import."}),(0,i.jsx)(d.Spacer,{y:1}),(0,i.jsx)(_.default,{"data-testid":(0,p.tid)("import-flow-layout","configure-github-app-button"),gitType:"github",loading:!1,onClick:n,children:"Configure GitHub App"})]}):(0,i.jsx)(b.default,{center:!0,noMargin:!0,preset:"body-2",style:{color:"var(--accents-6)"},children:"Try selecting a different Git account or organization on the top left."})]})})}function er(e){let{gitAccount:t,dispatch:r}=e;return(0,i.jsx)(j.default,{center:!0,className:(0,a.clsx)(G.default.selectProvider,G.default.emptyResult),children:(0,i.jsxs)(j.default,{flex:"0 0 auto",gap:0,children:[(0,i.jsx)(b.default,{center:!0,"data-testid":(0,p.tid)("import-flow-layout","no-results-found-text"),noMargin:!0,preset:"body-2",weight:500,children:"No Git Repositories Found"}),(0,i.jsx)(d.Spacer,{y:.25}),(0,i.jsxs)(b.default,{center:!0,"data-testid":(0,p.tid)("import-flow-layout","no-results-found-text"),noMargin:!0,preset:"body-2",style:{color:"var(--accents-6)"},children:["Your ",w.ORIGINS[t.provider]," account requires re-authentication to see your repositories."]}),(0,i.jsx)(d.Spacer,{y:1}),(0,i.jsx)(et,{dispatch:r,gitType:t.provider,namespaceId:t.namespaceId,requireReauth:!0})]})})}function ea(e){let{openGithubInstallation:t}=e;return(0,i.jsx)(j.default,{center:!0,className:(0,a.clsx)(G.default.selectProvider,G.default.emptyResult),children:(0,i.jsxs)(u.Stack,{align:"center",children:[(0,i.jsx)(b.default,{center:!0,"data-testid":(0,p.tid)("import-flow-layout","almost-done"),noMargin:!0,preset:"body-2",weight:500,children:"Install the GitHub application for the accounts you wish to Import from to continue"}),(0,i.jsx)(d.Spacer,{y:1.3}),(0,i.jsx)(u.Stack,{align:"center",flex:1,gap:2,justify:"center",children:(0,i.jsx)(_.default,{gitType:"github",onClick:t,children:"Install"})})]})})}function es(e){let{renderButton:t}=e;return(0,i.jsx)(i.Fragment,{children:[84,30,75,68,32].map((e,r)=>(0,i.jsx)(q,{renderButton:t,repoSkeletonWidthPercentage:e},`${r}_${e}`))})}function en(e){let{repos:t,repoSearchIsLoading:u,search:h,debouncedSearch:g,gitAccount:m,dispatch:x,renderButton:_,shouldUpdatePreferredGitAccount:S,small:w,onChangeGitSelector:A,isInstallationNotFound:C}=e,I=m?.provider,N=m?.host,{isLoading:E,data:R,mutate:L}=(0,k.useIsomorphicGitNamspaces)({provider:I,host:N}),[M,P]=(0,r.useState)(!1),{team:O}=(0,f.useTeam)(),[B,U]=(0,r.useState)(!1);(0,r.useEffect)(()=>{M&&!u&&P(!1)},[M,u]);let D=(0,r.useCallback)(async e=>{let{installationId:t}=e,i=await L(),r=Array.isArray(i)&&i.length>0&&(i.find(e=>e.installationId===t)?.id||i[0].id)||null;x({type:"SET_GIT_NAMESPACE",namespaceId:r}),S&&ed({provider:"github",namespaceId:r}),P(!0),x({type:"REVALIDATE_REPOS"})},[x,L,S]),{open:H}=(0,T.default)({onSuccess:D,provider:"github-limited"===I?"github-limited":"github"}),F=(0,r.useMemo)(()=>{if(("github"===I||"github-limited"===I)&&R?.length){let e=R.find(e=>Number(e.id)===Number(m?.namespaceId));if(e?.isAccessRestricted)return H}},[I,H,R,m]),Q=(0,r.useMemo)(()=>!E&&!!B&&(!m||"github"===m.provider&&(!m.namespaceId||!R?.length)),[m,R,E,B]),z=(0,r.useMemo)(()=>{if(m?.requireReauth||C&&m&&!Q)return{ui:(0,i.jsx)(er,{dispatch:x,gitAccount:m}),suggestionListBorder:!1};if(Q)return{ui:(0,i.jsx)(ea,{openGithubInstallation:H}),suggestionListBorder:!1};if(!t||!R||M||!B)return{ui:(0,i.jsx)(es,{renderButton:_}),suggestionListBorder:!1};if(0===t.length)return h!==g||g&&u?{ui:(0,i.jsx)(es,{renderButton:_}),suggestionListBorder:!1}:null===h?{ui:(0,i.jsx)(ei,{configureGithubInstallation:F,gitAccount:m}),suggestionListBorder:!1}:{ui:(0,i.jsx)(ei,{configureGithubInstallation:F,gitAccount:m,search:g}),suggestionListBorder:!1};let e=!1;m?.provider==="github"||m?.provider==="github-limited"?e=t.length<5&&!!F:(m?.provider==="gitlab"||m?.provider==="bitbucket")&&(e=t.length<5);let r=R.find(e=>String(e.id)===String(m?.namespaceId));return{ui:(0,i.jsxs)(i.Fragment,{children:[t.slice(0,5).map(e=>(0,i.jsx)(q,{currentNamespace:r,gitType:m?.provider,renderButton:_,repo:e,search:g},e.id)),e?(0,i.jsxs)(b.default,{preset:"body-2",style:{color:"var(--accents-6)",textAlign:"left"},children:["Missing Git repository?"," ",m?.provider==="github"?(0,i.jsx)(c.Link,{href:"",onClick:F,variant:"highlight",children:"Adjust GitHub App Permissions →"}):(0,i.jsx)(c.Link,{external:!0,href:`/docs/git/vercel-for-${m?.provider}#missing-git-repository`,variant:"highlight",children:"Learn More"})]}):null]}),suggestionListBorder:t.length<5}},[x,h,g,t,R,B,M,Q,m,H,F,_,C,u]),$=(0,r.useCallback)(e=>{if("select-different-git-provider"===e)x({type:"SET_GIT_ACCOUNT",gitAccount:null}),S&&ed({provider:null,namespaceId:null});else if("install-github"===e)H();else{let t=R?.find(t=>String(t.id)===String(e));x({type:"SET_GIT_NAMESPACE",namespaceId:t?.id??null,requireReauth:t?.requireReauth}),S&&ed({namespaceId:e})}A?.()},[x,R,H,S,A]),V=R&&[...R.map(e=>({"data-testid":(0,p.tid)("git-scope-combobox",`namespace-${e.provider}`),value:String(e.id),label:e.name||"",prefix:(0,i.jsx)(v.default,{gitType:e.provider}),isMenu:!1})),..."github"===I||"github-limited"===I?[{"data-testid":(0,p.tid)("import-flow-layout","git-scope-combobox","add-github-account"),value:"install-github",label:"Add GitHub Account",prefix:(0,i.jsx)(s.Plus,{size:14}),isMenu:!0}]:[],{"data-testid":(0,p.tid)("import-flow-layout","git-scope-combobox","switch-git-provider"),value:"select-different-git-provider",label:"Switch Git Provider",prefix:(0,i.jsx)(n.ListUnordered,{size:14}),isMenu:!0}],W=R?.find(e=>String(e.id)===String(m?.namespaceId)),K=W?.id||R?.[0]?.id||null;return(0,r.useEffect)(()=>{if(m&&Array.isArray(R)){if(!R.find(e=>String(e.id)===String(m.namespaceId))){let e=R[0],t=e?.id??null;(t||K)&&(m.namespaceId?$(t?String(t):null):x({type:"SET_GIT_NAMESPACE",namespaceId:t,requireReauth:e?.requireReauth}))}U(!0)}},[x,$,m,R,K]),(0,i.jsxs)(j.default,{className:(0,a.clsx)(G.default.suggestionList,{[G.default.suggestionListBorder]:!w&&z.suggestionListBorder}),gap:!1,children:[(0,i.jsx)(j.default,{flex:"0 0 auto",children:(0,i.jsxs)(j.default,{className:G.default.suggestionDescription,direction:["column","row","row"],gap:!1,noWrap:!0,children:[(0,i.jsx)(j.default,{flex:"50%",children:(0,i.jsx)(l.Skeleton,{show:void 0===m||!B||!Array.isArray(R),children:(0,i.jsxs)(o.Combobox,{clearable:!1,"data-git-namespace-combobox":!0,"data-testid":(0,p.tid)("import-flow-layout","git-scope-combobox"),noRawSelectedValue:!0,onChange:$,placeholder:"Select a Git Namespace",value:K?String(K):null,children:[(0,i.jsx)(o.Combobox.Input,{"data-git-namespace-combobox-input":!0,"data-testid":(0,p.tid)("import-flow-layout","git-scope-combobox","input"),loading:"github"===I&&!B}),(0,i.jsx)(o.Combobox.List,{children:V?.map(e=>(0,i.jsx)(o.Combobox.Option,{"data-testid":e["data-testid"],isMenu:e.isMenu,prefix:e.prefix,value:e.value,children:e.label},e.value))})]})})}),(0,i.jsx)(d.Spacer,{x:1/3,y:1/3}),(0,i.jsx)(j.default,{flex:"50%",children:(0,i.jsx)(l.Skeleton,{show:!C&&!(W?.ownerType==="team"&&!O)&&(!!(!t&&null===h&&!Q)||!B||!Array.isArray(R)||M),children:(0,i.jsx)(y.SearchInput,{"data-testid":(0,p.tid)("import-flow-layout","search-input"),disabled:t?.length===0&&null===h,onChange:e=>x({type:"SET_SEARCH",search:e.target.value}),placeholder:"Search…",value:h??"",width:"100%",loading:h!==g||!!(g&&u)})})})]})}),(0,i.jsx)(d.Spacer,{y:2/3}),(0,i.jsx)(j.default,{flex:"1 0 auto",children:(0,i.jsx)(j.default,{className:G.default.repoList,"data-testid":(0,p.tid)("import-flow-layout","repository-list"),gap:!1,children:z.ui})})]})}function eo(e){let{dispatch:t,small:s,shouldUpdatePreferredGitAccount:n}=e,{teamSlug:o}=(0,f.useTeam)(),l=(0,x.useServerFlag)("enable-github-onprem-project-creation-flow",!1),u=(0,x.useServerFlag)("enable-github-limited",!1)?["github","github-limited","gitlab","bitbucket"]:["github","gitlab","bitbucket"];return s?(0,i.jsxs)("div",{className:(0,a.clsx)(G.default.selectProvider,G.default.small),children:[u.map(e=>(0,i.jsxs)(r.default.Fragment,{children:[(0,i.jsx)("span",{className:G.default.providerBtn,children:(0,i.jsx)(et,{"data-testid":(0,p.tid)("select-git-repository","choose-provider",e),dispatch:t,gitType:e,shouldUpdatePreferredGitAccount:n})}),(0,i.jsx)("span",{className:(0,a.clsx)(G.default.providerBtn,G.default.providerBtnMobile),children:(0,i.jsx)(et,{"data-testid":(0,p.tid)("select-git-repository","choose-provider",e),dispatch:t,gitType:e,shouldUpdatePreferredGitAccount:n,size:"small"})}),(0,i.jsx)(d.Spacer,{x:.5,y:.25})]},e)),(0,i.jsx)(d.Spacer,{expand:!0,y:.5}),(0,i.jsx)(b.default,{span:!0,type:"success",weight:500,children:(0,i.jsx)(c.Link,{external:!0,href:"/account/authentication",variant:"highlight",children:"Manage Login Connections"})})]}):(0,i.jsx)(j.default,{center:!0,className:G.default.selectProvider,children:(0,i.jsxs)(j.default,{center:!0,flex:"0 0 auto",children:[(0,i.jsx)(b.default,{center:!0,preset:"body-2",style:{color:"var(--accents-6)"},children:"Select a Git provider to import an existing project from a Git Repository."}),(0,i.jsx)(d.Spacer,{}),(0,i.jsxs)(j.default,{direction:"column",gap:1/3,style:{width:320},children:[o&&l?(0,i.jsx)(j.default,{children:(0,i.jsx)(X,{dispatch:t,teamSlug:o,webhookUrl:"https://api.vercel.com/v1/incoming/github",flowKind:"new-project"})}):null,u.map(e=>(0,i.jsx)(j.default,{children:(0,i.jsx)(et,{"data-testid":(0,p.tid)("select-git-repository","choose-provider",e),dispatch:t,gitType:e,shouldUpdatePreferredGitAccount:n})},e))]}),(0,i.jsx)(d.Spacer,{}),(0,i.jsx)(b.default,{center:!0,preset:"body-2",type:"success",weight:500,children:(0,i.jsx)(c.Link,{external:!0,href:"/account/authentication",children:"Manage Login Connections"})})]})})}function el(e,t){switch(t.type){case"INIT_GIT_ACCOUNT":return{...e,preferredGitAccount:t.preferredGitAccount};case"SET_SEARCH":return{...e,search:t.search};case"SET_DEBOUNCED_SEARCH":return{...e,debouncedSearch:t.debouncedSearch,ts:e.debouncedSearch!==e.search?Date.now():e.ts};case"SET_GIT_ACCOUNT":return{...e,search:null,localGitAccount:t.gitAccount};case"SET_GIT_NAMESPACE":{let i=e.localGitAccount??e.preferredGitAccount;return i?{...e,localGitAccount:{...i,namespaceId:t.namespaceId,requireReauth:t.requireReauth??!1}}:e}case"REVALIDATE_REPOS":return{...e,ts:Date.now()};default:return e}}let ed=async e=>{let{namespaceId:t,provider:i}=e;await (0,h.fetchAPI)(g.API_USER,{method:"PATCH",body:JSON.stringify({importFlowGitNamespaceId:t,importFlowGitProvider:i})})};function eu(e){let{renderButton:t,renderConnections:s,small:n,shouldUpdatePreferredGitAccount:o,onChangeGitSelector:l}=e,{user:d,isLoading:u}=(0,m.useUser)(),[{search:c,debouncedSearch:p,localGitAccount:h,preferredGitAccount:g},f]=(0,r.useReducer)(el,{search:null,debouncedSearch:null,ts:Date.now()}),x=g||(d?.importFlowGitProvider&&d.importFlowGitNamespaceId?{provider:d.importFlowGitProvider,namespaceId:d.importFlowGitNamespaceId}:null),b=void 0!==h?h:x,{account:j,isLoading:y}=(0,I.default)({account:d,customHost:h?.provider==="github-custom-host"?h.host:void 0});(0,r.useEffect)(()=>{let e=setTimeout(()=>f({type:"SET_DEBOUNCED_SEARCH",debouncedSearch:c}),300);return()=>clearTimeout(e)},[c]);let v=(0,ee.usePrevious)(p),{data:_,isLoading:w,error:A}=(0,C.useIsomorphicRepoSearch)({query:p,provider:b?.provider||void 0,host:b?.host,namespaceId:b?.namespaceId,requireReauth:b?.requireReauth},{keepPreviousData:v!==p}),T=(0,Z.isError)(A),k=T&&"code"in A&&"installation_not_found"===A.code;(0,r.useEffect)(()=>{(_||!w)&&o&&f({type:"INIT_GIT_ACCOUNT",preferredGitAccount:!_||"error"in _?null:_.gitAccount})},[_,h,o,w]);let N=(0,r.useMemo)(()=>{let e=o&&void 0===g,r=j?.github?.verified??!1,a=j?.gitlab?.verified??!1,h=j?.bitbucket?.verified??!1,m=j?.["github-custom-host"]?.verified??!1;return(!T||k)&&(e||y||u||(r||m||a||h)&&b)?(0,i.jsx)(en,{debouncedSearch:p,dispatch:f,gitAccount:b,isInstallationNotFound:k,onChangeGitSelector:l,renderButton:t,repoSearchIsLoading:w,repos:_&&"repos"in _?_.repos:void 0,search:c,shouldUpdatePreferredGitAccount:o,small:n}):d?.limited?(0,i.jsx)(S.default,{small:n}):s?s({dispatch:f}):(0,i.jsx)(eo,{dispatch:f,shouldUpdatePreferredGitAccount:!0,small:n})},[g,o,j,y,d?.limited,s,n,p,l,t,w,_,c,u,b,T,k]);return(0,i.jsx)("div",{className:(0,a.clsx)(G.default.suggestionBox,{[G.default.small]:n}),children:N})}e.s(["ConnectGitButton",()=>et,"SelectGitRepository",()=>eu,"reducer",()=>el,"updatePreferredGitAccount",0,ed],7591419)}]);

//# sourceMappingURL=647da7e5d4bfe356.js.map
//# debugId=9709848b-c3af-5a36-9a88-c976e354f701
