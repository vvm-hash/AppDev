
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="c718d71a-45c9-531f-82e7-1f64f283b8c7")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9365938,e=>{"use strict";var t=e.i(7722264),i=e.i(1509709);function a(e){var a;let{type:r,error:n,attributes:s}=e;a=n,(0,t.isError)(a)&&(a.message.includes("NetworkError")||a.message.includes("Failed to fetch"))||(0,i.captureException)(n,{attributes:{section:r,owner:"lifecycle",...s}})}e.s(["trackLifecycleError",()=>a])},6450656,e=>{"use strict";var t=e.i(2466450);let i={fee:1e3,rate:{hobby:0,pro:3e3,plus:3e3},allocation:{hobby:5e4,pro:1e5,plus:1e5},reportingWindow:{hobby:"30 days",pro:"12 months",plus:"24 months"},bundle:"1M events prorated",bundleTooltip:"you'll be charged per event.\n\nFor example, {allocation} extra events will cost $3.",plusDescription:"Unlocks advanced UI features and view up to {reportingWindow} of data for all your projects. {fee} per month."},a=new Intl.NumberFormat("en-US");function r(e){let{offering:r="pro",currency:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.replace(/{plusDescription}/g,i.plusDescription).replace(/{bundleTooltip}/g,i.bundleTooltip).replace(/{fee}/g,(0,t.formatCurrency)(i.fee,n)).replace(/{allocation}/g,a.format(i.allocation[r])).replace(/{rate}/g,(0,t.formatCurrency)(i.rate[r],n)).replace(/{bundle}/g,i.bundle).replace(/{reportingWindow}/g,i.reportingWindow[r])}e.s(["pricingModel",0,i,"withPricing",()=>r])},2924439,e=>{"use strict";var t=e.i(6450656);let i=Object.freeze({pro:{title:"Pro",price:2e3,subLineItems:[],credit:2e3},teamSeats:{title:"Additional Team Seats",price:2e3,subLineItems:[]},concurrentBuilds:{title:"Concurrent Builds",price:5e3,subLineItems:[{title:"1 Free Concurrent Build",price:0,unit:"month"}]},bandwidth:{title:"Bandwidth – Overage Fee",price:4e3,batch:100,threshold:1e3,unit:"GB",subLineItems:[]},serverlessFunctionExecution:{title:"Serverless Function Execution – Overage Fee",price:4e3,batch:100,threshold:1e3,unit:"GB-Hours",subLineItems:[]},artifacts:{title:"Vercel Remote Caching",price:50,batch:1,threshold:10,unit:"GB",subLineItems:[]},edgeMiddlewareInvocations:{title:"Edge Middleware Invocations",price:65,batch:1e6,threshold:1e6,unit:"invocations",subLineItems:[]},edgeFunctionExecutionUnits:{title:"Edge Function Execution Units",price:200,batch:1e6,threshold:1e6,unit:"execution units",subLineItems:[]},sourceImages:{title:"Source Images",price:500,batch:1e3,threshold:5e3,subLineItems:[]},speedInsights:{title:"Speed Insights",price:1e3,unit:"month",subLineItems:[{title:"On-Demand Events",billedAfter:"Billed after 10k events",price:65,batch:1e4,threshold:1e4,unit:"10k"}]},observabilityPlus:{title:"Observability Plus",price:1e3,subLineItems:[]},passwordProtection:{title:"Advanced Deployment Protection",price:15e3,subLineItems:[{title:"Password Protection",price:0},{title:"Deployment Protection Exceptions",price:0},{title:"Private Production Deployments",price:0}]},previewDeploymentSuffix:{title:"Preview Deployment Suffix",price:1e4,subLineItems:[]},webAnalytics:{title:t.withPricing("Web Analytics with {allocation} Events"),price:0,threshold:t.pricingModel.allocation.pro,limit:1,subLineItems:[{title:"On-Demand Events",billedAfter:t.withPricing("Billed after {allocation} Events"),price:t.pricingModel.rate.pro,threshold:t.pricingModel.allocation.pro,batch:0,unit:t.withPricing("{bundle}")}]},webAnalyticsPlus:{title:"Web Analytics Plus",price:t.pricingModel.fee,unit:"month",threshold:t.pricingModel.allocation.plus,limit:1,subLineItems:[]},monitoring:{title:"Monitoring with 250k Data Points",price:1e3,unit:"month",subLineItems:[{title:"On-Demand Data Points",billedAfter:"Billed after 250k data points",price:120,threshold:25e4,batch:1e6,unit:"million"}]},storage:{title:"5 KV Databases",price:0,subLineItems:[]}});e.s(["pricingMenu",0,i])},1307729,7416719,e=>{"use strict";var t=e.i(119294),i=e.i(6352514),a=e.i(8042625),r=e.i(277234);let n=async e=>{let{teamId:n,nextTier:s,source:l}=e,o=await (0,r.fetchAPI)(`/stripe/invoices/web-analytics${(0,a.encode)({teamId:n})}`,{method:"PUT",body:{tier:s},throwOnHTTPError:!0});return"pro"===s?t.analytics.track(i.AnalyticsEvent.ANALYTICS_DOWNGRADE_SUCCESS,{teamId:n}):t.analytics.track(i.AnalyticsEvent.ANALYTICS_UPGRADE_SUCCESS,{teamId:n,source:l}),o};var s=e.i(7722264);async function l(e){let{teamId:t,retry:i=!1,source:a}=e,r=Date.now();do try{await n({nextTier:"plus",teamId:t,source:a});return}catch(e){if(e instanceof Error&&"You cannot upgrade or downgrade Web Analytics during a trial"===e.message)await new Promise(e=>{setTimeout(e,3e3)});else throw e}while(i&&Date.now()<r+3e4)}async function o(e){let{projectId:n,team:o,withPlus:d,retryOnTrialError:c=!0,source:u="enable_modal"}=e,m=o?.id;if(n)try{d&&m&&await l({teamId:m,retry:c,source:u}),await (0,r.fetchAPI)(`/api/v1/web/insights/toggle${(0,a.encode)({projectId:n,teamId:m})}`,{method:"POST",body:{value:!0},throwOnHTTPError:!0}),t.analytics.track(i.AnalyticsEvent.ANALYTICS_ENABLED,{teamId:m,projectId:n,plan:o?.billing?.plan||"hobby",source:u})}catch(e){throw(0,s.isErrorLike)(e)&&t.analytics.track(i.AnalyticsEvent.ERROR,{message:e.message,name:e.name,teamId:m}),e}}e.s(["enableWebAnalytics",()=>o,"enableWebAnalyticsPlusAddOn",()=>l],7416719),e.s([],1307729)},8434017,e=>{"use strict";var t=e.i(6696646),i=e.i(119294),a=e.i(6352514),r=e.i(277234),n=e.i(4244280),s=e.i(5338940);async function l(e,t){return(0,r.fetchAPI)(`${n.API_PRO_TRIAL_ONBOARDING_EVENT}?id=${e}&teamId=${t}`,{method:"POST",throwOnHTTPError:!0,body:"{}"})}function o(e,t){l(e,t).then(()=>{i.analytics.track(a.AnalyticsEvent.PRO_TRIAL_ONBOARDING,{eventName:e,timestamp:new Date().toUTCString()})}).catch(e=>{console.error("Failed to send onboarding event:",e)})}function d(){let{team:e}=(0,s.useTeam)();return(0,t.useCallback)(t=>{e?.id?o(t,e.id):console.debug("No team id, not triggering onboarding event.")},[e])}e.s(["triggerOnboardingEvent",()=>o,"triggerOnboardingEventAsync",()=>l,"useTriggerOnboardingEvent",()=>d])},8482433,(e,t,i)=>{var a=e.r(6684016),r=e.r(2083276);t.exports=function(e){return r(a(e).toLowerCase())}},2771361,e=>{"use strict";var t=e.i(8042625),i=e.i(4244280),a=e.i(277234),r=e.i(6232213);async function n(e){let{source:n,teamId:s,to:l}=e,o=await (0,a.fetchAPI)(`${i.API_PLANS_CHANGE_PLAN}${(0,t.encode)({teamId:s})}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:l,source:n}),throwOnHTTPError:!0});return"pro-trial"===l&&(0,r.postToStatsigClient)({events:[{eventName:"start_pro_trial",metadata:{source:n,action:"upgrade-plan"}}]}),o}e.s(["changePlan",()=>n])},7111889,e=>{"use strict";var t=e.i(4439612),i=(0,t.createServerReference)("40a992ef83fc0374da42dc0d5cb20c16a1bfaaa7ca",t.callServer,void 0,t.findSourceMapURL,"revalidateBillingData");e.s(["revalidateBillingData",()=>i])},4860345,e=>{"use strict";var t=e.i(455575),i=e.i(3911483),a=e.i(277234),r=e.i(4244280),n=e.i(8042625),s=e.i(1683927);function l(e,l){let{teamId:o,skip:d,...c}=e,u=(0,t.useToasts)();return(0,i.default)(()=>!d&&o&&c.from?[`${r.API_USAGE_METRICS_QUERY}${(0,n.encode)({teamId:o})}`,{...c,from:c.from??""}]:null,async e=>{let[t,i]=e,r=await (0,a.fetchAPI)(t,{throwOnHTTPError:!0,method:"POST",body:JSON.stringify(i)});if("string"==typeof r)throw Error();return r},{...(0,s.useUsageConfig)(u),...l})}e.s(["useNewUsageMetrics",()=>l])},4956623,9789132,e=>{"use strict";var t=e.i(237281);function i(e,i,a,r,n){if(!e||!i||!a||!r||!n)return{newPrice:void 0,imageOptimizationTransformation:0,imageOptimizationCacheRead:0,imageOptimizationCacheWrite:0};let s=(e,i)=>{let a=(0,t.Decimal)(0),r=e.results.totalValue,s=i.allocation?(0,t.Decimal)(i.allocation):void 0;for(let l of e.results.views.count.results){let e=(0,t.Decimal)(l.totalValue??0);if("pro"===n&&s?.gt(0)&&e.gt(0)&&r){let i=e.dividedBy(r);e=t.Decimal.max(0,e.minus(s.multipliedBy(i)))}let o=l.dimensionValues?.billableRegion??"",d=(0,t.Decimal)(i.matrix.find(e=>e.dimensionValues[0]===o)?.unitAmount??i.defaultUnitAmount);a=a.plus(e.multipliedBy(d))}return a.toNumber()},l=s(i,e.imageOptimizationTransformation),o=s(a,e.imageOptimizationCacheRead),d=s(r,e.imageOptimizationCacheWrite);return{newPrice:l+o+d,imageOptimizationTransformation:l,imageOptimizationCacheRead:o,imageOptimizationCacheWrite:d}}function a(e,t){if(!e||!t)return;let i=0;for(let t of e.data)i+=t.count;let a=i;return"pro"===t&&(a=Math.max(0,i-5e3)),a/1e3*5}e.s(["getNewPriceEstimate",()=>i],4956623),e.s(["getOldPriceEstimate",()=>a],9789132)},9089592,e=>{"use strict";var t=e.i(277234),i=e.i(4244280),a=e.i(3911483),r=e.i(8042625);async function n(e){return(await (0,t.fetchAPI)(e,{method:"GET",throwOnHTTPError:!0,returnStatus:!0})).body}function s(e,t){let{teamId:s,from:l,to:o}=e;return(0,a.default)(s?`${i.API_USAGE_IMAGE_OPTIMIZATIONS}${(0,r.encode)({teamId:s,from:l,to:o})}`:null,n,t)}e.s(["useLegacyImageUsage",()=>s])},6222316,e=>{"use strict";var t=e.i(6696646),i=e.i(277234),a=e.i(3911483),r=e.i(9100551);function n(e){let{switchToNewPro:n,teamId:s}=e,l=(0,r.useSearchParams)(),o=l?.get("debugSwitchToNewProError")==="1",{data:d,isLoading:c}=(0,a.default)(n&&s&&!o?`/v1/billing/subscription/upgrade/preview?teamId=${s}`:null,e=>(0,i.default)(e,{throwOnHTTPError:!0})),{everythingSettled:u,unsettledItems:m}=(0,t.useMemo)(()=>d?.eligible?{everythingSettled:d.lines.every(e=>0===e.approximateCost),unsettledItems:d.lines.filter(e=>e.approximateCost>0)}:{everythingSettled:!1,unsettledItems:null},[d]);return c?{isLoadingSwitchPreview:!0,switchPreviewData:null}:d&&d.eligible?{isLoadingSwitchPreview:!1,switchPreviewData:{monthlyCredit:d.monthlyCredit,everythingSettled:u,unsettledItems:m,proratedCredit:d.proratedCredit}}:{isLoadingSwitchPreview:!1,switchPreviewData:null}}e.s(["useSwitchToNewProPreview",()=>n])},6079422,6489459,626404,7197081,e=>{"use strict";var t=e.i(6696646),i=e.i(7917902),a=e.i(271259);let r={slug:"hobby",title:"Hobby",description:"Start for free"},n={slug:"pro-trial",title:"Pro Trial",description:"Try all the Pro features free for 14 days"},s={slug:"pro",title:"Pro",description:"Everything you need to build and scale your project"},l={slug:"pro",title:"Pro",description:"Upgrade your Pro Trial"};function o(e){let t=e.length>1||e[0].description===l.description;return{actualTrialBehavior:e.some(e=>"pro-trial"===e.slug)?t?"choose":"force-trial":"disallow-trial",showSelector:t,validSelectorOptions:e}}function d(e){let{teamManager:d,desiredTrialBehavior:c="choose",disallowHobby:u}=e,[m,p]=(0,t.useState)("pro"),{canCreateHobbyTeam:g,ready:h,hasHobbyTeam:f}=function(){let{user:e,teams:t}=(0,i.useAccount)(),{ready:r,canCreateTrial:n}=(0,a.useCanCreateTrial)();if(!e||!t||!r)return{ready:!1};if("northstar"!==e.version)return{ready:!0,canCreateHobbyTeam:!1,hasHobbyTeam:!1};let s=t.some(e=>e.billing?.plan==="hobby");return{ready:!0,canCreateHobbyTeam:!s&&!n,hasHobbyTeam:s}}(),{canCreateTrial:x,ready:b}=(0,a.useCanCreateTrial)(),{actualTrialBehavior:y,validSelectorOptions:w,showSelector:v}=(0,t.useMemo)(()=>(function(e){let{teamManager:t,canCreateHobbyTeam:i,hasTrialsRemaining:a,desiredTrialBehavior:d}=e;if(t?.userIntent==="upgrade-existing"&&t.team.billing?.plan==="pro"&&t.team.billing?.status==="trialing")if(a)return o([l]);else return o([s]);if(t?.userIntent==="upgrade-existing"&&t?.team?.billing?.plan==="hobby")if(!a)return o([s]);else if("force-trial"===d)return o([n]);else if("choose"===d)return o([n,s]);else return o([s]);if(t?.userIntent==="create"){if(a){if("force-trial"===d)return o([n]);else if("choose"===d)return o([n,s])}else if(i&&"choose"===d)return o([r,s])}return o([s])})({teamManager:d,canCreateHobbyTeam:g&&!u,hasTrialsRemaining:!!x,desiredTrialBehavior:c}),[d,g,x,c,u]),S=(0,t.useMemo)(()=>{let e=w.find(e=>e.slug===m);return e?.slug??w[0].slug},[m,w]),T=(0,t.useMemo)(()=>{if("force-trial"===c&&c!==y)return x?f?"This team is not eligible for a Pro Trial upgrade, but you have one or more existing Hobby teams. Choose one of those to start a Pro Trial.":"You don't have an existing trial-eligible team. Create a new team to start a Pro Trial.":"Sorry, you're out of Pro Trials!"},[y,c,f,x]);return h&&b?{loading:!1,data:{selectedPlan:S,setSelectedPlan:p,showSelector:v,desiredTrialBehavior:c,actualTrialBehavior:y,validSelectorOptions:w,hasTrialsRemaining:x,userHelpMessage:T}}:{loading:!0,data:void 0}}e.s(["usePlanSelector",()=>d],6079422);var c=e.i(9182110);function u(e){let{forceCreateTeam:i,eligibleTeams:a,teamHint:r,teamInScope:n,teamsAreLoading:s}=e,[l,o]=(0,t.useState)(i?"create":"upgrade-existing"),[d,c]=(0,t.useState)(""),[u,p]=(0,t.useState)(void 0),g=(0,t.useCallback)((e,t)=>{if(0===a.length)return o("create");if(o(e),"create"===e){p(void 0),"string"==typeof t&&c(t);return}return(c(""),"object"==typeof t&&a.find(e=>e.id===t.id))?p(t):p(m({eligibleTeams:a,teamHint:r,teamIdInScope:n?.id}))},[a,r,n?.id]);return((0,t.useEffect)(()=>{s||("upgrade-existing"===l&&a.length>0&&void 0===u?(0,t.startTransition)(()=>{p(m({eligibleTeams:a,teamHint:r,teamIdInScope:n?.id}))}):"upgrade-existing"===l&&0===a.length&&void 0===u&&(0,t.startTransition)(()=>{o("create")}))},[a,r,n?.id,u,s,l]),"create"===l)?{loading:!1,data:{teamName:d,setTeamName:c,userIntent:l,setUserIntent:g}}:u?{loading:!1,data:{userIntent:l,setUserIntent:g,team:u}}:{loading:!0,data:void 0}}function m(e){let{eligibleTeams:t,teamHint:i,teamIdInScope:a}=e,r=t.find(e=>(0,c.isHintedTeam)({team:e,teamHint:i}));if(r)return r;let n=t.find(e=>e.id===a);if(n)return n;let s=t.find(e=>e.billing?.plan==="hobby");return s||t.at(0)}function p(e){let{team:i}=e,[a,r]=(0,t.useState)(""),n=()=>{};return(0,t.useMemo)(()=>void 0===i?{userIntent:"create",teamName:a,setTeamName:r,setUserIntent:n}:{userIntent:"upgrade-existing",team:i,setUserIntent:n},[i,a])}e.s(["useTeamManager",()=>u,"useTeamManagerFromTeam",()=>p],6489459);var g=e.i(8128646),h=e.i(119294),f=e.i(6352514),x=e.i(8248823);function b(e){let{steps:t,workflowName:i,immutableDisabledSteps:a=new Set,mutableDisabledSteps:r=new Set}=e;if(void 0===t.at(0))throw Error("Tried to initialize useSteps with no steps");let n=t.filter(e=>!a.has(e)&&!r.has(e)),s=n.at(0);if(void 0===s)throw Error("Tried to initialize useSteps with no enabled steps");let l=n.at(-1);return{step:s,allSteps:t,enabledSteps:n,immutableDisabledSteps:a,mutableDisabledSteps:r,isFirstEnabledStep:!0,isLastEnabledStep:s===l,workflowName:i}}function y(e,t,i,a){let r="next"===a?1:-1,n=i.indexOf(e),s=i[n+r];if(void 0===s)throw Error(`Tried to go to the ${a} step, but it doesn't exist. If this was thrown during hook initialization, it's likely because all steps are disabled.`);return t.includes(s)?s:y(s,t,i,a)}function w(e){var i,a;let[r,n]=(0,t.useReducer)((0,g.default)((e,t)=>{switch(t.type){case"first-step":{let t=y(e.allSteps[0],e.enabledSteps,e.allSteps,"next");h.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"first"}),e.step=t;break}case"last-step":{let t=y(e.allSteps.at(-1)??e.allSteps[0],e.enabledSteps,e.allSteps,"previous");h.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"last"}),e.step=t;break}case"next-step":{let t=y(e.step,e.enabledSteps,e.allSteps,"next");h.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"next"}),e.step=t;break}case"previous-step":{let t=y(e.step,e.enabledSteps,e.allSteps,"previous");h.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t,switchType:"previous"}),e.step=t;break}case"set-step":h.analytics.track(f.AnalyticsEvent.STEPPED_WORKFLOW_CHANGE_STEP,{workflowName:e.workflowName,fromStep:e.step,toStep:t.step,switchType:"direct"}),e.step=t.step;break;case"set-immutable-disabled-steps":e.immutableDisabledSteps=t.disabledSteps;break;case"enable-step":e.mutableDisabledSteps.delete(t.step);break;case"disable-step":e.mutableDisabledSteps.add(t.step);break;default:(0,x.exhaustivenessCheck)(t)}let i=e.allSteps.filter(t=>!e.immutableDisabledSteps.has(t)&&!e.mutableDisabledSteps.has(t));(i.length!==e.enabledSteps.length||e.enabledSteps.some((e,t)=>e!==i[t]))&&(e.enabledSteps=i),e.isFirstEnabledStep=e.enabledSteps[0]===e.step,e.isLastEnabledStep=e.enabledSteps.at(-1)===e.step}),e,b),{isFirstEnabledStep:s,isLastEnabledStep:l,step:o}=r,d=(0,t.useCallback)((i=()=>n({type:"previous-step"}),async e=>{s?await e():i()}),[s]),c=(0,t.useCallback)((a=()=>n({type:"next-step"}),async e=>{l?await e():a()}),[l]),u=(0,t.useCallback)(e=>{let t=e[o];return t||e["*"]},[o]);return{...r,backOrCancel:d,nextOrSubmit:c,goto:{first:()=>n({type:"first-step"}),last:()=>n({type:"last-step"}),next:()=>n({type:"next-step"}),previous:()=>n({type:"previous-step"}),step:e=>n({type:"set-step",step:e})},disableStep:e=>n({type:"disable-step",step:e}),enableStep:e=>n({type:"enable-step",step:e}),renderSteps:u}}e.s(["useSteps",()=>w],626404),e.s([],7197081)},7846892,e=>{"use strict";var t=e.i(6468255),i=e.i(5806401),a=e.i(2504781),r=e.i(6942035),n=e.i(6143247),s=e.i(3306538),l=e.i(5468328),o=e.i(57106),d=e.i(6318858),c=e.i(7749291),u=e.i(2988836);let m="flex flex-row items-center gap-3 rounded-sm py-2 pl-4 pr-3";var p=e.i(5255926),g=e.i(6696646),h=e.i(1136434),f=e.i(9386557),x=e.i(4956623),b=e.i(4860345),y=e.i(9789132),w=e.i(9089592),v=e.i(277234),S=e.i(3911483),T=e.i(7432042);function N(e){let{teamManager:i}=e;if(i?.userIntent!=="upgrade-existing")return null;let{team:a}=i;return a.billing?.plan!=="pro"||a.billing?.planIteration==="plus"||a.enableImageOptimizationNewPrice?null:(0,t.jsx)(j,{team:a})}function j(e){var i,r;let{team:c}=e,[N]=(0,g.useState)(Date.now()),[j,I]=(0,g.useState)(!1),P=new Date(N-(0,T.default)("1d")),A=new Date(N-(0,T.default)("31d")),E={revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateIfStale:!1,refreshInterval:0},C=c?.id||void 0,O=(i=C,r=E,(0,S.default)(i?`/api/image-optimization/prices?teamId=${i}`:null,e=>(0,v.fetchAPI)(e,{throwOnHTTPError:!0}),r)),k=A.toISOString(),L=P.toISOString(),_=(0,w.useLegacyImageUsage)({teamId:C,from:k,to:L}),D=(0,y.getOldPriceEstimate)(_.data,c?.billing?.plan),R=(0,b.useNewUsageMetrics)({metric:"image_transformations_preview",teamId:C,from:A.toISOString(),to:P.toISOString(),format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-transformations-preview"},E),M=(0,b.useNewUsageMetrics)({metric:"data_cache_reads",teamId:C,from:A.toISOString(),to:P.toISOString(),filterBy:{origin:["IMAGE_OPTIMIZATION_PREVIEW"]},format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-cache-reads"},E),B=(0,b.useNewUsageMetrics)({metric:"data_cache_writes",teamId:C,from:A.toISOString(),to:P.toISOString(),filterBy:{origin:["IMAGE_OPTIMIZATION_PREVIEW"]},format:"scalar",views:{count:{groupBy:["billableRegion"]}},userAgent:"vercel-site.usage-estimate.image-cache-writes"},E),{newPrice:F}=(0,x.getNewPriceEstimate)(O.data,R.data,M.data,B.data,c?.billing?.plan),U=O.isLoading||R.isLoading||M.isLoading||B.isLoading,$=!!(O.error||R.error||M.error||B.error),W=(0,t.jsxs)("span",{className:"text-label-14 flex items-center gap-2",children:["New Image Optimization pricing",(0,t.jsx)(s.Badge,{size:"sm",variant:"blue-subtle",children:"New"})]});if(U)return(0,t.jsx)("li",{className:m,children:(0,t.jsxs)("span",{className:"flex flex-1 flex-col gap-2",children:[W,(0,t.jsx)(p.Skeleton,{width:128,height:12})]})});if(!F||!D||$)return(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[W,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:["Based on transformations, cache reads/writes"," ",(0,t.jsx)(l.Tooltip,{className:"inline",text:(0,t.jsx)(o.Link,{href:"https://vercel.com/changelog/faster-transformations-and-reduced-pricing-for-image-optimization",external:!0,className:"underline",children:"Learn more in the Changelog"}),children:(0,t.jsx)(u.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]})]})]});let G=Math.round((F-D)/D*100);return G<=0?(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[W,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:["Save ",-G,"% by switching"]})]})]}):(0,t.jsxs)("li",{className:(0,n.cn)(m,"flex-col gap-3 items-start"),children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-3 w-full",children:[(0,t.jsx)(f.WarningFill,{color:"amber-800"}),(0,t.jsxs)(a.Button,{variant:"unstyled",className:"flex flex-1 flex-col [&>span]:p-0 [&>span]:flex [&>span]:flex-col text-left",onClick:()=>I(!j),children:[W,(0,t.jsxs)("span",{className:"text-label-14 text-gray-900 flex flex-row items-center gap-1",children:["Cost increase projected",(0,t.jsx)(h.ChevronDownSmall,{className:j?"rotate-180":""})]})]})]}),j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-full h-px bg-gray-alpha-400"}),(0,t.jsxs)("span",{className:"text-copy-14 text-gray-900",children:["Image Optimization cost is projected to increase by ",G,"%, see how to"," ",(0,t.jsx)(o.Link,{variant:"highlight",tab:!0,href:"https://vercel.com/docs/image-optimization/limits-and-pricing",children:"optimize cost on the new pricing"})]})]}):null]})}let I={title:"Flexible usage credit",description:"For use towards metered resources",isNew:!0},P={title:"Fast Data Transfer",description:"1 TB /month included"},A={title:"Edge Requests",description:"10M /month included"},E={title:"Free Viewer seats",description:"Collaborate with your team",isNew:!0},C={title:"Enterprise-grade paid add-ons",description:"SAML SSO, HIPAA BAA, and more",isNew:!0},O={title:"New Image Optimization Pricing",description:"Based on transformations, cache reads/writes",isNew:!0},k={title:"On-demand Concurrent Builds",description:"No build queuing by default",isNew:!0,tooltip:{text:"Learn more in the Changelog",href:"/changelog/no-build-queues-on-demand-concurrent-builds-now-on-by-default"}},L={title:"Enhanced build machines",description:"Get even faster builds",isNew:!0,tooltip:{text:"Learn more in the Changelog",href:"/changelog/faster-builds-now-available-with-compute-upgrades-on-paid-plans"}},_=[I,P,A,{title:"Global CDN",description:"Cold start prevention and skew protection"},{title:"Observability tools",description:"Advanced monitoring and longer retention"},{title:"Advanced WAF protection",description:"Custom rules and rate limiting"},k,L,E,C],D=[I,E,C,k,L,O,P,A];function R(e){let{teamManager:i,switchToNewPro:a,isTeamMembersStep:r}=e;return(0,t.jsxs)("div",{className:(0,n.cn)("flex-1 bg-background-200 border-r-gray-alpha-400 border-t smd:border-r border-solid flex-col smd:min-w-[355px] xl:min-w-[400px] shrink-0 order-2 smd:order-1 p-1.5 smd:overflow-y-auto smd:overflow-x-hidden smd:overscroll-contain",{"hidden smd:flex":r,flex:!r}),children:[(0,t.jsx)("div",{className:"py-3 px-4",children:(0,t.jsx)("span",{className:"text-copy-14 font-medium",children:"What's included"})}),(0,t.jsx)("ul",{className:"flex flex-col border-b border-b-gray-alpha-400 mb-1 pb-1 [&>*:nth-child(odd)]:bg-gray-100",children:(a?D:_).map(e=>{let{title:r,description:n,isNew:c,tooltip:p}=e;return r===O.title?(0,t.jsx)(N,{teamManager:i},r):(0,t.jsxs)("li",{className:m,children:[(0,t.jsx)(d.Check,{color:"gray-1000"}),(0,t.jsxs)("span",{className:"flex flex-1 flex-col",children:[(0,t.jsxs)("span",{className:"text-label-14 flex items-center gap-2",children:[r,a&&c?(0,t.jsx)(s.Badge,{size:"sm",variant:"blue-subtle",children:"New"}):null]}),(0,t.jsxs)("span",{className:"text-label-14 text-gray-900",children:[n,a&&p?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(l.Tooltip,{className:"inline",text:(0,t.jsx)(o.Link,{href:p.href,external:!0,className:"underline",children:p.text}),children:(0,t.jsx)(u.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]}):null]})]})]},r)})}),(0,t.jsx)("div",{className:"py-2 px-4",children:(0,t.jsxs)(o.Link,{className:"flex gap-3 items-center hover:underline",href:a?"/blog/new-pro-pricing-plan":"/docs/pricing",tab:!0,children:[(0,t.jsx)(c.ExternalSmall,{}),(0,t.jsx)("span",{className:"text-label-14",children:"Learn more about pricing"})]})})]})}var M=e.i(4004502),B=e.i(8735244),F=e.i(9508212);function U(){return(0,t.jsx)(F.Stack,{align:"center",gap:4,justify:"center",className:"w-full max-h-full",children:(0,t.jsx)(B.Spinner,{})})}var $=e.i(9722978);function W(e){let{open:n=!0,children:s,isLoading:l,onClose:o,teamManager:d,sheetWrapperRef:c,switchToNewPro:u,isTeamMembersStep:m}=e;return(0,t.jsx)(i.Sheet,{open:n,onOpenChange:e=>{e||o()},children:(0,t.jsxs)(i.SheetContent,{"data-testid":(0,M.tid)("team","upgrade-modal"),className:(0,$.clsx)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-hidden rounded-[1rem] bg-white p-0 lg:w-11/12 xl:w-5/6 xl:max-w-6xl sm:max-w-[auto]"),side:"right",ref:c,children:[(0,t.jsx)(i.SheetClose,{asChild:!0,children:(0,t.jsx)(a.Button,{className:"absolute top-4 right-4 z-50","aria-label":"Close",shape:"square",size:"tiny",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(r.Cross,{})})}),(0,t.jsxs)("div",{className:"flex flex-col h-full overflow-y-auto smd:overflow-y-visible overscroll-contain smd:flex-row",children:[(0,t.jsx)(R,{teamManager:d,switchToNewPro:u,isTeamMembersStep:m}),(0,t.jsx)("div",{className:"flex flex-[2] p-4 smd:overflow-x-hidden order-1 smd:order-2 smd:overscroll-contain smd:px-0 smd:pt-8 smd:pb-4",children:l?(0,t.jsx)(U,{}):s})]})]})})}e.s(["SheetWrapper",()=>W],7846892)},5022130,e=>{"use strict";var t=e.i(6468255),i=e.i(4585051),a=e.i(3306538);function r(e){let{upgradingTeam:r,children:n}=e;return(0,t.jsxs)("div",{className:"flex flex-col gap-6 items-center",children:[(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[r?.id?(0,t.jsx)(i.Avatar,{hash:r.avatar,size:24,teamId:r.id}):null,(0,t.jsx)(a.Badge,{size:"md",variant:"blue",children:"Pro"})]}),(0,t.jsx)("div",{className:"flex flex-col gap-2 items-center text-center text-balance",children:n})]})}e.s(["HeaderWrapper",()=>r])},7109637,e=>{"use strict";var t=e.i(2924439);function i(e){let{modalTitle:i,enableFunction:a,buildLineItem:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.pricingMenu;return{...{...n[e],modalTitle:i??`enable ${n[e].title}`},enableFunction:a,buildLineItem(t){let{alreadyEnabledAddOns:i,addOnToBeEnabled:a}=t;return"function"==typeof r?r(n[e],{alreadyEnabledAddOns:i,addOnToBeEnabled:a}):{...n[e],count:1}}}}e.s(["createAddOn",()=>i])},7005176,144654,1686498,7519760,9989491,7534379,e=>{"use strict";var t=e.i(7109637);let i=(0,t.createAddOn)("concurrentBuilds",{modalTitle:"enable Additional Concurrent Builds",buildLineItem(e,t){let{alreadyEnabledAddOns:i}=t;if(!i?.concurrentBuilds)return null;let a=i.concurrentBuilds;return{...e,title:`${a+1} Concurrent Build${a+1>1?"s":""}`,count:a,subLineItems:[...e.subLineItems??[],{title:`${a} Additional Concurrent Build${a>1?"s":""}`,price:e.price*a,unit:"month"}]}}});e.s(["concurrentBuilds",0,i],7005176);let a=(0,t.createAddOn)("firewallRateLimit",{modalTitle:"use Rate Limits",buildLineItem(e,t){let{addOnToBeEnabled:i}=t;return i?.type!=="firewallRateLimit"?null:{...e,title:"Rate Limit",subLineItems:[{title:"Rate Limit: Allowed Requests",price:5,unit:"10k"},{title:"Rate Limit: Blocked Requests",price:0}],count:0}}});e.s(["firewallRateLimit",0,a],144654);var r=e.i(8248823),n=e.i(277234),s=e.i(4244280);let l=async e=>{let{enable:t,teamId:i,hobbyFlow:a}=e;try{let e=await (0,n.fetchAPI)(`${s.API_STRIPE_MONITORING}?teamId=${encodeURIComponent(i)}`,{method:"PUT",body:JSON.stringify({monitoring:t,hobbyFlow:a}),throwOnHTTPError:!0});return{kind:"ok",...e}}catch(e){return{kind:"error",error:(0,r.normalizeError)(e)}}},o=(0,t.createAddOn)("monitoring",{modalTitle:"enable Monitoring",async enableFunction(e){let{team:t}=e;await l({enable:!0,teamId:t.id})}});e.s(["monitoring",0,o],1686498),e.i(5202960);var d=e.i(6880199);let c="observabilityPlus",u=(0,t.createAddOn)(c,{modalTitle:"Enable Observability",async enableFunction(e){let{team:t,source:i}=e;await (0,d.patchObservabilityConfiguration)({team:t,source:i,enableTeam:!0})},buildLineItem(e,t){let{addOnToBeEnabled:i}=t;return i?.type!==c?null:{...e,count:1,subLineItems:[{title:"On-demand events",billedAfter:"Billed after 1M events",price:120,batch:1e6,threshold:1e6,unit:"1M"}]}}});e.s(["observabilityPlus",0,u],7519760);let m=(0,t.createAddOn)("passwordProtection");e.s(["passwordProtection",0,m],9989491);let p=(0,t.createAddOn)("previewDeploymentSuffix",{buildLineItem(e,t){let{alreadyEnabledAddOns:i}=t;return i?.previewDeploymentSuffix?{...e,count:1,subLineItems:[{title:i.previewDeploymentSuffix,price:e.price,unit:"month"}]}:null}});e.s(["previewDeploymentSuffix",0,p],7534379)},9568520,e=>{"use strict";var t=e.i(2793676),i=e.i(8042625),a=e.i(277234),r=e.i(7109637);let n="/api/v1/speed-insights",s=(0,r.createAddOn)("speedInsights",{async enableFunction(e){let{projectId:t,team:r}=e;t&&await (0,a.fetchAPI)(`${n}/toggle${(0,i.encode)({projectId:t,teamId:r.id})}`,{method:"POST",body:{value:!0},throwOnHTTPError:!0})},buildLineItem(e,i){let{alreadyEnabledAddOns:a,addOnToBeEnabled:r}=i;if(a?.speedInsights&&a.speedInsights.length>0||r?.type==="speedInsights"){let i=a?.speedInsights?.map(e=>e.name)??[];r?.type==="speedInsights"&&i.push(r.additionalConfigurations.projectName);let n=i.map(i=>({...(0,t.default)(e,["modalTitle","subLineItems"]),title:i??"",price:e.price,unit:e.unit}));return{...e,price:e.price*i.length,subLineItems:n.concat(e.subLineItems??[]),count:i.length}}return null}});e.s(["API_SPEED_INSIGHTS_PREFIX",0,n,"speedInsights",0,s])},1480217,2471796,e=>{"use strict";var t=e.i(7005176),i=e.i(144654),a=e.i(1686498),r=e.i(7519760),n=e.i(9989491),s=e.i(7534379),l=e.i(9568520),o=e.i(8482433),d=e.i(3798983),c=e.i(7109637);let u=(0,c.createAddOn)("storage",{modalTitle:"get more storage",buildLineItem(e,t){let{addOnToBeEnabled:i}=t;if(i?.type!=="storage")return null;let a=d.storeTitle[i.additionalConfigurations.storeType],r=(0,o.default)(d.storeOrDatabase[i.additionalConfigurations.storeType]);return{...e,title:`5 ${a} ${r}s`,count:1}}});e.i(1307729);var m=e.i(7416719);let p=(0,c.createAddOn)("webAnalytics",{modalTitle:"enable Web Analytics",enableFunction:m.enableWebAnalytics}),g=(0,c.createAddOn)("webAnalyticsPlus",{modalTitle:"add Web Analytics Plus",enableFunction(e){let{team:t,projectId:i,source:a}=e;return i?(0,m.enableWebAnalytics)({team:t,projectId:i,withPlus:!0}):(0,m.enableWebAnalyticsPlusAddOn)({teamId:t.id,source:a})}}),h={speedInsights:l.speedInsights,concurrentBuilds:t.concurrentBuilds,previewDeploymentSuffix:s.previewDeploymentSuffix,monitoring:a.monitoring,observabilityPlus:r.observabilityPlus,passwordProtection:n.passwordProtection,storage:u,webAnalytics:p,webAnalyticsPlus:g,firewallRateLimit:i.firewallRateLimit};e.s(["ADD_ONS",0,h],2471796);let f=Object.keys(h);function x(e){let{alreadyEnabledAddOns:t,addOnToBeEnabled:i}=e;if(!t&&!i)return[];let a=[];for(let e of f)if(t&&t[e]||i?.type===e){let r=h[e];if("function"==typeof r.buildLineItem){let e=r.buildLineItem({alreadyEnabledAddOns:t,addOnToBeEnabled:i});e&&a.push(e)}else a.push({...r,count:1})}return a}e.s(["generateAddOnLineItems",()=>x],1480217)},8378310,e=>{"use strict";var t=e.i(6468255),i=e.i(5022130);e.i(1480217);var a=e.i(2471796);function r(e){let{teamManager:r,addOn:n,switchToNewPro:s}=e,l="upgrade-existing"===r.userIntent?r.team:void 0;if(s)return(0,t.jsx)(i.HeaderWrapper,{upgradingTeam:l,children:(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Switch"," ",(0,t.jsx)("b",{className:"font-semibold",children:"upgrade-existing"===r.userIntent?r.team.name:""})," ","to the new Pro plan"]})});let o=n?` and ${a.ADD_ONS[n.type].modalTitle}`:"";return(0,t.jsxs)(i.HeaderWrapper,{upgradingTeam:l,children:["upgrade-existing"===r.userIntent?(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Upgrade ",(0,t.jsx)("b",{className:"font-semibold",children:r.team.name})," to Pro",o]}):(0,t.jsxs)("h1",{className:"text-label-20 font-medium",children:["Create"," ",r.teamName?(0,t.jsx)("b",{className:"font-semibold",children:r.teamName}):"a team",o]}),(0,t.jsx)("p",{className:"text-copy-16",children:"Unlock collaboration and improved performance."})]})}e.s(["DefaultTitle",()=>r])},2401140,2514109,e=>{"use strict";var t=e.i(6468255),i=e.i(4004502),a=e.i(6696646),r=e.i(2504781),n=e.i(6143247);function s(e){let{children:i,onSubmit:a}=e,r="w-full max-h-full";return a?(0,t.jsx)("form",{className:r,onSubmit:a,children:i}):(0,t.jsx)("div",{className:r,children:i})}function l(e){let{title:l,subtitle:o,defaultCancelText:d,defaultContinueText:c,cancelButton:u,continueButton:m,loading:p=!1,onCancel:g,onContinue:h,children:f,contained:x,hideFooter:b,onSubmit:y,hideCancelButton:w}=e,{sentinelRef:v,isAtBottom:S}=function(){let[e,t]=(0,a.useState)(!1),i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=i.current;if(!e)return;let a=new IntersectionObserver(e=>{let[i]=e;return t(i.isIntersecting)},{threshold:1});return a.observe(e),()=>a.disconnect()},[]),{sentinelRef:i,isAtBottom:e}}();return(0,t.jsx)(s,{onSubmit:y,children:(0,t.jsxs)("div",{className:"flex flex-col smd:block smd:max-h-full smd:relative",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-6 items-center smd:overflow-y-auto smd:px-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,t.jsx)("span",{className:"text-label-20 w-fit font-medium",children:l}),o?(0,t.jsx)("span",{className:"text-copy-16 w-fit",children:o}):null]}),(0,t.jsx)("div",{className:x?"bg-background-200 p-4 w-full rounded-sm border border-solid border-gray-alpha-400":"w-full",children:f})]}),(0,t.jsx)("div",{ref:v,className:"hidden smd:block smd:relative smd:top-16 w-full h-[1px]"}),(0,t.jsxs)("div",{className:(0,n.cn)("flex flex-col gap-3 w-full shrink-0 pt-6 smd:sticky smd:-bottom-4 smd:pb-4 smd:w-[calc(100%-theme(spacing.12))] smd:inset-x-6 smd:bg-gradient-to-b smd:from-transparent smd:via-background-100 smd:to-background-100 smd:via-10% sm:pt-8 smd:transition-all smd:duration-150 smd:ease-in-out smd:delay-150",{"smd:opacity-0":b,"smd:opacity-100":!b}),children:[(0,t.jsx)(r.Button,{typeName:h?"button":"submit","data-testid":(0,i.tid)("upgrade-modal","save-button"),disabled:b||m?.disabled,loading:p,...h?{onClick:h}:{},children:m?.text??c}),w?null:(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col w-full smd:grid smd:transition-all smd:duration-150 smd:ease-in-out",{"smd:grid-rows-[1fr] smd:opacity-100":S,"smd:grid-rows-[0fr] smd:opacity-0":!S}),children:(0,t.jsx)("div",{className:"flex flex-col w-full overflow-hidden",children:(0,t.jsx)(r.Button,{disabled:b||u?.disabled,onClick:()=>void g(),type:"tertiary",children:u?.text??d})})})]})]})})}e.s(["SheetStepWrapper",()=>l],2401140);let o=new Set(["VIEWER","BILLING","VIEWER_FOR_PLUS"]);e.s(["nonBillableRoles",0,o],2514109)},5342497,6969789,9239043,5450654,4907256,e=>{"use strict";var t=e.i(1480217),i=e.i(2514109),a=e.i(2924439);function r(e){let{user:r,existingTeamMembers:n=[],newTeamMembers:s,paidAddOns:l,addOnToBeEnabled:o}=e,d=[...n,...s.filter(e=>e.email.length>0)],c=d.length,u=1+d.filter(e=>i.nonBillableRoles.has(e.role)).length,m=d.map(e=>({title:e.email,price:i.nonBillableRoles.has(e.role)||e.uid===r.uid?0:a.pricingMenu.teamSeats.price,unit:"month",member:{role:e.role,isYourself:e.uid===r.uid,avatar:e.avatar,uid:e.uid}})),p={title:c>1?`${c} members`:"1 member",count:c,freeCount:u,price:a.pricingMenu.teamSeats.price,subLineItems:m,isMembersLineItem:!0},g=[{title:"Pro",price:a.pricingMenu.pro.price,count:1,creditTotal:a.pricingMenu.pro.credit},p];if(l||o){let e=(0,t.generateAddOnLineItems)({alreadyEnabledAddOns:l,addOnToBeEnabled:o});g.push(...e)}return g}function n(e){return e.reduce((e,t)=>{let{count:i,freeCount:a=0,price:r=0}=t;return e+(i-a)*r},0)}e.s(["generatePricingDataPlus",()=>r],5342497),e.s(["grandTotalFromPricingData",()=>n],6969789);var s=e.i(6468255),l=e.i(9508212),o=e.i(1344973),d=e.i(6696646),c=e.i(2753950),u=e.i(4788623),m=e.i(6143247),p=e.i(3306538),g=e.i(4585051),h=e.i(2466450),f=e.i(1235157);function x(e){let{role:t}=e;return(0,s.jsx)(p.Badge,{variant:"gray-subtle",size:"sm",children:(0,f.getRoleName)(t)})}function b(e){let{title:t,member:i,price:a,unit:r,currency:n="usd"}=e,l=r&&"month"!==r;return(0,s.jsxs)("div",{className:"flex items-center gap-2 py-2",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 text-left flex gap-1 items-center",children:[i?(0,s.jsx)(g.Avatar,{size:20,hash:i.avatar,uid:i.uid}):null,(0,s.jsx)("span",{className:"text-label-14 truncate",children:t}),i?.isYourself?(0,s.jsx)("span",{className:"text-label-14",children:" (You)"}):null,i?(0,s.jsx)(x,{role:i.role}):null]}),(0,s.jsx)("div",{className:(0,m.cn)("text-right flex-shrink-0",{"w-16":!l,"w-24":l}),children:(0,s.jsxs)("span",{className:"text-label-14 text-gray-900",children:[function(e){let{price:t,isYourself:i,currency:a}=e;return 0===t?i?"Included":"Free":(0,h.formatCurrency)(t??0,a)}({price:a,isYourself:i?.isYourself,currency:n}),l?` per ${r}`:""]})})]})}function y(e){let{title:t,price:i,currency:a="usd",isMembersLineItem:r}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2 py-3 border-b border-gray-alpha-400",children:[(0,s.jsx)("div",{className:"flex-1 text-left flex gap-1 items-center",children:(0,s.jsx)("span",{className:"text-label-14",children:t})}),(0,s.jsx)("div",{className:"text-right flex-shrink-0 w-16",children:(0,s.jsx)("span",{className:"text-label-14 text-gray-900",children:function(e){let{price:t,isMembersLineItem:i,currency:a}=e;return 0===t?i?"Included":"Free":(0,h.formatCurrency)(t??0,a)}({price:i,isMembersLineItem:r,currency:a})})})]})}var w=e.i(6352514),v=e.i(119294);function S(){return(0,s.jsxs)("header",{className:"flex text-gray-900 pb-2 gap-2 border-b border-gray-alpha-400",children:[(0,s.jsx)("span",{className:"text-label-13 flex-1 text-left",children:"Product"}),(0,s.jsx)("span",{className:"text-label-13 text-right flex-shrink-0 w-16",children:"Cost"})]})}function T(e){let{items:t,source:i,currency:a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(S,{}),(0,s.jsx)(u.CollapseGroup,{className:"border-none",children:t.map(e=>(0,s.jsx)(d.Fragment,{children:Array.isArray(e.subLineItems)&&e.subLineItems.length>0?(0,s.jsxs)(c.Collapse,{size:"xs",className:"[&_button>span:first-child]:py-3 [&_button>span]:font-normal [&_button>span:last-child]:py-3",onToggle:t=>{var a;return a=e.title,void(t?v.analytics.track(w.AnalyticsEvent.UPGRADE_MODAL_COLLAPSE_LINE_ITEM,{source:i,lineItem:a}):v.analytics.track(w.AnalyticsEvent.UPGRADE_MODAL_EXPAND_LINE_ITEM,{source:i,lineItem:a}))},title:e.title,titleSuffix:(0,s.jsx)("span",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:"text-right flex-shrink-0 w-16",children:(0,s.jsx)("span",{className:"text-label-14 text-gray-900",children:(0,h.formatCurrency)((e.price??0)*(e.count-(e.freeCount??0)),a)})})}),children:[e.subLineItems.map(e=>(0,d.createElement)(b,{...e,currency:a,key:e.title})),e.isMembersLineItem?(0,s.jsx)("div",{className:"flex items-center gap-2 py-2 mb-2",children:(0,s.jsx)("span",{className:"text-copy-14 text-gray-900",children:"You can invite more members to your team in the next step."})}):null]}):(0,s.jsx)(y,{...e,currency:a,title:e.title})},e.title))})]})}function N(e){let{grandTotal:t,items:i=[],currency:a,source:r}=e;return(0,s.jsxs)(l.Stack,{gap:4,children:[(0,s.jsx)(l.Stack,{children:(0,s.jsx)(T,{items:i,source:r,currency:a})}),(0,s.jsxs)(l.Stack,{direction:"row",justify:"space-between",children:[(0,s.jsx)(o.Text,{weight:500,children:"Total"}),(0,s.jsxs)(o.Text,{weight:500,children:[t," / month"]})]})]})}e.s(["ItemizedReceipt",()=>N],9239043);var j=e.i(6347389),I=e.i(2988836),P=e.i(7807066),A=e.i(5468328),E=e.i(5255926),C=e.i(2504781);function O(e){let{creditText:t,showSkeleton:i,proratedCredit:a,currency:r,isProTrialAndRequirePayment:n}=e,[l,o]=(0,d.useState)(!1),c=i?(0,s.jsx)(E.Skeleton,{width:16,height:16}):void 0,u=(0,s.jsxs)("div",{className:(0,m.cn)("w-full flex border border-gray-alpha-400 py-3 px-4 rounded flex-col gap-3",{"cursor-pointer":a,"mb-4":!a}),children:[(0,s.jsxs)("div",{className:"flex w-full gap-4 justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex gap-4 flex-1 items-center",children:[c??(a?(0,s.jsx)(P.ChevronRight,{className:(0,m.cn)("transition-transform duration-100",{"rotate-90":l})}):(0,s.jsx)(j.Coins,{color:"blue-900"})),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("span",{className:"text-label-14 font-medium",children:[n?"Trial":"Included"," credit"]})," ",(0,s.jsx)(A.Tooltip,{className:"inline",text:n?"Pro Trial includes a $20 credit":"Monthly credit toward metered resources expires at the end of each billing cycle",children:(0,s.jsx)(I.InformationFillSmall,{className:"inline-block -mt-0.5",color:"gray-900"})})]})]}),i?(0,s.jsx)("span",{className:"inline-flex mt-1",children:(0,s.jsx)(E.Skeleton,{width:30,height:16})}):(0,s.jsx)("span",{className:"text-label-14 font-medium text-blue-900",children:t})]}),l&&a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-full h-px bg-gray-alpha-400"}),(0,s.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex gap-4 flex-1 items-center min-w-0",children:[(0,s.jsx)(j.Coins,{color:"blue-900"}),(0,s.jsx)("span",{className:"text-label-14 font-medium min-w-0 text-wrap",children:"Prorated included credit for the current cycle"})]}),(0,s.jsx)("span",{className:"text-label-14 font-medium text-blue-900",children:(0,h.formatCurrency)(a,r,"auto",100)})]})]}):null]});return a?(0,s.jsx)(C.Button,{onClick:()=>{o(!l)},className:"w-full [&>span]:w-full [&>span]:px-0 text-left mb-4 flex",typeName:"button",variant:"unstyled",children:u}):u}e.s(["CreditsCallout",()=>O],5450654);var k=e.i(8522580);function L(e){let{switchPreviewData:t,currency:i}=e,a=(0,d.useMemo)(()=>{let e=Math.round(100*(t.unsettledItems||[]).reduce((e,t)=>e+t.approximateCost,0))/100;return(0,h.formatCurrency)(e,i,"auto",100)},[t,i,100]);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("header",{className:"flex text-gray-900 pb-2 gap-2 border-b border-gray-alpha-400",children:[(0,s.jsx)("span",{className:"text-label-13 flex-1 text-left",children:"Product"}),(0,s.jsx)("span",{className:"text-label-13 text-right flex-shrink-0 w-16",children:"Cost"})]}),(t.unsettledItems||[]).map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 py-2  border-b border-gray-alpha-400",children:[(0,s.jsx)("span",{className:"text-label-14",children:"on-demand"===e.kind?"On-Demand Charges":`${`${e.quantity} `||""}New Team Member${(e?.quantity||0)>1?"s":""}`}),(0,s.jsx)("span",{className:"text-label-14 text-gray-900 text-right",children:(0,h.formatCurrency)(Math.round(100*e.approximateCost)/100,i,"auto",100)})]},e.kind)),(0,s.jsxs)("footer",{className:"flex py-2 gap-2 mb-5",children:[(0,s.jsx)("span",{className:"text-label-14 font-medium flex-1 text-left",children:"Due Today"}),(0,s.jsx)("span",{className:"text-label-14 font-medium text-right",children:a})]}),(0,s.jsx)(k.Note,{fill:!0,type:"secondary",children:"On-demand usage or team seats were added this cycle and must be settled to continue. An invoice will be issued after confirmation, and the final amount may differ slightly. Your billing cycle stays the same, with credits prorated for the remaining days."})]})}e.s(["SwitchPreviewTable",()=>L],4907256)},415788,e=>{"use strict";var t=e.i(6696646);let i=(0,t.createContext)(null);i.displayName="UpgradeModalContext",e.s(["UpgradeModalContext",0,i,"useUpgradeModalContext",0,()=>(0,t.useContext)(i)])},4736806,1450448,5786585,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),a=e.i(9508212),r=e.i(9957872),n=e.i(8522580),s=e.i(609109),l=e.i(2466450),o=e.i(5342497),d=e.i(6969789),c=e.i(9239043),u=e.i(6143247),m=e.i(5450654),p=e.i(4907256),g=e.i(8161149),h=e.i(2504781),f=e.i(57106),x=e.i(6401841),b=e.i(415788);function y(){let{close:e}=(0,b.useUpgradeModalContext)();return(0,t.jsx)(g.EmptyState.Root,{className:"border-none bg-transparent px-4 py-12",description:(0,t.jsxs)(t.Fragment,{children:["Please try again and"," ",(0,t.jsx)(f.Link,{variant:"highlight",href:"/help",tab:!0,children:"contact us"})," ","if the error persists."]}),icon:(0,t.jsx)(g.EmptyState.Icon,{icon:(0,t.jsx)(x.Stop,{size:32})}),title:"Something went wrong",children:(0,t.jsx)(h.Button,{typeName:"button",onClick:e,children:"Close"})})}function w(e){let{user:g,newTeamMembers:h,existingTeamMembers:f,paidAddOns:x,currency:b,trialEnd:w,setGrandTotal:v,upgrade:S,children:T,addOnToBeEnabled:N,source:j,skeleton:I,switchToNewPro:P,switchPreviewData:A,continueButtonText:E,isProTrialAndRequirePayment:C}=e,O=(0,i.useMemo)(()=>(0,o.generatePricingDataPlus)({newTeamMembers:h,existingTeamMembers:f,paidAddOns:x,addOnToBeEnabled:N,user:g}),[h,f,x,N,g]),k=(0,i.useMemo)(()=>(0,d.grandTotalFromPricingData)(O),[O]),L=(0,l.formatCurrency)(k,b),_=(0,i.useMemo)(()=>{if(A)return A.monthlyCredit?(0,l.formatCurrency)(A.monthlyCredit,b,"auto",100):"";let e=O.reduce((e,t)=>e+(t.creditTotal?t.creditTotal:0),0);return e>0?(0,l.formatCurrency)(e,b):""},[O,b,A]);(0,i.useEffect)(()=>{v?.(k)},[k,v]);let D=w&&!S?.forceImmediateUpgrade&&S?.selectedOption==="later"?`on ${(0,s.formatDate)(w,{dateStyle:"long"})}`:"immediately",R=P&&!A&&!I;return(0,t.jsxs)(t.Fragment,{children:[_&&!R?(0,t.jsx)(m.CreditsCallout,{creditText:_,showSkeleton:I,proratedCredit:A?.proratedCredit,currency:b,isProTrialAndRequirePayment:C}):null,(0,t.jsx)(a.Stack,{gap:6,children:(0,t.jsxs)("div",{className:(0,u.cn)("flex flex-col gap-6 relative",{"min-h-screen overflow-hidden":I}),children:[I?(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("div",{className:"z-10 absolute top-0 -left-8 h-[calc(100%+32px)] w-[calc(100%+64px)] bg-gradient-to-b from-[hsla(var(--ds-background-200-value),0)_0px] to-[hsla(var(--ds-background-200-value),1)_92px]"})}):null,P&&A?.everythingSettled?(0,t.jsx)(n.Note,{fill:!0,type:"secondary",children:"Your billing cycle stays the same, and included usage will be prorated for the remaining days."}):(0,t.jsx)("div",{className:(0,u.cn)("flex flex-col gap-6",{"max-h-0 overflow-hidden":I}),children:P?A?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.SwitchPreviewTable,{switchPreviewData:A,currency:b}),T]}):(0,t.jsx)(y,{}):(0,t.jsxs)(t.Fragment,{children:[T,S&&w&&!S.forceImmediateUpgrade?(0,t.jsxs)(r.ChoiceboxGroup,{direction:"column",label:"When would you like to upgrade?",onChange:e=>S.setSelectedOption(e),type:"radio",value:S.selectedOption,children:[(0,t.jsx)(r.ChoiceboxGroup.Item,{title:"Upgrade immediately",value:"now"}),(0,t.jsx)(r.ChoiceboxGroup.Item,{title:"Upgrade at end of trial",value:"later"})]}):null,(0,t.jsx)("div",{className:"text-label-14 text-gray-900",children:C?(0,t.jsxs)(t.Fragment,{children:["Clicking"," ",(0,t.jsx)("span",{className:"font-medium text-gray-1000",children:E||"Confirm"})," ","will start a 14 day free Pro Trial. You will be charged after 14 days or once the included credit is fully used, whichever happens first. If you cancel Pro Trial before then, you will not be charged."]}):(0,t.jsxs)(t.Fragment,{children:["Upon clicking"," ",(0,t.jsx)("span",{className:"font-medium text-gray-1000",children:E||"Confirm"}),", you will be charged ",L,", plus any applicable taxes and fees, ",D," and then every month, until you cancel."]})}),(0,t.jsx)(c.ItemizedReceipt,{currency:b,grandTotal:L,items:O,source:j})]})})]})})]})}var v=e.i(3671642),S=e.i(5255926),T=e.i(1344973),N=e.i(4030453),j=e.i(9373142),I=e.i(9588822),P=e.i(8132352);function A(e){let{paymentMethodInfo:i,makeDefaultBillingAddress:r,onBillingFormReady:n,billingFormProps:s,isSubmitting:l,addressError:o,setUnparsedAddress:d,setTaxId:c,submissionError:u,scrollToRef:m}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"w-full",ref:m,children:["loading"===i.type?(0,t.jsx)(E,{}):null,"no-payment-method"===i.type?(0,t.jsxs)(a.Stack,{gap:5,className:"rounded-sm bg-background-200 p-4 border border-gray-alpha-400 border-solid",children:[(0,t.jsx)(I.BillingForm,{makeDefaultBillingAddress:r,breakLine:!0,onReady:n,...s}),r?null:(0,t.jsxs)(a.Stack,{gap:2,children:[(0,t.jsx)(a.Stack,{align:"center",className:"border-b border-gray-alpha-400",color:"gray-900",direction:"row",children:(0,t.jsx)(T.Text,{weight:600,children:"Team Billing Address"})}),(0,t.jsx)(P.FullBillingAddressForm,{captureAddress:d,captureTaxId:c,disabled:l||s.disabled,error:o})]})]}):null,"payment-method"===i.type?(0,t.jsxs)(a.Stack,{align:"center",className:"rounded bg-background-100 p-3 border border-gray-alpha-400",direction:"row",gap:3,children:[(0,t.jsx)(j.CreditCard,{}),(0,t.jsxs)(a.Stack,{children:[(0,t.jsxs)(T.Text,{weight:600,children:[i.cardBrand," ending in"," ",i.cardLast4]}),(0,t.jsxs)(T.Text,{color:"gray-900",children:["exp. ",i.cardExpiry]}),i.userEmail?(0,t.jsx)(T.Text,{color:"gray-900",children:i.userEmail}):null]})]}):null]}),u?(0,t.jsx)(N.Error,{children:u}):null]})}function E(){return(0,t.jsxs)(a.Stack,{gap:5,children:[(0,t.jsxs)(a.Stack,{direction:{sm:"column",md:"row"},gap:5,children:[(0,t.jsx)(a.Stack,{flex:"1",children:(0,t.jsx)(v.Label,{value:"Card Number",children:(0,t.jsx)(S.Skeleton,{height:40,width:"100%"})})}),(0,t.jsxs)(a.Stack,{direction:"row",gap:5,style:{minWidth:"calc(108px * 2 + var(--stack-gap))"},children:[(0,t.jsx)(a.Stack,{flex:"1",children:(0,t.jsx)(v.Label,{value:"Expires",children:(0,t.jsx)(S.Skeleton,{height:40,width:"100%"})})}),(0,t.jsx)(a.Stack,{flex:"1",children:(0,t.jsx)(v.Label,{value:"CVC",children:(0,t.jsx)(S.Skeleton,{height:40,width:"100%"})})})]})]}),(0,t.jsx)(a.Stack,{direction:"row",style:{"--small-input-width":"108px"},children:(0,t.jsx)(a.Stack,{flex:"1",children:(0,t.jsx)(v.Label,{value:"Country",children:(0,t.jsx)(S.Skeleton,{height:40,width:"100%"})})})})]})}function C(e){let{user:i,team:a,teamManager:r,setCartTotal:n,members:s,source:l,showSkeleton:o,paymentMethodInfo:d,makeDefaultBillingAddress:c,onBillingFormReady:u,billingFormProps:m,isSubmitting:p,addressError:g,scrollToRef:h,continueButtonText:f,isProTrialAndRequirePayment:x,...b}=e;return(0,t.jsx)(w,{user:i,addOnToBeEnabled:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?b.addOn:void 0,currency:a?.billing?.currency??"USD",existingTeamMembers:"upgrade-existing"===r.userIntent?s?.members:void 0,newTeamMembers:"create"===r.userIntent?[{email:i.email,role:"OWNER",uid:i.uid,avatar:i.avatar}]:[],paidAddOns:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?b.paidAddOns:void 0,setGrandTotal:n,source:l,teamManager:r,trialEnd:a?.billing?.trial?.end,isProTrialAndRequirePayment:x,upgrade:"upgrade-modal"===b.type&&"upgrade-existing"===r.userIntent?{selectedOption:b.upgradeTimingOption,setSelectedOption:b.setUpgradeTimingOption,forceImmediateUpgrade:b.forceImmediateUpgrade}:void 0,skeleton:o,switchPreviewData:"upgrade-modal"===b.type?b.switchPreviewData:void 0,switchToNewPro:"upgrade-modal"===b.type?b.switchToNewPro:void 0,continueButtonText:f,children:(0,t.jsx)(A,{paymentMethodInfo:d,makeDefaultBillingAddress:c,onBillingFormReady:u,billingFormProps:m,isSubmitting:p,addressError:g,submissionError:"upgrade-modal"===b.type?b.asyncStepError?.message:b.submissionError,scrollToRef:h,setUnparsedAddress:"upgrade-modal"===b.type?void 0:b.setUnparsedAddress,setTaxId:"upgrade-modal"===b.type?void 0:b.setTaxId})})}e.s(["PaymentInfoShared",()=>C],4736806);var O=e.i(8587921),k=e.i(8753873),L=e.i(6222316),_=e.i(8248823),D=e.i(9365938);function R(e){let t,a,{teamManager:r,switchToNewPro:n}=e,s="upgrade-existing"===r.userIntent?r.team:void 0,{data:l}=(0,O.useMembersForTeam)(s),[o,d]=(0,i.useState)(0),[c,u]=(0,i.useState)(!1),{scrollToRef:m,formResultErrorCallback:p}=(t=(0,i.useRef)(null),a=(0,i.useCallback)(()=>{t.current&&t.current.scrollIntoView({behavior:"smooth"})},[]),{scrollToRef:t,formResultErrorCallback:a}),g=(0,k.usePaymentMethodInfo)(s?.id),{switchPreviewData:h,isLoadingSwitchPreview:f}=(0,L.useSwitchToNewProPreview)({teamId:s?.id,switchToNewPro:n}),{showSkeleton:x,onBillingFormReady:b}=function(e){let{paymentMethodInfo:t,isLoadingSwitchPreview:a,ignorePaymentLoading:r}=e,[n,s]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{"payment-method"===t.type&&(0,i.startTransition)(()=>{s(!1)})},[t.type]),{showSkeleton:r?!!a:n||"loading"===t.type||!!a,onBillingFormReady:(0,i.useCallback)(()=>{s(!1)},[])}}({paymentMethodInfo:g,isLoadingSwitchPreview:f,ignorePaymentLoading:h?.everythingSettled}),{submit:y,makeDefaultBillingAddress:w,elements:v,...S}=(0,I.useBillingForm)({formResultErrorCallback:p}),[T,N]=(0,i.useState)();return(0,i.useEffect)(()=>{if(S.error?.sendToSentry){let e=(0,_.normalizeError)(S.error).message,{additionalStripeErrorInfo:t}=S.error;(0,D.trackLifecycleError)({type:"upgrade-existing"===r.userIntent?"upgrade":"create",error:Error(`Billing form error: ${e}`),attributes:{teamId:s?.id,...t?{stripeErrorType:t.type??"unknown",stripeErrorCode:t.code??"unknown"}:{}}})}},[S.error,s?.id,r.userIntent]),{team:s,members:l,cartTotal:o,setCartTotal:d,isSubmitting:c,setIsSubmitting:u,scrollToRef:m,paymentMethodInfo:g,showSkeleton:x,onBillingFormReady:b,switchPreviewData:h,submit:y,makeDefaultBillingAddress:w,elements:v,billingFormProps:S,addressError:T,setAddressError:N,isLoadingSwitchPreview:f}}e.s(["usePaymentInfoStep",()=>R],1450448);var M=e.i(7525322);let B="payment-info";function F(e){let{paymentMethodInfo:t,setIsSubmitting:a,makeDefaultBillingAddress:r,setAddressError:n,elements:s,submit:l,teamManager:o,cartTotal:d,team:c,...u}=e;return(0,i.useCallback)(async e=>{try{let i;if("loading"===t.type)return;a(!0);let c="no-payment-method"!==t.type||r?void 0:"new-flow"===u.type?(0,M.validateAddress)(u.unparsedAddress):e?(0,M.validateAddressFormData)(e):void 0;if(c instanceof Error){n(c),a(!1);return}if(r&&"no-payment-method"===t.type){if(!s){n("Failed to save billing address."),a(!1);return}let e=await s.getElement("address")?.getValue(),t=e?.value.address;if(!t){n("Failed to save billing address."),a(!1);return}c={line1:t.line1,line2:t.line2??void 0,city:t.city,state:t.state,zipCode:t.postal_code,country:t.country.toLowerCase()}}if(n(void 0),"new-flow"===u.type)i=u.taxId;else if("upgrade-modal"===u.type&&e){let t=e.get("tax-id-type"),a=e.get("tax-id-value");"string"==typeof t&&"string"==typeof a&&(i={type:t,value:a})}if("upgrade-modal"===u.type&&u.switchToNewPro){u.submissionQueue.enqueue({stepName:B,work:()=>u.immediatelySwitchToNewPro(),tracing:{name:"upgrade-modal-switch-to-new-pro",flowType:"switch-to-new-pro"}}),u.goto.next();return}let m=await U({submit:l,teamManager:o,paymentMethodInfo:t});if(void 0===m)return;if(await t.revalidateSources(),"new-flow"===u.type)return void await u.continueAction.onContinue({paymentMethodId:m,address:c,taxId:i,cartTotal:d});if("upgrade-modal"===u.type){"create"===o.userIntent?u.submissionQueue.enqueue({stepName:B,work:()=>u.createTeam({paymentMethodId:m,address:c,taxId:i,cartTotal:d}),tracing:{name:"upgrade-modal-create-team",attributes:{paymentMethodId:m},flowType:"create"}}):u.submissionQueue.enqueue({stepName:B,work:()=>u.upgradeTeam({upgradeTimingOption:u.upgradeTimingOption,paymentMethodId:m,address:c,taxId:i,cartTotal:d,paidAddOns:u.paidAddOns}),tracing:{name:"upgrade-modal-upgrade-team",attributes:{paymentMethodId:m,teamId:o.team.id},flowType:"upgrade"}}),u.goto.next();return}}catch(e){"new-flow"===u.type&&u.setSubmissionError((0,_.normalizeError)(e).message),(0,D.trackLifecycleError)({type:"upgrade-existing"===o.userIntent?"upgrade":"create",error:e,attributes:{teamId:c?.id}})}finally{a(!1)}},[t,a,r,n,s,l,o,d,c,u.type,u.taxId,u.unparsedAddress,u.continueAction,u.setSubmissionError,u.switchToNewPro,u.submissionQueue,u.goto,u.createTeam,u.upgradeTeam,u.immediatelySwitchToNewPro,u.paidAddOns,u.upgradeTimingOption])}async function U(e){let{submit:t,paymentMethodInfo:i,teamManager:a}=e;return"payment-method"===i.type?i.paymentMethodId:"create"===a.userIntent?await t({assignCardToEntity:!1,shouldUseTeam:!1})??void 0:await t({assignCardToEntity:!0,shouldUseTeam:!0,teamId:a.team.id})??void 0}e.s(["usePaymentInfoContinue",()=>F],5786585)},4976875,3238154,8668551,e=>{"use strict";var t=e.i(6696646),i=e.i(1628687);function a(e){let{teamManager:a}=e,[r,n]=(0,t.useState)(void 0),s=(0,t.useCallback)(()=>{if("create"===a.userIntent)return(0,i.validateTeamName)(a.teamName)},[a]),l=(0,t.useCallback)(()=>{let e=s();e?n(e):n(void 0)},[s,n]);return{validationError:r,setValidationError:n,validate:s,onBlur:l}}e.s(["useTeamNameInput",()=>a],4976875);var r=e.i(6468255),n=e.i(3500331),s=e.i(4004502);function l(e){let{validationError:t,onBlur:i,teamManager:a,isNewProjectFlow:l,frozen:o}=e,d=l?(0,s.tid)("import-flow","select-plan","team-name-input"):(0,s.tid)("upgrade-modal","team-name");return(0,r.jsx)(r.Fragment,{children:"create"===a.userIntent?(0,r.jsx)(n.Input,{autoFocus:!0,"data-testid":d,disabled:o,error:t,id:l?"new-flow-upgrade-team-name":"upgrade-modal-team-name",label:"Team Name",maxLength:48,onBlur:i,onChange:e=>a.setTeamName(e.currentTarget.value),onFocus:e=>e.currentTarget.select(),value:a.teamName,width:"100%"}):null})}e.s(["TeamNameInput",()=>l],3238154);var o=e.i(9957872),d=e.i(4030453);function c(e){let{planSelector:t,frozen:i,errorMessage:a,className:n}=e,s=t.showSelector,l=!!a;return s||l?(0,r.jsxs)("div",{className:n,children:[s?(0,r.jsx)(u,{planSelector:t,frozen:i}):null,l?(0,r.jsx)(d.Error,{children:a}):null]}):null}function u(e){let{planSelector:t,frozen:i}=e;return(0,r.jsx)(o.ChoiceboxGroup,{direction:{sm:"column",md:"row"},disabled:i,label:"Select plan type",onChange:e=>{t.setSelectedPlan(e)},type:"radio",value:t.selectedPlan,children:t.validSelectorOptions.map(e=>(0,r.jsx)(o.ChoiceboxGroup.Item,{description:e.description,disabled:i,title:e.title,value:e.slug,"data-testid":(0,s.tid)("select-plan",e.slug),optionClassName:"flex-1",titleDescriptionClassName:"self-start"},e.slug))})}e.s(["SelectorSection",()=>c],8668551)},2762499,6924689,1347988,4429918,e=>{"use strict";var t=e.i(6696646),i=e.i(5858269),a=e.i(277234),r=e.i(4244280),n=e.i(2020034),s=e.i(2674895),l=e.i(1434448),o=e.i(4361526),d=e.i(119294),c=e.i(6352514),u=e.i(6232213),m=e.i(8434017);async function p(e,t){let{name:i,slug:n,source:s,paymentMethodId:l,pricingExperiment:o,enablePreviewFeedback:u,bypassTrial:p=!1,plan:h="pro",orgId:f,fixSlugConflict:x=!1,attribution:b}=e,y=await (0,a.fetchAPI)(r.API_TEAMS,{method:"POST",body:JSON.stringify({slug:n,source:s,name:i,stripePaymentMethodId:l,pricingExperiment:o,enablePreviewFeedback:u,bypassTrial:p,plan:h,orgId:f,fixSlugConflict:x,attribution:b}),throwOnHTTPError:t});return p&&l?d.analytics.track(c.AnalyticsEvent.PRO_TEAM_CREATED,{newTeamId:"id"in y?y.id:void 0,source:s}):!p&&l?"billing"in y&&y.billing?.status==="trialing"?(g(s),d.analytics.track(c.AnalyticsEvent.INTENT_TO_GO_PRO,{billingStatus:"trialing",source:s})):d.analytics.track(c.AnalyticsEvent.INTENT_TO_GO_PRO,{billingStatus:"canceled or expired trial",source:s}):"pro"===h&&(g(s),"id"in y&&y.id&&(0,m.triggerOnboardingEvent)("start",y.id)),y}function g(e){d.analytics.track(c.AnalyticsEvent.START_PRO_TRIAL,{source:e}),(0,u.postToStatsigClient)({events:[{eventName:"start_pro_trial",metadata:{source:e,action:"create-team"}}]})}e.i(1480217);var h=e.i(2471796),f=e.i(455575);function x(e){let{teamManager:d,onConversionStart:c,planSelector:u,mutate:m,addOn:g,progressContextRef:x,onConversionError:b,deferredToasts:y,router:w,projectId:v,addOnMutate:S,mutateEnabledRoles:T,mutateBudget:N,customCreateTeamApiSource:j,customPostCreationFlow:I}=e;return(0,t.useCallback)(async function(){let{address:e,paymentMethodId:t,taxId:P,cartTotal:A}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cartTotal:0};if("create"!==d.userIntent)throw Error("Attempted to create a team when the user wanted to upgrade an existing one.");c?.({type:"create",team:void 0});let{teamName:E}=d;if(!E)throw Error("Team name is required.");let C=!!t,O=(0,i.default)(E),{selectedPlan:k,desiredTrialBehavior:L,actualTrialBehavior:_}=u,D=function(){let e=(0,s.getSessionReferrer)()||void 0,{pathname:t,utm:i}=(0,l.getSessionLandingPage)()||{},a=new URLSearchParams(window.location.search).get("gclid");if(!a){let e=localStorage?.getItem("gclid");if(e){let{value:t,expiration:i}=JSON.parse(e);new Date(i)>new Date&&(a=t)}}return{sessionReferrer:e,landingPage:t,pageBeforeConversionPage:document.referrer,utm:{utmSource:i?.utm_source,utmMedium:i?.utm_medium,utmCampaign:i?.utm_campaign,utmTerm:i?.utm_term},...a&&{gclid:a}}}(),R=await p({name:E,slug:O,source:j||"upgrade-modal",plan:"hobby"===k?"hobby":"pro",...C?{paymentMethodId:t}:{},bypassTrial:"pro"===k,fixSlugConflict:!0,attribution:D});if("error"in R)throw b?.({type:"create"}),Error(R.error.message);let M=await (0,a.fetchAPI)(`${r.API_TEAMS_V2}/${R.id}`);if(await m(),e&&(0,o.saveBillingDetails)(M.id,e,P).then(m).catch(()=>{(y?.push||f.toasts.error)({type:"error",text:"There was a problem saving your billing address. Please visit billing settings to update it.",action:"Go to Settings",onAction:()=>{w.replace(`/${M.slug}/~/settings/billing#billing-address`)},cancelAction:"Dismiss",preserve:!0})}),g&&h.ADD_ONS[g.type].enableFunction)try{await h.ADD_ONS[g.type].enableFunction?.({team:M,projectId:v,..."additionalConfigurations"in g?g.additionalConfigurations:{}}),S?.({projectId:v,teamId:M.id})}catch(e){throw b?.({type:"create",team:M}),e}if(M.billing?.plan!=="hobby"){let e,t=(e=M.id,`new_team_survey_${e}`);(0,n.setCookie)(t,"1","1d")}N&&(window?.localStorage?.setItem("budgetPolling","true"),N()),x&&(x.current.conversionDetails={type:"create",team:M,priorPlan:"hobby",newPlan:k,desiredTrialBehavior:L,actualTrialBehavior:_,cartTotal:A,existingTeamMembers:0}),T?.(),I?.({team:M,cartTotal:A,selectedPlan:k})},[d,c,u,m,g,x,b,y,w,v,S,T,N,j,I])}e.s(["useCreateTeam",()=>x],2762499);var b=e.i(2771361),y=e.i(7111889),w=e.i(8042625);async function v(e){let{teamId:t}=e;return await (0,a.fetchAPI)(`${r.API_PLANS_SWITCH_TO_NEW_PRO}${(0,w.encode)({teamId:t,immediate:!0})}`,{method:"POST",headers:{"Content-Type":"application/json"},throwOnHTTPError:!0})}function S(e){let{teamManager:i,onConversionStart:n,planSelector:s,deferredToasts:l,addOn:d,progressContextRef:c,pendingInvitations:u,source:m,onConversionError:p,mutate:g,router:x,projectId:w,addOnMutate:S,mutateEnabledRoles:T,mutateBudget:N,customPostUpgradeFlow:j,awaitMutate:I}=e;return(0,t.useCallback)(async function(){let e,{upgradeTimingOption:t,address:P,taxId:A,cartTotal:E,paidAddOns:C}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cartTotal:0};if("upgrade-existing"!==i.userIntent)throw Error("Attempted to upgrade a team when the user wanted to create a new one.");let{team:O}=i;n?.({type:"upgrade-existing",team:O});let{selectedPlan:k,desiredTrialBehavior:L,actualTrialBehavior:_}=s;if(O.billing?.status==="trialing"&&"now"!==t);else try{O.billing?.status==="trialing"&&"plus"!==O.billing.planIteration?await v({teamId:O.id}):await (0,b.changePlan)({source:m,teamId:O.id,to:k})}catch(e){throw p?.({type:"upgrade-existing",team:O}),e}if(P&&(0,o.saveBillingDetails)(O.id,P,A).then(g).catch(()=>{(l?.push||f.toasts.error)({type:"error",text:"There was a problem saving your billing address. Please visit billing settings to update it.",action:"Go to Settings",onAction:()=>{x.replace(`/${O.slug}/~/settings/billing#billing-address`)},cancelAction:"Dismiss",preserve:!0})}),I?await g():(async()=>{let e=0;do await g(),await new Promise(e=>setTimeout(e,2e3)),e++;while(O.billing?.cancelation&&e<5)})().catch(console.error),await (0,y.revalidateBillingData)(O.slug),N&&(window?.localStorage?.setItem("budgetPolling","true"),N()),e="pro"===k&&"now"===t?"Your team has been upgraded to Pro":"pro"===k?"Your team will automatically upgrade to Pro at the end of your Trial":"Your Pro Trial has started, and will expire in 14 days",(l?.push||f.toasts.success)({type:"success",text:e}),d&&h.ADD_ONS[d.type].enableFunction)try{await h.ADD_ONS[d.type].enableFunction?.({team:O,projectId:w,..."additionalConfigurations"in d?d.additionalConfigurations:{}}),S?.({projectId:w,teamId:O.id}),(l?.push||f.toasts.success)({type:"success",text:`${h.ADD_ONS[d.type].title} successfully enabled.`})}catch(e){throw p?.({type:"upgrade-existing",team:O}),e}let D=await (0,a.fetchAPI)(`${r.API_TEAMS_V2}/${O.id}`);c&&(c.current.conversionDetails={type:"upgrade-existing",team:D,priorPlan:(O.billing?.plan==="pro"&&"trialing"===O.billing.status?"pro-trial":O.billing?.plan)??"hobby",newPlan:k,desiredTrialBehavior:L,actualTrialBehavior:_,cartTotal:E,existingTeamMembers:(u||0)+(O.billing?.invoiceItems?.teamSeats?.quantity??1)-1,paidAddOns:C?{speedInsights:C.speedInsights?.length||0,additionalConcurrentBuilds:C.concurrentBuilds??0,previewDeploymentSuffix:!!C.previewDeploymentSuffix,passwordProtection:!!C.passwordProtection,monitoring:!!C.monitoring}:void 0}),T?.(),j?.({team:O,selectedPlan:k,cartTotal:E})},[i,n,s,l,d,c,u,m,p,g,x,w,S,T,N,j,I])}function T(e){return{value:e,rule:""}}e.s(["fetchSwitchToNewPro",()=>v],6924689),e.s(["useUpgradeTeam",()=>S],1347988),e.s(["statsigOption",()=>T],4429918)}]);

//# sourceMappingURL=8597834a930903a2.js.map
//# debugId=c718d71a-45c9-531f-82e7-1f64f283b8c7
