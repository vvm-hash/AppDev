
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0456f14e-105b-5643-806b-a189663a3f50")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3981247,e=>{"use strict";var t=e.i(3911483),i=e.i(2547843);function r(e){let{teamIdOrSlug:t,projectSlug:i}=e;return n({teamIdOrSlug:t,projectSlug:i},{suspense:!0,revalidateOnMount:!1})}function n(e,r){let{teamIdOrSlug:n,projectSlug:o}=e,a=!n||!o,l=(0,t.default)(()=>a?null:(0,i.getRollingReleaseEndpoint)(n,o),i.rollingReleaseFetcher,r);return{...l,skipped:a,isLoading:!a&&l.isLoading}}e.s(["useRollingRelease",()=>n,"useSuspenseRollingRelease",()=>r])},6619197,5645345,e=>{"use strict";var t=e.i(6468255),i=e.i(6696646),r=e.i(8248823),n=e.i(9100551),o=e.i(57106),a=e.i(3869281),l=e.i(4030453),s=e.i(2455417),c=e.i(6891161),d=e.i(8522580),u=e.i(5255926),m=e.i(9318197),g=e.i(9508212),p=e.i(1344973),h=e.i(455575),b=e.i(8761240),x=e.i(472117),y=e.i(4004502),f=e.i(8042625),j=e.i(277234),v=e.i(4244280),k=e.i(4443312),S=e.i(5140444),A=e.i(5338940),P=e.i(4614946),C=e.i(4450569),R=e.i(4396019),w=e.i(9375869),T=e.i(8518548);function I(e){if(!e)return;if("id"in e==!1)return e;let{aliasAssigned:t,aliasError:i=null,aliasAssignedAt:r,buildingAt:n,created:o=e.createdAt,createdAt:a,creator:l,name:s,ready:c,readyState:d,readySubstate:u,target:m=null,uid:g=e.id,url:p,isRollbackCandidate:h="production"===e.target}=e;return{aliasAssigned:t,aliasError:i,aliasAssignedAt:r,buildingAt:n,created:o,createdAt:a,creator:{email:"",githubLogin:"",...l},name:s,ready:c,readyState:d,readySubstate:u,target:m,type:"LAMBDAS",uid:g,url:p,isRollbackCandidate:h}}e.s(["asListDeployment",()=>I],5645345);var D=e.i(1840726),N=e.i(930810),L=e.i(7952834),M=e.i(1173672),$=e.i(9745887),z=e.i(3008300),O=e.i(3981247),E=e.i(6060673);function B(e){let t=e?.name,{deployment:r,isLoading:n}=(0,R.useProjectProductionDeployment)(t);return(0,i.useMemo)(()=>{let t=I(e);return t?n?"Loading…":t.uid===r?.id?"This Deployment is already in Production.":"readyState"in t&&"READY"!==t.readyState?"Only Deployments that are Ready can be promoted.":"":""},[e,n,r?.id])}function F(e){let{title:i}=e;return(0,t.jsx)(c.Modal.Header,{children:(0,t.jsx)(c.Modal.Title,{center:!0,children:i})})}function _(e){let{deploymentId:i}=e,r=(0,x.useChecksPrivateBetaFlag)(),n=(0,x.useCiChecksAndPoliciesFlagV2)(),a=r||n,{data:l,isLoading:s}=(0,k.useProjectCheckRuns)({deploymentId:i,enableCiChecksAndPolicies:a});if(!a)return null;if(s)return(0,t.jsx)(u.Skeleton,{});if(l?.runs.every(e=>"succeeded"===e.conclusion))return null;let c=l?.runs.filter(e=>"succeeded"!==e.conclusion)||[];return(0,t.jsxs)(d.Note,{type:"error",fill:!0,className:"mt-6",children:["By clicking Promote, you acknowledge that you are bypassing promotion requirements:",c.length>0&&(0,t.jsx)("ul",{className:"flex flex-col gap-1 ml-4 list-disc",children:c.slice(0,5).map(e=>(0,t.jsx)("li",{children:e.externalUrl?(0,t.jsx)(o.Link,{href:e.externalUrl,external:!0,children:e.name}):(0,t.jsx)("span",{children:e.name})},e.id||e.name||`${e.conclusion}-${e.status}`))})]})}function W(e,r){let{onDeploymentPromoted:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[u,h]=(0,i.useState)(!1),[x,f]=(0,i.useState)(null),{team:j}=(0,A.useTeam)(),v=e??x?.name,{data:k}=(0,E.useProject)(v),P=r??k,w=(0,D.useShowIgnoreBuildStep)({project:P,deployment:x}),[I,L]=(0,i.useState)(z.DEFAULT_USE_IGNORE_BUILD_STEP_PROMOTE),M=(0,i.useCallback)(()=>{h(!1)},[]),{error:B,loading:W,promote:H,setError:Y,setLoading:G}=U({deployment:x,useIgnoreBuildStep:I,project:P,onCurrentDeploymentPromoted:(0,i.useCallback)(()=>{M(),n?.()},[M,n])}),{user:V}=(0,S.useUser)(),{data:q}=(0,O.useRollingRelease)({teamIdOrSlug:j?.slug,projectSlug:v}),K=P?.rollingRelease?.stages!==void 0&&P.rollingRelease.stages.length>0,X=q?.rollingRelease?.state==="ACTIVE",J=q?.rollingRelease?.canaryDeployment?.id,Q=X&&J===x?.uid,Z=K&&!X&&x?.target==="production",ee=K&&X&&x?.target==="production",et=Z&&P.rollingRelease?.stages!==void 0?P.rollingRelease.stages[0]?.targetPercentage:null,{data:ei}=(0,T.useProjectDomains)(v,{limit:11,production:"true",redirects:"false",verified:"true",order:"ASC"}),er=(0,i.useCallback)(e=>{f(e),h(!0)},[]),en=(0,i.useCallback)(()=>{G(!1),f(null),Y(void 0)},[Y,G]),{rollbackDescription:eo,deploymentIsStale:ea}=(0,R.useProjectProductionDeployment)(P?.name),{andMoreDomains:el,remainingDomains:es}=(0,i.useMemo)(()=>{if(!ei)return{andMoreDomains:!1,remainingDomains:[]};let e=ei.length>2,t=e?ei.slice(2).map(e=>e.name):[];return{andMoreDomains:e,remainingDomains:t}},[ei]),ec=(0,i.useMemo)(()=>{if(!P||!x)return(0,t.jsx)(C.default,{center:!0,style:{marginTop:10},children:(0,t.jsx)(s.LoadingDots,{size:4})});let e=!!(ei&&ei.length>0);return(0,t.jsxs)(t.Fragment,{children:["production"===x.target?(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote:"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:"16px"},children:"A new deployment will be built using your production environment."}),(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:"16px"},weight:400,children:"Deployment to promote to production:"})]}),(0,t.jsx)("div",{children:(0,t.jsx)($.DeploymentCardSmall,{deployment:x,isPromote:!0,selectedDeployment:null})}),Z?(0,t.jsxs)(p.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:["This will start a new rolling release with initial traffic of"," ",et,"%."]}):null,ee?(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"This will queue the deployment for promotion after the current rolling release completes."}):null,Z||ee||!e?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:16,marginTop:24},weight:400,children:"It will be aliased to the following domains:"}),(0,t.jsx)(g.Stack,{gap:2,style:{paddingLeft:12},children:ei?.slice(0,2).map(e=>{let{name:i}=e;return(0,t.jsx)(p.Text,{as:"p",children:(0,t.jsxs)(g.Stack,{align:"center",direction:"row",gap:3,children:[(0,t.jsx)(b.CheckCircleFill,{color:"blue-700",size:20}),(0,t.jsx)("span",{children:i.startsWith("*")?i:(0,t.jsx)(o.Link,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","preview-link"),external:!0,href:`https://${i}`,variant:"highlight",children:i})})]})},i)})}),el?(0,t.jsxs)(p.Text,{as:"p",className:"mt-6 mb-4",children:["...and ",es.length," more"]}):null]}),!Z&&!e&&(0,t.jsxs)(p.Text,{as:"p",style:{marginBottom:"24px",marginTop:"24px"},children:["Warning: Your Project does not have a Production Domain. We recommend you"," ",(0,t.jsx)(o.Link,{href:`/${j?j.slug:V?.username}/${encodeURIComponent(P.name)}/settings/domains`,variant:"highlight",children:"add"})," ","one."]}),P.link&&x.gitSource?(0,t.jsx)(_,{deploymentId:x.id}):null,w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Spacer,{y:1}),(0,t.jsx)(a.Checkbox,{checked:I,fullWidth:!0,onChange:()=>{L(!I)},children:"Use project's Ignore Build Step"})]}):null,Q?(0,t.jsx)(d.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(g.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(g.Stack,{align:"start",children:(0,t.jsx)(p.Text,{as:"p",color:"inherit",children:"This will complete the rolling release for this deployment."})})})}):null,ea?(0,t.jsx)(d.Note,{className:" border border-[#fde68a] bg-[#fffbeb] text-[#bd5200] dark:border-[#411d06] dark:bg-[#241005] dark:text-[#fde68a] ",fill:!0,size:"small",style:{marginTop:24},type:"warning",variant:"contrast",children:(0,t.jsx)(g.Stack,{align:"center",direction:"row",gap:4,style:{padding:1},children:(0,t.jsx)(g.Stack,{align:"start",children:(0,t.jsx)(p.Text,{as:"p",color:"inherit",children:Z?"Completing the Rolling Release will undo the current Instant Rollback":"This action will undo the current Instant Rollback"})})})}):null,eo?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Text,{as:"p",style:{marginBottom:16,marginTop:24},children:"Rollback Details:"}),(0,t.jsx)(N.RollbackDescriptionCard,{rollbackDescription:eo,project:P})]}):null]})},[el,es,ei,P,j,V,x,I,w,ea,eo,et,Z,ee,Q]),ed=(0,i.useMemo)(()=>(0,t.jsx)(c.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","confirm-button"),loading:W,onClick:H,children:x&&"target"in x&&"production"===x.target?"Promote":"Promote to Production"}),[H,W,x]);return{modal:(0,i.useMemo)(()=>(0,t.jsxs)(c.Modal.Modal,{active:u,"data-testid":(0,y.tid)("deployments","promote-to-production-overlay"),onAnimationDone:en,onClickOutside:M,sticky:!0,width:"500px",children:[(0,t.jsxs)(c.Modal.Body,{children:[(0,t.jsx)(F,{title:ee?"Queue for Promotion":x&&"target"in x&&"production"!==x.target?"Promote to Production":"Promote"}),ec,B?(0,t.jsx)(l.Error,{error:B}):null]}),(0,t.jsxs)(c.Modal.Actions,{children:[(0,t.jsx)(c.Modal.Action,{"data-testid":(0,y.tid)("deployments","promote-to-production-overlay","cancel-button"),loading:!1,onClick:M,type:"secondary",children:"Cancel"}),ed]})]}),[u,en,M,ec,B,ed,ee,x]),close:M,open:er}}let U=e=>{let{deployment:t,project:o,useIgnoreBuildStep:a,onCurrentDeploymentPromoted:l}=e,s=(0,h.useToasts)(),c=(0,n.useRouter)(),{team:d}=(0,A.useTeam)(),{user:u}=(0,S.useUser)(),{mutate:m}=(0,P.useSWRConfig)(),[g,p]=(0,i.useState)(!1),[b,x]=(0,i.useState)(void 0),y=(0,D.useShowIgnoreBuildStep)({project:o,deployment:t});return{promote:(0,i.useCallback)(async()=>{if(t&&o){p(!0),x(void 0);try{let e,i=d?.id,r="Promoted Deployment successfully.";if("production"===t.target)await (0,j.fetchAPI)(`${(0,v.API_DEPLOYMENT_PROMOTE)(o.id,t.uid||t.id)}${(0,f.encode)({teamId:i})}`,{method:"POST",body:{},throwOnHTTPError:!0}),e=(0,w.pathFromDeployment)(t,{user:u,team:d});else{let n=await (0,j.fetchAPI)(`${(0,v.API_DEPLOYMENTS)("v13")}${(0,f.encode)({teamId:i,skipIgnoreBuildStep:y&&!a?"1":null})}`,{method:"POST",body:JSON.stringify({deploymentId:t.uid||t.id,meta:{action:"promote"},name:o.name,target:"production"}),throwOnHTTPError:!0});e=(0,w.pathFromDeployment)(n,{user:u,team:d});let l=t.uid||t.id;r="production"===t.target?l===n.id?"Deployment is already the current Production Deployment.":"Promoted Deployment to Production successfully.":"Created Production Deployment successfully."}d&&((0,L.revalidateProject)(m,o),await m((0,M.getProjectProductionDeploymentKey)({projectIdOrName:o.id,teamId:d.slug}))),s.success({text:r,key:"production-deployment"}),e&&(e===location.pathname?l?.():c.push(e))}catch(e){x((0,r.normalizeError)(e))}finally{p(!1)}}},[t,o,c,y,d,s,a,u,m,l]),loading:g,setLoading:p,error:b,setError:x}};e.s(["default",()=>W,"usePromoteDeployment",0,U,"usePromoteTooltip",()=>B],6619197)},4443312,e=>{"use strict";var t=e.i(4603164),i=e.i(5338940);function r(e){let{deploymentId:r,swrOptions:n,enableCiChecksAndPolicies:o}=e,{team:a}=(0,i.useTeam)();return(0,t.useTypedSWR)("/v2/deployments/{deploymentId}/check-runs",o&&r&&a?.id?{deploymentId:r,teamId:a.id}:null,{refreshInterval:3e3,...n})}e.s(["CHECK_RUNS_REFRESH_INTERVAL",0,3e3,"useProjectCheckRuns",()=>r])},3930829,e=>{"use strict";var t=e.i(6696646),i=e.i(8815282),r=e.i(2919890),n=e.i(7316497),o=e.i(5260505),a=e.i(8765922),l=e.i(1194788);function s(e,s,c){let{isServer:d,config:u,fetcher:m,fallbackSource:g}=(0,r.useIsomorphicSwrContext)(!0),p=(0,t.useMemo)(()=>"function"==typeof s?(e,t)=>s(e,t):(e,t)=>t(e),[s]),h=(0,t.useMemo)(()=>e=>{if(d)throw Error("useSWR: swrFetcher is not available on server");return p(e,m)},[d,p,m]),b="object"==typeof s?s:c,{ssr:x,...y}=b??{},f=(0,n.mergeConfig)(u,b),j=e(0,null),v=g(j??null,p,f,!1),{data:k,isLoading:S,error:A}=(0,o.useAsyncValue)(d,v),P=(0,i.default)((t,i)=>{let r=e(t,i);return S&&!d?null:r},h,{...y,suspense:!1,fallback:{[(0,i.unstable_serialize)(e)]:k?[k]:void 0},revalidateOnMount:!d&&(y.revalidateOnMount??(!k&&!S))}),{mutate:C,data:R,isLoading:w}=P,T=(0,t.useMemo)(()=>(0,a.withThrottle)(j,()=>{(0,l.debug)(`Client fallback data fetch for ${j}`),C()},2e3),[j,C]);return(0,t.useEffect)(()=>{!A||w||R||T()},[A,T,R,w]),{...P,isLoading:P.isLoading&&void 0===P.data||S||d}}e.s(["useIsomorphicSWRInfinite",()=>s])},5771992,e=>{"use strict";var t=e.i(6696646),i=e.i(3911483),r=e.i(8042625),n=e.i(277234),o=e.i(4244280),a=e.i(5338940),l=e.i(1360174),s=e.i(5140444),c=e.i(9100551),d=e.i(3930829),u=e.i(588428),m=e.i(4670733),g=e.i(2259673),p=e.i(7783521);function h(e){var i;let n,{limit:h,project:b,projectId:x,requireProject:y,users:f,target:j,readyStateFilter:v,meta:k,rollbackCandidate:S,since:A,until:P,subscribeToUpdates:C,branch:R,sha:w,ignoreProjectSlug:T,projectIds:I}=e,{refreshInterval:D,...N}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},L=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:M,team:$}=(0,a.useTeam)(),{user:z}=(0,s.useUser)(),[O,E]=(0,t.useState)(()=>D),B=f&&f.length>0?f.map(e=>e.uid).join(","):null,F=b?.id||x,{value:_}=(0,m.useInstantRollbackHobbyRestrictionFlag)(),{value:W}=(0,u.useInstantRollbackHobbyRestrictionTeamFlag)(),{teamSlug:U,project:H}=(0,c.useParams)()??{},Y={projectId:F,limit:h,teamId:$?.id,target:j||null,users:B,state:v,meta:k,rollbackCandidate:S,since:A,until:P,branch:R,sha:w,projectIds:I},G=y||(_||W)&&void 0!==S&&(!$||$.billing?.plan==="hobby"),V=(0,d.useIsomorphicSWRInfinite)((e,t)=>{if(U&&H&&!T){if(!e)return`${(0,o.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,teamId:U,projectId:H})}`;let i=t&&t.deployments.length>=h?t.deployments[t.deployments.length-1].created-1:null;return i?`${(0,o.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,teamId:U,projectId:H,from:i})}`:null}if(G&&!F)return null;if(!e)return M?`${(0,o.API_DEPLOYMENTS)(L)}${(0,r.encode)(Y)}`:null;let i=t&&t.deployments.length>=h?t.deployments[t.deployments.length-1].created-1:null;return i&&M?`${(0,o.API_DEPLOYMENTS)(L)}${(0,r.encode)({...Y,from:i})}`:null},{...N,refreshInterval:O,ssr:{timeout:1e3}}),{mutate:q}=V,K=(0,t.useMemo)(()=>(0,l.default)(()=>{q()},100),[q]),{isListening:X}=(n=(i=C?b:void 0)?`${i.accountId}-${i.id}`:void 0,(0,g.usePusherEvent)("deployments",n,"deployment-created",K));X||D===O?X&&3e4!==O&&E(3e4):E(D);let J=(0,t.useMemo)(()=>V.data?V.data.flatMap(e=>e.deployments):[],[V.data]),Q=$?$.id:z?.uid,Z=(0,t.useMemo)(()=>C&&Q?J.map(e=>({id:e.uid,readyState:e.readyState,aliasAssigned:!!e.aliasAssigned,ownerId:Q})):[],[J,C,Q]);(0,p.useDeploymentsStatusPing)(Z,K);let ee=!!V.data,et=ee&&0===J.length,ei=ee&&V.data&&V.size>V.data.length,er=ee&&V.data&&V.data[V.data.length-1]?.deployments.length<h;return[V,{deployments:J,initialDataLoaded:ee,isEmpty:et,loadMore:()=>V.setSize(e=>e+1),isLoadingMore:ei,isReachingEnd:er,mutate:V.mutate}]}function b(e){let{limit:t,projectId:l,project:s,from:c,target:d,users:u=[],...m}=e,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v6",{isReady:h,team:b}=(0,a.useTeam)(),x=u.length>0?u.map(e=>e.uid).join(","):null,y=!!l||!!s?.id;return(0,i.default)(h&&y&&t>0?`${(0,o.API_DEPLOYMENTS)(p)}${(0,r.encode)({projectId:l||s?.id,limit:t,from:c||null,teamId:b?.id,target:d,users:x,...m})}`:null,e=>(0,n.fetchAPI)(e,{throwOnHTTPError:!0}),g)}e.s(["default",()=>b,"useDeploymentsInfinite",()=>h],5771992)},415061,e=>{"use strict";var t=e.i(6468255);function i(e){let{width:i=24,height:r=24,style:n}=e;return(0,t.jsxs)("svg",{fill:"none",height:r,style:{border:"1px solid var(--accents-2)",borderRadius:"100%",boxSizing:"border-box",...n},viewBox:"0 0 24 24",width:i,children:[(0,t.jsx)("path",{clipRule:"evenodd",d:"M12 24c6.627 0 12-5.373 12-12S18.627 0 12 0 0 5.373 0 12s5.373 12 12 12z",fill:"#000",fillRule:"evenodd"}),(0,t.jsx)("path",{clipRule:"evenodd",d:"M12.24 6.24L18 16.378H6.48L12.24 6.24z",fill:"#fff",fillRule:"evenodd"})]})}e.s(["default",()=>i])},8651268,e=>{"use strict";var t=e.i(6468255),i=e.i(415061),r=e.i(4585051),n=e.i(76079),o=e.i(3025777),a=e.i(3896588),l=e.i(6683690);let s={12:-6},c={12:-5};function d(e){var u,m,g,p,h,b,x;let y,f,j,v,k,{title:S,principalId:A,principal:P,viaIds:C,via:R,size:w=32,style:T,entities:I,deploymentMeta:D,viewerId:N,iconBackground:L,...M}=e,$=!1,z=M.iconSize??(0==(y=(u=w/2.2)%2)?u:u+2-y);I?.forEach(e=>{"system"===e.type?$=!0:"github_login"===e.type?f=e:"gitlab_login"===e.type?j=e:"bitbucket_login"===e.type&&(v=e)}),D&&(D.githubCommitAuthorLogin?f={login:D.githubCommitAuthorLogin}:D.gitlabCommitAuthorLogin?j={login:D.gitlabCommitAuthorLogin,avatar:D.gitlabCommitAuthorAvatar}:D.bitbucketCommitAuthorName&&(v={login:D.bitbucketCommitAuthorName,avatar:D.bitbucketCommitAuthorAvatar}));let O="object"==typeof M.showProviderIcon?M.showProviderIcon:{github:M.showProviderIcon,gitlab:M.showProviderIcon,bitbucket:M.showProviderIcon};if(m=A,g=P,g?.type==="app"||m.startsWith("cl_")||(p=A,h=P,h?.type==="integration"||p.startsWith("oac_"))){let e=P&&"name"in P?P.name:void 0;return(0,t.jsx)(r.Avatar,{hash:P?.avatar,size:w,style:T,title:S??(e?`${e} Avatar`:void 0),uid:A})}if($||(b=A,x=P,x?.type==="system"||"system"===b))return(0,t.jsx)(i.default,{height:w,style:{marginTop:"2px",...T??{}},width:w});let E=S;A===N?(k="You",E??="Your Avatar"):P&&"username"in P&&(k=P.username,E??=`${k} Avatar`);let B=function(e,t){let i=e?.[0],r=t?.[0];if(!i){if(!r)return;switch(r.type){case"app":i=r.clientId;break;case"integration":i=r.id;break;case"system":i="system";break;default:i=r.uid}}return[i,r]}(C,R);return B?(0,t.jsx)(n.AvatarWithIcon,{hash:P?.avatar,size:w,style:T,title:E,uid:A,iconBackground:L,left:c[z],icon:(0,t.jsx)(d,{principalId:B[0],principal:B[1],size:z+4})}):f?.login?(0,t.jsx)(o.GitHubAvatar,{iconBackground:L,size:w,iconSize:z,left:s[z],bottom:s[z],style:T,title:S??`github/${f.login}`,username:f.login,showIcon:O.github}):j?.login?(0,t.jsx)(a.GitLabAvatar,{hash:j.avatar?void 0:P?.avatar,iconBackground:L,size:w,iconSize:z,style:T,title:S,url:j.avatar,showIcon:O.gitlab}):v?.login?(0,t.jsx)(l.BitbucketAvatar,{hash:v.avatar?void 0:P?.avatar,iconBackground:L,size:w,iconSize:z,style:T,title:S,url:v.avatar,showIcon:O.bitbucket}):(0,t.jsx)(r.Avatar,{hash:P?.avatar,size:w,style:T,title:E,uid:A})}function u(e){let t,{principalId:i,principal:r,viaIds:n,via:o,viewerId:a,includeVia:l}=e;if(r)switch(r.type){case"app":case"integration":t=r.name;break;case"system":t="System";break;default:if(r.uid===a){t="You";break}t=r.username}if(i&&i===a&&(t="You"),t&&l){let e=m({viaIds:n,via:o,viewerId:a});e&&(t+=`via ${e}`)}return t}function m(e){let{viaIds:t,via:i,viewerId:r}=e;if(t&&t.length>0)return u({principalId:t[0],principal:i?.[0],viewerId:r})}e.s(["PrincipalAvatar",()=>d,"getPrincipalName",()=>u,"getViaName",()=>m])},2982888,e=>{"use strict";var t=e.i(6468255),i=e.i(4585051),r=e.i(415061),n=e.i(8651268);function o(e){let{deployment:i,size:r=24,showIcon:n=!0,iconBackground:o=!0}=e;return(0,t.jsx)("span",{style:{display:"inline-block"},children:(0,t.jsx)(l,{deployment:i,iconBackground:o,showIcon:n,size:r})})}function a(e){let{deployment:t}=e;if(!t)return null;if(!t.meta?.originalDeploymentId){if(t.meta?.githubDeployment&&"string"==typeof t.meta.githubCommitAuthorLogin)return t.meta.githubCommitAuthorLogin;if(t.meta?.gitlabDeployment&&"string"==typeof t.meta.gitlabCommitAuthorLogin)return t.meta.gitlabCommitAuthorLogin;if(t.meta?.bitbucketDeployment){if("string"==typeof t.meta.bitbucketCommitAuthorLogin)return t.meta.bitbucketCommitAuthorLogin;if("string"==typeof t.meta.bitbucketCommitAuthorName)return t.meta.bitbucketCommitAuthorName}}return t.creator?.username||null}function l(e){let{deployment:r,showIcon:o,iconBackground:a,size:l}=e;return r?(0,t.jsx)(n.PrincipalAvatar,{size:l,principalId:r.creator.uid,principal:{type:"user",uid:r.creator.uid,username:r.creator.username},deploymentMeta:r.meta?.originalDeploymentId?void 0:r.meta,showProviderIcon:o,iconBackground:a}):(0,t.jsx)(i.Avatar,{placeholder:!0,size:l})}function s(e){let{height:i,width:n}=e;return(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)(r.default,{height:i,width:n})})}e.s(["DeployHookAvatar",()=>s,"DeploymentCreatorAvatar",()=>o,"getDeploymentCreatorUsername",()=>a])},8529990,e=>{"use strict";let t=encodeURIComponent;function i(e){return"string"==typeof e?e:void 0}function r(e){if(!e)return null;let{meta:r}=e;if(r?.githubDeployment){let e=`https://github.com/${t(r.githubCommitOrg??"")}/${t(r.githubCommitRepo??"")}/commit/${r.githubCommitSha}`,n=`https://github.com/${t(r.githubCommitOrg??"")}/${t(r.githubCommitRepo??"")}/tree/${t(r.githubCommitRef??"")}`,o=r.githubPrId?`https://github.com/${t(r.githubOrg??"")}/${t(r.githubRepo??"")}/pull/${r.githubPrId}`:void 0;return{type:"github",commitRef:String(r.githubCommitRef),commitSha:String(r.githubCommitSha),commitAuthorName:String(r.githubCommitAuthorName),commitAuthorLogin:i(r.githubCommitAuthorLogin),commitMessage:String(r.githubCommitMessage),repoName:String(r.githubCommitRepo),repoNamespace:String(r.githubCommitOrg),orgNamespace:String(r.githubOrg),commitUrl:e,refUrl:n,viaFork:r.githubOrg!==r.githubCommitOrg,prId:r.githubPrId?Number(r.githubPrId):void 0,prUrl:o,gitDirty:String(r.gitDirty),isPublic:"public"===r.githubRepoVisibility}}if(r?.gitlabDeployment){let e=`https://gitlab.com/${r.gitlabProjectPath}/tree/${t(r.gitlabCommitRef??"")}`,n=`https://gitlab.com/${r.gitlabProjectPath}/commit/${r.gitlabCommitSha}`;return{type:"gitlab",commitRef:String(r.gitlabCommitRef),commitSha:String(r.gitlabCommitSha),commitAuthorName:String(r.gitlabCommitAuthorName),commitAuthorLogin:i(r.gitlabCommitAuthorLogin),commitMessage:String(r.gitlabCommitMessage||r.gitCommitMessage),repoName:String(r.gitlabProjectName),repoNamespace:String(r.gitlabProjectNamespace),orgNamespace:String(r.gitlabProjectNamespace),commitUrl:n,refUrl:e,isPublic:"public"===r.gitlabProjectVisibility}}if(r?.bitbucketDeployment){let e=`https://bitbucket.org/${r.bitbucketRepoOwner}/${r.bitbucketRepoSlug}/branch/${t(r.bitbucketCommitRef??"")}`,n=`https://bitbucket.org/${r.bitbucketRepoOwner}/${r.bitbucketRepoSlug}/commits/${r.bitbucketCommitSha}`;return{type:"bitbucket",commitRef:String(r.bitbucketCommitRef),commitSha:String(r.bitbucketCommitSha),commitAuthorName:i(r.bitbucketCommitAuthorName),commitAuthorLogin:i(r.bitbucketCommitAuthorLogin),commitMessage:String(r.bitbucketCommitMessage),repoName:String(r.bitbucketRepoSlug),repoNamespace:String(r.bitbucketRepoOwner),orgNamespace:String(r.bitbucketRepoOwner),commitUrl:n,refUrl:e,isPublic:"public"===r.bitbucketRepoVisibility}}return null}e.s(["getGitInfoFromDeployment",()=>r])},3907048,e=>{"use strict";var t=e.i(6468255),i=e.i(4585051),r=e.i(6696646),n=e.i(2982888),o=e.i(8651268);let a=(0,r.memo)(e=>{let{deployment:r,size:a=24,showProviderIcon:l=!1}=e;return r.meta?.deployHookId?(0,t.jsx)(n.DeployHookAvatar,{height:a,width:a}):r.creator?.uid?(0,t.jsx)(o.PrincipalAvatar,{size:a,principalId:r.creator.uid,principal:{type:"user",uid:r.creator.uid,username:r.creator.username},deploymentMeta:r.meta?.originalDeploymentId?void 0:r.meta,showProviderIcon:{github:!1,gitlab:l,bitbucket:l}}):(0,t.jsx)(i.Avatar,{size:a})});a.displayName="CreatorAvatar",e.s(["CreatorAvatar",0,a])},8227242,e=>{"use strict";var t=e.i(6468255);e.i(9623499);var i=e.i(5576066);function r(e){let r,{text:n}=e;return(0,t.jsx)("span",{children:(r=/(?<temp1>https?:\/\/[^\s]+)/g,n.split(r).map(e=>r.test(e)?(0,t.jsx)(i.Link,{className:"break-all font-normal",href:e,rel:"noopener noreferrer",target:"_blank",type:"blend",children:e},e):(0,t.jsx)("span",{children:e},e)))})}e.s(["LinkParser",()=>r])},930810,9745887,e=>{"use strict";var t=e.i(6468255),i=e.i(1344973),r=e.i(2504781),n=e.i(9334091),o=e.i(3306538),a=e.i(9508212),l=e.i(57106),s=e.i(3753138),c=e.i(6226725),d=e.i(4345845),u=e.i(8893913),m=e.i(7218483),g=e.i(9722978),p=e.i(9375869),h=e.i(8529990),b=e.i(3907048);function x(e){let{isForm:i,children:r,className:n}=e;return i?(0,t.jsx)("label",{className:n,children:r}):(0,t.jsx)("div",{className:n,children:r})}function y(e){let{deployment:r,isForm:n,isPromote:y,isPreviousDeployment:f,isProductionDeployment:j,isRolledBackDeployment:v,selectedDeployment:k,setSelectedDeployment:S,ariaLabel:A="Rollback Deployment"}=e,P=(0,m.useAgo)(r.createdAt||0),C="number"==typeof r.aliasAssigned?r.aliasAssigned:0,R=C>0,w=(0,m.useAgo)(C),T=(0,p.useDeploymentLink)(r),I=(0,h.getGitInfoFromDeployment)(r),D=j||f||v;f&&v&&(f=!1);let N="Preview";if("target"in r)switch(r.target){case"staging":N="Staging";break;case"production":N="Production";break;default:N="Preview"}else N="Production";let L="uid"in r?r.uid:r.id,M=null;y?I?.commitRef&&(M=(0,t.jsxs)(a.Stack,{align:"center",direction:"row",gap:.5,children:[(0,t.jsx)(d.GitBranch,{color:"gray-900"}),(0,t.jsx)(i.Text,{as:"span",color:"gray-900",monospace:!0,style:{marginRight:"4px",maxWidth:120,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0},title:I.commitRef,truncate:!0,wrap:!1,children:I.commitRef}),(0,t.jsxs)(i.Text,{as:"span",className:"flex items-center gap-1",color:"gray-900",style:{flexBasis:"50%",flexShrink:0,flexGrow:1,textOverflow:"ellipsis",overflowX:"hidden",minWidth:0,maxWidth:260},truncate:!0,wrap:!1,children:["Staged"," ",P," by"," ",(0,t.jsx)("span",{children:(0,t.jsx)(b.CreatorAvatar,{deployment:r,showProviderIcon:!0,size:24})}),(0,t.jsx)("span",{children:!r.meta?.originalDeploymentId&&r.creator?.username?r.creator.username:I.commitAuthorLogin})]})]})):M=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"inline-flex flex-row items-center",children:[(0,t.jsx)(i.Text,{as:"span",color:"gray-900",size:14,style:{marginRight:"4px"},children:N}),I?.commitRef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.GitBranch,{color:"gray-900",size:14}),(0,t.jsx)(i.Text,{as:"span",className:"max-w-[100px] truncate whitespace-nowrap px-1 text-center text-sm leading-5 text-gray-900",monospace:!0,title:I.commitRef,children:I.commitRef}),(0,t.jsx)(i.Text,{as:"span",color:"gray-900",children:"by"}),(0,t.jsxs)("div",{className:"ml-1 inline-flex flex-row items-center gap-1",children:[(0,t.jsx)(b.CreatorAvatar,{deployment:r,size:20}),(0,t.jsx)(i.Text,{as:"span",className:"max-w-[140px] truncate",color:"gray-900",truncate:!0,children:!r.meta?.originalDeploymentId&&r.creator?.username?`${r.creator.username}`:I.commitAuthorLogin})]})]}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.Text,{as:"span",color:"gray-900",size:14,children:["Deployed"," "]}),(0,t.jsx)(i.Text,{as:"span",color:"gray-900",size:14,children:P}),(0,t.jsxs)(i.Text,{as:"span",color:"gray-900",size:14,children:[","," "]}),R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Text,{as:"span",color:"gray-900",size:14,children:["promoted"," "]}),(0,t.jsx)(i.Text,{as:"span",color:"gray-900",size:14,children:w})]}):(0,t.jsx)(i.Text,{as:"span",color:"gray-900",size:14,children:"never promoted"})]})]});let $=null;return n||($=y?(0,t.jsx)(s.ArrowCircleUp,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):j?(0,t.jsx)(c.CrossCircle,{className:"mr-4 hidden self-center sm:block",style:{flexShrink:0}}):(0,t.jsx)(u.RotateCounterClockwise,{className:"mr-4 hidden self-center sm:block",color:"gray-1000",style:{flexShrink:0}})),(0,t.jsxs)(x,{className:(0,g.clsx)("flex w-full items-end justify-start px-4 py-3","rounded border border-solid border-[var(--accents-2)]","rounded-b-none","last:rounded-b","[&+&]:rounded-t-none [&+&]:border-t-0",{"bg-[var(--accents-1)] shadow-none":j,"bg-[var(--geist-background)]":!j}),isForm:n,children:[n?(0,t.jsx)("input",{"aria-label":A,checked:k?.uid===L,className:`
            relative m-0 mr-4 size-4 shrink-0 appearance-none
            self-center rounded-[1000px] border
            border-solid border-[var(--geist-foreground)] after:absolute after:inset-[3px]
            after:rounded-[1000px] after:bg-[var(--geist-foreground)]
            after:content-none checked:after:content-['']
          `,name:"rollbackDeployment",onChange:()=>{"uid"in r&&"type"in r&&S&&S(r)},type:"radio",value:L}):$,(0,t.jsxs)("div",{style:{width:D?"initial":"100%",minWidth:0},children:[(0,t.jsx)(l.Link,{className:"flex w-[calc(100%-1ch)] items-center gap-0.5 break-all text-sm font-bold leading-5",href:T,target:"_blank",children:(0,t.jsx)(i.Text,{as:"span",title:r.url,truncate:1,weight:500,children:r.url})}),I?.commitMessage?(0,t.jsxs)(i.Text,{as:"p",className:"break-words",color:"gray-900",size:14,title:I.commitMessage,truncate:1,children:[I.commitSha.substring(0,7)," ",I.commitMessage]}):null,M]}),j?(0,t.jsx)(o.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"inverted",children:"Current"}):null,f?(0,t.jsx)(o.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"gray-subtle",children:"Previous"}):null,v?(0,t.jsx)(o.Badge,{className:"ml-auto hidden self-start text-xs font-medium sm:inline-flex",variant:"red-subtle",children:"Rolled back"}):null]})}e.s(["DeploymentCardSmall",()=>y],9745887);var f=e.i(8227242),j=e.i(8651268);function v(e){return"id"in e?e.id:"uid"in e?e.uid:void 0}function k(e){return void 0!==e.deleted}function S(e){let{rollbackDescription:r,project:n,preview:o}=e,a=(0,m.useAgo)(r.createdAt);return(0,t.jsxs)("div",{className:"px-4 py-3 rounded bg-background-200 shadow-border",children:[(0,t.jsx)(i.Text,{className:"break-words",color:"gray-900",children:r.description.length>0?(0,t.jsxs)(t.Fragment,{children:["“",(0,t.jsx)(f.LinkParser,{text:r.description}),"”"]}):(0,t.jsx)(i.Text,{children:"No reason provided."})}),(0,t.jsxs)("div",{className:"flex gap-1 pt-1",children:[o?null:(0,t.jsx)(i.Text,{children:"Rolled back by"}),r.username?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.PrincipalAvatar,{size:20,principalId:r.userId,principal:{type:"user",uid:r.userId,username:r.username}}),(0,t.jsx)(i.Text,{children:r.username}),n?.lastAliasRequest!==void 0&&!o&&(0,t.jsx)(i.Text,{children:a})]}):null]})]})}function A(e){let{deployments:i,previousDeployment:n,rolledBackDeploymentId:o,productionDeployment:a,selectedDeployment:l,setSelectedDeployment:s,swr:c,ariaLabel:d}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:i.map(e=>a.id!==e.uid&&(0,t.jsx)(y,{deployment:e,isForm:!0,isPreviousDeployment:n?.uid===e.uid,isRolledBackDeployment:o===e.uid,selectedDeployment:l,setSelectedDeployment:s,ariaLabel:d},e.uid))}),!c.isReachingEnd&&(0,t.jsx)(r.Button,{loading:c.isLoadingMore,onClick:()=>{c.loadMore()},style:{marginTop:24},type:"secondary",width:"100%",children:"Show More"})]})}function P(e){if(0===e.length)return;let t=e.reduce((e,t)=>e.aliasAssigned&&t.aliasAssigned?e.aliasAssigned>t.aliasAssigned?e:t:t.aliasAssigned?t:e);if(t.aliasAssigned)return t}function C(e){let{value:i,onChange:r,id:o}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.Textarea,{autoFocus:!0,className:"text-base min-h-24",error:i.length>=250?"Reason cannot be longer than 250 characters.":void 0,id:o,onChange:e=>r(e.target.value),placeholder:"Production is not behaving as expected…",required:!0,value:i,style:{fontSize:14}})})}e.s(["ChooseDeploymentList",()=>A,"REASON_MAX_CHARACTER_LENGTH",0,250,"RollbackDescriptionCard",()=>S,"RollbackDescriptionTextarea",()=>C,"getDeploymentId",()=>v,"getMostRecentlyPromotedDeployment",()=>P,"isDeleted",()=>k],930810)}]);

//# sourceMappingURL=74f887f24da43b8e.js.map
//# debugId=0456f14e-105b-5643-806b-a189663a3f50
